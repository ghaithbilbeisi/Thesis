[2019-12-21 16:36:13,368 INFO]  * tgt vocab size = 510
[2019-12-21 16:36:13,368 INFO] Building model...
[2019-12-22 14:16:10,092 INFO]  * tgt vocab size = 510
[2019-12-22 14:16:10,092 INFO] Building model...
[2019-12-22 14:16:16,963 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer3): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer5): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer6): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer7): Conv2d(128, 128, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layer8): Conv2d(128, 256, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layer9): Conv2d(256, 256, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layer10): Conv2d(256, 256, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layerfinal): Conv2d(256, 256, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (batch_norm1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(256, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 256)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-12-22 14:16:16,964 INFO] encoder: 4316416
[2019-12-22 14:16:16,964 INFO] decoder: 5214310
[2019-12-22 14:16:16,964 INFO] * number of parameters: 9530726
[2019-12-22 14:16:18,593 INFO] Starting training on GPU: [0]
[2019-12-22 14:16:18,593 INFO] Start training loop and validate every 10000 steps...
[2019-12-22 14:25:57,880 INFO] Step 500/100000; acc:  28.55; ppl: 40.79; xent: 3.71; lr: 0.10000;   0/1016 tok/s;    579 sec
[2019-12-22 14:35:14,411 INFO] Step 1000/100000; acc:  44.32; ppl: 13.65; xent: 2.61; lr: 0.10000;   0/1044 tok/s;   1136 sec
[2019-12-22 14:44:37,069 INFO] Step 1500/100000; acc:  48.06; ppl: 10.67; xent: 2.37; lr: 0.10000;   0/1047 tok/s;   1698 sec
[2019-12-22 14:53:54,736 INFO] Step 2000/100000; acc:  50.45; ppl:  9.21; xent: 2.22; lr: 0.10000;   0/1050 tok/s;   2256 sec
[2019-12-22 15:03:13,308 INFO] Step 2500/100000; acc:  54.70; ppl:  7.19; xent: 1.97; lr: 0.10000;   0/1046 tok/s;   2815 sec
[2019-12-22 15:12:41,592 INFO] Step 3000/100000; acc:  74.79; ppl:  2.90; xent: 1.07; lr: 0.10000;   0/1033 tok/s;   3383 sec
[2019-12-22 15:22:00,573 INFO] Step 3500/100000; acc:  85.80; ppl:  1.82; xent: 0.60; lr: 0.10000;   0/1046 tok/s;   3942 sec
[2019-12-22 15:31:28,682 INFO] Step 4000/100000; acc:  89.55; ppl:  1.55; xent: 0.44; lr: 0.10000;   0/1034 tok/s;   4510 sec
[2019-12-22 15:40:52,070 INFO] Step 4500/100000; acc:  91.19; ppl:  1.44; xent: 0.37; lr: 0.10000;   0/1037 tok/s;   5073 sec
[2019-12-22 15:50:06,295 INFO] Step 5000/100000; acc:  92.42; ppl:  1.37; xent: 0.32; lr: 0.10000;   0/1057 tok/s;   5628 sec
[2019-12-22 15:59:37,289 INFO] Step 5500/100000; acc:  93.21; ppl:  1.32; xent: 0.28; lr: 0.10000;   0/1031 tok/s;   6199 sec
[2019-12-22 16:08:56,157 INFO] Step 6000/100000; acc:  93.80; ppl:  1.29; xent: 0.26; lr: 0.10000;   0/1047 tok/s;   6758 sec
[2019-12-22 16:18:23,909 INFO] Step 6500/100000; acc:  94.24; ppl:  1.27; xent: 0.24; lr: 0.10000;   0/1033 tok/s;   7325 sec
[2019-12-22 16:27:45,450 INFO] Step 7000/100000; acc:  94.58; ppl:  1.25; xent: 0.22; lr: 0.10000;   0/1044 tok/s;   7887 sec
[2019-12-22 16:37:04,530 INFO] Step 7500/100000; acc:  94.98; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/1043 tok/s;   8446 sec
[2019-12-22 16:46:37,612 INFO] Step 8000/100000; acc:  95.14; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/1029 tok/s;   9019 sec
[2019-12-22 16:55:56,985 INFO] Step 8500/100000; acc:  95.43; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/1042 tok/s;   9578 sec
[2019-12-22 17:05:12,555 INFO] Step 9000/100000; acc:  95.63; ppl:  1.19; xent: 0.18; lr: 0.10000;   0/1052 tok/s;  10134 sec
[2019-12-22 17:14:40,262 INFO] Step 9500/100000; acc:  95.79; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/1041 tok/s;  10702 sec
[2019-12-22 17:23:56,055 INFO] Step 10000/100000; acc:  95.94; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/1048 tok/s;  11257 sec
[2019-12-22 17:29:02,652 INFO] Validation perplexity: 1.14993
[2019-12-22 17:29:02,653 INFO] Validation accuracy: 96.472
[2019-12-22 17:29:02,656 INFO] Saving checkpoint ../results/models/im2latex-62_step_10000.pt
[2019-12-22 17:38:27,358 INFO] Step 10500/100000; acc:  95.99; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/672 tok/s;  12129 sec
[2019-12-22 17:47:51,221 INFO] Step 11000/100000; acc:  96.12; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/1041 tok/s;  12693 sec
[2019-12-22 17:57:11,604 INFO] Step 11500/100000; acc:  96.25; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/1043 tok/s;  13253 sec
[2019-12-22 18:06:46,102 INFO] Step 12000/100000; acc:  96.36; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/1023 tok/s;  13828 sec
[2019-12-22 18:15:54,107 INFO] Step 12500/100000; acc:  96.53; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/1063 tok/s;  14376 sec
[2019-12-22 18:25:16,022 INFO] Step 13000/100000; acc:  96.55; ppl:  1.14; xent: 0.14; lr: 0.10000;   0/1043 tok/s;  14937 sec
[2019-12-22 18:34:38,223 INFO] Step 13500/100000; acc:  96.67; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1048 tok/s;  15500 sec
[2019-12-22 18:44:02,768 INFO] Step 14000/100000; acc:  96.71; ppl:  1.13; xent: 0.13; lr: 0.10000;   0/1037 tok/s;  16064 sec
[2019-12-22 18:53:31,550 INFO] Step 14500/100000; acc:  96.68; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1032 tok/s;  16633 sec
[2019-12-22 19:02:49,299 INFO] Step 15000/100000; acc:  96.80; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1046 tok/s;  17191 sec
[2019-12-22 19:12:18,148 INFO] Step 15500/100000; acc:  96.83; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1036 tok/s;  17760 sec
[2019-12-22 19:21:40,541 INFO] Step 16000/100000; acc:  96.92; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/1036 tok/s;  18322 sec
[2019-12-22 19:30:53,152 INFO] Step 16500/100000; acc:  96.96; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/1057 tok/s;  18875 sec
[2019-12-22 19:40:22,991 INFO] Step 17000/100000; acc:  97.05; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1036 tok/s;  19444 sec
[2019-12-22 19:55:27,966 INFO] Step 17500/100000; acc:  97.08; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/644 tok/s;  20349 sec
[2019-12-22 20:11:24,626 INFO] Step 18000/100000; acc:  97.10; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/614 tok/s;  21306 sec
[2019-12-22 20:27:19,476 INFO] Step 18500/100000; acc:  97.00; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/615 tok/s;  22261 sec
[2019-12-22 20:42:57,320 INFO] Step 19000/100000; acc:  97.14; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/621 tok/s;  23199 sec
[2019-12-22 20:59:10,268 INFO] Step 19500/100000; acc:  97.15; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/606 tok/s;  24172 sec
[2019-12-22 21:14:48,240 INFO] Step 20000/100000; acc:  97.23; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/621 tok/s;  25110 sec
[2019-12-22 21:23:41,271 INFO] Validation perplexity: 1.10745
[2019-12-22 21:23:41,272 INFO] Validation accuracy: 97.3474
[2019-12-22 21:23:41,275 INFO] Saving checkpoint ../results/models/im2latex-62_step_20000.pt
[2019-12-22 21:39:32,707 INFO] Step 20500/100000; acc:  97.28; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/396 tok/s;  26594 sec
[2019-12-22 21:55:24,065 INFO] Step 21000/100000; acc:  97.33; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/619 tok/s;  27545 sec
[2019-12-22 22:11:07,338 INFO] Step 21500/100000; acc:  97.38; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/618 tok/s;  28489 sec
[2019-12-22 22:27:01,755 INFO] Step 22000/100000; acc:  97.30; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/613 tok/s;  29443 sec
[2019-12-22 22:42:51,980 INFO] Step 22500/100000; acc:  97.32; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/617 tok/s;  30393 sec
[2019-12-22 22:58:48,155 INFO] Step 23000/100000; acc:  97.41; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/614 tok/s;  31350 sec
[2019-12-22 23:14:47,920 INFO] Step 23500/100000; acc:  97.41; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/610 tok/s;  32309 sec
[2019-12-22 23:30:21,949 INFO] Step 24000/100000; acc:  97.44; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/625 tok/s;  33243 sec
[2019-12-22 23:46:13,977 INFO] Step 24500/100000; acc:  97.50; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/616 tok/s;  34195 sec
[2019-12-23 00:02:04,413 INFO] Step 25000/100000; acc:  97.55; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/617 tok/s;  35146 sec
[2019-12-23 00:18:11,800 INFO] Step 25500/100000; acc:  97.54; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/607 tok/s;  36113 sec
[2019-12-23 00:34:09,744 INFO] Step 26000/100000; acc:  97.51; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/612 tok/s;  37071 sec
[2019-12-23 00:49:56,429 INFO] Step 26500/100000; acc:  97.55; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/615 tok/s;  38018 sec
[2019-12-23 01:06:02,069 INFO] Step 27000/100000; acc:  97.53; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/611 tok/s;  38983 sec
[2019-12-23 01:21:52,561 INFO] Step 27500/100000; acc:  97.65; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/613 tok/s;  39934 sec
[2019-12-23 01:37:34,613 INFO] Step 28000/100000; acc:  97.60; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/621 tok/s;  40876 sec
[2019-12-23 01:53:34,659 INFO] Step 28500/100000; acc:  97.66; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/614 tok/s;  41836 sec
[2019-12-23 02:09:18,260 INFO] Step 29000/100000; acc:  97.67; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/617 tok/s;  42780 sec
[2019-12-23 02:25:02,572 INFO] Step 29500/100000; acc:  97.67; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/623 tok/s;  43724 sec
[2019-12-23 02:40:40,792 INFO] Step 30000/100000; acc:  97.65; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/624 tok/s;  44662 sec
[2019-12-23 02:49:28,831 INFO] Validation perplexity: 1.09425
[2019-12-23 02:49:28,831 INFO] Validation accuracy: 97.6656
[2019-12-23 02:49:28,834 INFO] Saving checkpoint ../results/models/im2latex-62_step_30000.pt
[2019-12-23 03:04:54,638 INFO] Step 30500/100000; acc:  97.69; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/401 tok/s;  46116 sec
[2019-12-23 03:20:48,807 INFO] Step 31000/100000; acc:  97.73; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/618 tok/s;  47070 sec
[2019-12-23 03:36:02,802 INFO] Step 31500/100000; acc:  97.71; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/636 tok/s;  47984 sec
[2019-12-23 03:51:40,928 INFO] Step 32000/100000; acc:  97.79; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/627 tok/s;  48922 sec
[2019-12-23 04:07:17,694 INFO] Step 32500/100000; acc:  97.80; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/628 tok/s;  49859 sec
[2019-12-23 04:22:46,259 INFO] Step 33000/100000; acc:  97.79; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/629 tok/s;  50788 sec
[2019-12-23 04:38:28,353 INFO] Step 33500/100000; acc:  97.77; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/621 tok/s;  51730 sec
[2019-12-23 04:54:01,616 INFO] Step 34000/100000; acc:  97.80; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/627 tok/s;  52663 sec
[2019-12-23 05:09:40,991 INFO] Step 34500/100000; acc:  97.86; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/625 tok/s;  53602 sec
[2019-12-23 05:25:21,385 INFO] Step 35000/100000; acc:  97.83; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/622 tok/s;  54543 sec
[2019-12-23 05:40:41,940 INFO] Step 35500/100000; acc:  97.84; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/636 tok/s;  55463 sec
[2019-12-23 05:56:16,107 INFO] Step 36000/100000; acc:  97.89; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/629 tok/s;  56398 sec
[2019-12-23 06:11:46,285 INFO] Step 36500/100000; acc:  97.93; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/630 tok/s;  57328 sec
[2019-12-23 06:27:33,919 INFO] Step 37000/100000; acc:  97.91; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/619 tok/s;  58275 sec
[2019-12-23 06:43:09,704 INFO] Step 37500/100000; acc:  97.87; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/626 tok/s;  59211 sec
[2019-12-23 06:58:41,909 INFO] Step 38000/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/626 tok/s;  60143 sec
[2019-12-23 07:14:32,087 INFO] Step 38500/100000; acc:  97.85; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/622 tok/s;  61093 sec
[2019-12-23 07:30:10,866 INFO] Step 39000/100000; acc:  98.00; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/621 tok/s;  62032 sec
[2019-12-23 07:45:33,115 INFO] Step 39500/100000; acc:  97.96; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/633 tok/s;  62955 sec
[2019-12-23 08:01:18,148 INFO] Step 40000/100000; acc:  98.00; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/625 tok/s;  63900 sec
[2019-12-23 08:10:05,247 INFO] Validation perplexity: 1.08665
[2019-12-23 08:10:05,248 INFO] Validation accuracy: 97.852
[2019-12-23 08:10:05,250 INFO] Saving checkpoint ../results/models/im2latex-62_step_40000.pt
[2019-12-23 08:25:35,015 INFO] Step 40500/100000; acc:  97.99; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/400 tok/s;  65356 sec
[2019-12-23 08:41:17,088 INFO] Step 41000/100000; acc:  97.98; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/622 tok/s;  66298 sec
[2019-12-23 08:56:54,423 INFO] Step 41500/100000; acc:  97.96; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/626 tok/s;  67236 sec
[2019-12-23 09:12:20,630 INFO] Step 42000/100000; acc:  98.02; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/629 tok/s;  68162 sec
[2019-12-23 09:28:16,644 INFO] Step 42500/100000; acc:  98.00; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/616 tok/s;  69118 sec
[2019-12-23 09:43:29,866 INFO] Step 43000/100000; acc:  98.00; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/637 tok/s;  70031 sec
[2019-12-23 09:59:10,786 INFO] Step 43500/100000; acc:  98.06; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/627 tok/s;  70972 sec
[2019-12-23 10:14:46,656 INFO] Step 44000/100000; acc:  98.08; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/628 tok/s;  71908 sec
[2019-12-23 10:30:20,227 INFO] Step 44500/100000; acc:  98.07; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/626 tok/s;  72842 sec
[2019-12-23 10:46:06,867 INFO] Step 45000/100000; acc:  98.03; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/620 tok/s;  73788 sec
[2019-12-23 11:01:33,763 INFO] Step 45500/100000; acc:  98.06; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/630 tok/s;  74715 sec
[2019-12-23 11:12:20,516 INFO] Step 46000/100000; acc:  98.06; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/909 tok/s;  75362 sec
[2019-12-23 11:21:35,030 INFO] Step 46500/100000; acc:  98.10; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1053 tok/s;  75916 sec
[2019-12-23 11:30:40,103 INFO] Step 47000/100000; acc:  98.09; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1074 tok/s;  76462 sec
[2019-12-23 11:39:59,146 INFO] Step 47500/100000; acc:  98.13; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1051 tok/s;  77021 sec
[2019-12-23 11:49:08,332 INFO] Step 48000/100000; acc:  98.14; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1065 tok/s;  77570 sec
[2019-12-23 11:58:26,625 INFO] Step 48500/100000; acc:  98.16; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1050 tok/s;  78128 sec
[2019-12-23 12:07:40,302 INFO] Step 49000/100000; acc:  98.11; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1060 tok/s;  78682 sec
[2019-12-23 12:16:50,915 INFO] Step 49500/100000; acc:  98.14; ppl:  1.06; xent: 0.06; lr: 0.10000;   0/1059 tok/s;  79232 sec
[2019-12-23 12:26:15,696 INFO] Step 50000/100000; acc:  98.15; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/1044 tok/s;  79797 sec
[2019-12-23 12:31:19,834 INFO] Validation perplexity: 1.08213
[2019-12-23 12:31:19,835 INFO] Validation accuracy: 97.9469
[2019-12-23 12:31:19,837 INFO] Saving checkpoint ../results/models/im2latex-62_step_50000.pt
[2019-12-23 12:40:31,376 INFO] Step 50500/100000; acc:  98.31; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/681 tok/s;  80653 sec
[2019-12-23 12:49:42,317 INFO] Step 51000/100000; acc:  98.36; ppl:  1.06; xent: 0.05; lr: 0.05000;   0/1064 tok/s;  81204 sec
[2019-12-23 12:59:00,926 INFO] Step 51500/100000; acc:  98.38; ppl:  1.06; xent: 0.05; lr: 0.05000;   0/1057 tok/s;  81762 sec
[2019-12-23 13:08:09,934 INFO] Step 52000/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1060 tok/s;  82311 sec
[2019-12-23 13:17:27,908 INFO] Step 52500/100000; acc:  98.45; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1050 tok/s;  82869 sec
[2019-12-23 13:26:41,950 INFO] Step 53000/100000; acc:  98.44; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1058 tok/s;  83423 sec
[2019-12-23 13:35:56,256 INFO] Step 53500/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1056 tok/s;  83978 sec
[2019-12-23 13:45:21,142 INFO] Step 54000/100000; acc:  98.50; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1039 tok/s;  84543 sec
[2019-12-23 13:54:23,419 INFO] Step 54500/100000; acc:  98.48; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1074 tok/s;  85085 sec
[2019-12-23 14:03:40,147 INFO] Step 55000/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1055 tok/s;  85642 sec
[2019-12-23 14:12:55,436 INFO] Step 55500/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1059 tok/s;  86197 sec
[2019-12-23 14:22:11,217 INFO] Step 56000/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1054 tok/s;  86753 sec
[2019-12-23 14:31:32,880 INFO] Step 56500/100000; acc:  98.53; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1046 tok/s;  87314 sec
[2019-12-23 14:40:43,165 INFO] Step 57000/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1059 tok/s;  87865 sec
[2019-12-23 14:50:05,446 INFO] Step 57500/100000; acc:  98.57; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1049 tok/s;  88427 sec
[2019-12-23 14:59:21,708 INFO] Step 58000/100000; acc:  98.57; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1048 tok/s;  88983 sec
[2019-12-23 15:08:27,085 INFO] Step 58500/100000; acc:  98.57; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1070 tok/s;  89528 sec
[2019-12-23 15:17:51,007 INFO] Step 59000/100000; acc:  98.58; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1044 tok/s;  90092 sec
[2019-12-23 15:27:10,705 INFO] Step 59500/100000; acc:  98.60; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1041 tok/s;  90652 sec
[2019-12-23 15:36:41,238 INFO] Step 60000/100000; acc:  98.59; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1031 tok/s;  91223 sec
[2019-12-23 15:41:48,918 INFO] Validation perplexity: 1.07598
[2019-12-23 15:41:48,919 INFO] Validation accuracy: 98.1473
[2019-12-23 15:41:48,922 INFO] Saving checkpoint ../results/models/im2latex-62_step_60000.pt
[2019-12-23 15:51:09,233 INFO] Step 60500/100000; acc:  98.60; ppl:  1.05; xent: 0.04; lr: 0.02500;   0/676 tok/s;  92091 sec
[2019-12-23 16:00:16,803 INFO] Step 61000/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1064 tok/s;  92638 sec
[2019-12-23 16:09:46,542 INFO] Step 61500/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1035 tok/s;  93208 sec
[2019-12-23 16:18:51,514 INFO] Step 62000/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1066 tok/s;  93753 sec
[2019-12-23 16:28:05,400 INFO] Step 62500/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1061 tok/s;  94307 sec
[2019-12-23 16:37:23,176 INFO] Step 63000/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1055 tok/s;  94865 sec
[2019-12-23 16:46:33,597 INFO] Step 63500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1060 tok/s;  95415 sec
[2019-12-23 16:55:50,853 INFO] Step 64000/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1050 tok/s;  95972 sec
[2019-12-23 17:05:07,058 INFO] Step 64500/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1054 tok/s;  96528 sec
[2019-12-23 17:14:25,271 INFO] Step 65000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1051 tok/s;  97087 sec
[2019-12-23 17:23:44,659 INFO] Step 65500/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1046 tok/s;  97646 sec
[2019-12-23 17:32:49,431 INFO] Step 66000/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1073 tok/s;  98191 sec
[2019-12-23 17:42:03,588 INFO] Step 66500/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1061 tok/s;  98745 sec
[2019-12-23 17:51:16,825 INFO] Step 67000/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1060 tok/s;  99298 sec
[2019-12-23 18:00:35,199 INFO] Step 67500/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1051 tok/s;  99857 sec
[2019-12-23 18:09:52,145 INFO] Step 68000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1052 tok/s; 100414 sec
[2019-12-23 18:19:03,486 INFO] Step 68500/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1056 tok/s; 100965 sec
[2019-12-23 18:28:24,982 INFO] Step 69000/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1052 tok/s; 101526 sec
[2019-12-23 18:37:40,628 INFO] Step 69500/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1050 tok/s; 102082 sec
[2019-12-23 18:46:47,788 INFO] Step 70000/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1069 tok/s; 102629 sec
[2019-12-23 18:51:51,817 INFO] Validation perplexity: 1.07436
[2019-12-23 18:51:51,821 INFO] Validation accuracy: 98.2322
[2019-12-23 18:51:51,824 INFO] Saving checkpoint ../results/models/im2latex-62_step_70000.pt
[2019-12-23 19:01:07,600 INFO] Step 70500/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/685 tok/s; 103489 sec
[2019-12-23 19:10:18,474 INFO] Step 71000/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1058 tok/s; 104040 sec
[2019-12-23 19:19:37,316 INFO] Step 71500/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1051 tok/s; 104599 sec
[2019-12-23 19:28:54,034 INFO] Step 72000/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1053 tok/s; 105155 sec
[2019-12-23 19:38:03,230 INFO] Step 72500/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1061 tok/s; 105705 sec
[2019-12-23 19:47:29,690 INFO] Step 73000/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1039 tok/s; 106271 sec
[2019-12-23 19:56:31,673 INFO] Step 73500/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1073 tok/s; 106813 sec
[2019-12-23 20:05:50,027 INFO] Step 74000/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1054 tok/s; 107371 sec
[2019-12-23 20:15:05,861 INFO] Step 74500/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1058 tok/s; 107927 sec
[2019-12-23 20:24:16,756 INFO] Step 75000/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1060 tok/s; 108478 sec
[2019-12-23 20:33:36,320 INFO] Step 75500/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1047 tok/s; 109038 sec
[2019-12-23 20:42:47,300 INFO] Step 76000/100000; acc:  98.80; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1060 tok/s; 109589 sec
[2019-12-23 20:52:06,033 INFO] Step 76500/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1052 tok/s; 110147 sec
[2019-12-23 21:01:24,309 INFO] Step 77000/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1047 tok/s; 110706 sec
[2019-12-23 21:10:29,920 INFO] Step 77500/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1074 tok/s; 111251 sec
[2019-12-23 21:19:49,602 INFO] Step 78000/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1050 tok/s; 111811 sec
[2019-12-23 21:29:00,646 INFO] Step 78500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1062 tok/s; 112362 sec
[2019-12-23 21:38:21,987 INFO] Step 79000/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1045 tok/s; 112923 sec
[2019-12-23 21:47:40,847 INFO] Step 79500/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1050 tok/s; 113482 sec
[2019-12-23 21:56:50,368 INFO] Step 80000/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1059 tok/s; 114032 sec
[2019-12-23 22:01:54,471 INFO] Validation perplexity: 1.07502
[2019-12-23 22:01:54,472 INFO] Validation accuracy: 98.2559
[2019-12-23 22:01:54,475 INFO] Saving checkpoint ../results/models/im2latex-62_step_80000.pt
[2019-12-23 22:11:19,198 INFO] Step 80500/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/680 tok/s; 114901 sec
[2019-12-23 22:20:30,899 INFO] Step 81000/100000; acc:  98.90; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1056 tok/s; 115452 sec
[2019-12-23 22:29:36,003 INFO] Step 81500/100000; acc:  98.87; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1071 tok/s; 115997 sec
[2019-12-23 22:38:55,798 INFO] Step 82000/100000; acc:  98.87; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1055 tok/s; 116557 sec
[2019-12-23 22:48:05,678 INFO] Step 82500/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1060 tok/s; 117107 sec
[2019-12-23 22:57:22,393 INFO] Step 83000/100000; acc:  98.89; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1052 tok/s; 117664 sec
[2019-12-23 23:06:37,059 INFO] Step 83500/100000; acc:  98.87; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1056 tok/s; 118218 sec
[2019-12-23 23:15:47,942 INFO] Step 84000/100000; acc:  98.89; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1060 tok/s; 118769 sec
[2019-12-23 23:25:17,139 INFO] Step 84500/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1035 tok/s; 119339 sec
[2019-12-23 23:34:16,873 INFO] Step 85000/100000; acc:  98.89; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1077 tok/s; 119878 sec
[2019-12-23 23:43:30,417 INFO] Step 85500/100000; acc:  98.89; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1060 tok/s; 120432 sec
[2019-12-23 23:52:45,650 INFO] Step 86000/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1061 tok/s; 120987 sec
[2019-12-24 00:02:04,767 INFO] Step 86500/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1047 tok/s; 121546 sec
[2019-12-24 00:11:27,152 INFO] Step 87000/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1044 tok/s; 122109 sec
[2019-12-24 00:20:36,729 INFO] Step 87500/100000; acc:  98.88; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1062 tok/s; 122658 sec
[2019-12-24 00:29:56,833 INFO] Step 88000/100000; acc:  98.89; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1052 tok/s; 123218 sec
[2019-12-24 00:39:12,731 INFO] Step 88500/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1049 tok/s; 123774 sec
[2019-12-24 00:48:18,788 INFO] Step 89000/100000; acc:  98.89; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1071 tok/s; 124320 sec
[2019-12-24 00:57:44,573 INFO] Step 89500/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1043 tok/s; 124886 sec
[2019-12-24 01:06:55,322 INFO] Step 90000/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1061 tok/s; 125437 sec
[2019-12-24 01:11:59,444 INFO] Validation perplexity: 1.07513
[2019-12-24 01:11:59,445 INFO] Validation accuracy: 98.2539
[2019-12-24 01:11:59,448 INFO] Saving checkpoint ../results/models/im2latex-62_step_90000.pt
[2019-12-24 01:21:17,788 INFO] Step 90500/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/680 tok/s; 126299 sec
[2019-12-24 01:30:33,802 INFO] Step 91000/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1056 tok/s; 126855 sec
[2019-12-24 01:39:42,768 INFO] Step 91500/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1060 tok/s; 127404 sec
[2019-12-24 01:49:10,898 INFO] Step 92000/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1038 tok/s; 127972 sec
[2019-12-24 01:58:19,428 INFO] Step 92500/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1063 tok/s; 128521 sec
[2019-12-24 02:07:33,409 INFO] Step 93000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1058 tok/s; 129075 sec
[2019-12-24 02:16:48,983 INFO] Step 93500/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1061 tok/s; 129630 sec
[2019-12-24 02:25:57,132 INFO] Step 94000/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1062 tok/s; 130179 sec
[2019-12-24 02:35:15,770 INFO] Step 94500/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1049 tok/s; 130737 sec
[2019-12-24 02:44:31,168 INFO] Step 95000/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1054 tok/s; 131293 sec
[2019-12-24 02:53:45,816 INFO] Step 95500/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1056 tok/s; 131847 sec
[2019-12-24 03:03:10,337 INFO] Step 96000/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1039 tok/s; 132412 sec
[2019-12-24 03:12:12,054 INFO] Step 96500/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1076 tok/s; 132953 sec
[2019-12-24 03:21:25,259 INFO] Step 97000/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1058 tok/s; 133507 sec
[2019-12-24 03:30:40,379 INFO] Step 97500/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1058 tok/s; 134062 sec
[2019-12-24 03:39:57,550 INFO] Step 98000/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1053 tok/s; 134619 sec
[2019-12-24 03:49:18,369 INFO] Step 98500/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1048 tok/s; 135180 sec
[2019-12-24 03:58:27,372 INFO] Step 99000/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1060 tok/s; 135729 sec
[2019-12-24 04:07:49,455 INFO] Step 99500/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1051 tok/s; 136291 sec
[2019-12-24 04:17:03,143 INFO] Step 100000/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00156;   0/1052 tok/s; 136845 sec
[2019-12-24 04:22:07,135 INFO] Validation perplexity: 1.07536
[2019-12-24 04:22:07,139 INFO] Validation accuracy: 98.2527
[2019-12-24 04:22:07,142 INFO] Saving checkpoint ../results/models/im2latex-62_step_100000.pt
