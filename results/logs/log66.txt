[2019-12-31 02:28:56,857 INFO]  * tgt vocab size = 510
[2019-12-31 02:28:56,857 INFO] Building model...
[2019-12-31 02:29:00,440 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer3): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer5): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer6): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (batch_norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(512, 125, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 512)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(330, 250)
        (1): LSTMCell(250, 250)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=250, out_features=250, bias=False)
      (linear_out): Linear(in_features=500, out_features=250, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=250, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-12-31 02:29:00,442 INFO] encoder: 6031424
[2019-12-31 02:29:00,442 INFO] decoder: 1440310
[2019-12-31 02:29:00,442 INFO] * number of parameters: 7471734
[2019-12-31 02:29:02,608 INFO] Starting training on GPU: [0]
[2019-12-31 02:29:02,608 INFO] Start training loop and validate every 10000 steps...
[2019-12-31 02:31:55,056 INFO] Step 500/100000; acc:  29.81; ppl: 32.03; xent: 3.47; lr: 0.10000;   0/3412 tok/s;    172 sec
[2019-12-31 02:34:47,990 INFO] Step 1000/100000; acc:  44.46; ppl: 13.49; xent: 2.60; lr: 0.10000;   0/3361 tok/s;    345 sec
[2019-12-31 02:37:47,097 INFO] Step 1500/100000; acc:  48.07; ppl: 10.70; xent: 2.37; lr: 0.10000;   0/3288 tok/s;    524 sec
[2019-12-31 02:40:47,403 INFO] Step 2000/100000; acc:  50.82; ppl:  9.12; xent: 2.21; lr: 0.10000;   0/3258 tok/s;    705 sec
[2019-12-31 02:43:40,975 INFO] Step 2500/100000; acc:  55.75; ppl:  6.81; xent: 1.92; lr: 0.10000;   0/3363 tok/s;    878 sec
[2019-12-31 02:46:38,169 INFO] Step 3000/100000; acc:  69.92; ppl:  3.53; xent: 1.26; lr: 0.10000;   0/3311 tok/s;   1056 sec
[2019-12-31 02:49:59,750 INFO] Step 3500/100000; acc:  80.32; ppl:  2.27; xent: 0.82; lr: 0.10000;   0/2900 tok/s;   1257 sec
[2019-12-31 02:55:09,547 INFO] Step 4000/100000; acc:  84.92; ppl:  1.88; xent: 0.63; lr: 0.10000;   0/1899 tok/s;   1567 sec
[2019-12-31 03:00:46,864 INFO] Step 4500/100000; acc:  87.53; ppl:  1.68; xent: 0.52; lr: 0.10000;   0/1729 tok/s;   1904 sec
[2019-12-31 03:06:19,897 INFO] Step 5000/100000; acc:  89.30; ppl:  1.56; xent: 0.45; lr: 0.10000;   0/1760 tok/s;   2237 sec
[2019-12-31 03:11:45,039 INFO] Step 5500/100000; acc:  90.34; ppl:  1.49; xent: 0.40; lr: 0.10000;   0/1808 tok/s;   2562 sec
[2019-12-31 03:16:37,663 INFO] Step 6000/100000; acc:  91.11; ppl:  1.44; xent: 0.37; lr: 0.10000;   0/1999 tok/s;   2855 sec
[2019-12-31 03:21:11,866 INFO] Step 6500/100000; acc:  91.81; ppl:  1.40; xent: 0.33; lr: 0.10000;   0/2138 tok/s;   3129 sec
[2019-12-31 03:25:44,803 INFO] Step 7000/100000; acc:  92.36; ppl:  1.37; xent: 0.31; lr: 0.10000;   0/2147 tok/s;   3402 sec
[2019-12-31 03:30:10,638 INFO] Step 7500/100000; acc:  92.90; ppl:  1.33; xent: 0.29; lr: 0.10000;   0/2194 tok/s;   3668 sec
[2019-12-31 03:33:23,637 INFO] Step 8000/100000; acc:  93.13; ppl:  1.32; xent: 0.28; lr: 0.10000;   0/3057 tok/s;   3861 sec
[2019-12-31 03:35:39,234 INFO] Step 8500/100000; acc:  93.71; ppl:  1.29; xent: 0.26; lr: 0.10000;   0/4293 tok/s;   3997 sec
[2019-12-31 03:37:54,960 INFO] Step 9000/100000; acc:  94.02; ppl:  1.27; xent: 0.24; lr: 0.10000;   0/4315 tok/s;   4132 sec
[2019-12-31 03:40:14,787 INFO] Step 9500/100000; acc:  94.21; ppl:  1.27; xent: 0.24; lr: 0.10000;   0/4230 tok/s;   4272 sec
[2019-12-31 03:42:28,780 INFO] Step 10000/100000; acc:  94.37; ppl:  1.25; xent: 0.23; lr: 0.10000;   0/4345 tok/s;   4406 sec
[2019-12-31 03:43:36,911 INFO] Validation perplexity: 1.22563
[2019-12-31 03:43:36,912 INFO] Validation accuracy: 94.9529
[2019-12-31 03:43:36,914 INFO] Saving checkpoint ../results/models/im2latex-66_step_10000.pt
[2019-12-31 03:45:52,324 INFO] Step 10500/100000; acc:  94.47; ppl:  1.25; xent: 0.22; lr: 0.10000;   0/2877 tok/s;   4610 sec
[2019-12-31 03:48:09,275 INFO] Step 11000/100000; acc:  94.72; ppl:  1.23; xent: 0.21; lr: 0.10000;   0/4284 tok/s;   4747 sec
[2019-12-31 03:50:23,717 INFO] Step 11500/100000; acc:  94.89; ppl:  1.23; xent: 0.20; lr: 0.10000;   0/4348 tok/s;   4881 sec
[2019-12-31 03:52:40,151 INFO] Step 12000/100000; acc:  95.03; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/4305 tok/s;   5018 sec
[2019-12-31 03:54:53,477 INFO] Step 12500/100000; acc:  95.25; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/4370 tok/s;   5151 sec
[2019-12-31 03:57:09,542 INFO] Step 13000/100000; acc:  95.34; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/4303 tok/s;   5287 sec
[2019-12-31 03:59:25,357 INFO] Step 13500/100000; acc:  95.44; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/4333 tok/s;   5423 sec
[2019-12-31 04:01:41,388 INFO] Step 14000/100000; acc:  95.48; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/4308 tok/s;   5559 sec
[2019-12-31 04:03:57,845 INFO] Step 14500/100000; acc:  95.47; ppl:  1.19; xent: 0.18; lr: 0.10000;   0/4301 tok/s;   5695 sec
[2019-12-31 04:06:12,111 INFO] Step 15000/100000; acc:  95.70; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/4343 tok/s;   5830 sec
[2019-12-31 04:08:27,343 INFO] Step 15500/100000; acc:  95.71; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/4359 tok/s;   5965 sec
[2019-12-31 04:10:41,293 INFO] Step 16000/100000; acc:  95.82; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/4350 tok/s;   6099 sec
[2019-12-31 04:12:54,040 INFO] Step 16500/100000; acc:  95.98; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/4397 tok/s;   6231 sec
[2019-12-31 04:15:09,667 INFO] Step 17000/100000; acc:  96.01; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/4355 tok/s;   6367 sec
[2019-12-31 04:17:22,920 INFO] Step 17500/100000; acc:  96.02; ppl:  1.17; xent: 0.15; lr: 0.10000;   0/4376 tok/s;   6500 sec
[2019-12-31 04:19:38,111 INFO] Step 18000/100000; acc:  96.03; ppl:  1.17; xent: 0.15; lr: 0.10000;   0/4345 tok/s;   6636 sec
[2019-12-31 04:21:52,505 INFO] Step 18500/100000; acc:  96.09; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/4370 tok/s;   6770 sec
[2019-12-31 04:24:04,870 INFO] Step 19000/100000; acc:  96.18; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/4401 tok/s;   6902 sec
[2019-12-31 04:26:22,010 INFO] Step 19500/100000; acc:  96.14; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/4298 tok/s;   7039 sec
[2019-12-31 04:28:36,177 INFO] Step 20000/100000; acc:  96.34; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/4340 tok/s;   7174 sec
[2019-12-31 04:29:31,516 INFO] Validation perplexity: 1.13861
[2019-12-31 04:29:31,517 INFO] Validation accuracy: 96.671
[2019-12-31 04:29:31,520 INFO] Saving checkpoint ../results/models/im2latex-66_step_20000.pt
[2019-12-31 04:31:55,543 INFO] Step 20500/100000; acc:  96.39; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/2945 tok/s;   7373 sec
[2019-12-31 04:34:16,269 INFO] Step 21000/100000; acc:  96.46; ppl:  1.14; xent: 0.14; lr: 0.10000;   0/4184 tok/s;   7514 sec
[2019-12-31 04:36:30,273 INFO] Step 21500/100000; acc:  96.45; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/4352 tok/s;   7648 sec
[2019-12-31 04:38:47,252 INFO] Step 22000/100000; acc:  96.39; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/4270 tok/s;   7785 sec
[2019-12-31 04:41:10,241 INFO] Step 22500/100000; acc:  96.48; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/4097 tok/s;   7928 sec
[2019-12-31 04:43:34,177 INFO] Step 23000/100000; acc:  96.55; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/4080 tok/s;   8072 sec
[2019-12-31 04:45:58,174 INFO] Step 23500/100000; acc:  96.57; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/4064 tok/s;   8216 sec
[2019-12-31 04:48:17,707 INFO] Step 24000/100000; acc:  96.64; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/4184 tok/s;   8355 sec
[2019-12-31 04:50:32,373 INFO] Step 24500/100000; acc:  96.67; ppl:  1.13; xent: 0.13; lr: 0.10000;   0/4356 tok/s;   8490 sec
[2019-12-31 04:52:46,937 INFO] Step 25000/100000; acc:  96.77; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/4356 tok/s;   8624 sec
[2019-12-31 04:55:02,960 INFO] Step 25500/100000; acc:  96.69; ppl:  1.13; xent: 0.13; lr: 0.10000;   0/4322 tok/s;   8760 sec
[2019-12-31 04:57:18,006 INFO] Step 26000/100000; acc:  96.70; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/4340 tok/s;   8895 sec
[2019-12-31 04:59:31,252 INFO] Step 26500/100000; acc:  96.79; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/4373 tok/s;   9029 sec
[2019-12-31 05:01:46,819 INFO] Step 27000/100000; acc:  96.73; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/4351 tok/s;   9164 sec
[2019-12-31 05:04:00,202 INFO] Step 27500/100000; acc:  96.88; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/4369 tok/s;   9298 sec
[2019-12-31 05:06:13,505 INFO] Step 28000/100000; acc:  96.88; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/4389 tok/s;   9431 sec
[2019-12-31 05:08:28,571 INFO] Step 28500/100000; acc:  96.98; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/4375 tok/s;   9566 sec
[2019-12-31 05:10:41,837 INFO] Step 29000/100000; acc:  96.91; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/4371 tok/s;   9699 sec
[2019-12-31 05:12:56,713 INFO] Step 29500/100000; acc:  96.94; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/4358 tok/s;   9834 sec
[2019-12-31 05:15:10,451 INFO] Step 30000/100000; acc:  96.94; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/4382 tok/s;   9968 sec
[2019-12-31 05:16:05,140 INFO] Validation perplexity: 1.14185
[2019-12-31 05:16:05,141 INFO] Validation accuracy: 96.7116
[2019-12-31 05:16:05,143 INFO] Saving checkpoint ../results/models/im2latex-66_step_30000.pt
[2019-12-31 05:18:18,395 INFO] Step 30500/100000; acc:  96.97; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3100 tok/s;  10156 sec
[2019-12-31 05:20:34,189 INFO] Step 31000/100000; acc:  96.94; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/4335 tok/s;  10292 sec
[2019-12-31 05:22:45,955 INFO] Step 31500/100000; acc:  97.01; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/4414 tok/s;  10423 sec
[2019-12-31 05:25:00,474 INFO] Step 32000/100000; acc:  97.10; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/4376 tok/s;  10558 sec
[2019-12-31 05:27:13,862 INFO] Step 32500/100000; acc:  97.09; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/4396 tok/s;  10691 sec
[2019-12-31 05:29:26,583 INFO] Step 33000/100000; acc:  97.10; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/4401 tok/s;  10824 sec
[2019-12-31 05:31:40,712 INFO] Step 33500/100000; acc:  97.04; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/4362 tok/s;  10958 sec
[2019-12-31 05:33:53,715 INFO] Step 34000/100000; acc:  97.11; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/4403 tok/s;  11091 sec
[2019-12-31 05:36:07,430 INFO] Step 34500/100000; acc:  97.15; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/4389 tok/s;  11225 sec
[2019-12-31 05:38:22,174 INFO] Step 35000/100000; acc:  97.15; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/4340 tok/s;  11360 sec
[2019-12-31 05:40:35,727 INFO] Step 35500/100000; acc:  97.21; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/4386 tok/s;  11493 sec
[2019-12-31 05:42:51,464 INFO] Step 36000/100000; acc:  97.28; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/4330 tok/s;  11629 sec
[2019-12-31 05:45:05,666 INFO] Step 36500/100000; acc:  97.26; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/4366 tok/s;  11763 sec
[2019-12-31 05:47:21,014 INFO] Step 37000/100000; acc:  97.21; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/4333 tok/s;  11898 sec
[2019-12-31 05:49:35,028 INFO] Step 37500/100000; acc:  97.24; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/4367 tok/s;  12032 sec
[2019-12-31 05:51:48,621 INFO] Step 38000/100000; acc:  97.26; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/4369 tok/s;  12166 sec
[2019-12-31 05:54:04,493 INFO] Step 38500/100000; acc:  97.22; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/4346 tok/s;  12302 sec
[2019-12-31 05:56:18,325 INFO] Step 39000/100000; acc:  97.35; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/4356 tok/s;  12436 sec
[2019-12-31 05:58:31,562 INFO] Step 39500/100000; acc:  97.32; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/4383 tok/s;  12569 sec
[2019-12-31 06:00:48,521 INFO] Step 40000/100000; acc:  97.35; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/4314 tok/s;  12706 sec
[2019-12-31 06:01:46,113 INFO] Validation perplexity: 1.10688
[2019-12-31 06:01:46,114 INFO] Validation accuracy: 97.3864
[2019-12-31 06:01:46,116 INFO] Saving checkpoint ../results/models/im2latex-66_step_40000.pt
[2019-12-31 06:04:06,011 INFO] Step 40500/100000; acc:  97.31; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/2951 tok/s;  12903 sec
[2019-12-31 06:06:29,729 INFO] Step 41000/100000; acc:  97.35; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/4082 tok/s;  13047 sec
[2019-12-31 06:08:50,612 INFO] Step 41500/100000; acc:  97.33; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/4159 tok/s;  13188 sec
[2019-12-31 06:11:06,254 INFO] Step 42000/100000; acc:  97.37; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/4304 tok/s;  13324 sec
[2019-12-31 06:13:24,310 INFO] Step 42500/100000; acc:  97.36; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/4264 tok/s;  13462 sec
[2019-12-31 06:15:37,919 INFO] Step 43000/100000; acc:  97.43; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/4351 tok/s;  13595 sec
[2019-12-31 06:17:55,398 INFO] Step 43500/100000; acc:  97.47; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/4272 tok/s;  13733 sec
[2019-12-31 06:20:11,760 INFO] Step 44000/100000; acc:  97.48; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/4316 tok/s;  13869 sec
[2019-12-31 06:22:27,782 INFO] Step 44500/100000; acc:  97.49; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/4298 tok/s;  14005 sec
[2019-12-31 06:24:45,473 INFO] Step 45000/100000; acc:  97.46; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/4263 tok/s;  14143 sec
[2019-12-31 06:26:59,350 INFO] Step 45500/100000; acc:  97.44; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/4361 tok/s;  14277 sec
[2019-12-31 06:29:22,115 INFO] Step 46000/100000; acc:  97.54; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/4123 tok/s;  14420 sec
[2019-12-31 06:31:42,626 INFO] Step 46500/100000; acc:  97.52; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/4151 tok/s;  14560 sec
[2019-12-31 06:33:58,012 INFO] Step 47000/100000; acc:  97.53; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/4322 tok/s;  14695 sec
[2019-12-31 06:36:16,469 INFO] Step 47500/100000; acc:  97.62; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/4248 tok/s;  14834 sec
[2019-12-31 06:38:33,390 INFO] Step 48000/100000; acc:  97.56; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/4268 tok/s;  14971 sec
[2019-12-31 06:40:51,442 INFO] Step 48500/100000; acc:  97.53; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/4252 tok/s;  15109 sec
[2019-12-31 06:43:08,836 INFO] Step 49000/100000; acc:  97.53; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/4265 tok/s;  15246 sec
[2019-12-31 06:45:24,957 INFO] Step 49500/100000; acc:  97.59; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/4283 tok/s;  15382 sec
[2019-12-31 06:47:43,807 INFO] Step 50000/100000; acc:  97.56; ppl:  1.09; xent: 0.09; lr: 0.05000;   0/4248 tok/s;  15521 sec
[2019-12-31 06:48:39,410 INFO] Validation perplexity: 1.10825
[2019-12-31 06:48:39,411 INFO] Validation accuracy: 97.398
[2019-12-31 06:48:39,413 INFO] Saving checkpoint ../results/models/im2latex-66_step_50000.pt
[2019-12-31 06:50:57,193 INFO] Step 50500/100000; acc:  97.79; ppl:  1.08; xent: 0.08; lr: 0.05000;   0/3012 tok/s;  15715 sec
[2019-12-31 06:53:20,374 INFO] Step 51000/100000; acc:  97.92; ppl:  1.08; xent: 0.07; lr: 0.05000;   0/4095 tok/s;  15858 sec
[2019-12-31 06:55:37,267 INFO] Step 51500/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/4319 tok/s;  15995 sec
[2019-12-31 06:57:56,823 INFO] Step 52000/100000; acc:  98.00; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/4170 tok/s;  16134 sec
[2019-12-31 07:00:22,392 INFO] Step 52500/100000; acc:  97.96; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/4026 tok/s;  16280 sec
[2019-12-31 07:02:43,271 INFO] Step 53000/100000; acc:  98.03; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/4159 tok/s;  16421 sec
[2019-12-31 07:05:00,566 INFO] Step 53500/100000; acc:  98.05; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/4262 tok/s;  16558 sec
[2019-12-31 07:07:19,105 INFO] Step 54000/100000; acc:  98.08; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/4235 tok/s;  16696 sec
[2019-12-31 07:09:34,251 INFO] Step 54500/100000; acc:  98.05; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/4314 tok/s;  16832 sec
[2019-12-31 07:11:59,073 INFO] Step 55000/100000; acc:  98.05; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/4052 tok/s;  16976 sec
[2019-12-31 07:14:23,528 INFO] Step 55500/100000; acc:  98.11; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/4072 tok/s;  17121 sec
[2019-12-31 07:16:47,852 INFO] Step 56000/100000; acc:  98.11; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/4061 tok/s;  17265 sec
[2019-12-31 07:19:13,115 INFO] Step 56500/100000; acc:  98.10; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/4041 tok/s;  17411 sec
[2019-12-31 07:21:35,986 INFO] Step 57000/100000; acc:  98.12; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/4079 tok/s;  17553 sec
[2019-12-31 07:24:01,433 INFO] Step 57500/100000; acc:  98.15; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/4056 tok/s;  17699 sec
[2019-12-31 07:26:25,056 INFO] Step 58000/100000; acc:  98.14; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/4059 tok/s;  17842 sec
[2019-12-31 07:28:47,791 INFO] Step 58500/100000; acc:  98.13; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/4092 tok/s;  17985 sec
[2019-12-31 07:31:12,611 INFO] Step 59000/100000; acc:  98.17; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/4064 tok/s;  18130 sec
[2019-12-31 07:33:28,725 INFO] Step 59500/100000; acc:  98.18; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/4281 tok/s;  18266 sec
[2019-12-31 07:35:46,371 INFO] Step 60000/100000; acc:  98.21; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/4274 tok/s;  18404 sec
[2019-12-31 07:36:41,689 INFO] Validation perplexity: 1.09531
[2019-12-31 07:36:41,690 INFO] Validation accuracy: 97.6974
[2019-12-31 07:36:41,693 INFO] Saving checkpoint ../results/models/im2latex-66_step_60000.pt
[2019-12-31 07:38:58,699 INFO] Step 60500/100000; acc:  98.20; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/3052 tok/s;  18596 sec
[2019-12-31 07:41:13,032 INFO] Step 61000/100000; acc:  98.27; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/4336 tok/s;  18730 sec
[2019-12-31 07:43:31,071 INFO] Step 61500/100000; acc:  98.29; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/4273 tok/s;  18868 sec
[2019-12-31 07:45:43,375 INFO] Step 62000/100000; acc:  98.30; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/4395 tok/s;  19001 sec
[2019-12-31 07:47:57,566 INFO] Step 62500/100000; acc:  98.32; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/4379 tok/s;  19135 sec
[2019-12-31 07:50:12,251 INFO] Step 63000/100000; acc:  98.33; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/4370 tok/s;  19270 sec
[2019-12-31 07:52:25,476 INFO] Step 63500/100000; acc:  98.38; ppl:  1.06; xent: 0.05; lr: 0.02500;   0/4380 tok/s;  19403 sec
[2019-12-31 07:54:39,747 INFO] Step 64000/100000; acc:  98.35; ppl:  1.06; xent: 0.05; lr: 0.02500;   0/4357 tok/s;  19537 sec
[2019-12-31 07:56:53,388 INFO] Step 64500/100000; acc:  98.33; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/4383 tok/s;  19671 sec
[2019-12-31 07:59:07,811 INFO] Step 65000/100000; acc:  98.38; ppl:  1.06; xent: 0.05; lr: 0.02500;   0/4365 tok/s;  19805 sec
[2019-12-31 08:01:22,568 INFO] Step 65500/100000; acc:  98.35; ppl:  1.06; xent: 0.05; lr: 0.02500;   0/4343 tok/s;  19940 sec
[2019-12-31 08:03:34,988 INFO] Step 66000/100000; acc:  98.36; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/4416 tok/s;  20072 sec
[2019-12-31 08:05:49,134 INFO] Step 66500/100000; acc:  98.38; ppl:  1.06; xent: 0.05; lr: 0.02500;   0/4376 tok/s;  20207 sec
[2019-12-31 08:08:02,959 INFO] Step 67000/100000; acc:  98.41; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/4383 tok/s;  20340 sec
[2019-12-31 08:10:17,751 INFO] Step 67500/100000; acc:  98.44; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/4357 tok/s;  20475 sec
[2019-12-31 08:12:32,233 INFO] Step 68000/100000; acc:  98.38; ppl:  1.06; xent: 0.05; lr: 0.02500;   0/4352 tok/s;  20610 sec
[2019-12-31 08:14:45,348 INFO] Step 68500/100000; acc:  98.41; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/4376 tok/s;  20743 sec
[2019-12-31 08:17:00,623 INFO] Step 69000/100000; acc:  98.38; ppl:  1.06; xent: 0.05; lr: 0.02500;   0/4367 tok/s;  20878 sec
[2019-12-31 08:19:14,278 INFO] Step 69500/100000; acc:  98.44; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/4365 tok/s;  21012 sec
[2019-12-31 08:21:27,397 INFO] Step 70000/100000; acc:  98.39; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4392 tok/s;  21145 sec
[2019-12-31 08:22:22,212 INFO] Validation perplexity: 1.09466
[2019-12-31 08:22:22,212 INFO] Validation accuracy: 97.7995
[2019-12-31 08:22:22,215 INFO] Saving checkpoint ../results/models/im2latex-66_step_70000.pt
[2019-12-31 08:24:37,451 INFO] Step 70500/100000; acc:  98.45; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/3106 tok/s;  21335 sec
[2019-12-31 08:26:51,096 INFO] Step 71000/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4361 tok/s;  21468 sec
[2019-12-31 08:29:06,520 INFO] Step 71500/100000; acc:  98.46; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4336 tok/s;  21604 sec
[2019-12-31 08:31:23,443 INFO] Step 72000/100000; acc:  98.44; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4282 tok/s;  21741 sec
[2019-12-31 08:33:45,834 INFO] Step 72500/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4092 tok/s;  21883 sec
[2019-12-31 08:36:05,114 INFO] Step 73000/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4227 tok/s;  22023 sec
[2019-12-31 08:38:16,739 INFO] Step 73500/100000; acc:  98.50; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4416 tok/s;  22154 sec
[2019-12-31 08:40:31,517 INFO] Step 74000/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4368 tok/s;  22289 sec
[2019-12-31 08:42:46,443 INFO] Step 74500/100000; acc:  98.48; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4357 tok/s;  22424 sec
[2019-12-31 08:44:59,803 INFO] Step 75000/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4378 tok/s;  22557 sec
[2019-12-31 08:47:14,387 INFO] Step 75500/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4352 tok/s;  22692 sec
[2019-12-31 08:49:28,046 INFO] Step 76000/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4377 tok/s;  22825 sec
[2019-12-31 08:51:44,922 INFO] Step 76500/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4291 tok/s;  22962 sec
[2019-12-31 08:54:00,201 INFO] Step 77000/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4320 tok/s;  23098 sec
[2019-12-31 08:56:12,586 INFO] Step 77500/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4427 tok/s;  23230 sec
[2019-12-31 08:58:27,569 INFO] Step 78000/100000; acc:  98.50; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4349 tok/s;  23365 sec
[2019-12-31 09:00:40,910 INFO] Step 78500/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4391 tok/s;  23498 sec
[2019-12-31 09:02:56,365 INFO] Step 79000/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4329 tok/s;  23634 sec
[2019-12-31 09:05:11,967 INFO] Step 79500/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4327 tok/s;  23769 sec
[2019-12-31 09:07:26,969 INFO] Step 80000/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.00625;   0/4314 tok/s;  23904 sec
[2019-12-31 09:08:25,227 INFO] Validation perplexity: 1.09474
[2019-12-31 09:08:25,228 INFO] Validation accuracy: 97.8118
[2019-12-31 09:08:25,231 INFO] Saving checkpoint ../results/models/im2latex-66_step_80000.pt
[2019-12-31 09:10:50,605 INFO] Step 80500/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.00625;   0/2900 tok/s;  24108 sec
[2019-12-31 09:13:08,805 INFO] Step 81000/100000; acc:  98.59; ppl:  1.05; xent: 0.05; lr: 0.00625;   0/4218 tok/s;  24246 sec
[2019-12-31 09:15:22,707 INFO] Step 81500/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.00625;   0/4360 tok/s;  24380 sec
[2019-12-31 09:17:46,587 INFO] Step 82000/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.00625;   0/4114 tok/s;  24524 sec
[2019-12-31 09:20:09,467 INFO] Step 82500/100000; acc:  98.58; ppl:  1.05; xent: 0.05; lr: 0.00625;   0/4082 tok/s;  24667 sec
[2019-12-31 09:22:25,768 INFO] Step 83000/100000; acc:  98.58; ppl:  1.05; xent: 0.05; lr: 0.00625;   0/4295 tok/s;  24803 sec
[2019-12-31 09:24:40,500 INFO] Step 83500/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.00625;   0/4349 tok/s;  24938 sec
[2019-12-31 09:26:54,459 INFO] Step 84000/100000; acc:  98.58; ppl:  1.05; xent: 0.05; lr: 0.00625;   0/4359 tok/s;  25072 sec
[2019-12-31 09:29:14,725 INFO] Step 84500/100000; acc:  98.59; ppl:  1.05; xent: 0.05; lr: 0.00625;   0/4196 tok/s;  25212 sec
[2019-12-31 09:31:26,826 INFO] Step 85000/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.00625;   0/4405 tok/s;  25344 sec
[2019-12-31 09:33:46,125 INFO] Step 85500/100000; acc:  98.60; ppl:  1.05; xent: 0.05; lr: 0.00625;   0/4208 tok/s;  25484 sec
[2019-12-31 09:36:09,902 INFO] Step 86000/100000; acc:  98.59; ppl:  1.05; xent: 0.05; lr: 0.00625;   0/4095 tok/s;  25627 sec
[2019-12-31 09:38:33,143 INFO] Step 86500/100000; acc:  98.60; ppl:  1.05; xent: 0.04; lr: 0.00625;   0/4081 tok/s;  25771 sec
[2019-12-31 09:40:57,032 INFO] Step 87000/100000; acc:  98.57; ppl:  1.05; xent: 0.05; lr: 0.00625;   0/4082 tok/s;  25914 sec
[2019-12-31 09:43:19,035 INFO] Step 87500/100000; acc:  98.57; ppl:  1.05; xent: 0.05; lr: 0.00625;   0/4111 tok/s;  26056 sec
[2019-12-31 09:45:42,252 INFO] Step 88000/100000; acc:  98.61; ppl:  1.05; xent: 0.05; lr: 0.00625;   0/4110 tok/s;  26200 sec
[2019-12-31 09:47:57,183 INFO] Step 88500/100000; acc:  98.60; ppl:  1.05; xent: 0.04; lr: 0.00625;   0/4321 tok/s;  26335 sec
[2019-12-31 09:50:11,053 INFO] Step 89000/100000; acc:  98.58; ppl:  1.05; xent: 0.05; lr: 0.00625;   0/4370 tok/s;  26468 sec
[2019-12-31 09:52:27,769 INFO] Step 89500/100000; acc:  98.61; ppl:  1.05; xent: 0.04; lr: 0.00625;   0/4314 tok/s;  26605 sec
[2019-12-31 09:54:42,140 INFO] Step 90000/100000; acc:  98.60; ppl:  1.05; xent: 0.05; lr: 0.00313;   0/4346 tok/s;  26740 sec
[2019-12-31 09:55:37,380 INFO] Validation perplexity: 1.09494
[2019-12-31 09:55:37,380 INFO] Validation accuracy: 97.8273
[2019-12-31 09:55:37,383 INFO] Saving checkpoint ../results/models/im2latex-66_step_90000.pt
[2019-12-31 09:57:58,418 INFO] Step 90500/100000; acc:  98.62; ppl:  1.05; xent: 0.04; lr: 0.00313;   0/2989 tok/s;  26936 sec
[2019-12-31 10:00:20,700 INFO] Step 91000/100000; acc:  98.57; ppl:  1.05; xent: 0.05; lr: 0.00313;   0/4125 tok/s;  27078 sec
[2019-12-31 10:02:43,225 INFO] Step 91500/100000; acc:  98.61; ppl:  1.05; xent: 0.04; lr: 0.00313;   0/4084 tok/s;  27221 sec
[2019-12-31 10:05:08,064 INFO] Step 92000/100000; acc:  98.61; ppl:  1.05; xent: 0.04; lr: 0.00313;   0/4070 tok/s;  27365 sec
[2019-12-31 10:07:22,844 INFO] Step 92500/100000; acc:  98.61; ppl:  1.05; xent: 0.04; lr: 0.00313;   0/4328 tok/s;  27500 sec
[2019-12-31 10:09:37,412 INFO] Step 93000/100000; acc:  98.63; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/4356 tok/s;  27635 sec
[2019-12-31 10:11:56,145 INFO] Step 93500/100000; acc:  98.62; ppl:  1.05; xent: 0.04; lr: 0.00313;   0/4251 tok/s;  27774 sec
[2019-12-31 10:14:18,165 INFO] Step 94000/100000; acc:  98.62; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/4100 tok/s;  27916 sec
[2019-12-31 10:16:36,187 INFO] Step 94500/100000; acc:  98.61; ppl:  1.05; xent: 0.04; lr: 0.00313;   0/4245 tok/s;  28054 sec
[2019-12-31 10:18:49,958 INFO] Step 95000/100000; acc:  98.59; ppl:  1.05; xent: 0.04; lr: 0.00313;   0/4377 tok/s;  28187 sec
[2019-12-31 10:21:03,391 INFO] Step 95500/100000; acc:  98.63; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/4390 tok/s;  28321 sec
[2019-12-31 10:23:19,018 INFO] Step 96000/100000; acc:  98.62; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/4324 tok/s;  28456 sec
[2019-12-31 10:25:30,770 INFO] Step 96500/100000; acc:  98.62; ppl:  1.05; xent: 0.04; lr: 0.00313;   0/4423 tok/s;  28588 sec
[2019-12-31 10:27:45,267 INFO] Step 97000/100000; acc:  98.63; ppl:  1.05; xent: 0.04; lr: 0.00313;   0/4361 tok/s;  28723 sec
[2019-12-31 10:29:59,796 INFO] Step 97500/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/4366 tok/s;  28857 sec
[2019-12-31 10:32:14,684 INFO] Step 98000/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/4350 tok/s;  28992 sec
[2019-12-31 10:34:30,861 INFO] Step 98500/100000; acc:  98.60; ppl:  1.05; xent: 0.04; lr: 0.00313;   0/4314 tok/s;  29128 sec
[2019-12-31 10:36:44,996 INFO] Step 99000/100000; acc:  98.61; ppl:  1.05; xent: 0.04; lr: 0.00313;   0/4342 tok/s;  29262 sec
[2019-12-31 10:39:01,566 INFO] Step 99500/100000; acc:  98.63; ppl:  1.05; xent: 0.04; lr: 0.00313;   0/4316 tok/s;  29399 sec
[2019-12-31 10:41:16,542 INFO] Step 100000/100000; acc:  98.63; ppl:  1.04; xent: 0.04; lr: 0.00156;   0/4318 tok/s;  29534 sec
[2019-12-31 10:42:11,898 INFO] Validation perplexity: 1.09487
[2019-12-31 10:42:11,899 INFO] Validation accuracy: 97.8303
[2019-12-31 10:42:11,901 INFO] Saving checkpoint ../results/models/im2latex-66_step_100000.pt
