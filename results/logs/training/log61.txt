[2019-12-11 15:03:49,827 INFO]  * tgt vocab size = 510
[2019-12-11 15:03:49,828 INFO] Building model...
[2019-12-11 15:03:56,660 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds1): Downsample(
      (pad): ReflectionPad2d([3, 3, 3, 3])
    )
    (layer3): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer5): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer6): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer7): Conv2d(128, 128, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layer8): Conv2d(128, 256, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layer9): Conv2d(256, 256, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layer10): Conv2d(256, 256, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (batch_norm1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(256, 500, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 256)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(1080, 1000)
        (1): LSTMCell(1000, 1000)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=1000, out_features=1000, bias=False)
      (linear_out): Linear(in_features=2000, out_features=1000, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=1000, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-12-11 15:03:56,662 INFO] encoder: 10574016
[2019-12-11 15:03:56,662 INFO] decoder: 19887310
[2019-12-11 15:03:56,662 INFO] * number of parameters: 30461326
[2019-12-11 15:03:57,166 INFO] Starting training on GPU: [0]
[2019-12-11 15:03:57,166 INFO] Start training loop and validate every 10000 steps...
[2019-12-11 15:19:15,080 INFO] Step 500/100000; acc:  15.05; ppl: 115.30; xent: 4.75; lr: 0.10000;   0/641 tok/s;    918 sec
[2019-12-11 15:33:51,602 INFO] Step 1000/100000; acc:  28.54; ppl: 35.22; xent: 3.56; lr: 0.10000;   0/663 tok/s;   1794 sec
[2019-12-11 15:48:51,086 INFO] Step 1500/100000; acc:  44.54; ppl: 13.39; xent: 2.59; lr: 0.10000;   0/655 tok/s;   2694 sec
[2019-12-11 16:03:49,184 INFO] Step 2000/100000; acc:  48.77; ppl: 10.43; xent: 2.34; lr: 0.10000;   0/656 tok/s;   3592 sec
[2019-12-11 16:18:39,497 INFO] Step 2500/100000; acc:  51.89; ppl:  8.67; xent: 2.16; lr: 0.10000;   0/657 tok/s;   4482 sec
[2019-12-11 16:33:42,522 INFO] Step 3000/100000; acc:  68.91; ppl:  3.72; xent: 1.31; lr: 0.10000;   0/650 tok/s;   5385 sec
[2019-12-11 16:48:26,982 INFO] Step 3500/100000; acc:  84.39; ppl:  1.92; xent: 0.65; lr: 0.10000;   0/661 tok/s;   6270 sec
[2019-12-11 17:03:28,552 INFO] Step 4000/100000; acc:  88.87; ppl:  1.60; xent: 0.47; lr: 0.10000;   0/652 tok/s;   7171 sec
[2019-12-11 17:18:25,952 INFO] Step 4500/100000; acc:  90.78; ppl:  1.46; xent: 0.38; lr: 0.10000;   0/650 tok/s;   8069 sec
[2019-12-11 17:33:08,765 INFO] Step 5000/100000; acc:  92.05; ppl:  1.40; xent: 0.33; lr: 0.10000;   0/664 tok/s;   8952 sec
[2019-12-11 17:48:13,011 INFO] Step 5500/100000; acc:  93.00; ppl:  1.34; xent: 0.29; lr: 0.10000;   0/650 tok/s;   9856 sec
[2019-12-11 18:03:01,141 INFO] Step 6000/100000; acc:  93.56; ppl:  1.31; xent: 0.27; lr: 0.10000;   0/659 tok/s;  10744 sec
[2019-12-11 18:18:03,435 INFO] Step 6500/100000; acc:  94.03; ppl:  1.28; xent: 0.25; lr: 0.10000;   0/650 tok/s;  11646 sec
[2019-12-11 18:32:58,030 INFO] Step 7000/100000; acc:  94.33; ppl:  1.26; xent: 0.23; lr: 0.10000;   0/656 tok/s;  12541 sec
[2019-12-11 18:47:46,026 INFO] Step 7500/100000; acc:  94.80; ppl:  1.23; xent: 0.21; lr: 0.10000;   0/656 tok/s;  13429 sec
[2019-12-11 19:02:55,865 INFO] Step 8000/100000; acc:  94.92; ppl:  1.23; xent: 0.21; lr: 0.10000;   0/649 tok/s;  14339 sec
[2019-12-11 19:17:40,572 INFO] Step 8500/100000; acc:  95.30; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/658 tok/s;  15223 sec
[2019-12-11 19:32:25,985 INFO] Step 9000/100000; acc:  95.57; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/662 tok/s;  16109 sec
[2019-12-11 19:47:17,512 INFO] Step 9500/100000; acc:  95.73; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/660 tok/s;  17000 sec
[2019-12-11 20:01:59,054 INFO] Step 10000/100000; acc:  95.86; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/660 tok/s;  17882 sec
[2019-12-11 20:09:45,127 INFO] Validation perplexity: 1.15667
[2019-12-11 20:09:45,129 INFO] Validation accuracy: 96.4159
[2019-12-11 20:09:45,135 INFO] Saving checkpoint ../results/models/im2latex-61_step_10000.pt
[2019-12-11 20:24:49,043 INFO] Step 10500/100000; acc:  95.97; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/427 tok/s;  19252 sec
[2019-12-11 20:39:45,850 INFO] Step 11000/100000; acc:  96.06; ppl:  1.17; xent: 0.15; lr: 0.10000;   0/654 tok/s;  20149 sec
[2019-12-11 20:54:36,240 INFO] Step 11500/100000; acc:  96.24; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/656 tok/s;  21039 sec
[2019-12-11 21:09:47,188 INFO] Step 12000/100000; acc:  96.33; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/645 tok/s;  21950 sec
[2019-12-11 21:24:17,840 INFO] Step 12500/100000; acc:  96.43; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/669 tok/s;  22821 sec
[2019-12-11 21:39:18,052 INFO] Step 13000/100000; acc:  96.54; ppl:  1.14; xent: 0.14; lr: 0.10000;   0/653 tok/s;  23721 sec
[2019-12-11 21:54:11,677 INFO] Step 13500/100000; acc:  96.69; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/659 tok/s;  24615 sec
[2019-12-11 22:09:07,661 INFO] Step 14000/100000; acc:  96.65; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/654 tok/s;  25510 sec
[2019-12-11 22:24:11,252 INFO] Step 14500/100000; acc:  96.59; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/650 tok/s;  26414 sec
[2019-12-11 22:38:55,553 INFO] Step 15000/100000; acc:  96.79; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/659 tok/s;  27298 sec
[2019-12-11 22:54:00,607 INFO] Step 15500/100000; acc:  96.78; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/651 tok/s;  28203 sec
[2019-12-11 23:08:51,729 INFO] Step 16000/100000; acc:  96.92; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/654 tok/s;  29095 sec
[2019-12-11 23:23:27,013 INFO] Step 16500/100000; acc:  96.98; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/667 tok/s;  29970 sec
[2019-12-11 23:38:27,757 INFO] Step 17000/100000; acc:  97.07; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/655 tok/s;  30871 sec
[2019-12-11 23:53:10,522 INFO] Step 17500/100000; acc:  97.08; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/661 tok/s;  31753 sec
[2019-12-12 00:08:14,605 INFO] Step 18000/100000; acc:  97.08; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/650 tok/s;  32657 sec
[2019-12-12 00:23:08,560 INFO] Step 18500/100000; acc:  97.09; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/657 tok/s;  33551 sec
[2019-12-12 00:37:47,703 INFO] Step 19000/100000; acc:  97.20; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/662 tok/s;  34431 sec
[2019-12-12 00:53:05,141 INFO] Step 19500/100000; acc:  97.16; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/643 tok/s;  35348 sec
[2019-12-12 01:07:41,896 INFO] Step 20000/100000; acc:  97.28; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/664 tok/s;  36225 sec
[2019-12-12 01:15:26,952 INFO] Validation perplexity: 1.10921
[2019-12-12 01:15:26,953 INFO] Validation accuracy: 97.345
[2019-12-12 01:15:26,956 INFO] Saving checkpoint ../results/models/im2latex-61_step_20000.pt
[2019-12-12 01:30:19,620 INFO] Step 20500/100000; acc:  97.34; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/432 tok/s;  37582 sec
[2019-12-12 01:45:10,122 INFO] Step 21000/100000; acc:  97.38; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/660 tok/s;  38473 sec
[2019-12-12 01:59:53,281 INFO] Step 21500/100000; acc:  97.39; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/660 tok/s;  39356 sec
[2019-12-12 02:14:52,300 INFO] Step 22000/100000; acc:  97.35; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/650 tok/s;  40255 sec
[2019-12-12 02:29:45,500 INFO] Step 22500/100000; acc:  97.38; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/656 tok/s;  41148 sec
[2019-12-12 02:44:45,356 INFO] Step 23000/100000; acc:  97.46; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/653 tok/s;  42048 sec
[2019-12-12 02:59:45,248 INFO] Step 23500/100000; acc:  97.44; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/650 tok/s;  42948 sec
[2019-12-12 03:14:18,771 INFO] Step 24000/100000; acc:  97.51; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/668 tok/s;  43822 sec
[2019-12-12 03:29:17,727 INFO] Step 24500/100000; acc:  97.55; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/655 tok/s;  44721 sec
[2019-12-12 03:44:07,424 INFO] Step 25000/100000; acc:  97.61; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/659 tok/s;  45610 sec
[2019-12-12 03:59:06,809 INFO] Step 25500/100000; acc:  97.62; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/653 tok/s;  46510 sec
[2019-12-12 04:14:06,272 INFO] Step 26000/100000; acc:  97.57; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/652 tok/s;  47409 sec
[2019-12-12 04:28:50,427 INFO] Step 26500/100000; acc:  97.65; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/658 tok/s;  48293 sec
[2019-12-12 04:43:53,433 INFO] Step 27000/100000; acc:  97.60; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/654 tok/s;  49196 sec
[2019-12-12 04:58:45,971 INFO] Step 27500/100000; acc:  97.71; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/653 tok/s;  50089 sec
[2019-12-12 05:13:28,497 INFO] Step 28000/100000; acc:  97.65; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/663 tok/s;  50971 sec
[2019-12-12 05:28:22,141 INFO] Step 28500/100000; acc:  97.77; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/659 tok/s;  51865 sec
[2019-12-12 05:43:07,136 INFO] Step 29000/100000; acc:  97.71; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/659 tok/s;  52750 sec
[2019-12-12 05:58:09,915 INFO] Step 29500/100000; acc:  97.76; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/651 tok/s;  53653 sec
[2019-12-12 06:13:05,513 INFO] Step 30000/100000; acc:  97.74; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/655 tok/s;  54548 sec
[2019-12-12 06:20:52,937 INFO] Validation perplexity: 1.09273
[2019-12-12 06:20:52,937 INFO] Validation accuracy: 97.701
[2019-12-12 06:20:52,941 INFO] Saving checkpoint ../results/models/im2latex-61_step_30000.pt
[2019-12-12 06:35:38,509 INFO] Step 30500/100000; acc:  97.79; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/431 tok/s;  55901 sec
[2019-12-12 06:50:49,902 INFO] Step 31000/100000; acc:  97.79; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/647 tok/s;  56813 sec
[2019-12-12 07:05:20,189 INFO] Step 31500/100000; acc:  97.81; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/668 tok/s;  57683 sec
[2019-12-12 07:20:18,596 INFO] Step 32000/100000; acc:  97.89; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/655 tok/s;  58581 sec
[2019-12-12 07:35:05,723 INFO] Step 32500/100000; acc:  97.85; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/661 tok/s;  59469 sec
[2019-12-12 07:49:49,167 INFO] Step 33000/100000; acc:  97.92; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/661 tok/s;  60352 sec
[2019-12-12 08:04:52,614 INFO] Step 33500/100000; acc:  97.86; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/648 tok/s;  61255 sec
[2019-12-12 08:19:43,667 INFO] Step 34000/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/656 tok/s;  62146 sec
[2019-12-12 08:34:43,741 INFO] Step 34500/100000; acc:  97.92; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/652 tok/s;  63047 sec
[2019-12-12 08:49:41,057 INFO] Step 35000/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/652 tok/s;  63944 sec
[2019-12-12 09:04:18,127 INFO] Step 35500/100000; acc:  97.96; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/668 tok/s;  64821 sec
[2019-12-12 09:19:18,197 INFO] Step 36000/100000; acc:  98.01; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/653 tok/s;  65721 sec
[2019-12-12 09:34:02,669 INFO] Step 36500/100000; acc:  98.01; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/662 tok/s;  66606 sec
[2019-12-12 09:49:02,872 INFO] Step 37000/100000; acc:  98.01; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/651 tok/s;  67506 sec
[2019-12-12 10:03:59,590 INFO] Step 37500/100000; acc:  97.98; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/653 tok/s;  68402 sec
[2019-12-12 10:18:44,413 INFO] Step 38000/100000; acc:  98.03; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/659 tok/s;  69287 sec
[2019-12-12 10:33:52,570 INFO] Step 38500/100000; acc:  98.00; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/651 tok/s;  70195 sec
[2019-12-12 10:48:41,165 INFO] Step 39000/100000; acc:  98.09; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/655 tok/s;  71084 sec
[2019-12-12 11:03:26,174 INFO] Step 39500/100000; acc:  98.06; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/661 tok/s;  71969 sec
[2019-12-12 11:18:33,007 INFO] Step 40000/100000; acc:  98.08; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/652 tok/s;  72876 sec
[2019-12-12 11:26:20,093 INFO] Validation perplexity: 1.08943
[2019-12-12 11:26:20,094 INFO] Validation accuracy: 97.8381
[2019-12-12 11:26:20,097 INFO] Saving checkpoint ../results/models/im2latex-61_step_40000.pt
[2019-12-12 11:41:08,412 INFO] Step 40500/100000; acc:  98.11; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/430 tok/s;  74231 sec
[2019-12-12 11:56:13,772 INFO] Step 41000/100000; acc:  98.11; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/648 tok/s;  75137 sec
[2019-12-12 12:11:08,998 INFO] Step 41500/100000; acc:  98.06; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/654 tok/s;  76032 sec
[2019-12-12 12:25:56,669 INFO] Step 42000/100000; acc:  98.14; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/658 tok/s;  76920 sec
[2019-12-12 12:41:15,277 INFO] Step 42500/100000; acc:  98.14; ppl:  1.06; xent: 0.06; lr: 0.10000;   0/641 tok/s;  77838 sec
[2019-12-12 12:55:47,013 INFO] Step 43000/100000; acc:  98.14; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/666 tok/s;  78710 sec
[2019-12-12 13:10:37,939 INFO] Step 43500/100000; acc:  98.18; ppl:  1.06; xent: 0.06; lr: 0.10000;   0/657 tok/s;  79601 sec
[2019-12-12 13:25:35,861 INFO] Step 44000/100000; acc:  98.21; ppl:  1.06; xent: 0.06; lr: 0.10000;   0/656 tok/s;  80499 sec
[2019-12-12 13:40:30,688 INFO] Step 44500/100000; acc:  98.22; ppl:  1.06; xent: 0.06; lr: 0.10000;   0/654 tok/s;  81394 sec
[2019-12-12 13:55:32,503 INFO] Step 45000/100000; acc:  98.17; ppl:  1.06; xent: 0.06; lr: 0.10000;   0/651 tok/s;  82295 sec
[2019-12-12 14:10:19,350 INFO] Step 45500/100000; acc:  98.19; ppl:  1.06; xent: 0.06; lr: 0.10000;   0/659 tok/s;  83182 sec
[2019-12-12 14:25:27,123 INFO] Step 46000/100000; acc:  98.21; ppl:  1.06; xent: 0.06; lr: 0.10000;   0/648 tok/s;  84090 sec
[2019-12-12 14:40:18,490 INFO] Step 46500/100000; acc:  98.23; ppl:  1.06; xent: 0.06; lr: 0.10000;   0/655 tok/s;  84981 sec
[2019-12-12 14:54:54,847 INFO] Step 47000/100000; acc:  98.21; ppl:  1.06; xent: 0.06; lr: 0.10000;   0/668 tok/s;  85858 sec
[2019-12-12 15:10:03,397 INFO] Step 47500/100000; acc:  98.25; ppl:  1.06; xent: 0.06; lr: 0.10000;   0/647 tok/s;  86766 sec
[2019-12-12 15:24:49,320 INFO] Step 48000/100000; acc:  98.26; ppl:  1.06; xent: 0.06; lr: 0.10000;   0/660 tok/s;  87652 sec
[2019-12-12 15:39:50,402 INFO] Step 48500/100000; acc:  98.28; ppl:  1.06; xent: 0.06; lr: 0.10000;   0/651 tok/s;  88553 sec
[2019-12-12 15:54:51,752 INFO] Step 49000/100000; acc:  98.21; ppl:  1.06; xent: 0.06; lr: 0.10000;   0/651 tok/s;  89455 sec
[2019-12-12 16:09:37,200 INFO] Step 49500/100000; acc:  98.27; ppl:  1.06; xent: 0.06; lr: 0.10000;   0/658 tok/s;  90340 sec
[2019-12-12 16:24:52,776 INFO] Step 50000/100000; acc:  98.28; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/644 tok/s;  91256 sec
[2019-12-12 16:32:38,536 INFO] Validation perplexity: 1.08609
[2019-12-12 16:32:38,537 INFO] Validation accuracy: 97.9109
[2019-12-12 16:32:38,541 INFO] Saving checkpoint ../results/models/im2latex-61_step_50000.pt
[2019-12-12 16:47:23,860 INFO] Step 50500/100000; acc:  98.44; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/431 tok/s;  92607 sec
[2019-12-12 17:02:13,338 INFO] Step 51000/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/659 tok/s;  93496 sec
[2019-12-12 17:17:19,356 INFO] Step 51500/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/654 tok/s;  94402 sec
[2019-12-12 17:32:02,122 INFO] Step 52000/100000; acc:  98.61; ppl:  1.05; xent: 0.04; lr: 0.05000;   0/660 tok/s;  95285 sec
[2019-12-12 17:47:09,894 INFO] Step 52500/100000; acc:  98.63; ppl:  1.05; xent: 0.04; lr: 0.05000;   0/645 tok/s;  96193 sec
[2019-12-12 18:02:07,714 INFO] Step 53000/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.05000;   0/653 tok/s;  97091 sec
[2019-12-12 18:17:01,465 INFO] Step 53500/100000; acc:  98.65; ppl:  1.04; xent: 0.04; lr: 0.05000;   0/654 tok/s;  97984 sec
[2019-12-12 18:32:12,930 INFO] Step 54000/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.05000;   0/644 tok/s;  98896 sec
[2019-12-12 18:46:45,739 INFO] Step 54500/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.05000;   0/668 tok/s;  99769 sec
[2019-12-12 19:01:38,733 INFO] Step 55000/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.05000;   0/656 tok/s; 100662 sec
[2019-12-12 19:16:38,928 INFO] Step 55500/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.05000;   0/653 tok/s; 101562 sec
[2019-12-12 19:31:40,731 INFO] Step 56000/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.05000;   0/650 tok/s; 102464 sec
[2019-12-12 19:46:47,509 INFO] Step 56500/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.05000;   0/648 tok/s; 103370 sec
[2019-12-12 20:01:33,657 INFO] Step 57000/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.05000;   0/658 tok/s; 104256 sec
[2019-12-12 20:16:44,096 INFO] Step 57500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.05000;   0/648 tok/s; 105167 sec
[2019-12-12 20:31:37,768 INFO] Step 58000/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.05000;   0/652 tok/s; 106061 sec
[2019-12-12 20:46:17,265 INFO] Step 58500/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.05000;   0/664 tok/s; 106940 sec
[2019-12-12 21:01:25,089 INFO] Step 59000/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.05000;   0/650 tok/s; 107848 sec
[2019-12-12 21:16:11,087 INFO] Step 59500/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.05000;   0/657 tok/s; 108734 sec
[2019-12-12 21:31:17,037 INFO] Step 60000/100000; acc:  98.80; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/649 tok/s; 109640 sec
[2019-12-12 21:39:03,720 INFO] Validation perplexity: 1.08141
[2019-12-12 21:39:03,721 INFO] Validation accuracy: 98.129
[2019-12-12 21:39:03,725 INFO] Saving checkpoint ../results/models/im2latex-61_step_60000.pt
[2019-12-12 21:54:07,584 INFO] Step 60500/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/428 tok/s; 111010 sec
[2019-12-12 22:08:46,046 INFO] Step 61000/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.02500;   0/663 tok/s; 111889 sec
[2019-12-12 22:23:57,384 INFO] Step 61500/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.02500;   0/647 tok/s; 112800 sec
[2019-12-12 22:38:30,778 INFO] Step 62000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.02500;   0/666 tok/s; 113674 sec
[2019-12-12 22:53:24,455 INFO] Step 62500/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.02500;   0/657 tok/s; 114567 sec
[2019-12-12 23:08:25,990 INFO] Step 63000/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.02500;   0/654 tok/s; 115469 sec
[2019-12-12 23:23:07,627 INFO] Step 63500/100000; acc:  99.00; ppl:  1.03; xent: 0.03; lr: 0.02500;   0/662 tok/s; 116350 sec
[2019-12-12 23:38:05,422 INFO] Step 64000/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.02500;   0/652 tok/s; 117248 sec
[2019-12-12 23:53:01,287 INFO] Step 64500/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.02500;   0/654 tok/s; 118144 sec
[2019-12-13 00:07:59,668 INFO] Step 65000/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.02500;   0/653 tok/s; 119043 sec
[2019-12-13 00:22:59,380 INFO] Step 65500/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.02500;   0/650 tok/s; 119942 sec
[2019-12-13 00:37:37,919 INFO] Step 66000/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.02500;   0/666 tok/s; 120821 sec
[2019-12-13 00:52:27,671 INFO] Step 66500/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.02500;   0/658 tok/s; 121711 sec
[2019-12-13 01:07:19,593 INFO] Step 67000/100000; acc:  99.00; ppl:  1.03; xent: 0.03; lr: 0.02500;   0/657 tok/s; 122602 sec
[2019-12-13 01:22:21,949 INFO] Step 67500/100000; acc:  99.03; ppl:  1.03; xent: 0.03; lr: 0.02500;   0/651 tok/s; 123505 sec
[2019-12-13 01:37:18,798 INFO] Step 68000/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.02500;   0/653 tok/s; 124402 sec
[2019-12-13 01:52:04,699 INFO] Step 68500/100000; acc:  98.98; ppl:  1.03; xent: 0.03; lr: 0.02500;   0/657 tok/s; 125288 sec
[2019-12-13 02:07:04,745 INFO] Step 69000/100000; acc:  99.01; ppl:  1.03; xent: 0.03; lr: 0.02500;   0/656 tok/s; 126188 sec
[2019-12-13 02:21:53,128 INFO] Step 69500/100000; acc:  99.00; ppl:  1.03; xent: 0.03; lr: 0.02500;   0/656 tok/s; 127076 sec
[2019-12-13 02:36:33,144 INFO] Step 70000/100000; acc:  99.00; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/665 tok/s; 127956 sec
[2019-12-13 02:44:15,963 INFO] Validation perplexity: 1.0802
[2019-12-13 02:44:15,964 INFO] Validation accuracy: 98.2334
[2019-12-13 02:44:15,968 INFO] Saving checkpoint ../results/models/im2latex-61_step_70000.pt
[2019-12-13 02:59:12,771 INFO] Step 70500/100000; acc:  99.04; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/433 tok/s; 129316 sec
[2019-12-13 03:13:56,744 INFO] Step 71000/100000; acc:  99.06; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/660 tok/s; 130200 sec
[2019-12-13 03:28:53,955 INFO] Step 71500/100000; acc:  99.08; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/654 tok/s; 131097 sec
[2019-12-13 03:43:46,920 INFO] Step 72000/100000; acc:  99.03; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/657 tok/s; 131990 sec
[2019-12-13 03:58:28,352 INFO] Step 72500/100000; acc:  99.05; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/661 tok/s; 132871 sec
[2019-12-13 04:13:45,303 INFO] Step 73000/100000; acc:  99.10; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/642 tok/s; 133788 sec
[2019-12-13 04:28:16,392 INFO] Step 73500/100000; acc:  99.06; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/667 tok/s; 134659 sec
[2019-12-13 04:43:14,384 INFO] Step 74000/100000; acc:  99.10; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/656 tok/s; 135557 sec
[2019-12-13 04:58:12,977 INFO] Step 74500/100000; acc:  99.06; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/657 tok/s; 136456 sec
[2019-12-13 05:12:59,163 INFO] Step 75000/100000; acc:  99.12; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/660 tok/s; 137342 sec
[2019-12-13 05:28:06,306 INFO] Step 75500/100000; acc:  99.09; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/646 tok/s; 138249 sec
[2019-12-13 05:42:56,311 INFO] Step 76000/100000; acc:  99.07; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/656 tok/s; 139139 sec
[2019-12-13 05:57:56,685 INFO] Step 76500/100000; acc:  99.12; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/653 tok/s; 140040 sec
[2019-12-13 06:12:58,480 INFO] Step 77000/100000; acc:  99.10; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/648 tok/s; 140941 sec
[2019-12-13 06:27:34,423 INFO] Step 77500/100000; acc:  99.12; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/669 tok/s; 141817 sec
[2019-12-13 06:42:24,360 INFO] Step 78000/100000; acc:  99.09; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/658 tok/s; 142707 sec
[2019-12-13 06:57:07,228 INFO] Step 78500/100000; acc:  99.13; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/663 tok/s; 143590 sec
[2019-12-13 07:12:06,731 INFO] Step 79000/100000; acc:  99.12; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/652 tok/s; 144490 sec
[2019-12-13 07:27:01,657 INFO] Step 79500/100000; acc:  99.10; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/655 tok/s; 145384 sec
[2019-12-13 07:41:45,123 INFO] Step 80000/100000; acc:  99.11; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/660 tok/s; 146268 sec
[2019-12-13 07:49:28,224 INFO] Validation perplexity: 1.08241
[2019-12-13 07:49:28,225 INFO] Validation accuracy: 98.2326
[2019-12-13 07:49:28,229 INFO] Saving checkpoint ../results/models/im2latex-61_step_80000.pt
[2019-12-13 08:04:38,890 INFO] Step 80500/100000; acc:  99.14; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/430 tok/s; 147642 sec
[2019-12-13 08:19:25,049 INFO] Step 81000/100000; acc:  99.12; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/657 tok/s; 148528 sec
[2019-12-13 08:34:00,657 INFO] Step 81500/100000; acc:  99.13; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/667 tok/s; 149403 sec
[2019-12-13 08:48:58,028 INFO] Step 82000/100000; acc:  99.13; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/657 tok/s; 150301 sec
[2019-12-13 09:03:40,089 INFO] Step 82500/100000; acc:  99.16; ppl:  1.02; xent: 0.02; lr: 0.00625;   0/661 tok/s; 151183 sec
[2019-12-13 09:18:39,545 INFO] Step 83000/100000; acc:  99.16; ppl:  1.02; xent: 0.02; lr: 0.00625;   0/651 tok/s; 152082 sec
[2019-12-13 09:33:32,739 INFO] Step 83500/100000; acc:  99.14; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/656 tok/s; 152976 sec
[2019-12-13 09:48:18,768 INFO] Step 84000/100000; acc:  99.16; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/659 tok/s; 153862 sec
[2019-12-13 10:03:33,182 INFO] Step 84500/100000; acc:  99.17; ppl:  1.03; xent: 0.02; lr: 0.00625;   0/644 tok/s; 154776 sec
[2019-12-13 10:17:59,546 INFO] Step 85000/100000; acc:  99.14; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/671 tok/s; 155642 sec
[2019-12-13 10:32:58,394 INFO] Step 85500/100000; acc:  99.16; ppl:  1.03; xent: 0.02; lr: 0.00625;   0/656 tok/s; 156541 sec
[2019-12-13 10:47:47,503 INFO] Step 86000/100000; acc:  99.15; ppl:  1.02; xent: 0.02; lr: 0.00625;   0/662 tok/s; 157430 sec
[2019-12-13 11:02:42,179 INFO] Step 86500/100000; acc:  99.19; ppl:  1.02; xent: 0.02; lr: 0.00625;   0/654 tok/s; 158325 sec
[2019-12-13 11:17:43,963 INFO] Step 87000/100000; acc:  99.17; ppl:  1.02; xent: 0.02; lr: 0.00625;   0/651 tok/s; 159227 sec
[2019-12-13 11:32:26,619 INFO] Step 87500/100000; acc:  99.16; ppl:  1.03; xent: 0.02; lr: 0.00625;   0/662 tok/s; 160109 sec
[2019-12-13 11:47:28,465 INFO] Step 88000/100000; acc:  99.18; ppl:  1.02; xent: 0.02; lr: 0.00625;   0/653 tok/s; 161011 sec
[2019-12-13 12:02:22,528 INFO] Step 88500/100000; acc:  99.18; ppl:  1.02; xent: 0.02; lr: 0.00625;   0/652 tok/s; 161905 sec
[2019-12-13 12:16:57,157 INFO] Step 89000/100000; acc:  99.14; ppl:  1.03; xent: 0.02; lr: 0.00625;   0/669 tok/s; 162780 sec
[2019-12-13 12:31:55,428 INFO] Step 89500/100000; acc:  99.16; ppl:  1.02; xent: 0.02; lr: 0.00625;   0/654 tok/s; 163678 sec
[2019-12-13 12:46:35,955 INFO] Step 90000/100000; acc:  99.19; ppl:  1.02; xent: 0.02; lr: 0.00313;   0/664 tok/s; 164559 sec
[2019-12-13 12:54:17,956 INFO] Validation perplexity: 1.08265
[2019-12-13 12:54:17,957 INFO] Validation accuracy: 98.2573
[2019-12-13 12:54:17,961 INFO] Saving checkpoint ../results/models/im2latex-61_step_90000.pt
[2019-12-13 13:09:15,780 INFO] Step 90500/100000; acc:  99.19; ppl:  1.02; xent: 0.02; lr: 0.00313;   0/432 tok/s; 165919 sec
[2019-12-13 13:24:13,593 INFO] Step 91000/100000; acc:  99.16; ppl:  1.03; xent: 0.02; lr: 0.00313;   0/654 tok/s; 166816 sec
[2019-12-13 13:38:51,013 INFO] Step 91500/100000; acc:  99.17; ppl:  1.02; xent: 0.02; lr: 0.00313;   0/663 tok/s; 167694 sec
[2019-12-13 13:54:00,165 INFO] Step 92000/100000; acc:  99.21; ppl:  1.02; xent: 0.02; lr: 0.00313;   0/649 tok/s; 168603 sec
[2019-12-13 14:08:36,844 INFO] Step 92500/100000; acc:  99.17; ppl:  1.02; xent: 0.02; lr: 0.00313;   0/665 tok/s; 169480 sec
[2019-12-13 14:23:21,085 INFO] Step 93000/100000; acc:  99.19; ppl:  1.02; xent: 0.02; lr: 0.00313;   0/663 tok/s; 170364 sec
[2019-12-13 14:38:14,305 INFO] Step 93500/100000; acc:  99.19; ppl:  1.02; xent: 0.02; lr: 0.00313;   0/659 tok/s; 171257 sec
[2019-12-13 14:52:55,161 INFO] Step 94000/100000; acc:  99.22; ppl:  1.02; xent: 0.02; lr: 0.00313;   0/661 tok/s; 172138 sec
[2019-12-13 15:07:54,822 INFO] Step 94500/100000; acc:  99.18; ppl:  1.02; xent: 0.02; lr: 0.00313;   0/651 tok/s; 173038 sec
[2019-12-13 15:22:43,036 INFO] Step 95000/100000; acc:  99.17; ppl:  1.02; xent: 0.02; lr: 0.00313;   0/659 tok/s; 173926 sec
[2019-12-13 15:37:28,142 INFO] Step 95500/100000; acc:  99.20; ppl:  1.02; xent: 0.02; lr: 0.00313;   0/662 tok/s; 174811 sec
[2019-12-13 15:52:25,095 INFO] Step 96000/100000; acc:  99.19; ppl:  1.02; xent: 0.02; lr: 0.00313;   0/654 tok/s; 175708 sec
[2019-12-13 16:06:48,678 INFO] Step 96500/100000; acc:  99.18; ppl:  1.02; xent: 0.02; lr: 0.00313;   0/675 tok/s; 176572 sec
[2019-12-13 16:21:46,774 INFO] Step 97000/100000; acc:  99.19; ppl:  1.02; xent: 0.02; lr: 0.00313;   0/657 tok/s; 177470 sec
[2019-12-13 16:36:28,295 INFO] Step 97500/100000; acc:  99.21; ppl:  1.02; xent: 0.02; lr: 0.00313;   0/666 tok/s; 178351 sec
[2019-12-13 16:51:20,209 INFO] Step 98000/100000; acc:  99.22; ppl:  1.02; xent: 0.02; lr: 0.00313;   0/658 tok/s; 179243 sec
[2019-12-13 17:06:13,495 INFO] Step 98500/100000; acc:  99.18; ppl:  1.02; xent: 0.02; lr: 0.00313;   0/657 tok/s; 180136 sec
[2019-12-13 17:20:53,711 INFO] Step 99000/100000; acc:  99.18; ppl:  1.02; xent: 0.02; lr: 0.00313;   0/662 tok/s; 181017 sec
[2019-12-13 17:35:51,403 INFO] Step 99500/100000; acc:  99.21; ppl:  1.02; xent: 0.02; lr: 0.00313;   0/657 tok/s; 181914 sec
[2019-12-13 17:50:35,963 INFO] Step 100000/100000; acc:  99.20; ppl:  1.02; xent: 0.02; lr: 0.00156;   0/658 tok/s; 182799 sec
[2019-12-13 17:58:15,154 INFO] Validation perplexity: 1.08298
[2019-12-13 17:58:15,155 INFO] Validation accuracy: 98.2529
[2019-12-13 17:58:15,159 INFO] Saving checkpoint ../results/models/im2latex-61_step_100000.pt
