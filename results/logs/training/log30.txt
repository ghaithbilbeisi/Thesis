[2019-09-17 14:04:06,068 INFO]  * tgt vocab size = 510
[2019-09-17 14:04:06,068 INFO] Building model...
[2019-09-17 14:04:09,981 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer3): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer5): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer6): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (batch_norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(512, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 512)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-09-17 14:04:09,983 INFO] encoder: 8047424
[2019-09-17 14:04:09,983 INFO] decoder: 5214310
[2019-09-17 14:04:09,983 INFO] * number of parameters: 13261734
[2019-09-17 14:04:10,900 INFO] Starting training on GPU: [0]
[2019-09-17 14:04:10,901 INFO] Start training loop and validate every 10000 steps...
[2019-09-17 14:06:57,383 INFO] Step 500/100000; acc:  28.79; ppl: 38.77; xent: 3.66; lr: 0.10000;   0/3535 tok/s;    166 sec
[2019-09-17 14:09:39,025 INFO] Step 1000/100000; acc:  44.46; ppl: 13.45; xent: 2.60; lr: 0.10000;   0/3596 tok/s;    328 sec
[2019-09-17 14:12:22,701 INFO] Step 1500/100000; acc:  48.03; ppl: 10.69; xent: 2.37; lr: 0.10000;   0/3598 tok/s;    492 sec
[2019-09-17 14:15:06,911 INFO] Step 2000/100000; acc:  50.10; ppl:  9.45; xent: 2.25; lr: 0.10000;   0/3579 tok/s;    656 sec
[2019-09-17 14:17:50,199 INFO] Step 2500/100000; acc:  51.09; ppl:  8.85; xent: 2.18; lr: 0.10000;   0/3577 tok/s;    819 sec
[2019-09-17 14:20:35,171 INFO] Step 3000/100000; acc:  52.21; ppl:  8.30; xent: 2.12; lr: 0.10000;   0/3559 tok/s;    984 sec
[2019-09-17 14:23:17,805 INFO] Step 3500/100000; acc:  53.02; ppl:  7.90; xent: 2.07; lr: 0.10000;   0/3593 tok/s;   1147 sec
[2019-09-17 14:26:03,300 INFO] Step 4000/100000; acc:  53.48; ppl:  7.65; xent: 2.03; lr: 0.10000;   0/3551 tok/s;   1312 sec
[2019-09-17 14:28:46,858 INFO] Step 4500/100000; acc:  54.13; ppl:  7.38; xent: 2.00; lr: 0.10000;   0/3569 tok/s;   1476 sec
[2019-09-17 14:31:28,186 INFO] Step 5000/100000; acc:  54.65; ppl:  7.18; xent: 1.97; lr: 0.10000;   0/3633 tok/s;   1637 sec
[2019-09-17 14:34:11,292 INFO] Step 5500/100000; acc:  54.96; ppl:  7.02; xent: 1.95; lr: 0.10000;   0/3595 tok/s;   1800 sec
[2019-09-17 14:36:54,155 INFO] Step 6000/100000; acc:  55.38; ppl:  6.85; xent: 1.92; lr: 0.10000;   0/3592 tok/s;   1963 sec
[2019-09-17 14:39:38,530 INFO] Step 6500/100000; acc:  55.74; ppl:  6.72; xent: 1.91; lr: 0.10000;   0/3570 tok/s;   2128 sec
[2019-09-17 14:42:21,924 INFO] Step 7000/100000; acc:  56.18; ppl:  6.56; xent: 1.88; lr: 0.10000;   0/3591 tok/s;   2291 sec
[2019-09-17 14:45:04,270 INFO] Step 7500/100000; acc:  56.52; ppl:  6.44; xent: 1.86; lr: 0.10000;   0/3589 tok/s;   2453 sec
[2019-09-17 14:47:49,948 INFO] Step 8000/100000; acc:  56.70; ppl:  6.35; xent: 1.85; lr: 0.10000;   0/3561 tok/s;   2619 sec
[2019-09-17 14:50:32,034 INFO] Step 8500/100000; acc:  56.98; ppl:  6.24; xent: 1.83; lr: 0.10000;   0/3593 tok/s;   2781 sec
[2019-09-17 14:53:12,730 INFO] Step 9000/100000; acc:  57.12; ppl:  6.16; xent: 1.82; lr: 0.10000;   0/3641 tok/s;   2942 sec
[2019-09-17 14:55:58,537 INFO] Step 9500/100000; acc:  57.65; ppl:  6.04; xent: 1.80; lr: 0.10000;   0/3574 tok/s;   3108 sec
[2019-09-17 14:58:40,509 INFO] Step 10000/100000; acc:  57.66; ppl:  6.01; xent: 1.79; lr: 0.10000;   0/3593 tok/s;   3270 sec
[2019-09-17 14:59:56,657 INFO] Validation perplexity: 6.01942
[2019-09-17 14:59:56,658 INFO] Validation accuracy: 57.6374
[2019-09-17 14:59:56,660 INFO] Saving checkpoint ../results/models/im2latex-30_step_10000.pt
[2019-09-17 15:02:41,342 INFO] Step 10500/100000; acc:  58.02; ppl:  5.91; xent: 1.78; lr: 0.10000;   0/2432 tok/s;   3510 sec
[2019-09-17 15:05:25,016 INFO] Step 11000/100000; acc:  58.07; ppl:  5.88; xent: 1.77; lr: 0.10000;   0/3584 tok/s;   3674 sec
[2019-09-17 15:08:07,706 INFO] Step 11500/100000; acc:  58.29; ppl:  5.79; xent: 1.76; lr: 0.10000;   0/3593 tok/s;   3837 sec
[2019-09-17 15:10:52,805 INFO] Step 12000/100000; acc:  58.48; ppl:  5.75; xent: 1.75; lr: 0.10000;   0/3557 tok/s;   4002 sec
[2019-09-17 15:13:32,249 INFO] Step 12500/100000; acc:  58.56; ppl:  5.70; xent: 1.74; lr: 0.10000;   0/3655 tok/s;   4161 sec
[2019-09-17 15:16:14,810 INFO] Step 13000/100000; acc:  58.62; ppl:  5.69; xent: 1.74; lr: 0.10000;   0/3610 tok/s;   4324 sec
[2019-09-17 15:18:57,280 INFO] Step 13500/100000; acc:  58.96; ppl:  5.60; xent: 1.72; lr: 0.10000;   0/3623 tok/s;   4486 sec
[2019-09-17 15:21:39,853 INFO] Step 14000/100000; acc:  58.93; ppl:  5.60; xent: 1.72; lr: 0.10000;   0/3601 tok/s;   4649 sec
[2019-09-17 15:24:24,481 INFO] Step 14500/100000; acc:  59.27; ppl:  5.51; xent: 1.71; lr: 0.10000;   0/3570 tok/s;   4814 sec
[2019-09-17 15:27:06,068 INFO] Step 15000/100000; acc:  59.37; ppl:  5.48; xent: 1.70; lr: 0.10000;   0/3605 tok/s;   4975 sec
[2019-09-17 15:29:50,591 INFO] Step 15500/100000; acc:  59.43; ppl:  5.44; xent: 1.69; lr: 0.10000;   0/3585 tok/s;   5140 sec
[2019-09-17 15:32:32,909 INFO] Step 16000/100000; acc:  59.55; ppl:  5.43; xent: 1.69; lr: 0.10000;   0/3590 tok/s;   5302 sec
[2019-09-17 15:35:12,884 INFO] Step 16500/100000; acc:  59.59; ppl:  5.39; xent: 1.68; lr: 0.10000;   0/3650 tok/s;   5462 sec
[2019-09-17 15:37:56,636 INFO] Step 17000/100000; acc:  59.75; ppl:  5.37; xent: 1.68; lr: 0.10000;   0/3594 tok/s;   5626 sec
[2019-09-17 15:40:38,224 INFO] Step 17500/100000; acc:  59.84; ppl:  5.35; xent: 1.68; lr: 0.10000;   0/3610 tok/s;   5787 sec
[2019-09-17 15:43:21,154 INFO] Step 18000/100000; acc:  59.97; ppl:  5.29; xent: 1.67; lr: 0.10000;   0/3607 tok/s;   5950 sec
[2019-09-17 15:46:04,926 INFO] Step 18500/100000; acc:  60.10; ppl:  5.26; xent: 1.66; lr: 0.10000;   0/3584 tok/s;   6114 sec
[2019-09-17 15:48:45,175 INFO] Step 19000/100000; acc:  60.12; ppl:  5.23; xent: 1.66; lr: 0.10000;   0/3632 tok/s;   6274 sec
[2019-09-17 15:51:31,235 INFO] Step 19500/100000; acc:  60.22; ppl:  5.22; xent: 1.65; lr: 0.10000;   0/3555 tok/s;   6440 sec
[2019-09-17 15:54:11,873 INFO] Step 20000/100000; acc:  60.25; ppl:  5.20; xent: 1.65; lr: 0.10000;   0/3620 tok/s;   6601 sec
[2019-09-17 15:55:28,181 INFO] Validation perplexity: 5.38258
[2019-09-17 15:55:28,182 INFO] Validation accuracy: 59.8061
[2019-09-17 15:55:28,185 INFO] Saving checkpoint ../results/models/im2latex-30_step_20000.pt
[2019-09-17 15:58:11,376 INFO] Step 20500/100000; acc:  60.29; ppl:  5.18; xent: 1.65; lr: 0.10000;   0/2452 tok/s;   6840 sec
[2019-09-17 16:00:55,462 INFO] Step 21000/100000; acc:  60.60; ppl:  5.15; xent: 1.64; lr: 0.10000;   0/3590 tok/s;   7005 sec
[2019-09-17 16:03:36,448 INFO] Step 21500/100000; acc:  60.51; ppl:  5.13; xent: 1.64; lr: 0.10000;   0/3622 tok/s;   7166 sec
[2019-09-17 16:06:20,415 INFO] Step 22000/100000; acc:  60.66; ppl:  5.09; xent: 1.63; lr: 0.10000;   0/3568 tok/s;   7330 sec
[2019-09-17 16:09:03,835 INFO] Step 22500/100000; acc:  60.59; ppl:  5.11; xent: 1.63; lr: 0.10000;   0/3586 tok/s;   7493 sec
[2019-09-17 16:11:51,616 INFO] Step 23000/100000; acc:  60.83; ppl:  5.04; xent: 1.62; lr: 0.10000;   0/3500 tok/s;   7661 sec
[2019-09-17 16:14:36,421 INFO] Step 23500/100000; acc:  60.88; ppl:  5.03; xent: 1.62; lr: 0.10000;   0/3550 tok/s;   7826 sec
[2019-09-17 16:17:15,141 INFO] Step 24000/100000; acc:  60.84; ppl:  5.04; xent: 1.62; lr: 0.10000;   0/3678 tok/s;   7984 sec
[2019-09-17 16:19:58,847 INFO] Step 24500/100000; acc:  60.82; ppl:  5.03; xent: 1.62; lr: 0.10000;   0/3594 tok/s;   8148 sec
[2019-09-17 16:22:40,521 INFO] Step 25000/100000; acc:  61.01; ppl:  5.01; xent: 1.61; lr: 0.10000;   0/3626 tok/s;   8310 sec
[2019-09-17 16:25:25,991 INFO] Step 25500/100000; acc:  61.02; ppl:  5.01; xent: 1.61; lr: 0.10000;   0/3550 tok/s;   8475 sec
[2019-09-17 16:28:14,299 INFO] Step 26000/100000; acc:  61.24; ppl:  4.95; xent: 1.60; lr: 0.10000;   0/3486 tok/s;   8643 sec
[2019-09-17 16:30:59,063 INFO] Step 26500/100000; acc:  61.24; ppl:  4.94; xent: 1.60; lr: 0.10000;   0/3533 tok/s;   8808 sec
[2019-09-17 16:33:47,581 INFO] Step 27000/100000; acc:  61.27; ppl:  4.93; xent: 1.59; lr: 0.10000;   0/3499 tok/s;   8977 sec
[2019-09-17 16:36:32,829 INFO] Step 27500/100000; acc:  61.36; ppl:  4.92; xent: 1.59; lr: 0.10000;   0/3529 tok/s;   9142 sec
[2019-09-17 16:39:17,859 INFO] Step 28000/100000; acc:  61.25; ppl:  4.92; xent: 1.59; lr: 0.10000;   0/3547 tok/s;   9307 sec
[2019-09-17 16:42:03,910 INFO] Step 28500/100000; acc:  61.48; ppl:  4.90; xent: 1.59; lr: 0.10000;   0/3544 tok/s;   9473 sec
[2019-09-17 16:44:49,754 INFO] Step 29000/100000; acc:  61.43; ppl:  4.89; xent: 1.59; lr: 0.10000;   0/3514 tok/s;   9639 sec
[2019-09-17 16:47:37,140 INFO] Step 29500/100000; acc:  61.64; ppl:  4.86; xent: 1.58; lr: 0.10000;   0/3512 tok/s;   9806 sec
[2019-09-17 16:50:29,165 INFO] Step 30000/100000; acc:  61.56; ppl:  4.85; xent: 1.58; lr: 0.10000;   0/3407 tok/s;   9978 sec
[2019-09-17 16:51:45,548 INFO] Validation perplexity: 5.14227
[2019-09-17 16:51:45,549 INFO] Validation accuracy: 60.7394
[2019-09-17 16:51:45,553 INFO] Saving checkpoint ../results/models/im2latex-30_step_30000.pt
[2019-09-17 16:54:31,834 INFO] Step 30500/100000; acc:  61.68; ppl:  4.83; xent: 1.57; lr: 0.10000;   0/2403 tok/s;  10221 sec
[2019-09-17 16:57:21,516 INFO] Step 31000/100000; acc:  61.73; ppl:  4.82; xent: 1.57; lr: 0.10000;   0/3473 tok/s;  10391 sec
[2019-09-17 17:00:09,790 INFO] Step 31500/100000; acc:  61.71; ppl:  4.82; xent: 1.57; lr: 0.10000;   0/3451 tok/s;  10559 sec
[2019-09-17 17:03:01,618 INFO] Step 32000/100000; acc:  61.75; ppl:  4.82; xent: 1.57; lr: 0.10000;   0/3424 tok/s;  10731 sec
[2019-09-17 17:05:49,371 INFO] Step 32500/100000; acc:  61.89; ppl:  4.79; xent: 1.57; lr: 0.10000;   0/3506 tok/s;  10898 sec
[2019-09-17 17:08:39,553 INFO] Step 33000/100000; acc:  61.83; ppl:  4.80; xent: 1.57; lr: 0.10000;   0/3435 tok/s;  11069 sec
[2019-09-17 17:11:31,383 INFO] Step 33500/100000; acc:  62.03; ppl:  4.75; xent: 1.56; lr: 0.10000;   0/3403 tok/s;  11240 sec
[2019-09-17 17:14:25,012 INFO] Step 34000/100000; acc:  61.99; ppl:  4.77; xent: 1.56; lr: 0.10000;   0/3371 tok/s;  11414 sec
[2019-09-17 17:17:16,432 INFO] Step 34500/100000; acc:  62.05; ppl:  4.72; xent: 1.55; lr: 0.10000;   0/3425 tok/s;  11586 sec
[2019-09-17 17:20:14,671 INFO] Step 35000/100000; acc:  62.10; ppl:  4.72; xent: 1.55; lr: 0.10000;   0/3282 tok/s;  11764 sec
[2019-09-17 17:23:11,982 INFO] Step 35500/100000; acc:  62.05; ppl:  4.73; xent: 1.55; lr: 0.10000;   0/3303 tok/s;  11941 sec
[2019-09-17 17:26:06,302 INFO] Step 36000/100000; acc:  62.08; ppl:  4.74; xent: 1.56; lr: 0.10000;   0/3374 tok/s;  12115 sec
[2019-09-17 17:28:58,656 INFO] Step 36500/100000; acc:  62.10; ppl:  4.72; xent: 1.55; lr: 0.10000;   0/3398 tok/s;  12288 sec
[2019-09-17 17:31:57,132 INFO] Step 37000/100000; acc:  62.10; ppl:  4.74; xent: 1.56; lr: 0.10000;   0/3287 tok/s;  12466 sec
[2019-09-17 17:34:57,741 INFO] Step 37500/100000; acc:  62.21; ppl:  4.70; xent: 1.55; lr: 0.10000;   0/3241 tok/s;  12647 sec
[2019-09-17 17:37:55,334 INFO] Step 38000/100000; acc:  62.36; ppl:  4.67; xent: 1.54; lr: 0.10000;   0/3283 tok/s;  12824 sec
[2019-09-17 17:40:49,810 INFO] Step 38500/100000; acc:  62.28; ppl:  4.67; xent: 1.54; lr: 0.10000;   0/3390 tok/s;  12999 sec
[2019-09-17 17:43:38,414 INFO] Step 39000/100000; acc:  62.31; ppl:  4.68; xent: 1.54; lr: 0.10000;   0/3454 tok/s;  13168 sec
[2019-09-17 17:46:22,234 INFO] Step 39500/100000; acc:  62.18; ppl:  4.69; xent: 1.54; lr: 0.10000;   0/3567 tok/s;  13331 sec
[2019-09-17 17:49:08,858 INFO] Step 40000/100000; acc:  62.51; ppl:  4.65; xent: 1.54; lr: 0.10000;   0/3544 tok/s;  13498 sec
[2019-09-17 17:50:25,316 INFO] Validation perplexity: 4.99181
[2019-09-17 17:50:25,317 INFO] Validation accuracy: 61.2404
[2019-09-17 17:50:25,320 INFO] Saving checkpoint ../results/models/im2latex-30_step_40000.pt
[2019-09-17 17:53:10,984 INFO] Step 40500/100000; acc:  62.43; ppl:  4.65; xent: 1.54; lr: 0.10000;   0/2407 tok/s;  13740 sec
[2019-09-17 17:55:53,953 INFO] Step 41000/100000; acc:  62.51; ppl:  4.63; xent: 1.53; lr: 0.10000;   0/3595 tok/s;  13903 sec
[2019-09-17 17:58:36,100 INFO] Step 41500/100000; acc:  62.46; ppl:  4.64; xent: 1.54; lr: 0.10000;   0/3615 tok/s;  14065 sec
[2019-09-17 18:01:16,543 INFO] Step 42000/100000; acc:  62.56; ppl:  4.60; xent: 1.53; lr: 0.10000;   0/3637 tok/s;  14226 sec
[2019-09-17 18:04:05,884 INFO] Step 42500/100000; acc:  62.68; ppl:  4.60; xent: 1.53; lr: 0.10000;   0/3478 tok/s;  14395 sec
[2019-09-17 18:06:44,358 INFO] Step 43000/100000; acc:  62.56; ppl:  4.61; xent: 1.53; lr: 0.10000;   0/3666 tok/s;  14553 sec
[2019-09-17 18:09:25,466 INFO] Step 43500/100000; acc:  62.58; ppl:  4.62; xent: 1.53; lr: 0.10000;   0/3635 tok/s;  14715 sec
[2019-09-17 18:12:08,468 INFO] Step 44000/100000; acc:  62.69; ppl:  4.59; xent: 1.52; lr: 0.10000;   0/3618 tok/s;  14878 sec
[2019-09-17 18:14:50,894 INFO] Step 44500/100000; acc:  62.60; ppl:  4.60; xent: 1.53; lr: 0.10000;   0/3600 tok/s;  15040 sec
[2019-09-17 18:17:36,404 INFO] Step 45000/100000; acc:  62.80; ppl:  4.56; xent: 1.52; lr: 0.10000;   0/3545 tok/s;  15206 sec
[2019-09-17 18:20:17,442 INFO] Step 45500/100000; acc:  62.73; ppl:  4.57; xent: 1.52; lr: 0.10000;   0/3627 tok/s;  15367 sec
[2019-09-17 18:23:00,737 INFO] Step 46000/100000; acc:  62.87; ppl:  4.54; xent: 1.51; lr: 0.10000;   0/3603 tok/s;  15530 sec
[2019-09-17 18:25:50,242 INFO] Step 46500/100000; acc:  62.80; ppl:  4.55; xent: 1.52; lr: 0.10000;   0/3442 tok/s;  15699 sec
[2019-09-17 18:28:34,873 INFO] Step 47000/100000; acc:  62.92; ppl:  4.54; xent: 1.51; lr: 0.10000;   0/3558 tok/s;  15864 sec
[2019-09-17 18:31:29,457 INFO] Step 47500/100000; acc:  62.85; ppl:  4.57; xent: 1.52; lr: 0.10000;   0/3373 tok/s;  16039 sec
[2019-09-17 18:34:12,052 INFO] Step 48000/100000; acc:  62.94; ppl:  4.54; xent: 1.51; lr: 0.10000;   0/3596 tok/s;  16201 sec
[2019-09-17 18:37:00,210 INFO] Step 48500/100000; acc:  63.01; ppl:  4.52; xent: 1.51; lr: 0.10000;   0/3492 tok/s;  16369 sec
[2019-09-17 18:39:50,037 INFO] Step 49000/100000; acc:  62.96; ppl:  4.52; xent: 1.51; lr: 0.10000;   0/3453 tok/s;  16539 sec
[2019-09-17 18:42:38,428 INFO] Step 49500/100000; acc:  62.98; ppl:  4.52; xent: 1.51; lr: 0.10000;   0/3459 tok/s;  16708 sec
[2019-09-17 18:45:25,898 INFO] Step 50000/100000; acc:  63.01; ppl:  4.50; xent: 1.50; lr: 0.05000;   0/3522 tok/s;  16875 sec
[2019-09-17 18:46:41,882 INFO] Validation perplexity: 4.93943
[2019-09-17 18:46:41,883 INFO] Validation accuracy: 61.51
[2019-09-17 18:46:41,886 INFO] Saving checkpoint ../results/models/im2latex-30_step_50000.pt
[2019-09-17 18:49:24,270 INFO] Step 50500/100000; acc:  63.44; ppl:  4.42; xent: 1.49; lr: 0.05000;   0/2445 tok/s;  17113 sec
[2019-09-17 18:52:04,543 INFO] Step 51000/100000; acc:  63.62; ppl:  4.39; xent: 1.48; lr: 0.05000;   0/3655 tok/s;  17274 sec
[2019-09-17 18:54:46,813 INFO] Step 51500/100000; acc:  63.92; ppl:  4.33; xent: 1.47; lr: 0.05000;   0/3631 tok/s;  17436 sec
[2019-09-17 18:57:27,696 INFO] Step 52000/100000; acc:  63.87; ppl:  4.33; xent: 1.47; lr: 0.05000;   0/3621 tok/s;  17597 sec
[2019-09-17 19:00:10,312 INFO] Step 52500/100000; acc:  64.10; ppl:  4.27; xent: 1.45; lr: 0.05000;   0/3600 tok/s;  17759 sec
[2019-09-17 19:02:53,631 INFO] Step 53000/100000; acc:  64.11; ppl:  4.28; xent: 1.45; lr: 0.05000;   0/3590 tok/s;  17923 sec
[2019-09-17 19:05:35,519 INFO] Step 53500/100000; acc:  64.22; ppl:  4.23; xent: 1.44; lr: 0.05000;   0/3614 tok/s;  18085 sec
[2019-09-17 19:08:21,556 INFO] Step 54000/100000; acc:  64.31; ppl:  4.24; xent: 1.44; lr: 0.05000;   0/3537 tok/s;  18251 sec
[2019-09-17 19:11:01,053 INFO] Step 54500/100000; acc:  64.00; ppl:  4.30; xent: 1.46; lr: 0.05000;   0/3651 tok/s;  18410 sec
[2019-09-17 19:13:43,646 INFO] Step 55000/100000; acc:  64.02; ppl:  4.29; xent: 1.46; lr: 0.05000;   0/3607 tok/s;  18573 sec
[2019-09-17 19:16:25,814 INFO] Step 55500/100000; acc:  64.20; ppl:  4.26; xent: 1.45; lr: 0.05000;   0/3626 tok/s;  18735 sec
[2019-09-17 19:19:07,751 INFO] Step 56000/100000; acc:  64.15; ppl:  4.27; xent: 1.45; lr: 0.05000;   0/3617 tok/s;  18897 sec
[2019-09-17 19:21:50,843 INFO] Step 56500/100000; acc:  64.40; ppl:  4.21; xent: 1.44; lr: 0.05000;   0/3604 tok/s;  19060 sec
[2019-09-17 19:24:30,393 INFO] Step 57000/100000; acc:  64.37; ppl:  4.22; xent: 1.44; lr: 0.05000;   0/3651 tok/s;  19219 sec
[2019-09-17 19:27:13,960 INFO] Step 57500/100000; acc:  64.46; ppl:  4.18; xent: 1.43; lr: 0.05000;   0/3607 tok/s;  19383 sec
[2019-09-17 19:29:57,072 INFO] Step 58000/100000; acc:  64.30; ppl:  4.23; xent: 1.44; lr: 0.05000;   0/3572 tok/s;  19546 sec
[2019-09-17 19:32:37,060 INFO] Step 58500/100000; acc:  64.37; ppl:  4.22; xent: 1.44; lr: 0.05000;   0/3650 tok/s;  19706 sec
[2019-09-17 19:35:21,966 INFO] Step 59000/100000; acc:  64.47; ppl:  4.21; xent: 1.44; lr: 0.05000;   0/3589 tok/s;  19871 sec
[2019-09-17 19:38:03,805 INFO] Step 59500/100000; acc:  64.47; ppl:  4.19; xent: 1.43; lr: 0.05000;   0/3600 tok/s;  20033 sec
[2019-09-17 19:40:48,586 INFO] Step 60000/100000; acc:  64.61; ppl:  4.16; xent: 1.43; lr: 0.02500;   0/3569 tok/s;  20198 sec
[2019-09-17 19:42:04,546 INFO] Validation perplexity: 4.82661
[2019-09-17 19:42:04,547 INFO] Validation accuracy: 62.0862
[2019-09-17 19:42:04,550 INFO] Saving checkpoint ../results/models/im2latex-30_step_60000.pt
[2019-09-17 19:44:49,265 INFO] Step 60500/100000; acc:  64.83; ppl:  4.12; xent: 1.42; lr: 0.02500;   0/2439 tok/s;  20438 sec
[2019-09-17 19:47:30,268 INFO] Step 61000/100000; acc:  65.10; ppl:  4.07; xent: 1.40; lr: 0.02500;   0/3619 tok/s;  20599 sec
[2019-09-17 19:50:16,372 INFO] Step 61500/100000; acc:  65.18; ppl:  4.05; xent: 1.40; lr: 0.02500;   0/3551 tok/s;  20765 sec
[2019-09-17 19:52:56,601 INFO] Step 62000/100000; acc:  65.07; ppl:  4.08; xent: 1.41; lr: 0.02500;   0/3628 tok/s;  20926 sec
[2019-09-17 19:55:38,067 INFO] Step 62500/100000; acc:  65.23; ppl:  4.05; xent: 1.40; lr: 0.02500;   0/3637 tok/s;  21087 sec
[2019-09-17 19:58:20,139 INFO] Step 63000/100000; acc:  65.51; ppl:  4.01; xent: 1.39; lr: 0.02500;   0/3627 tok/s;  21249 sec
[2019-09-17 20:01:02,009 INFO] Step 63500/100000; acc:  65.51; ppl:  4.00; xent: 1.39; lr: 0.02500;   0/3602 tok/s;  21411 sec
[2019-09-17 20:03:44,984 INFO] Step 64000/100000; acc:  65.66; ppl:  3.97; xent: 1.38; lr: 0.02500;   0/3591 tok/s;  21574 sec
[2019-09-17 20:06:26,348 INFO] Step 64500/100000; acc:  65.40; ppl:  4.02; xent: 1.39; lr: 0.02500;   0/3637 tok/s;  21735 sec
[2019-09-17 20:09:09,389 INFO] Step 65000/100000; acc:  65.64; ppl:  3.95; xent: 1.37; lr: 0.02500;   0/3592 tok/s;  21898 sec
[2019-09-17 20:11:52,429 INFO] Step 65500/100000; acc:  65.72; ppl:  3.95; xent: 1.37; lr: 0.02500;   0/3589 tok/s;  22062 sec
[2019-09-17 20:14:31,440 INFO] Step 66000/100000; acc:  65.71; ppl:  3.96; xent: 1.38; lr: 0.02500;   0/3678 tok/s;  22221 sec
[2019-09-17 20:17:14,145 INFO] Step 66500/100000; acc:  65.70; ppl:  3.96; xent: 1.38; lr: 0.02500;   0/3602 tok/s;  22383 sec
[2019-09-17 20:19:55,440 INFO] Step 67000/100000; acc:  66.01; ppl:  3.91; xent: 1.36; lr: 0.02500;   0/3637 tok/s;  22545 sec
[2019-09-17 20:22:39,304 INFO] Step 67500/100000; acc:  66.05; ppl:  3.90; xent: 1.36; lr: 0.02500;   0/3581 tok/s;  22708 sec
[2019-09-17 20:25:22,774 INFO] Step 68000/100000; acc:  66.13; ppl:  3.88; xent: 1.36; lr: 0.02500;   0/3584 tok/s;  22872 sec
[2019-09-17 20:28:04,245 INFO] Step 68500/100000; acc:  66.27; ppl:  3.88; xent: 1.35; lr: 0.02500;   0/3607 tok/s;  23033 sec
[2019-09-17 20:30:48,296 INFO] Step 69000/100000; acc:  66.40; ppl:  3.85; xent: 1.35; lr: 0.02500;   0/3598 tok/s;  23197 sec
[2019-09-17 20:33:29,721 INFO] Step 69500/100000; acc:  66.41; ppl:  3.85; xent: 1.35; lr: 0.02500;   0/3611 tok/s;  23359 sec
[2019-09-17 20:36:12,156 INFO] Step 70000/100000; acc:  66.50; ppl:  3.86; xent: 1.35; lr: 0.01250;   0/3606 tok/s;  23521 sec
[2019-09-17 20:37:28,251 INFO] Validation perplexity: 4.62957
[2019-09-17 20:37:28,252 INFO] Validation accuracy: 62.9556
[2019-09-17 20:37:28,255 INFO] Saving checkpoint ../results/models/im2latex-30_step_70000.pt
[2019-09-17 20:40:12,705 INFO] Step 70500/100000; acc:  66.96; ppl:  3.79; xent: 1.33; lr: 0.01250;   0/2460 tok/s;  23762 sec
[2019-09-17 20:42:54,228 INFO] Step 71000/100000; acc:  67.31; ppl:  3.74; xent: 1.32; lr: 0.01250;   0/3608 tok/s;  23923 sec
[2019-09-17 20:45:37,991 INFO] Step 71500/100000; acc:  67.46; ppl:  3.71; xent: 1.31; lr: 0.01250;   0/3585 tok/s;  24087 sec
[2019-09-17 20:48:20,719 INFO] Step 72000/100000; acc:  67.46; ppl:  3.72; xent: 1.31; lr: 0.01250;   0/3600 tok/s;  24250 sec
[2019-09-17 20:51:01,668 INFO] Step 72500/100000; acc:  67.70; ppl:  3.68; xent: 1.30; lr: 0.01250;   0/3620 tok/s;  24411 sec
[2019-09-17 20:53:53,192 INFO] Step 73000/100000; acc:  67.99; ppl:  3.64; xent: 1.29; lr: 0.01250;   0/3434 tok/s;  24582 sec
[2019-09-17 20:56:36,635 INFO] Step 73500/100000; acc:  67.95; ppl:  3.66; xent: 1.30; lr: 0.01250;   0/3556 tok/s;  24746 sec
[2019-09-17 20:59:24,612 INFO] Step 74000/100000; acc:  68.00; ppl:  3.65; xent: 1.29; lr: 0.01250;   0/3506 tok/s;  24914 sec
[2019-09-17 21:02:11,333 INFO] Step 74500/100000; acc:  68.09; ppl:  3.64; xent: 1.29; lr: 0.01250;   0/3514 tok/s;  25080 sec
[2019-09-17 21:05:00,016 INFO] Step 75000/100000; acc:  68.21; ppl:  3.62; xent: 1.29; lr: 0.01250;   0/3464 tok/s;  25249 sec
[2019-09-17 21:07:49,482 INFO] Step 75500/100000; acc:  68.49; ppl:  3.58; xent: 1.27; lr: 0.01250;   0/3454 tok/s;  25419 sec
[2019-09-17 21:10:38,503 INFO] Step 76000/100000; acc:  68.44; ppl:  3.59; xent: 1.28; lr: 0.01250;   0/3464 tok/s;  25588 sec
[2019-09-17 21:13:35,920 INFO] Step 76500/100000; acc:  68.66; ppl:  3.53; xent: 1.26; lr: 0.01250;   0/3308 tok/s;  25765 sec
[2019-09-17 21:16:36,383 INFO] Step 77000/100000; acc:  68.76; ppl:  3.54; xent: 1.26; lr: 0.01250;   0/3244 tok/s;  25945 sec
[2019-09-17 21:19:33,270 INFO] Step 77500/100000; acc:  68.85; ppl:  3.52; xent: 1.26; lr: 0.01250;   0/3307 tok/s;  26122 sec
[2019-09-17 21:22:32,730 INFO] Step 78000/100000; acc:  68.83; ppl:  3.53; xent: 1.26; lr: 0.01250;   0/3271 tok/s;  26302 sec
[2019-09-17 21:25:28,428 INFO] Step 78500/100000; acc:  69.09; ppl:  3.49; xent: 1.25; lr: 0.01250;   0/3331 tok/s;  26478 sec
[2019-09-17 21:28:25,407 INFO] Step 79000/100000; acc:  69.37; ppl:  3.45; xent: 1.24; lr: 0.01250;   0/3314 tok/s;  26655 sec
[2019-09-17 21:31:15,749 INFO] Step 79500/100000; acc:  69.63; ppl:  3.41; xent: 1.23; lr: 0.01250;   0/3444 tok/s;  26825 sec
[2019-09-17 21:34:02,723 INFO] Step 80000/100000; acc:  69.99; ppl:  3.35; xent: 1.21; lr: 0.00625;   0/3486 tok/s;  26992 sec
[2019-09-17 21:35:19,272 INFO] Validation perplexity: 4.1569
[2019-09-17 21:35:19,273 INFO] Validation accuracy: 65.6317
[2019-09-17 21:35:19,276 INFO] Saving checkpoint ../results/models/im2latex-30_step_80000.pt
[2019-09-17 21:38:09,676 INFO] Step 80500/100000; acc:  70.47; ppl:  3.29; xent: 1.19; lr: 0.00625;   0/2393 tok/s;  27239 sec
[2019-09-17 21:40:57,364 INFO] Step 81000/100000; acc:  70.69; ppl:  3.26; xent: 1.18; lr: 0.00625;   0/3475 tok/s;  27406 sec
[2019-09-17 21:43:41,962 INFO] Step 81500/100000; acc:  70.84; ppl:  3.23; xent: 1.17; lr: 0.00625;   0/3550 tok/s;  27571 sec
[2019-09-17 21:46:30,374 INFO] Step 82000/100000; acc:  71.08; ppl:  3.21; xent: 1.17; lr: 0.00625;   0/3519 tok/s;  27739 sec
[2019-09-17 21:49:18,741 INFO] Step 82500/100000; acc:  71.45; ppl:  3.15; xent: 1.15; lr: 0.00625;   0/3464 tok/s;  27908 sec
[2019-09-17 21:52:05,140 INFO] Step 83000/100000; acc:  71.89; ppl:  3.10; xent: 1.13; lr: 0.00625;   0/3517 tok/s;  28074 sec
[2019-09-17 21:54:50,549 INFO] Step 83500/100000; acc:  71.91; ppl:  3.09; xent: 1.13; lr: 0.00625;   0/3543 tok/s;  28240 sec
[2019-09-17 21:57:36,005 INFO] Step 84000/100000; acc:  72.34; ppl:  3.02; xent: 1.11; lr: 0.00625;   0/3530 tok/s;  28405 sec
[2019-09-17 22:00:24,504 INFO] Step 84500/100000; acc:  72.51; ppl:  2.99; xent: 1.10; lr: 0.00625;   0/3493 tok/s;  28574 sec
[2019-09-17 22:03:07,557 INFO] Step 85000/100000; acc:  72.88; ppl:  2.94; xent: 1.08; lr: 0.00625;   0/3566 tok/s;  28737 sec
[2019-09-17 22:05:54,388 INFO] Step 85500/100000; acc:  73.11; ppl:  2.92; xent: 1.07; lr: 0.00625;   0/3515 tok/s;  28903 sec
[2019-09-17 22:08:40,485 INFO] Step 86000/100000; acc:  73.59; ppl:  2.85; xent: 1.05; lr: 0.00625;   0/3543 tok/s;  29070 sec
[2019-09-17 22:11:25,974 INFO] Step 86500/100000; acc:  73.95; ppl:  2.80; xent: 1.03; lr: 0.00625;   0/3536 tok/s;  29235 sec
[2019-09-17 22:14:14,588 INFO] Step 87000/100000; acc:  74.57; ppl:  2.73; xent: 1.00; lr: 0.00625;   0/3481 tok/s;  29404 sec
[2019-09-17 22:16:58,823 INFO] Step 87500/100000; acc:  74.96; ppl:  2.67; xent: 0.98; lr: 0.00625;   0/3555 tok/s;  29568 sec
[2019-09-17 22:19:46,357 INFO] Step 88000/100000; acc:  75.44; ppl:  2.62; xent: 0.96; lr: 0.00625;   0/3515 tok/s;  29735 sec
[2019-09-17 22:22:31,568 INFO] Step 88500/100000; acc:  75.86; ppl:  2.57; xent: 0.95; lr: 0.00625;   0/3530 tok/s;  29901 sec
[2019-09-17 22:25:13,484 INFO] Step 89000/100000; acc:  76.41; ppl:  2.51; xent: 0.92; lr: 0.00625;   0/3612 tok/s;  30063 sec
[2019-09-17 22:27:59,619 INFO] Step 89500/100000; acc:  76.71; ppl:  2.48; xent: 0.91; lr: 0.00625;   0/3540 tok/s;  30229 sec
[2019-09-17 22:30:45,208 INFO] Step 90000/100000; acc:  77.48; ppl:  2.41; xent: 0.88; lr: 0.00313;   0/3528 tok/s;  30394 sec
[2019-09-17 22:32:01,466 INFO] Validation perplexity: 2.53693
[2019-09-17 22:32:01,467 INFO] Validation accuracy: 76.6068
[2019-09-17 22:32:01,470 INFO] Saving checkpoint ../results/models/im2latex-30_step_90000.pt
[2019-09-17 22:34:48,179 INFO] Step 90500/100000; acc:  78.20; ppl:  2.33; xent: 0.85; lr: 0.00313;   0/2414 tok/s;  30637 sec
[2019-09-17 22:37:33,930 INFO] Step 91000/100000; acc:  78.38; ppl:  2.31; xent: 0.84; lr: 0.00313;   0/3540 tok/s;  30803 sec
[2019-09-17 22:40:20,090 INFO] Step 91500/100000; acc:  78.83; ppl:  2.27; xent: 0.82; lr: 0.00313;   0/3501 tok/s;  30969 sec
[2019-09-17 22:43:06,618 INFO] Step 92000/100000; acc:  79.00; ppl:  2.25; xent: 0.81; lr: 0.00313;   0/3547 tok/s;  31136 sec
[2019-09-17 22:45:51,719 INFO] Step 92500/100000; acc:  79.39; ppl:  2.22; xent: 0.80; lr: 0.00313;   0/3529 tok/s;  31301 sec
[2019-09-17 22:48:35,310 INFO] Step 93000/100000; acc:  79.54; ppl:  2.20; xent: 0.79; lr: 0.00313;   0/3586 tok/s;  31464 sec
[2019-09-17 22:51:21,221 INFO] Step 93500/100000; acc:  79.95; ppl:  2.17; xent: 0.77; lr: 0.00313;   0/3558 tok/s;  31630 sec
[2019-09-17 22:54:06,397 INFO] Step 94000/100000; acc:  80.26; ppl:  2.14; xent: 0.76; lr: 0.00313;   0/3525 tok/s;  31795 sec
[2019-09-17 22:56:52,830 INFO] Step 94500/100000; acc:  80.55; ppl:  2.11; xent: 0.75; lr: 0.00313;   0/3520 tok/s;  31962 sec
[2019-09-17 22:59:37,613 INFO] Step 95000/100000; acc:  80.64; ppl:  2.10; xent: 0.74; lr: 0.00313;   0/3553 tok/s;  32127 sec
[2019-09-17 23:02:22,142 INFO] Step 95500/100000; acc:  81.13; ppl:  2.06; xent: 0.73; lr: 0.00313;   0/3560 tok/s;  32291 sec
[2019-09-17 23:05:07,989 INFO] Step 96000/100000; acc:  81.29; ppl:  2.05; xent: 0.72; lr: 0.00313;   0/3537 tok/s;  32457 sec
[2019-09-17 23:07:50,310 INFO] Step 96500/100000; acc:  81.55; ppl:  2.02; xent: 0.71; lr: 0.00313;   0/3590 tok/s;  32619 sec
[2019-09-17 23:10:38,878 INFO] Step 97000/100000; acc:  81.72; ppl:  2.01; xent: 0.70; lr: 0.00313;   0/3488 tok/s;  32788 sec
[2019-09-17 23:13:24,978 INFO] Step 97500/100000; acc:  82.17; ppl:  1.98; xent: 0.68; lr: 0.00313;   0/3533 tok/s;  32954 sec
[2019-09-17 23:16:14,419 INFO] Step 98000/100000; acc:  82.41; ppl:  1.96; xent: 0.67; lr: 0.00313;   0/3464 tok/s;  33124 sec
[2019-09-17 23:19:01,503 INFO] Step 98500/100000; acc:  82.72; ppl:  1.94; xent: 0.66; lr: 0.00313;   0/3513 tok/s;  33291 sec
[2019-09-17 23:21:44,952 INFO] Step 99000/100000; acc:  82.97; ppl:  1.91; xent: 0.65; lr: 0.00313;   0/3563 tok/s;  33454 sec
[2019-09-17 23:24:32,614 INFO] Step 99500/100000; acc:  83.15; ppl:  1.90; xent: 0.64; lr: 0.00313;   0/3520 tok/s;  33622 sec
[2019-09-17 23:27:17,832 INFO] Step 100000/100000; acc:  83.47; ppl:  1.88; xent: 0.63; lr: 0.00156;   0/3525 tok/s;  33787 sec
[2019-09-17 23:28:34,395 INFO] Validation perplexity: 1.87666
[2019-09-17 23:28:34,396 INFO] Validation accuracy: 83.8813
[2019-09-17 23:28:34,399 INFO] Saving checkpoint ../results/models/im2latex-30_step_100000.pt
