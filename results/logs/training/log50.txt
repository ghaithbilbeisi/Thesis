[2019-11-18 14:49:14,833 INFO]  * tgt vocab size = 510
[2019-11-18 14:49:14,834 INFO] Building model...
[2019-11-18 14:49:25,895 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds1): Downsample(
      (pad): ReflectionPad2d([3, 3, 3, 3])
    )
    (layer2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds2): Downsample(
      (pad): ReflectionPad2d([3, 3, 3, 3])
    )
    (layer3): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds3): Downsample(
      (pad): ReflectionPad2d([3, 3, 3, 3])
    )
    (layer4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds4): Downsample(
      (pad): ReflectionPad2d([3, 3, 3, 3])
    )
    (layer5): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds5): Downsample(
      (pad): ReflectionPad2d([3, 3, 3, 3])
    )
    (layer6): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds6): Downsample(
      (pad): ReflectionPad2d([3, 3, 3, 3])
    )
    (batch_norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(512, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 512)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-11-18 14:49:25,901 INFO] encoder: 8047424
[2019-11-18 14:49:25,902 INFO] decoder: 5214310
[2019-11-18 14:49:25,902 INFO] * number of parameters: 13261734
[2019-11-18 14:49:27,592 INFO] Starting training on GPU: [0]
[2019-11-18 14:49:27,593 INFO] Start training loop and validate every 10000 steps...
[2019-11-18 14:57:32,235 INFO] Step 500/100000; acc:  28.94; ppl: 37.84; xent: 3.63; lr: 0.10000;   0/1214 tok/s;    485 sec
[2019-11-18 15:05:39,339 INFO] Step 1000/100000; acc:  44.46; ppl: 13.54; xent: 2.61; lr: 0.10000;   0/1193 tok/s;    972 sec
[2019-11-18 15:14:40,863 INFO] Step 1500/100000; acc:  48.17; ppl: 10.64; xent: 2.36; lr: 0.10000;   0/1088 tok/s;   1513 sec
[2019-11-18 15:23:56,050 INFO] Step 2000/100000; acc:  51.05; ppl:  8.94; xent: 2.19; lr: 0.10000;   0/1060 tok/s;   2068 sec
[2019-11-18 15:33:15,310 INFO] Step 2500/100000; acc:  58.85; ppl:  5.93; xent: 1.78; lr: 0.10000;   0/1045 tok/s;   2628 sec
[2019-11-18 15:42:34,174 INFO] Step 3000/100000; acc:  73.79; ppl:  2.97; xent: 1.09; lr: 0.10000;   0/1049 tok/s;   3187 sec
[2019-11-18 15:51:40,890 INFO] Step 3500/100000; acc:  82.33; ppl:  2.08; xent: 0.73; lr: 0.10000;   0/1069 tok/s;   3733 sec
[2019-11-18 16:00:55,824 INFO] Step 4000/100000; acc:  86.15; ppl:  1.78; xent: 0.58; lr: 0.10000;   0/1060 tok/s;   4288 sec
[2019-11-18 16:10:30,072 INFO] Step 4500/100000; acc:  88.36; ppl:  1.61; xent: 0.48; lr: 0.10000;   0/1016 tok/s;   4862 sec
[2019-11-18 16:19:51,981 INFO] Step 5000/100000; acc:  89.73; ppl:  1.52; xent: 0.42; lr: 0.10000;   0/1043 tok/s;   5424 sec
[2019-11-18 16:29:17,267 INFO] Step 5500/100000; acc:  90.80; ppl:  1.45; xent: 0.37; lr: 0.10000;   0/1036 tok/s;   5990 sec
[2019-11-18 16:38:21,766 INFO] Step 6000/100000; acc:  91.56; ppl:  1.41; xent: 0.34; lr: 0.10000;   0/1074 tok/s;   6534 sec
[2019-11-18 16:46:45,892 INFO] Step 6500/100000; acc:  92.12; ppl:  1.37; xent: 0.32; lr: 0.10000;   0/1163 tok/s;   7038 sec
[2019-11-18 16:55:16,551 INFO] Step 7000/100000; acc:  92.72; ppl:  1.34; xent: 0.29; lr: 0.10000;   0/1149 tok/s;   7549 sec
[2019-11-18 17:05:21,896 INFO] Step 7500/100000; acc:  93.32; ppl:  1.30; xent: 0.27; lr: 0.10000;   0/962 tok/s;   8154 sec
[2019-11-18 17:15:22,392 INFO] Step 8000/100000; acc:  93.56; ppl:  1.29; xent: 0.26; lr: 0.10000;   0/983 tok/s;   8755 sec
[2019-11-18 17:25:06,106 INFO] Step 8500/100000; acc:  94.16; ppl:  1.26; xent: 0.23; lr: 0.10000;   0/998 tok/s;   9339 sec
[2019-11-18 17:34:49,372 INFO] Step 9000/100000; acc:  94.42; ppl:  1.25; xent: 0.22; lr: 0.10000;   0/1004 tok/s;   9922 sec
[2019-11-18 17:44:49,371 INFO] Step 9500/100000; acc:  94.61; ppl:  1.24; xent: 0.21; lr: 0.10000;   0/987 tok/s;  10522 sec
[2019-11-18 17:54:35,715 INFO] Step 10000/100000; acc:  94.78; ppl:  1.23; xent: 0.21; lr: 0.10000;   0/993 tok/s;  11108 sec
[2019-11-18 17:59:14,089 INFO] Validation perplexity: 1.19476
[2019-11-18 17:59:14,093 INFO] Validation accuracy: 95.4026
[2019-11-18 17:59:14,097 INFO] Saving checkpoint ../results/models/im2latex-50_step_10000.pt
[2019-11-18 18:08:57,837 INFO] Step 10500/100000; acc:  94.96; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/679 tok/s;  11970 sec
[2019-11-18 18:18:34,880 INFO] Step 11000/100000; acc:  95.10; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/1017 tok/s;  12547 sec
[2019-11-18 18:28:16,655 INFO] Step 11500/100000; acc:  95.24; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/1004 tok/s;  13129 sec
[2019-11-18 18:37:57,514 INFO] Step 12000/100000; acc:  95.34; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/1011 tok/s;  13710 sec
[2019-11-18 18:47:15,155 INFO] Step 12500/100000; acc:  95.60; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/1045 tok/s;  14268 sec
[2019-11-18 18:56:29,005 INFO] Step 13000/100000; acc:  95.71; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/1060 tok/s;  14821 sec
[2019-11-18 19:06:01,373 INFO] Step 13500/100000; acc:  95.85; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/1028 tok/s;  15394 sec
[2019-11-18 19:16:13,224 INFO] Step 14000/100000; acc:  95.92; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/957 tok/s;  16006 sec
[2019-11-18 19:26:09,462 INFO] Step 14500/100000; acc:  95.90; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/986 tok/s;  16602 sec
[2019-11-18 19:36:09,941 INFO] Step 15000/100000; acc:  96.05; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/971 tok/s;  17202 sec
[2019-11-18 19:45:39,121 INFO] Step 15500/100000; acc:  96.06; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/1035 tok/s;  17772 sec
[2019-11-18 19:55:55,150 INFO] Step 16000/100000; acc:  96.21; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/946 tok/s;  18388 sec
[2019-11-18 20:05:51,091 INFO] Step 16500/100000; acc:  96.29; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/980 tok/s;  18983 sec
[2019-11-18 20:15:57,804 INFO] Step 17000/100000; acc:  96.39; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/970 tok/s;  19590 sec
[2019-11-18 20:25:38,499 INFO] Step 17500/100000; acc:  96.46; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1005 tok/s;  20171 sec
[2019-11-18 20:35:39,743 INFO] Step 18000/100000; acc:  96.44; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/977 tok/s;  20772 sec
[2019-11-18 20:45:11,222 INFO] Step 18500/100000; acc:  96.49; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1027 tok/s;  21344 sec
[2019-11-18 20:54:36,341 INFO] Step 19000/100000; acc:  96.57; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1031 tok/s;  21909 sec
[2019-11-18 21:05:40,859 INFO] Step 19500/100000; acc:  96.51; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/888 tok/s;  22573 sec
[2019-11-18 21:14:09,731 INFO] Step 20000/100000; acc:  96.72; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1142 tok/s;  23082 sec
[2019-11-18 21:18:25,340 INFO] Validation perplexity: 1.13118
[2019-11-18 21:18:25,341 INFO] Validation accuracy: 96.8922
[2019-11-18 21:18:25,349 INFO] Saving checkpoint ../results/models/im2latex-50_step_20000.pt
[2019-11-18 21:26:28,617 INFO] Step 20500/100000; acc:  96.74; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/795 tok/s;  23821 sec
[2019-11-18 21:34:36,156 INFO] Step 21000/100000; acc:  96.77; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1208 tok/s;  24309 sec
[2019-11-18 21:42:34,381 INFO] Step 21500/100000; acc:  96.80; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1220 tok/s;  24787 sec
[2019-11-18 21:50:32,090 INFO] Step 22000/100000; acc:  96.80; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1225 tok/s;  25264 sec
[2019-11-18 21:58:25,094 INFO] Step 22500/100000; acc:  96.84; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/1239 tok/s;  25737 sec
[2019-11-18 22:06:09,915 INFO] Step 23000/100000; acc:  96.91; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1263 tok/s;  26202 sec
[2019-11-18 22:14:03,764 INFO] Step 23500/100000; acc:  96.90; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1235 tok/s;  26676 sec
[2019-11-18 22:21:56,728 INFO] Step 24000/100000; acc:  96.99; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1234 tok/s;  27149 sec
[2019-11-18 22:28:51,649 INFO] Step 24500/100000; acc:  97.03; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1416 tok/s;  27564 sec
[2019-11-18 22:36:22,506 INFO] Step 25000/100000; acc:  97.09; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1301 tok/s;  28015 sec
[2019-11-18 22:43:50,179 INFO] Step 25500/100000; acc:  97.10; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1312 tok/s;  28463 sec
[2019-11-18 22:50:32,970 INFO] Step 26000/100000; acc:  97.07; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1455 tok/s;  28865 sec
[2019-11-18 22:57:03,394 INFO] Step 26500/100000; acc:  97.15; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1493 tok/s;  29256 sec
[2019-11-18 23:04:19,559 INFO] Step 27000/100000; acc:  97.03; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1353 tok/s;  29692 sec
[2019-11-18 23:09:08,338 INFO] Step 27500/100000; acc:  97.20; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/2016 tok/s;  29981 sec
[2019-11-18 23:15:40,582 INFO] Step 28000/100000; acc:  97.18; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1494 tok/s;  30373 sec
[2019-11-18 23:22:19,474 INFO] Step 28500/100000; acc:  97.26; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1479 tok/s;  30772 sec
[2019-11-18 23:28:45,994 INFO] Step 29000/100000; acc:  97.23; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1508 tok/s;  31158 sec
[2019-11-18 23:35:05,250 INFO] Step 29500/100000; acc:  97.30; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1549 tok/s;  31538 sec
[2019-11-18 23:41:30,080 INFO] Step 30000/100000; acc:  97.24; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1522 tok/s;  31922 sec
[2019-11-18 23:44:37,322 INFO] Validation perplexity: 1.11279
[2019-11-18 23:44:37,327 INFO] Validation accuracy: 97.231
[2019-11-18 23:44:37,339 INFO] Saving checkpoint ../results/models/im2latex-50_step_30000.pt
[2019-11-18 23:50:31,435 INFO] Step 30500/100000; acc:  97.28; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1077 tok/s;  32464 sec
[2019-11-18 23:56:01,850 INFO] Step 31000/100000; acc:  97.29; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1783 tok/s;  32794 sec
[2019-11-19 00:03:15,188 INFO] Step 31500/100000; acc:  97.34; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1342 tok/s;  33228 sec
[2019-11-19 00:11:47,317 INFO] Step 32000/100000; acc:  97.46; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1150 tok/s;  33740 sec
[2019-11-19 00:20:05,362 INFO] Step 32500/100000; acc:  97.43; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1179 tok/s;  34238 sec
[2019-11-19 00:28:22,862 INFO] Step 33000/100000; acc:  97.47; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1175 tok/s;  34735 sec
[2019-11-19 00:37:01,433 INFO] Step 33500/100000; acc:  97.43; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1128 tok/s;  35254 sec
[2019-11-19 00:45:09,232 INFO] Step 34000/100000; acc:  97.42; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1200 tok/s;  35742 sec
[2019-11-19 00:53:20,712 INFO] Step 34500/100000; acc:  97.50; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1194 tok/s;  36233 sec
[2019-11-19 01:01:10,064 INFO] Step 35000/100000; acc:  97.47; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1247 tok/s;  36702 sec
[2019-11-19 01:09:06,485 INFO] Step 35500/100000; acc:  97.51; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1229 tok/s;  37179 sec
[2019-11-19 01:16:46,245 INFO] Step 36000/100000; acc:  97.55; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1277 tok/s;  37639 sec
[2019-11-19 01:24:48,584 INFO] Step 36500/100000; acc:  97.56; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1215 tok/s;  38121 sec
[2019-11-19 01:32:42,245 INFO] Step 37000/100000; acc:  97.59; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1237 tok/s;  38595 sec
[2019-11-19 01:40:34,534 INFO] Step 37500/100000; acc:  97.59; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1240 tok/s;  39067 sec
[2019-11-19 01:48:10,778 INFO] Step 38000/100000; acc:  97.61; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1279 tok/s;  39523 sec
[2019-11-19 01:56:14,924 INFO] Step 38500/100000; acc:  97.55; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1220 tok/s;  40007 sec
[2019-11-19 02:02:32,033 INFO] Step 39000/100000; acc:  97.68; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1545 tok/s;  40384 sec
[2019-11-19 02:08:38,212 INFO] Step 39500/100000; acc:  97.68; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1596 tok/s;  40751 sec
[2019-11-19 02:15:37,047 INFO] Step 40000/100000; acc:  97.70; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1414 tok/s;  41169 sec
[2019-11-19 02:18:46,689 INFO] Validation perplexity: 1.10371
[2019-11-19 02:18:46,692 INFO] Validation accuracy: 97.4714
[2019-11-19 02:18:46,704 INFO] Saving checkpoint ../results/models/im2latex-50_step_40000.pt
[2019-11-19 02:25:17,453 INFO] Step 40500/100000; acc:  97.72; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1005 tok/s;  41750 sec
[2019-11-19 02:31:20,064 INFO] Step 41000/100000; acc:  97.70; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1615 tok/s;  42112 sec
[2019-11-19 02:37:48,767 INFO] Step 41500/100000; acc:  97.66; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1507 tok/s;  42501 sec
[2019-11-19 02:43:57,798 INFO] Step 42000/100000; acc:  97.71; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1583 tok/s;  42870 sec
[2019-11-19 02:50:07,821 INFO] Step 42500/100000; acc:  97.72; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1590 tok/s;  43240 sec
[2019-11-19 02:56:16,761 INFO] Step 43000/100000; acc:  97.77; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1576 tok/s;  43609 sec
[2019-11-19 03:02:05,585 INFO] Step 43500/100000; acc:  97.81; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1679 tok/s;  43958 sec
[2019-11-19 03:07:48,069 INFO] Step 44000/100000; acc:  97.78; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1721 tok/s;  44300 sec
[2019-11-19 03:13:35,355 INFO] Step 44500/100000; acc:  97.81; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1684 tok/s;  44648 sec
[2019-11-19 03:19:27,516 INFO] Step 45000/100000; acc:  97.75; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1666 tok/s;  45000 sec
[2019-11-19 03:25:02,836 INFO] Step 45500/100000; acc:  97.76; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1742 tok/s;  45335 sec
[2019-11-19 03:30:53,306 INFO] Step 46000/100000; acc:  97.80; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1681 tok/s;  45686 sec
[2019-11-19 03:36:39,873 INFO] Step 46500/100000; acc:  97.84; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1683 tok/s;  46032 sec
[2019-11-19 03:42:15,993 INFO] Step 47000/100000; acc:  97.86; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1741 tok/s;  46368 sec
[2019-11-19 03:48:39,111 INFO] Step 47500/100000; acc:  97.90; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1535 tok/s;  46752 sec
[2019-11-19 03:55:34,643 INFO] Step 48000/100000; acc:  97.87; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1406 tok/s;  47167 sec
[2019-11-19 04:02:08,034 INFO] Step 48500/100000; acc:  97.87; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1492 tok/s;  47560 sec
[2019-11-19 04:08:54,074 INFO] Step 49000/100000; acc:  97.84; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1444 tok/s;  47966 sec
[2019-11-19 04:15:47,582 INFO] Step 49500/100000; acc:  97.88; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1410 tok/s;  48380 sec
[2019-11-19 04:22:39,235 INFO] Step 50000/100000; acc:  97.86; ppl:  1.08; xent: 0.07; lr: 0.05000;   0/1433 tok/s;  48792 sec
[2019-11-19 04:26:12,637 INFO] Validation perplexity: 1.1037
[2019-11-19 04:26:12,638 INFO] Validation accuracy: 97.5345
[2019-11-19 04:26:12,648 INFO] Saving checkpoint ../results/models/im2latex-50_step_50000.pt
[2019-11-19 04:33:24,874 INFO] Step 50500/100000; acc:  98.10; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/902 tok/s;  49437 sec
[2019-11-19 04:40:48,423 INFO] Step 51000/100000; acc:  98.19; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1322 tok/s;  49881 sec
[2019-11-19 04:48:22,314 INFO] Step 51500/100000; acc:  98.22; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1304 tok/s;  50335 sec
[2019-11-19 04:55:19,324 INFO] Step 52000/100000; acc:  98.28; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1395 tok/s;  50752 sec
[2019-11-19 05:02:31,792 INFO] Step 52500/100000; acc:  98.28; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1355 tok/s;  51184 sec
[2019-11-19 05:09:53,243 INFO] Step 53000/100000; acc:  98.30; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1327 tok/s;  51626 sec
[2019-11-19 05:17:23,569 INFO] Step 53500/100000; acc:  98.39; ppl:  1.06; xent: 0.05; lr: 0.05000;   0/1300 tok/s;  52076 sec
[2019-11-19 05:26:17,229 INFO] Step 54000/100000; acc:  98.36; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1099 tok/s;  52610 sec
[2019-11-19 05:34:59,435 INFO] Step 54500/100000; acc:  98.35; ppl:  1.06; xent: 0.05; lr: 0.05000;   0/1116 tok/s;  53132 sec
[2019-11-19 05:43:46,106 INFO] Step 55000/100000; acc:  98.37; ppl:  1.06; xent: 0.05; lr: 0.05000;   0/1112 tok/s;  53659 sec
[2019-11-19 05:52:38,505 INFO] Step 55500/100000; acc:  98.39; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1104 tok/s;  54191 sec
[2019-11-19 06:01:22,458 INFO] Step 56000/100000; acc:  98.42; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1119 tok/s;  54715 sec
[2019-11-19 06:10:08,748 INFO] Step 56500/100000; acc:  98.41; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1117 tok/s;  55241 sec
[2019-11-19 06:18:49,548 INFO] Step 57000/100000; acc:  98.43; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1119 tok/s;  55762 sec
[2019-11-19 06:27:39,830 INFO] Step 57500/100000; acc:  98.46; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1112 tok/s;  56292 sec
[2019-11-19 06:37:15,842 INFO] Step 58000/100000; acc:  98.44; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1011 tok/s;  56868 sec
[2019-11-19 06:46:47,682 INFO] Step 58500/100000; acc:  98.45; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1022 tok/s;  57440 sec
[2019-11-19 06:56:36,812 INFO] Step 59000/100000; acc:  98.46; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1001 tok/s;  58029 sec
[2019-11-19 07:06:30,239 INFO] Step 59500/100000; acc:  98.48; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/982 tok/s;  58623 sec
[2019-11-19 07:16:49,652 INFO] Step 60000/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/949 tok/s;  59242 sec
[2019-11-19 07:22:06,964 INFO] Validation perplexity: 1.09124
[2019-11-19 07:22:06,972 INFO] Validation accuracy: 97.849
[2019-11-19 07:22:06,989 INFO] Saving checkpoint ../results/models/im2latex-50_step_60000.pt
[2019-11-19 07:32:24,837 INFO] Step 60500/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/628 tok/s;  60177 sec
[2019-11-19 07:42:49,686 INFO] Step 61000/100000; acc:  98.57; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/932 tok/s;  60802 sec
[2019-11-19 07:53:08,712 INFO] Step 61500/100000; acc:  98.59; ppl:  1.05; xent: 0.04; lr: 0.02500;   0/953 tok/s;  61421 sec
[2019-11-19 08:03:24,331 INFO] Step 62000/100000; acc:  98.60; ppl:  1.05; xent: 0.04; lr: 0.02500;   0/944 tok/s;  62037 sec
[2019-11-19 08:13:45,266 INFO] Step 62500/100000; acc:  98.62; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/945 tok/s;  62658 sec
[2019-11-19 08:24:03,034 INFO] Step 63000/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/955 tok/s;  63275 sec
[2019-11-19 08:34:15,574 INFO] Step 63500/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/952 tok/s;  63888 sec
[2019-11-19 08:44:40,610 INFO] Step 64000/100000; acc:  98.65; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/936 tok/s;  64513 sec
[2019-11-19 08:54:48,108 INFO] Step 64500/100000; acc:  98.62; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/965 tok/s;  65121 sec
[2019-11-19 09:05:13,854 INFO] Step 65000/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/937 tok/s;  65746 sec
[2019-11-19 09:15:28,887 INFO] Step 65500/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/952 tok/s;  66361 sec
[2019-11-19 09:25:46,420 INFO] Step 66000/100000; acc:  98.65; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/947 tok/s;  66979 sec
[2019-11-19 09:35:36,918 INFO] Step 66500/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/991 tok/s;  67569 sec
[2019-11-19 09:45:48,947 INFO] Step 67000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/958 tok/s;  68181 sec
[2019-11-19 09:56:09,404 INFO] Step 67500/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/946 tok/s;  68802 sec
[2019-11-19 10:06:25,097 INFO] Step 68000/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/952 tok/s;  69418 sec
[2019-11-19 10:16:39,369 INFO] Step 68500/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/948 tok/s;  70032 sec
[2019-11-19 10:27:02,715 INFO] Step 69000/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/947 tok/s;  70655 sec
[2019-11-19 10:37:13,839 INFO] Step 69500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/954 tok/s;  71266 sec
[2019-11-19 10:47:25,124 INFO] Step 70000/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/957 tok/s;  71878 sec
[2019-11-19 10:52:46,354 INFO] Validation perplexity: 1.08853
[2019-11-19 10:52:46,355 INFO] Validation accuracy: 97.9692
[2019-11-19 10:52:46,362 INFO] Saving checkpoint ../results/models/im2latex-50_step_70000.pt
[2019-11-19 11:03:10,416 INFO] Step 70500/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/626 tok/s;  72823 sec
[2019-11-19 11:13:10,186 INFO] Step 71000/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/971 tok/s;  73423 sec
[2019-11-19 11:22:33,373 INFO] Step 71500/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1042 tok/s;  73986 sec
[2019-11-19 11:31:50,429 INFO] Step 72000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1052 tok/s;  74543 sec
[2019-11-19 11:41:08,031 INFO] Step 72500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1045 tok/s;  75100 sec
[2019-11-19 11:50:32,787 INFO] Step 73000/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1043 tok/s;  75665 sec
[2019-11-19 11:59:44,596 INFO] Step 73500/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1054 tok/s;  76217 sec
[2019-11-19 12:09:13,218 INFO] Step 74000/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1035 tok/s;  76786 sec
[2019-11-19 12:18:36,302 INFO] Step 74500/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1045 tok/s;  77349 sec
[2019-11-19 12:27:49,508 INFO] Step 75000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1056 tok/s;  77902 sec
[2019-11-19 12:37:10,390 INFO] Step 75500/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1044 tok/s;  78463 sec
[2019-11-19 12:46:15,307 INFO] Step 76000/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1073 tok/s;  79008 sec
[2019-11-19 12:54:58,094 INFO] Step 76500/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1124 tok/s;  79530 sec
[2019-11-19 13:03:25,232 INFO] Step 77000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1153 tok/s;  80038 sec
[2019-11-19 13:11:58,222 INFO] Step 77500/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1142 tok/s;  80551 sec
[2019-11-19 13:20:27,554 INFO] Step 78000/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1149 tok/s;  81060 sec
[2019-11-19 13:28:59,093 INFO] Step 78500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1144 tok/s;  81571 sec
[2019-11-19 13:37:36,514 INFO] Step 79000/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1133 tok/s;  82089 sec
[2019-11-19 13:45:56,222 INFO] Step 79500/100000; acc:  98.80; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1174 tok/s;  82589 sec
[2019-11-19 13:53:39,890 INFO] Step 80000/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1256 tok/s;  83052 sec
[2019-11-19 13:57:28,158 INFO] Validation perplexity: 1.08948
[2019-11-19 13:57:28,160 INFO] Validation accuracy: 97.9853
[2019-11-19 13:57:28,179 INFO] Saving checkpoint ../results/models/im2latex-50_step_80000.pt
[2019-11-19 14:05:16,244 INFO] Step 80500/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/848 tok/s;  83749 sec
[2019-11-19 14:12:48,828 INFO] Step 81000/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1288 tok/s;  84201 sec
[2019-11-19 14:20:28,780 INFO] Step 81500/100000; acc:  98.86; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1269 tok/s;  84661 sec
[2019-11-19 14:28:19,593 INFO] Step 82000/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1258 tok/s;  85132 sec
[2019-11-19 14:36:01,510 INFO] Step 82500/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1262 tok/s;  85594 sec
[2019-11-19 14:43:47,610 INFO] Step 83000/100000; acc:  98.87; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1256 tok/s;  86060 sec
[2019-11-19 14:53:41,441 INFO] Step 83500/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/987 tok/s;  86654 sec
[2019-11-19 15:04:04,833 INFO] Step 84000/100000; acc:  98.87; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/937 tok/s;  87277 sec
[2019-11-19 15:14:27,911 INFO] Step 84500/100000; acc:  98.87; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/945 tok/s;  87900 sec
[2019-11-19 15:22:16,812 INFO] Step 85000/100000; acc:  98.86; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1240 tok/s;  88369 sec
[2019-11-19 15:30:23,789 INFO] Step 85500/100000; acc:  98.87; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1206 tok/s;  88856 sec
[2019-11-19 15:38:03,636 INFO] Step 86000/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1281 tok/s;  89316 sec
[2019-11-19 15:46:03,886 INFO] Step 86500/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1219 tok/s;  89796 sec
[2019-11-19 15:54:08,215 INFO] Step 87000/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1213 tok/s;  90281 sec
[2019-11-19 16:01:56,231 INFO] Step 87500/100000; acc:  98.87; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1246 tok/s;  90749 sec
[2019-11-19 16:08:24,017 INFO] Step 88000/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1519 tok/s;  91136 sec
[2019-11-19 16:15:08,497 INFO] Step 88500/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1441 tok/s;  91541 sec
[2019-11-19 16:21:34,319 INFO] Step 89000/100000; acc:  98.88; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1517 tok/s;  91927 sec
[2019-11-19 16:28:13,666 INFO] Step 89500/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1470 tok/s;  92326 sec
[2019-11-19 16:34:25,388 INFO] Step 90000/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1571 tok/s;  92698 sec
[2019-11-19 16:37:26,489 INFO] Validation perplexity: 1.09005
[2019-11-19 16:37:26,490 INFO] Validation accuracy: 97.9984
[2019-11-19 16:37:26,497 INFO] Saving checkpoint ../results/models/im2latex-50_step_90000.pt
[2019-11-19 16:44:06,578 INFO] Step 90500/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1010 tok/s;  93279 sec
[2019-11-19 16:50:43,672 INFO] Step 91000/100000; acc:  98.86; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1477 tok/s;  93676 sec
[2019-11-19 16:57:02,286 INFO] Step 91500/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1537 tok/s;  94055 sec
[2019-11-19 17:03:23,692 INFO] Step 92000/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1548 tok/s;  94436 sec
[2019-11-19 17:09:56,289 INFO] Step 92500/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1483 tok/s;  94829 sec
[2019-11-19 17:16:22,434 INFO] Step 93000/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1520 tok/s;  95215 sec
[2019-11-19 17:23:00,599 INFO] Step 93500/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1482 tok/s;  95613 sec
[2019-11-19 17:29:29,060 INFO] Step 94000/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1499 tok/s;  96001 sec
[2019-11-19 17:35:54,491 INFO] Step 94500/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1520 tok/s;  96387 sec
[2019-11-19 17:42:18,642 INFO] Step 95000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1524 tok/s;  96771 sec
[2019-11-19 17:48:55,242 INFO] Step 95500/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1477 tok/s;  97168 sec
[2019-11-19 17:55:15,679 INFO] Step 96000/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1542 tok/s;  97548 sec
[2019-11-19 18:01:47,838 INFO] Step 96500/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1486 tok/s;  97940 sec
[2019-11-19 18:08:15,556 INFO] Step 97000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1517 tok/s;  98328 sec
[2019-11-19 18:14:49,816 INFO] Step 97500/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1491 tok/s;  98722 sec
[2019-11-19 18:21:18,003 INFO] Step 98000/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1511 tok/s;  99110 sec
[2019-11-19 18:27:58,555 INFO] Step 98500/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1465 tok/s;  99511 sec
[2019-11-19 18:34:15,568 INFO] Step 99000/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1545 tok/s;  99888 sec
[2019-11-19 18:40:44,852 INFO] Step 99500/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1515 tok/s; 100277 sec
[2019-11-19 18:47:10,793 INFO] Step 100000/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00156;   0/1508 tok/s; 100663 sec
[2019-11-19 18:50:38,128 INFO] Validation perplexity: 1.0904
[2019-11-19 18:50:38,129 INFO] Validation accuracy: 97.998
[2019-11-19 18:50:38,139 INFO] Saving checkpoint ../results/models/im2latex-50_step_100000.pt
