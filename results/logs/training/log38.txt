[2019-10-23 09:14:55,965 INFO]  * tgt vocab size = 510
[2019-10-23 09:14:55,965 INFO] Building model...
[2019-10-23 09:14:59,843 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer3): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer4): DCN(
      (conv_offset_mask): Conv2d(256, 54, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    )
    (layer5): DCN(
      (conv_offset_mask): Conv2d(256, 54, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    )
    (layer6): DCN(
      (conv_offset_mask): Conv2d(512, 54, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    )
    (batch_norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(512, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 512)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-10-23 09:14:59,845 INFO] encoder: 8545250
[2019-10-23 09:14:59,845 INFO] decoder: 5214310
[2019-10-23 09:14:59,845 INFO] * number of parameters: 13759560
[2019-10-23 09:15:00,221 INFO] Starting training on GPU: [0]
[2019-10-23 09:15:00,221 INFO] Start training loop and validate every 10000 steps...
[2019-10-23 09:21:28,260 INFO] Step 500/100000; acc:  28.21; ppl: 39.07; xent: 3.67; lr: 0.10000;   0/1517 tok/s;    388 sec
[2019-10-23 09:27:28,877 INFO] Step 1000/100000; acc:  44.57; ppl: 13.35; xent: 2.59; lr: 0.10000;   0/1612 tok/s;    749 sec
[2019-10-23 09:33:43,899 INFO] Step 1500/100000; acc:  48.06; ppl: 10.64; xent: 2.36; lr: 0.10000;   0/1570 tok/s;   1124 sec
[2019-10-23 09:39:57,800 INFO] Step 2000/100000; acc:  50.12; ppl:  9.43; xent: 2.24; lr: 0.10000;   0/1569 tok/s;   1498 sec
[2019-10-23 09:46:11,941 INFO] Step 2500/100000; acc:  51.16; ppl:  8.81; xent: 2.18; lr: 0.10000;   0/1562 tok/s;   1872 sec
[2019-10-23 09:52:33,487 INFO] Step 3000/100000; acc:  52.16; ppl:  8.33; xent: 2.12; lr: 0.10000;   0/1537 tok/s;   2253 sec
[2019-10-23 09:58:48,764 INFO] Step 3500/100000; acc:  52.92; ppl:  7.93; xent: 2.07; lr: 0.10000;   0/1558 tok/s;   2629 sec
[2019-10-23 10:05:10,698 INFO] Step 4000/100000; acc:  53.38; ppl:  7.68; xent: 2.04; lr: 0.10000;   0/1539 tok/s;   3010 sec
[2019-10-23 10:11:26,604 INFO] Step 4500/100000; acc:  53.89; ppl:  7.47; xent: 2.01; lr: 0.10000;   0/1552 tok/s;   3386 sec
[2019-10-23 10:17:33,014 INFO] Step 5000/100000; acc:  54.39; ppl:  7.26; xent: 1.98; lr: 0.10000;   0/1600 tok/s;   3753 sec
[2019-10-23 10:23:50,348 INFO] Step 5500/100000; acc:  54.82; ppl:  7.09; xent: 1.96; lr: 0.10000;   0/1555 tok/s;   4130 sec
[2019-10-23 10:29:59,310 INFO] Step 6000/100000; acc:  55.17; ppl:  6.95; xent: 1.94; lr: 0.10000;   0/1586 tok/s;   4499 sec
[2019-10-23 10:36:20,413 INFO] Step 6500/100000; acc:  55.71; ppl:  6.76; xent: 1.91; lr: 0.10000;   0/1539 tok/s;   4880 sec
[2019-10-23 10:42:36,131 INFO] Step 7000/100000; acc:  56.05; ppl:  6.62; xent: 1.89; lr: 0.10000;   0/1562 tok/s;   5256 sec
[2019-10-23 10:48:48,023 INFO] Step 7500/100000; acc:  56.34; ppl:  6.49; xent: 1.87; lr: 0.10000;   0/1567 tok/s;   5628 sec
[2019-10-23 10:55:12,321 INFO] Step 8000/100000; acc:  56.56; ppl:  6.40; xent: 1.86; lr: 0.10000;   0/1535 tok/s;   6012 sec
[2019-10-23 11:01:23,169 INFO] Step 8500/100000; acc:  56.95; ppl:  6.25; xent: 1.83; lr: 0.10000;   0/1572 tok/s;   6383 sec
[2019-10-23 11:07:30,453 INFO] Step 9000/100000; acc:  57.10; ppl:  6.19; xent: 1.82; lr: 0.10000;   0/1592 tok/s;   6750 sec
[2019-10-23 11:13:52,253 INFO] Step 9500/100000; acc:  57.66; ppl:  6.05; xent: 1.80; lr: 0.10000;   0/1553 tok/s;   7132 sec
[2019-10-23 11:19:59,025 INFO] Step 10000/100000; acc:  57.65; ppl:  6.04; xent: 1.80; lr: 0.10000;   0/1587 tok/s;   7499 sec
[2019-10-23 11:23:36,517 INFO] Validation perplexity: 5.99908
[2019-10-23 11:23:36,518 INFO] Validation accuracy: 57.7727
[2019-10-23 11:23:36,521 INFO] Saving checkpoint ../results/models/im2latex-38_step_10000.pt
[2019-10-23 11:29:55,036 INFO] Step 10500/100000; acc:  57.90; ppl:  5.96; xent: 1.78; lr: 0.10000;   0/982 tok/s;   8095 sec
[2019-10-23 11:36:11,080 INFO] Step 11000/100000; acc:  58.18; ppl:  5.87; xent: 1.77; lr: 0.10000;   0/1560 tok/s;   8471 sec
[2019-10-23 11:42:24,365 INFO] Step 11500/100000; acc:  58.29; ppl:  5.81; xent: 1.76; lr: 0.10000;   0/1565 tok/s;   8844 sec
[2019-10-23 11:48:52,119 INFO] Step 12000/100000; acc:  58.46; ppl:  5.77; xent: 1.75; lr: 0.10000;   0/1515 tok/s;   9232 sec
[2019-10-23 11:54:53,509 INFO] Step 12500/100000; acc:  58.44; ppl:  5.75; xent: 1.75; lr: 0.10000;   0/1612 tok/s;   9593 sec
[2019-10-23 12:01:06,685 INFO] Step 13000/100000; acc:  58.48; ppl:  5.74; xent: 1.75; lr: 0.10000;   0/1566 tok/s;   9966 sec
[2019-10-23 12:07:16,920 INFO] Step 13500/100000; acc:  58.78; ppl:  5.66; xent: 1.73; lr: 0.10000;   0/1591 tok/s;  10337 sec
[2019-10-23 12:13:31,696 INFO] Step 14000/100000; acc:  58.86; ppl:  5.64; xent: 1.73; lr: 0.10000;   0/1562 tok/s;  10711 sec
[2019-10-23 12:19:48,204 INFO] Step 14500/100000; acc:  59.09; ppl:  5.55; xent: 1.71; lr: 0.10000;   0/1560 tok/s;  11088 sec
[2019-10-23 12:25:57,514 INFO] Step 15000/100000; acc:  59.22; ppl:  5.53; xent: 1.71; lr: 0.10000;   0/1578 tok/s;  11457 sec
[2019-10-23 12:32:15,940 INFO] Step 15500/100000; acc:  59.28; ppl:  5.49; xent: 1.70; lr: 0.10000;   0/1559 tok/s;  11836 sec
[2019-10-23 12:38:28,674 INFO] Step 16000/100000; acc:  59.42; ppl:  5.45; xent: 1.70; lr: 0.10000;   0/1563 tok/s;  12208 sec
[2019-10-23 12:44:33,583 INFO] Step 16500/100000; acc:  59.53; ppl:  5.40; xent: 1.69; lr: 0.10000;   0/1600 tok/s;  12573 sec
[2019-10-23 12:50:54,052 INFO] Step 17000/100000; acc:  59.63; ppl:  5.40; xent: 1.69; lr: 0.10000;   0/1553 tok/s;  12954 sec
[2019-10-23 12:57:02,867 INFO] Step 17500/100000; acc:  59.69; ppl:  5.37; xent: 1.68; lr: 0.10000;   0/1581 tok/s;  13323 sec
[2019-10-23 13:03:15,980 INFO] Step 18000/100000; acc:  59.97; ppl:  5.32; xent: 1.67; lr: 0.10000;   0/1574 tok/s;  13696 sec
[2019-10-23 13:09:32,674 INFO] Step 18500/100000; acc:  60.04; ppl:  5.27; xent: 1.66; lr: 0.10000;   0/1560 tok/s;  14072 sec
[2019-10-23 13:15:38,776 INFO] Step 19000/100000; acc:  60.06; ppl:  5.26; xent: 1.66; lr: 0.10000;   0/1589 tok/s;  14439 sec
[2019-10-23 13:22:04,396 INFO] Step 19500/100000; acc:  60.15; ppl:  5.24; xent: 1.66; lr: 0.10000;   0/1531 tok/s;  14824 sec
[2019-10-23 13:28:10,121 INFO] Step 20000/100000; acc:  60.17; ppl:  5.22; xent: 1.65; lr: 0.10000;   0/1591 tok/s;  15190 sec
[2019-10-23 13:31:47,262 INFO] Validation perplexity: 5.33018
[2019-10-23 13:31:47,263 INFO] Validation accuracy: 59.8809
[2019-10-23 13:31:47,266 INFO] Saving checkpoint ../results/models/im2latex-38_step_20000.pt
[2019-10-23 13:37:59,465 INFO] Step 20500/100000; acc:  60.21; ppl:  5.21; xent: 1.65; lr: 0.10000;   0/996 tok/s;  15779 sec
[2019-10-23 13:44:11,437 INFO] Step 21000/100000; acc:  60.52; ppl:  5.15; xent: 1.64; lr: 0.10000;   0/1586 tok/s;  16151 sec
[2019-10-23 13:50:19,628 INFO] Step 21500/100000; acc:  60.45; ppl:  5.16; xent: 1.64; lr: 0.10000;   0/1584 tok/s;  16519 sec
[2019-10-23 13:56:33,273 INFO] Step 22000/100000; acc:  60.58; ppl:  5.12; xent: 1.63; lr: 0.10000;   0/1565 tok/s;  16893 sec
[2019-10-23 14:02:46,530 INFO] Step 22500/100000; acc:  60.57; ppl:  5.14; xent: 1.64; lr: 0.10000;   0/1570 tok/s;  17266 sec
[2019-10-23 14:09:01,333 INFO] Step 23000/100000; acc:  60.69; ppl:  5.08; xent: 1.62; lr: 0.10000;   0/1567 tok/s;  17641 sec
[2019-10-23 14:15:19,101 INFO] Step 23500/100000; acc:  60.85; ppl:  5.06; xent: 1.62; lr: 0.10000;   0/1549 tok/s;  18019 sec
[2019-10-23 14:21:20,204 INFO] Step 24000/100000; acc:  60.85; ppl:  5.05; xent: 1.62; lr: 0.10000;   0/1617 tok/s;  18380 sec
[2019-10-23 14:27:30,099 INFO] Step 24500/100000; acc:  60.86; ppl:  5.05; xent: 1.62; lr: 0.10000;   0/1579 tok/s;  18750 sec
[2019-10-23 14:33:39,475 INFO] Step 25000/100000; acc:  60.94; ppl:  5.02; xent: 1.61; lr: 0.10000;   0/1587 tok/s;  19119 sec
[2019-10-23 14:39:55,422 INFO] Step 25500/100000; acc:  60.97; ppl:  5.02; xent: 1.61; lr: 0.10000;   0/1564 tok/s;  19495 sec
[2019-10-23 14:46:10,638 INFO] Step 26000/100000; acc:  61.07; ppl:  4.98; xent: 1.60; lr: 0.10000;   0/1563 tok/s;  19870 sec
[2019-10-23 14:52:21,292 INFO] Step 26500/100000; acc:  61.20; ppl:  4.96; xent: 1.60; lr: 0.10000;   0/1572 tok/s;  20241 sec
[2019-10-23 14:58:39,145 INFO] Step 27000/100000; acc:  61.21; ppl:  4.95; xent: 1.60; lr: 0.10000;   0/1561 tok/s;  20619 sec
[2019-10-23 15:04:49,754 INFO] Step 27500/100000; acc:  61.30; ppl:  4.94; xent: 1.60; lr: 0.10000;   0/1571 tok/s;  20990 sec
[2019-10-23 15:10:54,140 INFO] Step 28000/100000; acc:  61.30; ppl:  4.94; xent: 1.60; lr: 0.10000;   0/1607 tok/s;  21354 sec
[2019-10-23 15:17:10,204 INFO] Step 28500/100000; acc:  61.42; ppl:  4.91; xent: 1.59; lr: 0.10000;   0/1573 tok/s;  21730 sec
[2019-10-23 15:23:17,917 INFO] Step 29000/100000; acc:  61.36; ppl:  4.91; xent: 1.59; lr: 0.10000;   0/1583 tok/s;  22098 sec
[2019-10-23 15:29:33,093 INFO] Step 29500/100000; acc:  61.52; ppl:  4.87; xent: 1.58; lr: 0.10000;   0/1569 tok/s;  22473 sec
[2019-10-23 15:35:48,201 INFO] Step 30000/100000; acc:  61.47; ppl:  4.88; xent: 1.59; lr: 0.10000;   0/1560 tok/s;  22848 sec
[2019-10-23 15:39:25,560 INFO] Validation perplexity: 5.06605
[2019-10-23 15:39:25,561 INFO] Validation accuracy: 60.8411
[2019-10-23 15:39:25,563 INFO] Saving checkpoint ../results/models/im2latex-38_step_30000.pt
[2019-10-23 15:45:36,139 INFO] Step 30500/100000; acc:  61.61; ppl:  4.84; xent: 1.58; lr: 0.10000;   0/993 tok/s;  23436 sec
[2019-10-23 15:52:05,025 INFO] Step 31000/100000; acc:  61.73; ppl:  4.83; xent: 1.58; lr: 0.10000;   0/1515 tok/s;  23825 sec
[2019-10-23 15:58:08,766 INFO] Step 31500/100000; acc:  61.64; ppl:  4.83; xent: 1.58; lr: 0.10000;   0/1597 tok/s;  24189 sec
[2019-10-23 16:04:27,668 INFO] Step 32000/100000; acc:  61.70; ppl:  4.82; xent: 1.57; lr: 0.10000;   0/1554 tok/s;  24567 sec
[2019-10-23 16:10:43,493 INFO] Step 32500/100000; acc:  61.81; ppl:  4.80; xent: 1.57; lr: 0.10000;   0/1565 tok/s;  24943 sec
[2019-10-23 16:16:54,650 INFO] Step 33000/100000; acc:  61.74; ppl:  4.81; xent: 1.57; lr: 0.10000;   0/1574 tok/s;  25314 sec
[2019-10-23 16:23:16,589 INFO] Step 33500/100000; acc:  61.94; ppl:  4.77; xent: 1.56; lr: 0.10000;   0/1531 tok/s;  25696 sec
[2019-10-23 16:29:33,016 INFO] Step 34000/100000; acc:  61.87; ppl:  4.78; xent: 1.57; lr: 0.10000;   0/1555 tok/s;  26073 sec
[2019-10-23 16:35:51,696 INFO] Step 34500/100000; acc:  61.98; ppl:  4.74; xent: 1.56; lr: 0.10000;   0/1551 tok/s;  26451 sec
[2019-10-23 16:42:13,971 INFO] Step 35000/100000; acc:  62.05; ppl:  4.74; xent: 1.56; lr: 0.10000;   0/1529 tok/s;  26834 sec
[2019-10-23 16:48:21,900 INFO] Step 35500/100000; acc:  62.03; ppl:  4.74; xent: 1.56; lr: 0.10000;   0/1592 tok/s;  27202 sec
[2019-10-23 16:54:39,294 INFO] Step 36000/100000; acc:  62.12; ppl:  4.75; xent: 1.56; lr: 0.10000;   0/1550 tok/s;  27579 sec
[2019-10-23 17:00:50,949 INFO] Step 36500/100000; acc:  62.04; ppl:  4.74; xent: 1.56; lr: 0.10000;   0/1576 tok/s;  27951 sec
[2019-10-23 17:07:12,694 INFO] Step 37000/100000; acc:  62.16; ppl:  4.73; xent: 1.55; lr: 0.10000;   0/1537 tok/s;  28332 sec
[2019-10-23 17:13:29,431 INFO] Step 37500/100000; acc:  62.18; ppl:  4.70; xent: 1.55; lr: 0.10000;   0/1554 tok/s;  28709 sec
[2019-10-23 17:19:45,403 INFO] Step 38000/100000; acc:  62.34; ppl:  4.67; xent: 1.54; lr: 0.10000;   0/1552 tok/s;  29085 sec
[2019-10-23 17:26:08,502 INFO] Step 38500/100000; acc:  62.30; ppl:  4.68; xent: 1.54; lr: 0.10000;   0/1542 tok/s;  29468 sec
[2019-10-23 17:32:24,508 INFO] Step 39000/100000; acc:  62.30; ppl:  4.67; xent: 1.54; lr: 0.10000;   0/1550 tok/s;  29844 sec
[2019-10-23 17:38:34,069 INFO] Step 39500/100000; acc:  62.22; ppl:  4.69; xent: 1.54; lr: 0.10000;   0/1580 tok/s;  30214 sec
[2019-10-23 17:44:58,712 INFO] Step 40000/100000; acc:  62.49; ppl:  4.65; xent: 1.54; lr: 0.10000;   0/1542 tok/s;  30598 sec
[2019-10-23 17:48:35,689 INFO] Validation perplexity: 5.01691
[2019-10-23 17:48:35,689 INFO] Validation accuracy: 61.1767
[2019-10-23 17:48:35,692 INFO] Saving checkpoint ../results/models/im2latex-38_step_40000.pt
[2019-10-23 17:54:46,849 INFO] Step 40500/100000; acc:  62.44; ppl:  4.65; xent: 1.54; lr: 0.10000;   0/991 tok/s;  31187 sec
[2019-10-23 18:01:07,039 INFO] Step 41000/100000; acc:  62.54; ppl:  4.63; xent: 1.53; lr: 0.10000;   0/1541 tok/s;  31567 sec
[2019-10-23 18:07:27,133 INFO] Step 41500/100000; acc:  62.43; ppl:  4.65; xent: 1.54; lr: 0.10000;   0/1541 tok/s;  31947 sec
[2019-10-23 18:13:37,242 INFO] Step 42000/100000; acc:  62.55; ppl:  4.60; xent: 1.53; lr: 0.10000;   0/1578 tok/s;  32317 sec
[2019-10-23 18:20:08,673 INFO] Step 42500/100000; acc:  62.63; ppl:  4.61; xent: 1.53; lr: 0.10000;   0/1503 tok/s;  32708 sec
[2019-10-23 18:26:12,961 INFO] Step 43000/100000; acc:  62.55; ppl:  4.61; xent: 1.53; lr: 0.10000;   0/1596 tok/s;  33073 sec
[2019-10-23 18:32:28,498 INFO] Step 43500/100000; acc:  62.56; ppl:  4.62; xent: 1.53; lr: 0.10000;   0/1565 tok/s;  33448 sec
[2019-10-23 18:38:45,086 INFO] Step 44000/100000; acc:  62.70; ppl:  4.59; xent: 1.52; lr: 0.10000;   0/1562 tok/s;  33825 sec
[2019-10-23 18:45:00,311 INFO] Step 44500/100000; acc:  62.64; ppl:  4.60; xent: 1.53; lr: 0.10000;   0/1558 tok/s;  34200 sec
[2019-10-23 18:51:21,715 INFO] Step 45000/100000; acc:  62.81; ppl:  4.56; xent: 1.52; lr: 0.10000;   0/1539 tok/s;  34581 sec
[2019-10-23 18:57:35,450 INFO] Step 45500/100000; acc:  62.74; ppl:  4.58; xent: 1.52; lr: 0.10000;   0/1563 tok/s;  34955 sec
[2019-10-23 19:03:58,768 INFO] Step 46000/100000; acc:  62.84; ppl:  4.55; xent: 1.51; lr: 0.10000;   0/1536 tok/s;  35339 sec
[2019-10-23 19:10:14,057 INFO] Step 46500/100000; acc:  62.77; ppl:  4.56; xent: 1.52; lr: 0.10000;   0/1554 tok/s;  35714 sec
[2019-10-23 19:16:21,903 INFO] Step 47000/100000; acc:  62.91; ppl:  4.54; xent: 1.51; lr: 0.10000;   0/1591 tok/s;  36082 sec
[2019-10-23 19:22:41,022 INFO] Step 47500/100000; acc:  62.75; ppl:  4.58; xent: 1.52; lr: 0.10000;   0/1546 tok/s;  36461 sec
[2019-10-23 19:28:50,333 INFO] Step 48000/100000; acc:  62.82; ppl:  4.55; xent: 1.51; lr: 0.10000;   0/1583 tok/s;  36830 sec
[2019-10-23 19:35:08,639 INFO] Step 48500/100000; acc:  63.01; ppl:  4.52; xent: 1.51; lr: 0.10000;   0/1552 tok/s;  37208 sec
[2019-10-23 19:41:23,575 INFO] Step 49000/100000; acc:  62.89; ppl:  4.53; xent: 1.51; lr: 0.10000;   0/1563 tok/s;  37583 sec
[2019-10-23 19:47:37,101 INFO] Step 49500/100000; acc:  63.05; ppl:  4.51; xent: 1.51; lr: 0.10000;   0/1561 tok/s;  37957 sec
[2019-10-23 19:54:01,066 INFO] Step 50000/100000; acc:  62.94; ppl:  4.52; xent: 1.51; lr: 0.05000;   0/1535 tok/s;  38341 sec
[2019-10-23 19:57:38,217 INFO] Validation perplexity: 4.91484
[2019-10-23 19:57:38,218 INFO] Validation accuracy: 61.3816
[2019-10-23 19:57:38,221 INFO] Saving checkpoint ../results/models/im2latex-38_step_50000.pt
[2019-10-23 20:03:51,629 INFO] Step 50500/100000; acc:  63.44; ppl:  4.41; xent: 1.48; lr: 0.05000;   0/987 tok/s;  38931 sec
[2019-10-23 20:10:03,993 INFO] Step 51000/100000; acc:  63.54; ppl:  4.38; xent: 1.48; lr: 0.05000;   0/1573 tok/s;  39304 sec
[2019-10-23 20:16:25,965 INFO] Step 51500/100000; acc:  63.89; ppl:  4.34; xent: 1.47; lr: 0.05000;   0/1550 tok/s;  39686 sec
[2019-10-23 20:22:33,954 INFO] Step 52000/100000; acc:  63.89; ppl:  4.32; xent: 1.46; lr: 0.05000;   0/1583 tok/s;  40054 sec
[2019-10-23 20:28:50,130 INFO] Step 52500/100000; acc:  64.14; ppl:  4.28; xent: 1.45; lr: 0.05000;   0/1556 tok/s;  40430 sec
[2019-10-23 20:35:10,118 INFO] Step 53000/100000; acc:  64.06; ppl:  4.28; xent: 1.45; lr: 0.05000;   0/1543 tok/s;  40810 sec
[2019-10-23 20:41:22,765 INFO] Step 53500/100000; acc:  64.26; ppl:  4.22; xent: 1.44; lr: 0.05000;   0/1569 tok/s;  41183 sec
[2019-10-23 20:47:50,718 INFO] Step 54000/100000; acc:  64.26; ppl:  4.25; xent: 1.45; lr: 0.05000;   0/1515 tok/s;  41570 sec
[2019-10-23 20:53:53,855 INFO] Step 54500/100000; acc:  64.07; ppl:  4.28; xent: 1.45; lr: 0.05000;   0/1605 tok/s;  41934 sec
[2019-10-23 21:00:08,901 INFO] Step 55000/100000; acc:  64.01; ppl:  4.30; xent: 1.46; lr: 0.05000;   0/1562 tok/s;  42309 sec
[2019-10-23 21:06:23,671 INFO] Step 55500/100000; acc:  64.23; ppl:  4.26; xent: 1.45; lr: 0.05000;   0/1570 tok/s;  42683 sec
[2019-10-23 21:12:38,925 INFO] Step 56000/100000; acc:  64.22; ppl:  4.26; xent: 1.45; lr: 0.05000;   0/1562 tok/s;  43059 sec
[2019-10-23 21:18:58,996 INFO] Step 56500/100000; acc:  64.42; ppl:  4.21; xent: 1.44; lr: 0.05000;   0/1546 tok/s;  43439 sec
[2019-10-23 21:25:12,002 INFO] Step 57000/100000; acc:  64.36; ppl:  4.22; xent: 1.44; lr: 0.05000;   0/1561 tok/s;  43812 sec
[2019-10-23 21:31:33,219 INFO] Step 57500/100000; acc:  64.44; ppl:  4.19; xent: 1.43; lr: 0.05000;   0/1548 tok/s;  44193 sec
[2019-10-23 21:37:47,761 INFO] Step 58000/100000; acc:  64.27; ppl:  4.24; xent: 1.44; lr: 0.05000;   0/1555 tok/s;  44568 sec
[2019-10-23 21:43:54,229 INFO] Step 58500/100000; acc:  64.26; ppl:  4.24; xent: 1.44; lr: 0.05000;   0/1592 tok/s;  44934 sec
[2019-10-23 21:50:11,199 INFO] Step 59000/100000; acc:  64.33; ppl:  4.23; xent: 1.44; lr: 0.05000;   0/1563 tok/s;  45311 sec
[2019-10-23 21:56:21,632 INFO] Step 59500/100000; acc:  64.38; ppl:  4.23; xent: 1.44; lr: 0.05000;   0/1573 tok/s;  45681 sec
[2019-10-23 22:02:41,052 INFO] Step 60000/100000; acc:  64.57; ppl:  4.19; xent: 1.43; lr: 0.02500;   0/1551 tok/s;  46061 sec
[2019-10-23 22:06:17,603 INFO] Validation perplexity: 4.82166
[2019-10-23 22:06:17,604 INFO] Validation accuracy: 62.0768
[2019-10-23 22:06:17,607 INFO] Saving checkpoint ../results/models/im2latex-38_step_60000.pt
[2019-10-23 22:12:36,759 INFO] Step 60500/100000; acc:  64.59; ppl:  4.17; xent: 1.43; lr: 0.02500;   0/985 tok/s;  46657 sec
[2019-10-23 22:18:45,639 INFO] Step 61000/100000; acc:  64.94; ppl:  4.11; xent: 1.41; lr: 0.02500;   0/1579 tok/s;  47025 sec
[2019-10-23 22:25:15,775 INFO] Step 61500/100000; acc:  64.92; ppl:  4.11; xent: 1.41; lr: 0.02500;   0/1512 tok/s;  47416 sec
[2019-10-23 22:31:22,145 INFO] Step 62000/100000; acc:  64.82; ppl:  4.13; xent: 1.42; lr: 0.02500;   0/1587 tok/s;  47782 sec
[2019-10-23 22:37:37,083 INFO] Step 62500/100000; acc:  64.84; ppl:  4.12; xent: 1.42; lr: 0.02500;   0/1566 tok/s;  48157 sec
[2019-10-23 22:43:56,395 INFO] Step 63000/100000; acc:  65.13; ppl:  4.08; xent: 1.41; lr: 0.02500;   0/1556 tok/s;  48536 sec
[2019-10-23 22:50:05,469 INFO] Step 63500/100000; acc:  65.07; ppl:  4.07; xent: 1.40; lr: 0.02500;   0/1579 tok/s;  48905 sec
[2019-10-23 22:56:22,414 INFO] Step 64000/100000; acc:  65.29; ppl:  4.04; xent: 1.40; lr: 0.02500;   0/1553 tok/s;  49282 sec
[2019-10-23 23:02:40,106 INFO] Step 64500/100000; acc:  64.95; ppl:  4.11; xent: 1.41; lr: 0.02500;   0/1553 tok/s;  49660 sec
[2019-10-23 23:08:57,691 INFO] Step 65000/100000; acc:  65.11; ppl:  4.05; xent: 1.40; lr: 0.02500;   0/1553 tok/s;  50037 sec
[2019-10-23 23:15:19,043 INFO] Step 65500/100000; acc:  65.18; ppl:  4.07; xent: 1.40; lr: 0.02500;   0/1534 tok/s;  50419 sec
[2019-10-23 23:21:22,736 INFO] Step 66000/100000; acc:  65.03; ppl:  4.08; xent: 1.41; lr: 0.02500;   0/1606 tok/s;  50783 sec
[2019-10-23 23:27:39,736 INFO] Step 66500/100000; acc:  65.01; ppl:  4.09; xent: 1.41; lr: 0.02500;   0/1556 tok/s;  51160 sec
[2019-10-23 23:33:52,000 INFO] Step 67000/100000; acc:  65.18; ppl:  4.06; xent: 1.40; lr: 0.02500;   0/1577 tok/s;  51532 sec
[2019-10-23 23:40:11,206 INFO] Step 67500/100000; acc:  65.26; ppl:  4.04; xent: 1.40; lr: 0.02500;   0/1548 tok/s;  51911 sec
[2019-10-23 23:46:29,007 INFO] Step 68000/100000; acc:  65.25; ppl:  4.04; xent: 1.40; lr: 0.02500;   0/1550 tok/s;  52289 sec
[2019-10-23 23:52:42,086 INFO] Step 68500/100000; acc:  65.22; ppl:  4.04; xent: 1.40; lr: 0.02500;   0/1562 tok/s;  52662 sec
[2019-10-23 23:59:03,765 INFO] Step 69000/100000; acc:  65.26; ppl:  4.03; xent: 1.39; lr: 0.02500;   0/1547 tok/s;  53044 sec
[2019-10-24 00:05:17,669 INFO] Step 69500/100000; acc:  65.17; ppl:  4.05; xent: 1.40; lr: 0.02500;   0/1559 tok/s;  53417 sec
[2019-10-24 00:11:27,548 INFO] Step 70000/100000; acc:  65.07; ppl:  4.07; xent: 1.40; lr: 0.01250;   0/1583 tok/s;  53787 sec
[2019-10-24 00:15:04,415 INFO] Validation perplexity: 4.77661
[2019-10-24 00:15:04,416 INFO] Validation accuracy: 62.2925
[2019-10-24 00:15:04,418 INFO] Saving checkpoint ../results/models/im2latex-38_step_70000.pt
[2019-10-24 00:21:20,630 INFO] Step 70500/100000; acc:  65.35; ppl:  4.03; xent: 1.39; lr: 0.01250;   0/994 tok/s;  54380 sec
[2019-10-24 00:27:32,068 INFO] Step 71000/100000; acc:  65.42; ppl:  4.01; xent: 1.39; lr: 0.01250;   0/1569 tok/s;  54752 sec
[2019-10-24 00:33:50,528 INFO] Step 71500/100000; acc:  65.63; ppl:  3.97; xent: 1.38; lr: 0.01250;   0/1552 tok/s;  55130 sec
[2019-10-24 00:40:09,397 INFO] Step 72000/100000; acc:  65.40; ppl:  4.01; xent: 1.39; lr: 0.01250;   0/1547 tok/s;  55509 sec
[2019-10-24 00:46:19,599 INFO] Step 72500/100000; acc:  65.58; ppl:  3.97; xent: 1.38; lr: 0.01250;   0/1574 tok/s;  55879 sec
[2019-10-24 00:52:45,839 INFO] Step 73000/100000; acc:  65.69; ppl:  3.96; xent: 1.38; lr: 0.01250;   0/1524 tok/s;  56266 sec
[2019-10-24 00:58:49,253 INFO] Step 73500/100000; acc:  65.55; ppl:  3.98; xent: 1.38; lr: 0.01250;   0/1600 tok/s;  56629 sec
[2019-10-24 01:05:08,294 INFO] Step 74000/100000; acc:  65.54; ppl:  3.99; xent: 1.38; lr: 0.01250;   0/1553 tok/s;  57008 sec
[2019-10-24 01:11:24,572 INFO] Step 74500/100000; acc:  65.54; ppl:  3.99; xent: 1.38; lr: 0.01250;   0/1564 tok/s;  57384 sec
[2019-10-24 01:17:33,065 INFO] Step 75000/100000; acc:  65.55; ppl:  3.98; xent: 1.38; lr: 0.01250;   0/1585 tok/s;  57753 sec
[2019-10-24 01:23:54,325 INFO] Step 75500/100000; acc:  65.80; ppl:  3.94; xent: 1.37; lr: 0.01250;   0/1537 tok/s;  58134 sec
[2019-10-24 01:30:09,741 INFO] Step 76000/100000; acc:  65.55; ppl:  3.98; xent: 1.38; lr: 0.01250;   0/1557 tok/s;  58510 sec
[2019-10-24 01:36:25,105 INFO] Step 76500/100000; acc:  65.78; ppl:  3.93; xent: 1.37; lr: 0.01250;   0/1564 tok/s;  58885 sec
[2019-10-24 01:42:46,417 INFO] Step 77000/100000; acc:  65.70; ppl:  3.95; xent: 1.37; lr: 0.01250;   0/1535 tok/s;  59266 sec
[2019-10-24 01:48:53,121 INFO] Step 77500/100000; acc:  65.71; ppl:  3.96; xent: 1.38; lr: 0.01250;   0/1597 tok/s;  59633 sec
[2019-10-24 01:55:10,162 INFO] Step 78000/100000; acc:  65.51; ppl:  4.00; xent: 1.39; lr: 0.01250;   0/1557 tok/s;  60010 sec
[2019-10-24 02:01:20,323 INFO] Step 78500/100000; acc:  65.56; ppl:  3.98; xent: 1.38; lr: 0.01250;   0/1582 tok/s;  60380 sec
[2019-10-24 02:07:38,028 INFO] Step 79000/100000; acc:  65.84; ppl:  3.94; xent: 1.37; lr: 0.01250;   0/1551 tok/s;  60758 sec
[2019-10-24 02:13:54,725 INFO] Step 79500/100000; acc:  65.70; ppl:  3.96; xent: 1.38; lr: 0.01250;   0/1556 tok/s;  61135 sec
[2019-10-24 02:20:08,722 INFO] Step 80000/100000; acc:  65.80; ppl:  3.94; xent: 1.37; lr: 0.00625;   0/1558 tok/s;  61509 sec
[2019-10-24 02:23:46,224 INFO] Validation perplexity: 4.77349
[2019-10-24 02:23:46,225 INFO] Validation accuracy: 62.4162
[2019-10-24 02:23:46,228 INFO] Saving checkpoint ../results/models/im2latex-38_step_80000.pt
[2019-10-24 02:30:11,222 INFO] Step 80500/100000; acc:  65.78; ppl:  3.93; xent: 1.37; lr: 0.00625;   0/981 tok/s;  62111 sec
[2019-10-24 02:36:23,348 INFO] Step 81000/100000; acc:  65.77; ppl:  3.95; xent: 1.37; lr: 0.00625;   0/1565 tok/s;  62483 sec
[2019-10-24 02:42:32,244 INFO] Step 81500/100000; acc:  65.68; ppl:  3.95; xent: 1.37; lr: 0.00625;   0/1583 tok/s;  62852 sec
[2019-10-24 02:48:47,920 INFO] Step 82000/100000; acc:  65.79; ppl:  3.94; xent: 1.37; lr: 0.00625;   0/1573 tok/s;  63228 sec
[2019-10-24 02:54:56,106 INFO] Step 82500/100000; acc:  65.83; ppl:  3.93; xent: 1.37; lr: 0.00625;   0/1583 tok/s;  63596 sec
[2019-10-24 03:01:12,708 INFO] Step 83000/100000; acc:  66.11; ppl:  3.89; xent: 1.36; lr: 0.00625;   0/1555 tok/s;  63972 sec
[2019-10-24 03:07:28,533 INFO] Step 83500/100000; acc:  65.85; ppl:  3.93; xent: 1.37; lr: 0.00625;   0/1559 tok/s;  64348 sec
[2019-10-24 03:13:38,337 INFO] Step 84000/100000; acc:  65.95; ppl:  3.89; xent: 1.36; lr: 0.00625;   0/1579 tok/s;  64718 sec
[2019-10-24 03:20:06,485 INFO] Step 84500/100000; acc:  65.95; ppl:  3.91; xent: 1.36; lr: 0.00625;   0/1517 tok/s;  65106 sec
[2019-10-24 03:26:06,623 INFO] Step 85000/100000; acc:  65.85; ppl:  3.93; xent: 1.37; lr: 0.00625;   0/1615 tok/s;  65466 sec
[2019-10-24 03:32:22,214 INFO] Step 85500/100000; acc:  65.76; ppl:  3.94; xent: 1.37; lr: 0.00625;   0/1563 tok/s;  65842 sec
[2019-10-24 03:38:32,272 INFO] Step 86000/100000; acc:  65.86; ppl:  3.92; xent: 1.37; lr: 0.00625;   0/1592 tok/s;  66212 sec
[2019-10-24 03:44:44,713 INFO] Step 86500/100000; acc:  65.90; ppl:  3.92; xent: 1.37; lr: 0.00625;   0/1570 tok/s;  66584 sec
[2019-10-24 03:51:02,577 INFO] Step 87000/100000; acc:  66.10; ppl:  3.88; xent: 1.36; lr: 0.00625;   0/1553 tok/s;  66962 sec
[2019-10-24 03:57:12,127 INFO] Step 87500/100000; acc:  65.96; ppl:  3.90; xent: 1.36; lr: 0.00625;   0/1581 tok/s;  67332 sec
[2019-10-24 04:03:31,728 INFO] Step 88000/100000; acc:  65.94; ppl:  3.90; xent: 1.36; lr: 0.00625;   0/1550 tok/s;  67712 sec
[2019-10-24 04:09:43,673 INFO] Step 88500/100000; acc:  65.88; ppl:  3.92; xent: 1.36; lr: 0.00625;   0/1568 tok/s;  68083 sec
[2019-10-24 04:15:53,002 INFO] Step 89000/100000; acc:  65.90; ppl:  3.90; xent: 1.36; lr: 0.00625;   0/1583 tok/s;  68453 sec
[2019-10-24 04:22:15,879 INFO] Step 89500/100000; acc:  65.82; ppl:  3.94; xent: 1.37; lr: 0.00625;   0/1538 tok/s;  68836 sec
[2019-10-24 04:28:26,453 INFO] Step 90000/100000; acc:  65.90; ppl:  3.92; xent: 1.37; lr: 0.00313;   0/1576 tok/s;  69206 sec
[2019-10-24 04:32:04,511 INFO] Validation perplexity: 4.74735
[2019-10-24 04:32:04,512 INFO] Validation accuracy: 62.5456
[2019-10-24 04:32:04,515 INFO] Saving checkpoint ../results/models/im2latex-38_step_90000.pt
[2019-10-24 04:38:21,516 INFO] Step 90500/100000; acc:  66.12; ppl:  3.88; xent: 1.36; lr: 0.00313;   0/987 tok/s;  69801 sec
[2019-10-24 04:44:38,188 INFO] Step 91000/100000; acc:  65.98; ppl:  3.91; xent: 1.36; lr: 0.00313;   0/1557 tok/s;  70178 sec
[2019-10-24 04:50:48,391 INFO] Step 91500/100000; acc:  66.06; ppl:  3.88; xent: 1.36; lr: 0.00313;   0/1573 tok/s;  70548 sec
[2019-10-24 04:57:14,391 INFO] Step 92000/100000; acc:  66.08; ppl:  3.89; xent: 1.36; lr: 0.00313;   0/1528 tok/s;  70934 sec
[2019-10-24 05:03:21,562 INFO] Step 92500/100000; acc:  66.03; ppl:  3.90; xent: 1.36; lr: 0.00313;   0/1588 tok/s;  71301 sec
[2019-10-24 05:09:33,885 INFO] Step 93000/100000; acc:  65.92; ppl:  3.91; xent: 1.36; lr: 0.00313;   0/1574 tok/s;  71674 sec
[2019-10-24 05:15:48,189 INFO] Step 93500/100000; acc:  66.12; ppl:  3.89; xent: 1.36; lr: 0.00313;   0/1577 tok/s;  72048 sec
[2019-10-24 05:21:55,695 INFO] Step 94000/100000; acc:  66.10; ppl:  3.88; xent: 1.36; lr: 0.00313;   0/1584 tok/s;  72415 sec
[2019-10-24 05:28:15,013 INFO] Step 94500/100000; acc:  66.18; ppl:  3.87; xent: 1.35; lr: 0.00313;   0/1545 tok/s;  72795 sec
[2019-10-24 05:34:32,382 INFO] Step 95000/100000; acc:  65.95; ppl:  3.91; xent: 1.36; lr: 0.00313;   0/1552 tok/s;  73172 sec
[2019-10-24 05:40:47,224 INFO] Step 95500/100000; acc:  66.09; ppl:  3.87; xent: 1.35; lr: 0.00313;   0/1563 tok/s;  73547 sec
[2019-10-24 05:47:11,152 INFO] Step 96000/100000; acc:  66.07; ppl:  3.88; xent: 1.36; lr: 0.00313;   0/1528 tok/s;  73931 sec
[2019-10-24 05:53:12,831 INFO] Step 96500/100000; acc:  65.98; ppl:  3.89; xent: 1.36; lr: 0.00313;   0/1611 tok/s;  74293 sec
[2019-10-24 05:59:31,152 INFO] Step 97000/100000; acc:  65.90; ppl:  3.91; xent: 1.36; lr: 0.00313;   0/1551 tok/s;  74671 sec
[2019-10-24 06:05:43,651 INFO] Step 97500/100000; acc:  66.08; ppl:  3.89; xent: 1.36; lr: 0.00313;   0/1576 tok/s;  75043 sec
[2019-10-24 06:12:00,688 INFO] Step 98000/100000; acc:  66.10; ppl:  3.89; xent: 1.36; lr: 0.00313;   0/1555 tok/s;  75420 sec
[2019-10-24 06:18:20,698 INFO] Step 98500/100000; acc:  66.18; ppl:  3.86; xent: 1.35; lr: 0.00313;   0/1547 tok/s;  75800 sec
[2019-10-24 06:24:29,311 INFO] Step 99000/100000; acc:  66.04; ppl:  3.88; xent: 1.36; lr: 0.00313;   0/1579 tok/s;  76169 sec
[2019-10-24 06:30:52,223 INFO] Step 99500/100000; acc:  66.16; ppl:  3.86; xent: 1.35; lr: 0.00313;   0/1541 tok/s;  76552 sec
[2019-10-24 06:37:07,075 INFO] Step 100000/100000; acc:  66.01; ppl:  3.89; xent: 1.36; lr: 0.00156;   0/1556 tok/s;  76927 sec
[2019-10-24 06:40:48,099 INFO] Validation perplexity: 4.73705
[2019-10-24 06:40:48,100 INFO] Validation accuracy: 62.5643
[2019-10-24 06:40:48,103 INFO] Saving checkpoint ../results/models/im2latex-38_step_100000.pt
