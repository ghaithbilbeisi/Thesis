[2019-11-22 12:16:46,695 INFO]  * tgt vocab size = 510
[2019-11-22 12:16:46,695 INFO] Building model...
[2019-11-22 12:16:59,641 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer3): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer5): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer6): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (batch_norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(512, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 512)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-11-22 12:16:59,647 INFO] encoder: 8047424
[2019-11-22 12:16:59,647 INFO] decoder: 5214310
[2019-11-22 12:16:59,647 INFO] * number of parameters: 13261734
[2019-11-22 12:17:00,665 INFO] Starting training on GPU: [0]
[2019-11-22 12:17:00,665 INFO] Start training loop and validate every 10000 steps...
[2019-11-22 12:25:59,035 INFO] Step 500/100000; acc:  35.77; ppl: 21.88; xent: 3.09; lr: 1.00000;   0/1093 tok/s;    538 sec
[2019-11-22 12:35:35,410 INFO] Step 1000/100000; acc:  48.32; ppl: 10.69; xent: 2.37; lr: 1.00000;   0/1008 tok/s;   1115 sec
[2019-11-22 12:45:12,481 INFO] Step 1500/100000; acc:  56.30; ppl:  6.99; xent: 1.94; lr: 1.00000;   0/1021 tok/s;   1692 sec
[2019-11-22 12:53:43,862 INFO] Step 2000/100000; acc:  73.46; ppl:  3.08; xent: 1.13; lr: 1.00000;   0/1149 tok/s;   2203 sec
[2019-11-22 13:01:41,612 INFO] Step 2500/100000; acc:  82.79; ppl:  2.08; xent: 0.73; lr: 1.00000;   0/1223 tok/s;   2681 sec
[2019-11-22 13:09:42,319 INFO] Step 3000/100000; acc:  86.59; ppl:  1.76; xent: 0.57; lr: 1.00000;   0/1221 tok/s;   3162 sec
[2019-11-22 13:17:34,163 INFO] Step 3500/100000; acc:  88.83; ppl:  1.60; xent: 0.47; lr: 1.00000;   0/1239 tok/s;   3633 sec
[2019-11-22 13:25:34,079 INFO] Step 4000/100000; acc:  90.02; ppl:  1.52; xent: 0.42; lr: 1.00000;   0/1225 tok/s;   4113 sec
[2019-11-22 13:33:28,683 INFO] Step 4500/100000; acc:  91.07; ppl:  1.45; xent: 0.37; lr: 1.00000;   0/1230 tok/s;   4588 sec
[2019-11-22 13:40:51,133 INFO] Step 5000/100000; acc:  91.69; ppl:  1.42; xent: 0.35; lr: 1.00000;   0/1325 tok/s;   5030 sec
[2019-11-22 13:48:14,240 INFO] Step 5500/100000; acc:  92.41; ppl:  1.37; xent: 0.32; lr: 1.00000;   0/1325 tok/s;   5474 sec
[2019-11-22 13:56:03,155 INFO] Step 6000/100000; acc:  92.90; ppl:  1.35; xent: 0.30; lr: 1.00000;   0/1248 tok/s;   5942 sec
[2019-11-22 14:03:46,772 INFO] Step 6500/100000; acc:  93.28; ppl:  1.33; xent: 0.28; lr: 1.00000;   0/1265 tok/s;   6406 sec
[2019-11-22 14:11:30,622 INFO] Step 7000/100000; acc:  93.61; ppl:  1.30; xent: 0.27; lr: 1.00000;   0/1264 tok/s;   6870 sec
[2019-11-22 14:19:09,225 INFO] Step 7500/100000; acc:  93.96; ppl:  1.28; xent: 0.25; lr: 1.00000;   0/1271 tok/s;   7329 sec
[2019-11-22 14:27:00,849 INFO] Step 8000/100000; acc:  94.08; ppl:  1.28; xent: 0.25; lr: 1.00000;   0/1251 tok/s;   7800 sec
[2019-11-22 14:34:42,698 INFO] Step 8500/100000; acc:  94.50; ppl:  1.26; xent: 0.23; lr: 1.00000;   0/1260 tok/s;   8262 sec
[2019-11-22 14:42:21,299 INFO] Step 9000/100000; acc:  94.67; ppl:  1.25; xent: 0.22; lr: 1.00000;   0/1277 tok/s;   8721 sec
[2019-11-22 14:50:08,731 INFO] Step 9500/100000; acc:  94.80; ppl:  1.24; xent: 0.21; lr: 1.00000;   0/1265 tok/s;   9188 sec
[2019-11-22 14:57:41,808 INFO] Step 10000/100000; acc:  94.92; ppl:  1.23; xent: 0.21; lr: 1.00000;   0/1285 tok/s;   9641 sec
[2019-11-22 15:01:41,287 INFO] Validation perplexity: 1.19755
[2019-11-22 15:01:41,290 INFO] Validation accuracy: 95.7341
[2019-11-22 15:01:41,301 INFO] Saving checkpoint ../results/models/im2latex-51_step_10000.pt
[2019-11-22 15:09:25,590 INFO] Step 10500/100000; acc:  95.05; ppl:  1.23; xent: 0.20; lr: 1.00000;   0/832 tok/s;  10345 sec
[2019-11-22 15:17:07,755 INFO] Step 11000/100000; acc:  95.15; ppl:  1.22; xent: 0.20; lr: 1.00000;   0/1269 tok/s;  10807 sec
[2019-11-22 15:24:43,197 INFO] Step 11500/100000; acc:  95.29; ppl:  1.21; xent: 0.19; lr: 1.00000;   0/1284 tok/s;  11263 sec
[2019-11-22 15:32:25,675 INFO] Step 12000/100000; acc:  95.32; ppl:  1.21; xent: 0.19; lr: 1.00000;   0/1270 tok/s;  11725 sec
[2019-11-22 15:40:29,403 INFO] Step 12500/100000; acc:  95.53; ppl:  1.20; xent: 0.18; lr: 1.00000;   0/1204 tok/s;  12209 sec
[2019-11-22 15:49:04,692 INFO] Step 13000/100000; acc:  95.57; ppl:  1.20; xent: 0.18; lr: 1.00000;   0/1138 tok/s;  12724 sec
[2019-11-22 15:57:42,013 INFO] Step 13500/100000; acc:  95.75; ppl:  1.19; xent: 0.17; lr: 1.00000;   0/1137 tok/s;  13241 sec
[2019-11-22 16:06:14,448 INFO] Step 14000/100000; acc:  95.69; ppl:  1.19; xent: 0.18; lr: 1.00000;   0/1142 tok/s;  13754 sec
[2019-11-22 16:14:47,291 INFO] Step 14500/100000; acc:  95.76; ppl:  1.19; xent: 0.17; lr: 1.00000;   0/1146 tok/s;  14267 sec
[2019-11-22 16:23:17,106 INFO] Step 15000/100000; acc:  95.86; ppl:  1.18; xent: 0.17; lr: 1.00000;   0/1144 tok/s;  14776 sec
[2019-11-22 16:32:02,886 INFO] Step 15500/100000; acc:  95.87; ppl:  1.18; xent: 0.17; lr: 1.00000;   0/1121 tok/s;  15302 sec
[2019-11-22 16:40:34,625 INFO] Step 16000/100000; acc:  96.01; ppl:  1.17; xent: 0.16; lr: 1.00000;   0/1139 tok/s;  15814 sec
[2019-11-22 16:49:06,052 INFO] Step 16500/100000; acc:  96.09; ppl:  1.17; xent: 0.16; lr: 1.00000;   0/1142 tok/s;  16325 sec
[2019-11-22 16:57:40,358 INFO] Step 17000/100000; acc:  96.11; ppl:  1.17; xent: 0.16; lr: 1.00000;   0/1148 tok/s;  16840 sec
[2019-11-22 17:06:13,875 INFO] Step 17500/100000; acc:  96.15; ppl:  1.17; xent: 0.15; lr: 1.00000;   0/1136 tok/s;  17353 sec
[2019-11-22 17:14:51,082 INFO] Step 18000/100000; acc:  96.18; ppl:  1.17; xent: 0.15; lr: 1.00000;   0/1137 tok/s;  17870 sec
[2019-11-22 17:23:24,522 INFO] Step 18500/100000; acc:  96.14; ppl:  1.17; xent: 0.15; lr: 1.00000;   0/1143 tok/s;  18384 sec
[2019-11-22 17:31:08,764 INFO] Step 19000/100000; acc:  96.25; ppl:  1.16; xent: 0.15; lr: 1.00000;   0/1254 tok/s;  18848 sec
[2019-11-22 17:38:41,795 INFO] Step 19500/100000; acc:  96.19; ppl:  1.16; xent: 0.15; lr: 1.00000;   0/1302 tok/s;  19301 sec
[2019-11-22 17:46:06,092 INFO] Step 20000/100000; acc:  96.35; ppl:  1.16; xent: 0.15; lr: 1.00000;   0/1309 tok/s;  19745 sec
[2019-11-22 17:50:00,940 INFO] Validation perplexity: 1.14471
[2019-11-22 17:50:00,941 INFO] Validation accuracy: 96.662
[2019-11-22 17:50:00,959 INFO] Saving checkpoint ../results/models/im2latex-51_step_20000.pt
[2019-11-22 17:57:28,032 INFO] Step 20500/100000; acc:  96.42; ppl:  1.16; xent: 0.14; lr: 1.00000;   0/861 tok/s;  20427 sec
[2019-11-22 18:04:56,661 INFO] Step 21000/100000; acc:  96.47; ppl:  1.15; xent: 0.14; lr: 1.00000;   0/1313 tok/s;  20876 sec
[2019-11-22 18:12:33,158 INFO] Step 21500/100000; acc:  96.44; ppl:  1.15; xent: 0.14; lr: 1.00000;   0/1277 tok/s;  21332 sec
[2019-11-22 18:19:23,139 INFO] Step 22000/100000; acc:  96.45; ppl:  1.15; xent: 0.14; lr: 1.00000;   0/1426 tok/s;  21742 sec
[2019-11-22 18:26:10,838 INFO] Step 22500/100000; acc:  96.45; ppl:  1.15; xent: 0.14; lr: 1.00000;   0/1438 tok/s;  22150 sec
[2019-11-22 18:32:32,787 INFO] Step 23000/100000; acc:  96.53; ppl:  1.15; xent: 0.14; lr: 1.00000;   0/1538 tok/s;  22532 sec
[2019-11-22 18:36:32,890 INFO] Step 23500/100000; acc:  96.52; ppl:  1.15; xent: 0.14; lr: 1.00000;   0/2437 tok/s;  22772 sec
[2019-11-22 18:40:27,204 INFO] Step 24000/100000; acc:  96.55; ppl:  1.15; xent: 0.14; lr: 1.00000;   0/2491 tok/s;  23007 sec
[2019-11-22 18:44:25,215 INFO] Step 24500/100000; acc:  96.62; ppl:  1.14; xent: 0.13; lr: 1.00000;   0/2464 tok/s;  23245 sec
[2019-11-22 18:47:51,342 INFO] Step 25000/100000; acc:  96.72; ppl:  1.14; xent: 0.13; lr: 1.00000;   0/2841 tok/s;  23451 sec
[2019-11-22 18:50:58,117 INFO] Step 25500/100000; acc:  96.68; ppl:  1.14; xent: 0.13; lr: 1.00000;   0/3147 tok/s;  23637 sec
[2019-11-22 18:54:03,981 INFO] Step 26000/100000; acc:  96.64; ppl:  1.14; xent: 0.13; lr: 1.00000;   0/3157 tok/s;  23823 sec
[2019-11-22 18:57:03,538 INFO] Step 26500/100000; acc:  96.70; ppl:  1.14; xent: 0.13; lr: 1.00000;   0/3241 tok/s;  24003 sec
[2019-11-22 19:00:09,656 INFO] Step 27000/100000; acc:  96.64; ppl:  1.14; xent: 0.13; lr: 1.00000;   0/3170 tok/s;  24189 sec
[2019-11-22 19:03:16,507 INFO] Step 27500/100000; acc:  96.79; ppl:  1.13; xent: 0.12; lr: 1.00000;   0/3118 tok/s;  24376 sec
[2019-11-22 19:06:18,436 INFO] Step 28000/100000; acc:  96.76; ppl:  1.14; xent: 0.13; lr: 1.00000;   0/3219 tok/s;  24558 sec
[2019-11-22 19:09:21,936 INFO] Step 28500/100000; acc:  96.85; ppl:  1.13; xent: 0.12; lr: 1.00000;   0/3223 tok/s;  24741 sec
[2019-11-22 19:12:22,538 INFO] Step 29000/100000; acc:  96.84; ppl:  1.13; xent: 0.13; lr: 1.00000;   0/3225 tok/s;  24922 sec
[2019-11-22 19:15:29,009 INFO] Step 29500/100000; acc:  96.84; ppl:  1.13; xent: 0.12; lr: 1.00000;   0/3153 tok/s;  25108 sec
[2019-11-22 19:18:33,479 INFO] Step 30000/100000; acc:  96.85; ppl:  1.13; xent: 0.12; lr: 1.00000;   0/3175 tok/s;  25293 sec
[2019-11-22 19:19:56,170 INFO] Validation perplexity: 1.13039
[2019-11-22 19:19:56,171 INFO] Validation accuracy: 97.0168
[2019-11-22 19:19:56,174 INFO] Saving checkpoint ../results/models/im2latex-51_step_30000.pt
[2019-11-22 19:23:01,523 INFO] Step 30500/100000; acc:  96.79; ppl:  1.13; xent: 0.13; lr: 1.00000;   0/2175 tok/s;  25561 sec
[2019-11-22 19:26:07,132 INFO] Step 31000/100000; acc:  96.86; ppl:  1.13; xent: 0.12; lr: 1.00000;   0/3171 tok/s;  25746 sec
[2019-11-22 19:29:09,202 INFO] Step 31500/100000; acc:  96.91; ppl:  1.13; xent: 0.12; lr: 1.00000;   0/3195 tok/s;  25929 sec
[2019-11-22 19:32:13,461 INFO] Step 32000/100000; acc:  96.97; ppl:  1.13; xent: 0.12; lr: 1.00000;   0/3191 tok/s;  26113 sec
[2019-11-22 19:35:17,804 INFO] Step 32500/100000; acc:  96.96; ppl:  1.13; xent: 0.12; lr: 1.00000;   0/3185 tok/s;  26297 sec
[2019-11-22 19:38:19,351 INFO] Step 33000/100000; acc:  97.00; ppl:  1.13; xent: 0.12; lr: 1.00000;   0/3220 tok/s;  26479 sec
[2019-11-22 19:41:24,348 INFO] Step 33500/100000; acc:  96.96; ppl:  1.13; xent: 0.12; lr: 1.00000;   0/3162 tok/s;  26664 sec
[2019-11-22 19:44:25,555 INFO] Step 34000/100000; acc:  96.96; ppl:  1.12; xent: 0.12; lr: 1.00000;   0/3229 tok/s;  26845 sec
[2019-11-22 19:47:30,700 INFO] Step 34500/100000; acc:  97.01; ppl:  1.12; xent: 0.12; lr: 1.00000;   0/3170 tok/s;  27030 sec
[2019-11-22 19:50:34,824 INFO] Step 35000/100000; acc:  96.99; ppl:  1.12; xent: 0.12; lr: 1.00000;   0/3178 tok/s;  27214 sec
[2019-11-22 19:53:35,022 INFO] Step 35500/100000; acc:  97.03; ppl:  1.12; xent: 0.12; lr: 1.00000;   0/3250 tok/s;  27394 sec
[2019-11-22 19:56:39,156 INFO] Step 36000/100000; acc:  97.07; ppl:  1.12; xent: 0.11; lr: 1.00000;   0/3185 tok/s;  27578 sec
[2019-11-22 19:59:39,129 INFO] Step 36500/100000; acc:  97.10; ppl:  1.12; xent: 0.11; lr: 1.00000;   0/3255 tok/s;  27758 sec
[2019-11-22 20:02:44,882 INFO] Step 37000/100000; acc:  97.08; ppl:  1.12; xent: 0.11; lr: 1.00000;   0/3157 tok/s;  27944 sec
[2019-11-22 20:05:45,673 INFO] Step 37500/100000; acc:  97.05; ppl:  1.12; xent: 0.11; lr: 1.00000;   0/3241 tok/s;  28125 sec
[2019-11-22 20:08:47,375 INFO] Step 38000/100000; acc:  97.09; ppl:  1.12; xent: 0.11; lr: 1.00000;   0/3209 tok/s;  28307 sec
[2019-11-22 20:11:51,695 INFO] Step 38500/100000; acc:  97.00; ppl:  1.12; xent: 0.12; lr: 1.00000;   0/3205 tok/s;  28491 sec
[2019-11-22 20:14:54,827 INFO] Step 39000/100000; acc:  97.17; ppl:  1.12; xent: 0.11; lr: 1.00000;   0/3182 tok/s;  28674 sec
[2019-11-22 20:17:56,441 INFO] Step 39500/100000; acc:  97.09; ppl:  1.12; xent: 0.11; lr: 1.00000;   0/3216 tok/s;  28856 sec
[2019-11-22 20:21:01,438 INFO] Step 40000/100000; acc:  97.19; ppl:  1.12; xent: 0.11; lr: 1.00000;   0/3206 tok/s;  29041 sec
[2019-11-22 20:22:22,304 INFO] Validation perplexity: 1.12209
[2019-11-22 20:22:22,305 INFO] Validation accuracy: 97.2014
[2019-11-22 20:22:22,308 INFO] Saving checkpoint ../results/models/im2latex-51_step_40000.pt
[2019-11-22 20:25:28,592 INFO] Step 40500/100000; acc:  97.18; ppl:  1.12; xent: 0.11; lr: 1.00000;   0/2181 tok/s;  29308 sec
[2019-11-22 20:28:32,057 INFO] Step 41000/100000; acc:  97.15; ppl:  1.12; xent: 0.11; lr: 1.00000;   0/3194 tok/s;  29491 sec
[2019-11-22 20:31:35,706 INFO] Step 41500/100000; acc:  97.17; ppl:  1.12; xent: 0.11; lr: 1.00000;   0/3191 tok/s;  29675 sec
[2019-11-22 20:34:49,242 INFO] Step 42000/100000; acc:  97.18; ppl:  1.12; xent: 0.11; lr: 1.00000;   0/3019 tok/s;  29869 sec
[2019-11-22 20:38:25,341 INFO] Step 42500/100000; acc:  97.17; ppl:  1.11; xent: 0.11; lr: 1.00000;   0/2722 tok/s;  30085 sec
[2019-11-22 20:41:52,189 INFO] Step 43000/100000; acc:  97.21; ppl:  1.11; xent: 0.11; lr: 1.00000;   0/2809 tok/s;  30292 sec
[2019-11-22 20:45:23,335 INFO] Step 43500/100000; acc:  97.27; ppl:  1.11; xent: 0.11; lr: 1.00000;   0/2776 tok/s;  30503 sec
[2019-11-22 20:48:54,187 INFO] Step 44000/100000; acc:  97.28; ppl:  1.11; xent: 0.10; lr: 1.00000;   0/2793 tok/s;  30714 sec
[2019-11-22 20:52:25,309 INFO] Step 44500/100000; acc:  97.27; ppl:  1.11; xent: 0.10; lr: 1.00000;   0/2769 tok/s;  30925 sec
[2019-11-22 20:55:57,045 INFO] Step 45000/100000; acc:  97.20; ppl:  1.11; xent: 0.11; lr: 1.00000;   0/2770 tok/s;  31136 sec
[2019-11-22 20:59:26,156 INFO] Step 45500/100000; acc:  97.25; ppl:  1.11; xent: 0.10; lr: 1.00000;   0/2794 tok/s;  31345 sec
[2019-11-22 21:02:57,499 INFO] Step 46000/100000; acc:  97.28; ppl:  1.11; xent: 0.11; lr: 1.00000;   0/2785 tok/s;  31557 sec
[2019-11-22 21:06:26,734 INFO] Step 46500/100000; acc:  97.31; ppl:  1.11; xent: 0.10; lr: 1.00000;   0/2787 tok/s;  31766 sec
[2019-11-22 21:09:56,194 INFO] Step 47000/100000; acc:  97.32; ppl:  1.11; xent: 0.10; lr: 1.00000;   0/2796 tok/s;  31976 sec
[2019-11-22 21:13:27,611 INFO] Step 47500/100000; acc:  97.33; ppl:  1.11; xent: 0.10; lr: 1.00000;   0/2779 tok/s;  32187 sec
[2019-11-22 21:16:56,384 INFO] Step 48000/100000; acc:  97.32; ppl:  1.11; xent: 0.10; lr: 1.00000;   0/2801 tok/s;  32396 sec
[2019-11-22 21:20:28,304 INFO] Step 48500/100000; acc:  97.36; ppl:  1.11; xent: 0.10; lr: 1.00000;   0/2769 tok/s;  32608 sec
[2019-11-22 21:23:58,963 INFO] Step 49000/100000; acc:  97.29; ppl:  1.11; xent: 0.10; lr: 1.00000;   0/2783 tok/s;  32818 sec
[2019-11-22 21:27:28,838 INFO] Step 49500/100000; acc:  97.36; ppl:  1.11; xent: 0.10; lr: 1.00000;   0/2776 tok/s;  33028 sec
[2019-11-22 21:31:01,839 INFO] Step 50000/100000; acc:  97.31; ppl:  1.11; xent: 0.10; lr: 0.50000;   0/2770 tok/s;  33241 sec
[2019-11-22 21:32:44,137 INFO] Validation perplexity: 1.11811
[2019-11-22 21:32:44,138 INFO] Validation accuracy: 97.3208
[2019-11-22 21:32:44,141 INFO] Saving checkpoint ../results/models/im2latex-51_step_50000.pt
[2019-11-22 21:36:16,198 INFO] Step 50500/100000; acc:  97.60; ppl:  1.09; xent: 0.09; lr: 0.50000;   0/1853 tok/s;  33556 sec
[2019-11-22 21:39:45,711 INFO] Step 51000/100000; acc:  97.71; ppl:  1.09; xent: 0.09; lr: 0.50000;   0/2797 tok/s;  33765 sec
[2019-11-22 21:43:19,246 INFO] Step 51500/100000; acc:  97.80; ppl:  1.09; xent: 0.08; lr: 0.50000;   0/2774 tok/s;  33979 sec
[2019-11-22 21:46:49,887 INFO] Step 52000/100000; acc:  97.82; ppl:  1.08; xent: 0.08; lr: 0.50000;   0/2766 tok/s;  34189 sec
[2019-11-22 21:50:21,438 INFO] Step 52500/100000; acc:  97.80; ppl:  1.08; xent: 0.08; lr: 0.50000;   0/2767 tok/s;  34401 sec
[2019-11-22 21:53:52,031 INFO] Step 53000/100000; acc:  97.87; ppl:  1.08; xent: 0.08; lr: 0.50000;   0/2782 tok/s;  34611 sec
[2019-11-22 21:57:20,167 INFO] Step 53500/100000; acc:  97.90; ppl:  1.08; xent: 0.08; lr: 0.50000;   0/2810 tok/s;  34820 sec
[2019-11-22 22:00:54,476 INFO] Step 54000/100000; acc:  97.91; ppl:  1.08; xent: 0.08; lr: 0.50000;   0/2741 tok/s;  35034 sec
[2019-11-22 22:04:21,836 INFO] Step 54500/100000; acc:  97.87; ppl:  1.08; xent: 0.08; lr: 0.50000;   0/2810 tok/s;  35241 sec
[2019-11-22 22:07:51,508 INFO] Step 55000/100000; acc:  97.93; ppl:  1.08; xent: 0.08; lr: 0.50000;   0/2791 tok/s;  35451 sec
[2019-11-22 22:11:22,250 INFO] Step 55500/100000; acc:  97.98; ppl:  1.08; xent: 0.07; lr: 0.50000;   0/2788 tok/s;  35662 sec
[2019-11-22 22:14:50,887 INFO] Step 56000/100000; acc:  97.98; ppl:  1.08; xent: 0.07; lr: 0.50000;   0/2807 tok/s;  35870 sec
[2019-11-22 22:18:21,829 INFO] Step 56500/100000; acc:  97.93; ppl:  1.08; xent: 0.07; lr: 0.50000;   0/2787 tok/s;  36081 sec
[2019-11-22 22:21:50,688 INFO] Step 57000/100000; acc:  98.00; ppl:  1.08; xent: 0.07; lr: 0.50000;   0/2790 tok/s;  36290 sec
[2019-11-22 22:25:22,836 INFO] Step 57500/100000; acc:  97.99; ppl:  1.08; xent: 0.07; lr: 0.50000;   0/2781 tok/s;  36502 sec
[2019-11-22 22:28:53,557 INFO] Step 58000/100000; acc:  98.01; ppl:  1.07; xent: 0.07; lr: 0.50000;   0/2765 tok/s;  36713 sec
[2019-11-22 22:32:22,338 INFO] Step 58500/100000; acc:  98.00; ppl:  1.08; xent: 0.07; lr: 0.50000;   0/2799 tok/s;  36922 sec
[2019-11-22 22:35:56,444 INFO] Step 59000/100000; acc:  98.03; ppl:  1.07; xent: 0.07; lr: 0.50000;   0/2756 tok/s;  37136 sec
[2019-11-22 22:39:25,909 INFO] Step 59500/100000; acc:  98.07; ppl:  1.07; xent: 0.07; lr: 0.50000;   0/2781 tok/s;  37345 sec
[2019-11-22 22:42:58,193 INFO] Step 60000/100000; acc:  98.02; ppl:  1.07; xent: 0.07; lr: 0.25000;   0/2772 tok/s;  37558 sec
[2019-11-22 22:44:39,593 INFO] Validation perplexity: 1.10469
[2019-11-22 22:44:39,594 INFO] Validation accuracy: 97.6212
[2019-11-22 22:44:39,597 INFO] Saving checkpoint ../results/models/im2latex-51_step_60000.pt
[2019-11-22 22:48:12,934 INFO] Step 60500/100000; acc:  98.08; ppl:  1.07; xent: 0.07; lr: 0.25000;   0/1865 tok/s;  37872 sec
[2019-11-22 22:51:42,338 INFO] Step 61000/100000; acc:  98.17; ppl:  1.07; xent: 0.06; lr: 0.25000;   0/2781 tok/s;  38082 sec
[2019-11-22 22:55:15,577 INFO] Step 61500/100000; acc:  98.18; ppl:  1.07; xent: 0.06; lr: 0.25000;   0/2765 tok/s;  38295 sec
[2019-11-22 22:58:43,389 INFO] Step 62000/100000; acc:  98.22; ppl:  1.07; xent: 0.06; lr: 0.25000;   0/2797 tok/s;  38503 sec
[2019-11-22 23:02:13,895 INFO] Step 62500/100000; acc:  98.23; ppl:  1.07; xent: 0.06; lr: 0.25000;   0/2791 tok/s;  38713 sec
[2019-11-22 23:06:24,163 INFO] Step 63000/100000; acc:  98.26; ppl:  1.06; xent: 0.06; lr: 0.25000;   0/2357 tok/s;  38963 sec
[2019-11-22 23:10:36,951 INFO] Step 63500/100000; acc:  98.28; ppl:  1.06; xent: 0.06; lr: 0.25000;   0/2307 tok/s;  39216 sec
[2019-11-22 23:14:53,531 INFO] Step 64000/100000; acc:  98.25; ppl:  1.06; xent: 0.06; lr: 0.25000;   0/2282 tok/s;  39473 sec
[2019-11-22 23:19:39,442 INFO] Step 64500/100000; acc:  98.24; ppl:  1.06; xent: 0.06; lr: 0.25000;   0/2049 tok/s;  39759 sec
[2019-11-22 23:24:32,198 INFO] Step 65000/100000; acc:  98.27; ppl:  1.06; xent: 0.06; lr: 0.25000;   0/2003 tok/s;  40052 sec
[2019-11-22 23:29:19,867 INFO] Step 65500/100000; acc:  98.27; ppl:  1.06; xent: 0.06; lr: 0.25000;   0/2035 tok/s;  40339 sec
[2019-11-22 23:34:51,186 INFO] Step 66000/100000; acc:  98.25; ppl:  1.06; xent: 0.06; lr: 0.25000;   0/1765 tok/s;  40671 sec
[2019-11-22 23:40:50,017 INFO] Step 66500/100000; acc:  98.31; ppl:  1.06; xent: 0.06; lr: 0.25000;   0/1632 tok/s;  41029 sec
[2019-11-22 23:46:47,893 INFO] Step 67000/100000; acc:  98.35; ppl:  1.06; xent: 0.06; lr: 0.25000;   0/1639 tok/s;  41387 sec
[2019-11-22 23:53:36,598 INFO] Step 67500/100000; acc:  98.36; ppl:  1.06; xent: 0.06; lr: 0.25000;   0/1436 tok/s;  41796 sec
[2019-11-23 00:00:59,494 INFO] Step 68000/100000; acc:  98.29; ppl:  1.06; xent: 0.06; lr: 0.25000;   0/1323 tok/s;  42239 sec
[2019-11-23 00:08:11,575 INFO] Step 68500/100000; acc:  98.32; ppl:  1.06; xent: 0.06; lr: 0.25000;   0/1347 tok/s;  42671 sec
[2019-11-23 00:15:26,389 INFO] Step 69000/100000; acc:  98.29; ppl:  1.06; xent: 0.06; lr: 0.25000;   0/1358 tok/s;  43106 sec
[2019-11-23 00:23:29,912 INFO] Step 69500/100000; acc:  98.33; ppl:  1.06; xent: 0.06; lr: 0.25000;   0/1206 tok/s;  43589 sec
[2019-11-23 00:31:21,905 INFO] Step 70000/100000; acc:  98.33; ppl:  1.06; xent: 0.06; lr: 0.12500;   0/1240 tok/s;  44061 sec
[2019-11-23 00:35:03,504 INFO] Validation perplexity: 1.10338
[2019-11-23 00:35:03,508 INFO] Validation accuracy: 97.7448
[2019-11-23 00:35:03,547 INFO] Saving checkpoint ../results/models/im2latex-51_step_70000.pt
[2019-11-23 00:42:38,797 INFO] Step 70500/100000; acc:  98.42; ppl:  1.06; xent: 0.06; lr: 0.12500;   0/872 tok/s;  44738 sec
[2019-11-23 00:49:39,880 INFO] Step 71000/100000; acc:  98.42; ppl:  1.06; xent: 0.06; lr: 0.12500;   0/1385 tok/s;  45159 sec
[2019-11-23 00:58:30,639 INFO] Step 71500/100000; acc:  98.44; ppl:  1.06; xent: 0.05; lr: 0.12500;   0/1106 tok/s;  45690 sec
[2019-11-23 01:09:05,800 INFO] Step 72000/100000; acc:  98.40; ppl:  1.06; xent: 0.06; lr: 0.12500;   0/923 tok/s;  46325 sec
[2019-11-23 01:18:45,900 INFO] Step 72500/100000; acc:  98.41; ppl:  1.06; xent: 0.06; lr: 0.12500;   0/1005 tok/s;  46905 sec
[2019-11-23 01:26:00,323 INFO] Step 73000/100000; acc:  98.45; ppl:  1.05; xent: 0.05; lr: 0.12500;   0/1355 tok/s;  47340 sec
[2019-11-23 01:32:52,016 INFO] Step 73500/100000; acc:  98.44; ppl:  1.06; xent: 0.05; lr: 0.12500;   0/1412 tok/s;  47751 sec
[2019-11-23 01:39:50,300 INFO] Step 74000/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.12500;   0/1408 tok/s;  48170 sec
[2019-11-23 01:46:44,529 INFO] Step 74500/100000; acc:  98.46; ppl:  1.06; xent: 0.05; lr: 0.12500;   0/1419 tok/s;  48584 sec
[2019-11-23 01:53:42,572 INFO] Step 75000/100000; acc:  98.48; ppl:  1.05; xent: 0.05; lr: 0.12500;   0/1397 tok/s;  49002 sec
[2019-11-23 02:00:34,531 INFO] Step 75500/100000; acc:  98.43; ppl:  1.06; xent: 0.05; lr: 0.12500;   0/1421 tok/s;  49414 sec
[2019-11-23 02:07:31,559 INFO] Step 76000/100000; acc:  98.46; ppl:  1.05; xent: 0.05; lr: 0.12500;   0/1404 tok/s;  49831 sec
[2019-11-23 02:14:01,188 INFO] Step 76500/100000; acc:  98.48; ppl:  1.05; xent: 0.05; lr: 0.12500;   0/1508 tok/s;  50221 sec
[2019-11-23 02:19:25,380 INFO] Step 77000/100000; acc:  98.50; ppl:  1.05; xent: 0.05; lr: 0.12500;   0/1800 tok/s;  50545 sec
[2019-11-23 02:25:45,662 INFO] Step 77500/100000; acc:  98.48; ppl:  1.05; xent: 0.05; lr: 0.12500;   0/1541 tok/s;  50925 sec
[2019-11-23 02:32:22,584 INFO] Step 78000/100000; acc:  98.50; ppl:  1.05; xent: 0.05; lr: 0.12500;   0/1481 tok/s;  51322 sec
[2019-11-23 02:38:55,769 INFO] Step 78500/100000; acc:  98.50; ppl:  1.05; xent: 0.05; lr: 0.12500;   0/1489 tok/s;  51715 sec
[2019-11-23 02:46:31,405 INFO] Step 79000/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.12500;   0/1286 tok/s;  52171 sec
[2019-11-23 02:53:43,396 INFO] Step 79500/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.12500;   0/1358 tok/s;  52603 sec
[2019-11-23 03:00:21,586 INFO] Step 80000/100000; acc:  98.48; ppl:  1.05; xent: 0.05; lr: 0.06250;   0/1463 tok/s;  53001 sec
[2019-11-23 03:03:39,197 INFO] Validation perplexity: 1.10342
[2019-11-23 03:03:39,200 INFO] Validation accuracy: 97.783
[2019-11-23 03:03:39,220 INFO] Saving checkpoint ../results/models/im2latex-51_step_80000.pt
[2019-11-23 03:10:21,214 INFO] Step 80500/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.06250;   0/985 tok/s;  53601 sec
[2019-11-23 03:16:58,374 INFO] Step 81000/100000; acc:  98.53; ppl:  1.05; xent: 0.05; lr: 0.06250;   0/1467 tok/s;  53998 sec
[2019-11-23 03:23:42,667 INFO] Step 81500/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.06250;   0/1443 tok/s;  54402 sec
[2019-11-23 03:31:33,060 INFO] Step 82000/100000; acc:  98.53; ppl:  1.05; xent: 0.05; lr: 0.06250;   0/1256 tok/s;  54872 sec
[2019-11-23 03:41:52,568 INFO] Step 82500/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.06250;   0/941 tok/s;  55492 sec
[2019-11-23 03:53:11,403 INFO] Step 83000/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.06250;   0/863 tok/s;  56171 sec
[2019-11-23 04:04:36,281 INFO] Step 83500/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.06250;   0/855 tok/s;  56856 sec
[2019-11-23 04:15:59,848 INFO] Step 84000/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.06250;   0/854 tok/s;  57539 sec
[2019-11-23 04:27:25,462 INFO] Step 84500/100000; acc:  98.57; ppl:  1.05; xent: 0.05; lr: 0.06250;   0/859 tok/s;  58225 sec
[2019-11-23 04:38:58,020 INFO] Step 85000/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.06250;   0/840 tok/s;  58917 sec
[2019-11-23 04:50:20,885 INFO] Step 85500/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.06250;   0/861 tok/s;  59600 sec
[2019-11-23 05:01:38,356 INFO] Step 86000/100000; acc:  98.58; ppl:  1.05; xent: 0.05; lr: 0.06250;   0/869 tok/s;  60278 sec
[2019-11-23 05:12:53,339 INFO] Step 86500/100000; acc:  98.58; ppl:  1.05; xent: 0.05; lr: 0.06250;   0/867 tok/s;  60953 sec
[2019-11-23 05:23:35,136 INFO] Step 87000/100000; acc:  98.53; ppl:  1.05; xent: 0.05; lr: 0.06250;   0/915 tok/s;  61594 sec
[2019-11-23 05:33:52,254 INFO] Step 87500/100000; acc:  98.58; ppl:  1.05; xent: 0.05; lr: 0.06250;   0/946 tok/s;  62212 sec
[2019-11-23 05:43:28,789 INFO] Step 88000/100000; acc:  98.57; ppl:  1.05; xent: 0.05; lr: 0.06250;   0/1021 tok/s;  62788 sec
[2019-11-23 05:52:39,364 INFO] Step 88500/100000; acc:  98.57; ppl:  1.05; xent: 0.05; lr: 0.06250;   0/1060 tok/s;  63339 sec
[2019-11-23 06:01:44,457 INFO] Step 89000/100000; acc:  98.58; ppl:  1.05; xent: 0.05; lr: 0.06250;   0/1073 tok/s;  63884 sec
[2019-11-23 06:10:52,274 INFO] Step 89500/100000; acc:  98.60; ppl:  1.05; xent: 0.05; lr: 0.06250;   0/1074 tok/s;  64432 sec
[2019-11-23 06:19:58,879 INFO] Step 90000/100000; acc:  98.59; ppl:  1.05; xent: 0.05; lr: 0.03125;   0/1068 tok/s;  64978 sec
[2019-11-23 06:24:18,610 INFO] Validation perplexity: 1.10412
[2019-11-23 06:24:18,611 INFO] Validation accuracy: 97.7804
[2019-11-23 06:24:18,618 INFO] Saving checkpoint ../results/models/im2latex-51_step_90000.pt
[2019-11-23 06:31:32,361 INFO] Step 90500/100000; acc:  98.60; ppl:  1.05; xent: 0.05; lr: 0.03125;   0/846 tok/s;  65672 sec
[2019-11-23 06:37:43,047 INFO] Step 91000/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.03125;   0/1583 tok/s;  66042 sec
[2019-11-23 06:43:52,649 INFO] Step 91500/100000; acc:  98.62; ppl:  1.05; xent: 0.05; lr: 0.03125;   0/1574 tok/s;  66412 sec
[2019-11-23 06:50:03,578 INFO] Step 92000/100000; acc:  98.59; ppl:  1.05; xent: 0.05; lr: 0.03125;   0/1593 tok/s;  66783 sec
[2019-11-23 06:56:11,085 INFO] Step 92500/100000; acc:  98.61; ppl:  1.05; xent: 0.05; lr: 0.03125;   0/1584 tok/s;  67150 sec
[2019-11-23 07:02:20,621 INFO] Step 93000/100000; acc:  98.63; ppl:  1.05; xent: 0.05; lr: 0.03125;   0/1589 tok/s;  67520 sec
[2019-11-23 07:08:26,266 INFO] Step 93500/100000; acc:  98.60; ppl:  1.05; xent: 0.05; lr: 0.03125;   0/1614 tok/s;  67886 sec
[2019-11-23 07:14:30,123 INFO] Step 94000/100000; acc:  98.65; ppl:  1.05; xent: 0.05; lr: 0.03125;   0/1600 tok/s;  68249 sec
[2019-11-23 07:20:27,946 INFO] Step 94500/100000; acc:  98.57; ppl:  1.05; xent: 0.05; lr: 0.03125;   0/1637 tok/s;  68607 sec
[2019-11-23 07:26:06,706 INFO] Step 95000/100000; acc:  98.61; ppl:  1.05; xent: 0.05; lr: 0.03125;   0/1729 tok/s;  68946 sec
[2019-11-23 07:31:50,544 INFO] Step 95500/100000; acc:  98.61; ppl:  1.05; xent: 0.05; lr: 0.03125;   0/1704 tok/s;  69290 sec
[2019-11-23 07:37:34,978 INFO] Step 96000/100000; acc:  98.63; ppl:  1.05; xent: 0.05; lr: 0.03125;   0/1703 tok/s;  69634 sec
[2019-11-23 07:43:41,864 INFO] Step 96500/100000; acc:  98.61; ppl:  1.05; xent: 0.05; lr: 0.03125;   0/1588 tok/s;  70001 sec
[2019-11-23 07:50:20,972 INFO] Step 97000/100000; acc:  98.61; ppl:  1.05; xent: 0.05; lr: 0.03125;   0/1472 tok/s;  70400 sec
[2019-11-23 07:56:59,774 INFO] Step 97500/100000; acc:  98.65; ppl:  1.05; xent: 0.05; lr: 0.03125;   0/1472 tok/s;  70799 sec
[2019-11-23 08:03:44,725 INFO] Step 98000/100000; acc:  98.62; ppl:  1.05; xent: 0.05; lr: 0.03125;   0/1450 tok/s;  71204 sec
[2019-11-23 08:11:03,559 INFO] Step 98500/100000; acc:  98.58; ppl:  1.05; xent: 0.05; lr: 0.03125;   0/1337 tok/s;  71643 sec
[2019-11-23 08:18:35,818 INFO] Step 99000/100000; acc:  98.62; ppl:  1.05; xent: 0.05; lr: 0.03125;   0/1288 tok/s;  72095 sec
[2019-11-23 08:26:40,942 INFO] Step 99500/100000; acc:  98.62; ppl:  1.05; xent: 0.05; lr: 0.03125;   0/1216 tok/s;  72580 sec
[2019-11-23 08:36:22,766 INFO] Step 100000/100000; acc:  98.65; ppl:  1.05; xent: 0.05; lr: 0.01562;   0/1002 tok/s;  73162 sec
[2019-11-23 08:42:43,935 INFO] Validation perplexity: 1.10467
[2019-11-23 08:42:43,936 INFO] Validation accuracy: 97.785
[2019-11-23 08:42:43,945 INFO] Saving checkpoint ../results/models/im2latex-51_step_100000.pt
