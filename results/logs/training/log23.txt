[2019-08-11 15:09:07,871 INFO]  * tgt vocab size = 510
[2019-08-11 15:09:07,872 INFO] Building model...
[2019-08-11 15:09:11,822 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer3): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer5): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer6): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (batch_norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(512, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 512)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-08-11 15:09:11,823 INFO] encoder: 8047424
[2019-08-11 15:09:11,823 INFO] decoder: 5214310
[2019-08-11 15:09:11,823 INFO] * number of parameters: 13261734
[2019-08-11 15:09:12,664 INFO] Starting training on GPU: [0]
[2019-08-11 15:09:12,664 INFO] Start training loop and validate every 10000 steps...
[2019-08-11 15:12:12,099 INFO] Step 500/100000; acc:  28.72; ppl: 39.50; xent: 3.68; lr: 0.10000;   0/3280 tok/s;    179 sec
[2019-08-11 15:15:00,174 INFO] Step 1000/100000; acc:  44.57; ppl: 13.41; xent: 2.60; lr: 0.10000;   0/3458 tok/s;    348 sec
[2019-08-11 15:17:52,631 INFO] Step 1500/100000; acc:  48.43; ppl: 10.47; xent: 2.35; lr: 0.10000;   0/3415 tok/s;    520 sec
[2019-08-11 15:20:44,958 INFO] Step 2000/100000; acc:  52.49; ppl:  8.23; xent: 2.11; lr: 0.10000;   0/3416 tok/s;    692 sec
[2019-08-11 15:23:39,352 INFO] Step 2500/100000; acc:  65.47; ppl:  4.34; xent: 1.47; lr: 0.10000;   0/3351 tok/s;    867 sec
[2019-08-11 15:26:33,550 INFO] Step 3000/100000; acc:  78.72; ppl:  2.43; xent: 0.89; lr: 0.10000;   0/3367 tok/s;   1041 sec
[2019-08-11 15:29:24,171 INFO] Step 3500/100000; acc:  84.85; ppl:  1.88; xent: 0.63; lr: 0.10000;   0/3429 tok/s;   1212 sec
[2019-08-11 15:32:18,129 INFO] Step 4000/100000; acc:  87.64; ppl:  1.67; xent: 0.52; lr: 0.10000;   0/3379 tok/s;   1385 sec
[2019-08-11 15:35:12,695 INFO] Step 4500/100000; acc:  89.18; ppl:  1.56; xent: 0.44; lr: 0.10000;   0/3343 tok/s;   1560 sec
[2019-08-11 15:38:03,242 INFO] Step 5000/100000; acc:  90.53; ppl:  1.48; xent: 0.39; lr: 0.10000;   0/3435 tok/s;   1731 sec
[2019-08-11 15:40:56,610 INFO] Step 5500/100000; acc:  91.48; ppl:  1.41; xent: 0.35; lr: 0.10000;   0/3393 tok/s;   1904 sec
[2019-08-11 15:43:49,264 INFO] Step 6000/100000; acc:  92.08; ppl:  1.38; xent: 0.32; lr: 0.10000;   0/3387 tok/s;   2077 sec
[2019-08-11 15:46:45,841 INFO] Step 6500/100000; acc:  92.69; ppl:  1.34; xent: 0.30; lr: 0.10000;   0/3322 tok/s;   2253 sec
[2019-08-11 15:49:40,370 INFO] Step 7000/100000; acc:  93.14; ppl:  1.32; xent: 0.27; lr: 0.10000;   0/3359 tok/s;   2428 sec
[2019-08-11 15:52:31,823 INFO] Step 7500/100000; acc:  93.68; ppl:  1.29; xent: 0.25; lr: 0.10000;   0/3399 tok/s;   2599 sec
[2019-08-11 15:55:32,591 INFO] Step 8000/100000; acc:  93.90; ppl:  1.28; xent: 0.24; lr: 0.10000;   0/3266 tok/s;   2780 sec
[2019-08-11 15:58:38,644 INFO] Step 8500/100000; acc:  94.34; ppl:  1.25; xent: 0.22; lr: 0.10000;   0/3127 tok/s;   2966 sec
[2019-08-11 16:01:42,489 INFO] Step 9000/100000; acc:  94.67; ppl:  1.24; xent: 0.21; lr: 0.10000;   0/3188 tok/s;   3150 sec
[2019-08-11 16:04:49,677 INFO] Step 9500/100000; acc:  94.87; ppl:  1.23; xent: 0.20; lr: 0.10000;   0/3150 tok/s;   3337 sec
[2019-08-11 16:07:54,302 INFO] Step 10000/100000; acc:  95.04; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/3153 tok/s;   3522 sec
[2019-08-11 16:09:12,513 INFO] Validation perplexity: 1.21557
[2019-08-11 16:09:12,513 INFO] Validation accuracy: 95.0188
[2019-08-11 16:09:12,517 INFO] Saving checkpoint ../results/models/im2latex-23_step_10000.pt
[2019-08-11 16:12:24,321 INFO] Step 10500/100000; acc:  95.12; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/2169 tok/s;   3792 sec
[2019-08-11 16:15:27,403 INFO] Step 11000/100000; acc:  95.34; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/3205 tok/s;   3975 sec
[2019-08-11 16:18:31,374 INFO] Step 11500/100000; acc:  95.45; ppl:  1.19; xent: 0.18; lr: 0.10000;   0/3177 tok/s;   4159 sec
[2019-08-11 16:21:42,412 INFO] Step 12000/100000; acc:  95.56; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/3075 tok/s;   4350 sec
[2019-08-11 16:24:46,495 INFO] Step 12500/100000; acc:  95.76; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/3165 tok/s;   4534 sec
[2019-08-11 16:27:52,220 INFO] Step 13000/100000; acc:  95.86; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/3163 tok/s;   4720 sec
[2019-08-11 16:30:57,304 INFO] Step 13500/100000; acc:  96.02; ppl:  1.17; xent: 0.15; lr: 0.10000;   0/3179 tok/s;   4905 sec
[2019-08-11 16:34:03,215 INFO] Step 14000/100000; acc:  96.03; ppl:  1.17; xent: 0.15; lr: 0.10000;   0/3149 tok/s;   5091 sec
[2019-08-11 16:37:10,502 INFO] Step 14500/100000; acc:  96.07; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/3137 tok/s;   5278 sec
[2019-08-11 16:40:15,463 INFO] Step 15000/100000; acc:  96.15; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/3153 tok/s;   5463 sec
[2019-08-11 16:43:17,019 INFO] Step 15500/100000; acc:  96.20; ppl:  1.16; xent: 0.14; lr: 0.10000;   0/3244 tok/s;   5644 sec
[2019-08-11 16:46:08,407 INFO] Step 16000/100000; acc:  96.34; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/3400 tok/s;   5816 sec
[2019-08-11 16:48:58,735 INFO] Step 16500/100000; acc:  96.43; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/3430 tok/s;   5986 sec
[2019-08-11 16:51:52,536 INFO] Step 17000/100000; acc:  96.49; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/3397 tok/s;   6160 sec
[2019-08-11 16:54:42,851 INFO] Step 17500/100000; acc:  96.55; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/3423 tok/s;   6330 sec
[2019-08-11 16:57:34,760 INFO] Step 18000/100000; acc:  96.52; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/3419 tok/s;   6502 sec
[2019-08-11 17:00:26,231 INFO] Step 18500/100000; acc:  96.53; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/3424 tok/s;   6674 sec
[2019-08-11 17:03:13,811 INFO] Step 19000/100000; acc:  96.67; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/3475 tok/s;   6841 sec
[2019-08-11 17:06:08,698 INFO] Step 19500/100000; acc:  96.67; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/3374 tok/s;   7016 sec
[2019-08-11 17:08:56,930 INFO] Step 20000/100000; acc:  96.80; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/3457 tok/s;   7184 sec
[2019-08-11 17:10:13,925 INFO] Validation perplexity: 1.12813
[2019-08-11 17:10:13,926 INFO] Validation accuracy: 96.7663
[2019-08-11 17:10:13,929 INFO] Saving checkpoint ../results/models/im2latex-23_step_20000.pt
[2019-08-11 17:13:07,072 INFO] Step 20500/100000; acc:  96.85; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2349 tok/s;   7434 sec
[2019-08-11 17:15:59,998 INFO] Step 21000/100000; acc:  96.88; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/3398 tok/s;   7607 sec
[2019-08-11 17:18:51,842 INFO] Step 21500/100000; acc:  96.94; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3393 tok/s;   7779 sec
[2019-08-11 17:21:43,382 INFO] Step 22000/100000; acc:  96.88; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/3409 tok/s;   7951 sec
[2019-08-11 17:24:33,103 INFO] Step 22500/100000; acc:  96.93; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3453 tok/s;   8120 sec
[2019-08-11 17:27:24,816 INFO] Step 23000/100000; acc:  97.00; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3421 tok/s;   8292 sec
[2019-08-11 17:30:15,783 INFO] Step 23500/100000; acc:  96.97; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3420 tok/s;   8463 sec
[2019-08-11 17:33:04,051 INFO] Step 24000/100000; acc:  97.05; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/3470 tok/s;   8631 sec
[2019-08-11 17:35:56,520 INFO] Step 24500/100000; acc:  97.11; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/3405 tok/s;   8804 sec
[2019-08-11 17:38:45,243 INFO] Step 25000/100000; acc:  97.17; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/3474 tok/s;   8973 sec
[2019-08-11 17:41:37,708 INFO] Step 25500/100000; acc:  97.20; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/3407 tok/s;   9145 sec
[2019-08-11 17:44:30,737 INFO] Step 26000/100000; acc:  97.13; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/3389 tok/s;   9318 sec
[2019-08-11 17:47:20,317 INFO] Step 26500/100000; acc:  97.22; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/3432 tok/s;   9488 sec
[2019-08-11 17:50:13,943 INFO] Step 27000/100000; acc:  97.19; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/3399 tok/s;   9661 sec
[2019-08-11 17:53:04,144 INFO] Step 27500/100000; acc:  97.27; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/3425 tok/s;   9831 sec
[2019-08-11 17:55:53,224 INFO] Step 28000/100000; acc:  97.29; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/3463 tok/s;  10001 sec
[2019-08-11 17:58:42,977 INFO] Step 28500/100000; acc:  97.35; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/3480 tok/s;  10170 sec
[2019-08-11 18:01:31,613 INFO] Step 29000/100000; acc:  97.34; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/3457 tok/s;  10339 sec
[2019-08-11 18:04:23,275 INFO] Step 29500/100000; acc:  97.37; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/3423 tok/s;  10511 sec
[2019-08-11 18:07:14,753 INFO] Step 30000/100000; acc:  97.38; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/3416 tok/s;  10682 sec
[2019-08-11 18:08:31,775 INFO] Validation perplexity: 1.11973
[2019-08-11 18:08:31,775 INFO] Validation accuracy: 97.1152
[2019-08-11 18:08:31,778 INFO] Saving checkpoint ../results/models/im2latex-23_step_30000.pt
[2019-08-11 18:11:22,722 INFO] Step 30500/100000; acc:  97.39; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/2350 tok/s;  10930 sec
[2019-08-11 18:14:16,091 INFO] Step 31000/100000; acc:  97.37; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/3395 tok/s;  11103 sec
[2019-08-11 18:17:05,256 INFO] Step 31500/100000; acc:  97.43; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3438 tok/s;  11273 sec
[2019-08-11 18:19:55,705 INFO] Step 32000/100000; acc:  97.52; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3454 tok/s;  11443 sec
[2019-08-11 18:22:47,025 INFO] Step 32500/100000; acc:  97.49; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3425 tok/s;  11614 sec
[2019-08-11 18:25:35,834 INFO] Step 33000/100000; acc:  97.54; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3459 tok/s;  11783 sec
[2019-08-11 18:28:28,480 INFO] Step 33500/100000; acc:  97.45; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3391 tok/s;  11956 sec
[2019-08-11 18:31:18,419 INFO] Step 34000/100000; acc:  97.49; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3443 tok/s;  12126 sec
[2019-08-11 18:34:10,260 INFO] Step 34500/100000; acc:  97.57; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3416 tok/s;  12298 sec
[2019-08-11 18:37:00,942 INFO] Step 35000/100000; acc:  97.54; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3428 tok/s;  12468 sec
[2019-08-11 18:39:50,004 INFO] Step 35500/100000; acc:  97.62; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3463 tok/s;  12637 sec
[2019-08-11 18:42:40,838 INFO] Step 36000/100000; acc:  97.62; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3439 tok/s;  12808 sec
[2019-08-11 18:45:32,124 INFO] Step 36500/100000; acc:  97.66; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3419 tok/s;  12979 sec
[2019-08-11 18:48:24,508 INFO] Step 37000/100000; acc:  97.61; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3403 tok/s;  13152 sec
[2019-08-11 18:51:16,688 INFO] Step 37500/100000; acc:  97.61; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3401 tok/s;  13324 sec
[2019-08-11 18:54:05,691 INFO] Step 38000/100000; acc:  97.69; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3451 tok/s;  13493 sec
[2019-08-11 18:56:57,673 INFO] Step 38500/100000; acc:  97.63; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3438 tok/s;  13665 sec
[2019-08-11 18:59:48,592 INFO] Step 39000/100000; acc:  97.72; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3406 tok/s;  13836 sec
[2019-08-11 19:02:36,151 INFO] Step 39500/100000; acc:  97.71; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3488 tok/s;  14003 sec
[2019-08-11 19:05:26,752 INFO] Step 40000/100000; acc:  97.72; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3469 tok/s;  14174 sec
[2019-08-11 19:06:43,536 INFO] Validation perplexity: 1.10725
[2019-08-11 19:06:43,537 INFO] Validation accuracy: 97.424
[2019-08-11 19:06:43,540 INFO] Saving checkpoint ../results/models/im2latex-23_step_40000.pt
[2019-08-11 19:09:33,954 INFO] Step 40500/100000; acc:  97.74; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/2358 tok/s;  14421 sec
[2019-08-11 19:12:27,048 INFO] Step 41000/100000; acc:  97.74; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3384 tok/s;  14594 sec
[2019-08-11 19:15:17,301 INFO] Step 41500/100000; acc:  97.74; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3441 tok/s;  14765 sec
[2019-08-11 19:18:07,021 INFO] Step 42000/100000; acc:  97.76; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3442 tok/s;  14934 sec
[2019-08-11 19:21:01,379 INFO] Step 42500/100000; acc:  97.77; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3375 tok/s;  15109 sec
[2019-08-11 19:23:47,835 INFO] Step 43000/100000; acc:  97.80; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/3490 tok/s;  15275 sec
[2019-08-11 19:26:36,968 INFO] Step 43500/100000; acc:  97.87; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/3467 tok/s;  15444 sec
[2019-08-11 19:29:28,540 INFO] Step 44000/100000; acc:  97.89; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/3436 tok/s;  15616 sec
[2019-08-11 19:32:18,305 INFO] Step 44500/100000; acc:  97.86; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/3446 tok/s;  15786 sec
[2019-08-11 19:35:11,736 INFO] Step 45000/100000; acc:  97.84; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/3384 tok/s;  15959 sec
[2019-08-11 19:38:02,555 INFO] Step 45500/100000; acc:  97.86; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/3418 tok/s;  16130 sec
[2019-08-11 19:40:53,842 INFO] Step 46000/100000; acc:  97.89; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/3436 tok/s;  16301 sec
[2019-08-11 19:43:43,088 INFO] Step 46500/100000; acc:  97.90; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/3447 tok/s;  16470 sec
[2019-08-11 19:46:31,400 INFO] Step 47000/100000; acc:  97.90; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/3477 tok/s;  16639 sec
[2019-08-11 19:49:22,664 INFO] Step 47500/100000; acc:  97.96; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/3425 tok/s;  16810 sec
[2019-08-11 19:52:11,840 INFO] Step 48000/100000; acc:  97.96; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/3457 tok/s;  16979 sec
[2019-08-11 19:55:03,695 INFO] Step 48500/100000; acc:  97.95; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/3413 tok/s;  17151 sec
[2019-08-11 19:57:56,589 INFO] Step 49000/100000; acc:  97.91; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/3392 tok/s;  17324 sec
[2019-08-11 20:00:45,566 INFO] Step 49500/100000; acc:  97.98; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/3448 tok/s;  17493 sec
[2019-08-11 20:03:40,351 INFO] Step 50000/100000; acc:  97.96; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/3376 tok/s;  17668 sec
[2019-08-11 20:04:57,183 INFO] Validation perplexity: 1.10361
[2019-08-11 20:04:57,184 INFO] Validation accuracy: 97.5034
[2019-08-11 20:04:57,187 INFO] Saving checkpoint ../results/models/im2latex-23_step_50000.pt
[2019-08-11 20:07:48,416 INFO] Step 50500/100000; acc:  98.18; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/2347 tok/s;  17916 sec
[2019-08-11 20:10:37,796 INFO] Step 51000/100000; acc:  98.24; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/3461 tok/s;  18085 sec
[2019-08-11 20:13:32,802 INFO] Step 51500/100000; acc:  98.30; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/3384 tok/s;  18260 sec
[2019-08-11 20:16:21,788 INFO] Step 52000/100000; acc:  98.34; ppl:  1.06; xent: 0.05; lr: 0.05000;   0/3447 tok/s;  18429 sec
[2019-08-11 20:19:13,465 INFO] Step 52500/100000; acc:  98.35; ppl:  1.06; xent: 0.05; lr: 0.05000;   0/3413 tok/s;  18601 sec
[2019-08-11 20:22:02,961 INFO] Step 53000/100000; acc:  98.38; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3455 tok/s;  18770 sec
[2019-08-11 20:24:52,284 INFO] Step 53500/100000; acc:  98.43; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3456 tok/s;  18940 sec
[2019-08-11 20:27:45,795 INFO] Step 54000/100000; acc:  98.42; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3384 tok/s;  19113 sec
[2019-08-11 20:30:33,676 INFO] Step 54500/100000; acc:  98.39; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3471 tok/s;  19281 sec
[2019-08-11 20:33:25,986 INFO] Step 55000/100000; acc:  98.42; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3405 tok/s;  19453 sec
[2019-08-11 20:36:18,082 INFO] Step 55500/100000; acc:  98.48; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3417 tok/s;  19625 sec
[2019-08-11 20:39:07,502 INFO] Step 56000/100000; acc:  98.48; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3458 tok/s;  19795 sec
[2019-08-11 20:42:01,288 INFO] Step 56500/100000; acc:  98.48; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3381 tok/s;  19969 sec
[2019-08-11 20:44:51,122 INFO] Step 57000/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3431 tok/s;  20138 sec
[2019-08-11 20:47:46,150 INFO] Step 57500/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3369 tok/s;  20313 sec
[2019-08-11 20:50:36,828 INFO] Step 58000/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3415 tok/s;  20484 sec
[2019-08-11 20:53:26,698 INFO] Step 58500/100000; acc:  98.50; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3437 tok/s;  20654 sec
[2019-08-11 20:56:17,995 INFO] Step 59000/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3435 tok/s;  20825 sec
[2019-08-11 20:59:08,272 INFO] Step 59500/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3423 tok/s;  20996 sec
[2019-08-11 21:01:59,516 INFO] Step 60000/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/3434 tok/s;  21167 sec
[2019-08-11 21:03:16,266 INFO] Validation perplexity: 1.09478
[2019-08-11 21:03:16,267 INFO] Validation accuracy: 97.814
[2019-08-11 21:03:16,271 INFO] Saving checkpoint ../results/models/im2latex-23_step_60000.pt
[2019-08-11 21:06:08,648 INFO] Step 60500/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/2355 tok/s;  21416 sec
[2019-08-11 21:08:58,112 INFO] Step 61000/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3440 tok/s;  21585 sec
[2019-08-11 21:11:52,436 INFO] Step 61500/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3384 tok/s;  21760 sec
[2019-08-11 21:14:40,912 INFO] Step 62000/100000; acc:  98.63; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3449 tok/s;  21928 sec
[2019-08-11 21:17:32,468 INFO] Step 62500/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3426 tok/s;  22100 sec
[2019-08-11 21:20:24,005 INFO] Step 63000/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3438 tok/s;  22271 sec
[2019-08-11 21:23:13,333 INFO] Step 63500/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3445 tok/s;  22441 sec
[2019-08-11 21:26:04,016 INFO] Step 64000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3427 tok/s;  22611 sec
[2019-08-11 21:28:52,631 INFO] Step 64500/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3475 tok/s;  22780 sec
[2019-08-11 21:31:43,421 INFO] Step 65000/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3434 tok/s;  22951 sec
[2019-08-11 21:34:34,990 INFO] Step 65500/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3413 tok/s;  23122 sec
[2019-08-11 21:37:22,380 INFO] Step 66000/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3490 tok/s;  23290 sec
[2019-08-11 21:40:12,829 INFO] Step 66500/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3448 tok/s;  23460 sec
[2019-08-11 21:43:03,483 INFO] Step 67000/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3437 tok/s;  23631 sec
[2019-08-11 21:45:55,899 INFO] Step 67500/100000; acc:  98.80; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3405 tok/s;  23803 sec
[2019-08-11 21:48:48,381 INFO] Step 68000/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3396 tok/s;  23976 sec
[2019-08-11 21:51:36,861 INFO] Step 68500/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3457 tok/s;  24144 sec
[2019-08-11 21:54:30,325 INFO] Step 69000/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3406 tok/s;  24318 sec
[2019-08-11 21:57:20,036 INFO] Step 69500/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3435 tok/s;  24487 sec
[2019-08-11 22:00:09,198 INFO] Step 70000/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3459 tok/s;  24657 sec
[2019-08-11 22:01:26,121 INFO] Validation perplexity: 1.09481
[2019-08-11 22:01:26,122 INFO] Validation accuracy: 97.8974
[2019-08-11 22:01:26,125 INFO] Saving checkpoint ../results/models/im2latex-23_step_70000.pt
[2019-08-11 22:04:16,605 INFO] Step 70500/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/2380 tok/s;  24904 sec
[2019-08-11 22:07:05,178 INFO] Step 71000/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3461 tok/s;  25073 sec
[2019-08-11 22:09:57,213 INFO] Step 71500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3410 tok/s;  25245 sec
[2019-08-11 22:12:49,753 INFO] Step 72000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3397 tok/s;  25417 sec
[2019-08-11 22:15:38,485 INFO] Step 72500/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3453 tok/s;  25586 sec
[2019-08-11 22:18:31,541 INFO] Step 73000/100000; acc:  98.88; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/3402 tok/s;  25759 sec
[2019-08-11 22:21:20,919 INFO] Step 73500/100000; acc:  98.87; ppl:  1.04; xent: 0.03; lr: 0.01250;   0/3431 tok/s;  25928 sec
[2019-08-11 22:24:11,580 INFO] Step 74000/100000; acc:  98.88; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/3449 tok/s;  26099 sec
[2019-08-11 22:27:04,746 INFO] Step 74500/100000; acc:  98.86; ppl:  1.04; xent: 0.03; lr: 0.01250;   0/3399 tok/s;  26272 sec
[2019-08-11 22:29:54,905 INFO] Step 75000/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/3431 tok/s;  26442 sec
[2019-08-11 22:32:48,475 INFO] Step 75500/100000; acc:  98.87; ppl:  1.04; xent: 0.03; lr: 0.01250;   0/3374 tok/s;  26616 sec
[2019-08-11 22:35:38,696 INFO] Step 76000/100000; acc:  98.86; ppl:  1.04; xent: 0.03; lr: 0.01250;   0/3435 tok/s;  26786 sec
[2019-08-11 22:38:30,288 INFO] Step 76500/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/3425 tok/s;  26958 sec
[2019-08-11 22:41:21,532 INFO] Step 77000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/3415 tok/s;  27129 sec
[2019-08-11 22:44:10,598 INFO] Step 77500/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/3464 tok/s;  27298 sec
[2019-08-11 22:47:01,122 INFO] Step 78000/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/3445 tok/s;  27468 sec
[2019-08-11 22:49:50,371 INFO] Step 78500/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/3457 tok/s;  27638 sec
[2019-08-11 22:52:40,924 INFO] Step 79000/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/3437 tok/s;  27808 sec
[2019-08-11 22:55:32,261 INFO] Step 79500/100000; acc:  98.88; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/3427 tok/s;  27980 sec
[2019-08-11 22:58:20,323 INFO] Step 80000/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3464 tok/s;  28148 sec
[2019-08-11 22:59:37,156 INFO] Validation perplexity: 1.09671
[2019-08-11 22:59:37,157 INFO] Validation accuracy: 97.9204
[2019-08-11 22:59:37,159 INFO] Saving checkpoint ../results/models/im2latex-23_step_80000.pt
[2019-08-11 23:02:29,928 INFO] Step 80500/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/2366 tok/s;  28397 sec
[2019-08-11 23:05:17,046 INFO] Step 81000/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3487 tok/s;  28564 sec
[2019-08-11 23:08:04,059 INFO] Step 81500/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3495 tok/s;  28731 sec
[2019-08-11 23:10:54,790 INFO] Step 82000/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3463 tok/s;  28902 sec
[2019-08-11 23:13:42,886 INFO] Step 82500/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3470 tok/s;  29070 sec
[2019-08-11 23:16:34,249 INFO] Step 83000/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3416 tok/s;  29242 sec
[2019-08-11 23:19:23,609 INFO] Step 83500/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3460 tok/s;  29411 sec
[2019-08-11 23:22:12,780 INFO] Step 84000/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3451 tok/s;  29580 sec
[2019-08-11 23:25:06,053 INFO] Step 84500/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3398 tok/s;  29753 sec
[2019-08-11 23:27:51,411 INFO] Step 85000/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3517 tok/s;  29919 sec
[2019-08-11 23:30:41,414 INFO] Step 85500/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3460 tok/s;  30089 sec
[2019-08-11 23:33:30,397 INFO] Step 86000/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3484 tok/s;  30258 sec
[2019-08-11 23:36:18,308 INFO] Step 86500/100000; acc:  98.99; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3481 tok/s;  30426 sec
[2019-08-11 23:39:10,377 INFO] Step 87000/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3413 tok/s;  30598 sec
[2019-08-11 23:41:57,869 INFO] Step 87500/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3484 tok/s;  30765 sec
[2019-08-11 23:44:50,122 INFO] Step 88000/100000; acc:  98.98; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3418 tok/s;  30937 sec
[2019-08-11 23:47:38,329 INFO] Step 88500/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3470 tok/s;  31106 sec
[2019-08-11 23:50:25,289 INFO] Step 89000/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3502 tok/s;  31273 sec
[2019-08-11 23:53:16,076 INFO] Step 89500/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3446 tok/s;  31443 sec
[2019-08-11 23:56:05,129 INFO] Step 90000/100000; acc:  99.00; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3453 tok/s;  31612 sec
[2019-08-11 23:57:21,896 INFO] Validation perplexity: 1.09727
[2019-08-11 23:57:21,897 INFO] Validation accuracy: 97.9234
[2019-08-11 23:57:21,899 INFO] Saving checkpoint ../results/models/im2latex-23_step_90000.pt
[2019-08-12 00:00:12,580 INFO] Step 90500/100000; acc:  99.00; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2371 tok/s;  31860 sec
[2019-08-12 00:03:03,113 INFO] Step 91000/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3442 tok/s;  32030 sec
[2019-08-12 00:05:51,607 INFO] Step 91500/100000; acc:  98.99; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3453 tok/s;  32199 sec
[2019-08-12 00:08:44,598 INFO] Step 92000/100000; acc:  99.00; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3412 tok/s;  32372 sec
[2019-08-12 00:11:31,333 INFO] Step 92500/100000; acc:  99.00; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3494 tok/s;  32539 sec
[2019-08-12 00:14:21,560 INFO] Step 93000/100000; acc:  99.01; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3448 tok/s;  32709 sec
[2019-08-12 00:17:11,201 INFO] Step 93500/100000; acc:  98.98; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3468 tok/s;  32879 sec
[2019-08-12 00:19:59,365 INFO] Step 94000/100000; acc:  99.04; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3462 tok/s;  33047 sec
[2019-08-12 00:22:50,145 INFO] Step 94500/100000; acc:  98.99; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3431 tok/s;  33217 sec
[2019-08-12 00:25:40,351 INFO] Step 95000/100000; acc:  98.99; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3440 tok/s;  33388 sec
[2019-08-12 00:28:29,633 INFO] Step 95500/100000; acc:  99.00; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3460 tok/s;  33557 sec
[2019-08-12 00:31:20,828 INFO] Step 96000/100000; acc:  99.01; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3426 tok/s;  33728 sec
[2019-08-12 00:34:06,777 INFO] Step 96500/100000; acc:  98.98; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3512 tok/s;  33894 sec
[2019-08-12 00:36:57,247 INFO] Step 97000/100000; acc:  98.99; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3456 tok/s;  34065 sec
[2019-08-12 00:39:45,429 INFO] Step 97500/100000; acc:  99.02; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3488 tok/s;  34233 sec
[2019-08-12 00:42:32,745 INFO] Step 98000/100000; acc:  99.05; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3507 tok/s;  34400 sec
[2019-08-12 00:45:22,589 INFO] Step 98500/100000; acc:  98.99; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3457 tok/s;  34570 sec
[2019-08-12 00:48:07,806 INFO] Step 99000/100000; acc:  99.02; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3528 tok/s;  34735 sec
[2019-08-12 00:50:57,917 INFO] Step 99500/100000; acc:  99.02; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3468 tok/s;  34905 sec
[2019-08-12 00:53:43,641 INFO] Step 100000/100000; acc:  99.01; ppl:  1.03; xent: 0.03; lr: 0.00156;   0/3514 tok/s;  35071 sec
[2019-08-12 00:55:00,205 INFO] Validation perplexity: 1.098
[2019-08-12 00:55:00,206 INFO] Validation accuracy: 97.9147
[2019-08-12 00:55:00,208 INFO] Saving checkpoint ../results/models/im2latex-23_step_100000.pt
