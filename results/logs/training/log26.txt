[2019-09-08 17:40:18,584 INFO]  * tgt vocab size = 510
[2019-09-08 17:40:18,584 INFO] Building model...
[2019-09-08 17:43:17,324 INFO]  * tgt vocab size = 510
[2019-09-08 17:43:17,325 INFO] Building model...
[2019-09-08 17:43:21,228 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds1): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (layer2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds2): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (layer3): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds3): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (layer4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds4): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (layer5): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds5): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (layer6): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds6): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (batch_norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(512, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 512)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-09-08 17:43:21,230 INFO] encoder: 8047424
[2019-09-08 17:43:21,230 INFO] decoder: 5214310
[2019-09-08 17:43:21,230 INFO] * number of parameters: 13261734
[2019-09-08 17:43:23,603 INFO] Starting training on GPU: [0]
[2019-09-08 17:43:23,603 INFO] Start training loop and validate every 10000 steps...
[2019-09-08 17:45:46,480 INFO] Step 500/100000; acc:  28.66; ppl: 38.69; xent: 3.66; lr: 0.10000;   0/4119 tok/s;    143 sec
[2019-09-08 17:47:56,776 INFO] Step 1000/100000; acc:  45.57; ppl: 12.73; xent: 2.54; lr: 0.10000;   0/4461 tok/s;    273 sec
[2019-09-08 17:50:06,405 INFO] Step 1500/100000; acc:  53.42; ppl:  8.07; xent: 2.09; lr: 0.10000;   0/4543 tok/s;    403 sec
[2019-09-08 17:52:17,274 INFO] Step 2000/100000; acc:  65.37; ppl:  4.38; xent: 1.48; lr: 0.10000;   0/4480 tok/s;    534 sec
[2019-09-08 17:54:37,860 INFO] Step 2500/100000; acc:  73.99; ppl:  2.98; xent: 1.09; lr: 0.10000;   0/4156 tok/s;    674 sec
[2019-09-08 17:56:46,412 INFO] Step 3000/100000; acc:  78.99; ppl:  2.38; xent: 0.87; lr: 0.10000;   0/4569 tok/s;    803 sec
[2019-09-08 17:58:56,996 INFO] Step 3500/100000; acc:  82.31; ppl:  2.06; xent: 0.72; lr: 0.10000;   0/4470 tok/s;    933 sec
[2019-09-08 18:01:21,296 INFO] Step 4000/100000; acc:  84.49; ppl:  1.89; xent: 0.64; lr: 0.10000;   0/4074 tok/s;   1078 sec
[2019-09-08 18:03:31,970 INFO] Step 4500/100000; acc:  86.03; ppl:  1.76; xent: 0.56; lr: 0.10000;   0/4470 tok/s;   1208 sec
[2019-09-08 18:05:36,845 INFO] Step 5000/100000; acc:  87.33; ppl:  1.67; xent: 0.51; lr: 0.10000;   0/4690 tok/s;   1333 sec
[2019-09-08 18:07:41,438 INFO] Step 5500/100000; acc:  88.32; ppl:  1.60; xent: 0.47; lr: 0.10000;   0/4723 tok/s;   1458 sec
[2019-09-08 18:09:45,124 INFO] Step 6000/100000; acc:  89.12; ppl:  1.55; xent: 0.44; lr: 0.10000;   0/4729 tok/s;   1582 sec
[2019-09-08 18:11:48,649 INFO] Step 6500/100000; acc:  89.76; ppl:  1.51; xent: 0.41; lr: 0.10000;   0/4746 tok/s;   1705 sec
[2019-09-08 18:13:51,385 INFO] Step 7000/100000; acc:  90.26; ppl:  1.47; xent: 0.39; lr: 0.10000;   0/4776 tok/s;   1828 sec
[2019-09-08 18:15:57,262 INFO] Step 7500/100000; acc:  90.92; ppl:  1.43; xent: 0.36; lr: 0.10000;   0/4631 tok/s;   1954 sec
[2019-09-08 18:18:05,415 INFO] Step 8000/100000; acc:  91.26; ppl:  1.41; xent: 0.35; lr: 0.10000;   0/4608 tok/s;   2082 sec
[2019-09-08 18:20:08,605 INFO] Step 8500/100000; acc:  91.78; ppl:  1.38; xent: 0.32; lr: 0.10000;   0/4723 tok/s;   2205 sec
[2019-09-08 18:22:27,362 INFO] Step 9000/100000; acc:  92.12; ppl:  1.36; xent: 0.31; lr: 0.10000;   0/4222 tok/s;   2344 sec
[2019-09-08 18:24:42,847 INFO] Step 9500/100000; acc:  92.45; ppl:  1.35; xent: 0.30; lr: 0.10000;   0/4368 tok/s;   2479 sec
[2019-09-08 18:26:53,000 INFO] Step 10000/100000; acc:  92.69; ppl:  1.33; xent: 0.29; lr: 0.10000;   0/4472 tok/s;   2609 sec
[2019-09-08 18:27:48,938 INFO] Validation perplexity: 1.33314
[2019-09-08 18:27:48,939 INFO] Validation accuracy: 92.8085
[2019-09-08 18:27:48,941 INFO] Saving checkpoint ../results/models/im2latex-26_step_10000.pt
[2019-09-08 18:29:53,882 INFO] Step 10500/100000; acc:  92.93; ppl:  1.32; xent: 0.28; lr: 0.10000;   0/3237 tok/s;   2790 sec
[2019-09-08 18:32:02,837 INFO] Step 11000/100000; acc:  93.12; ppl:  1.31; xent: 0.27; lr: 0.10000;   0/4551 tok/s;   2919 sec
[2019-09-08 18:34:14,735 INFO] Step 11500/100000; acc:  93.43; ppl:  1.29; xent: 0.26; lr: 0.10000;   0/4430 tok/s;   3051 sec
[2019-09-08 18:36:24,754 INFO] Step 12000/100000; acc:  93.58; ppl:  1.28; xent: 0.25; lr: 0.10000;   0/4518 tok/s;   3181 sec
[2019-09-08 18:38:26,995 INFO] Step 12500/100000; acc:  93.87; ppl:  1.27; xent: 0.24; lr: 0.10000;   0/4767 tok/s;   3303 sec
[2019-09-08 18:40:35,005 INFO] Step 13000/100000; acc:  94.00; ppl:  1.26; xent: 0.23; lr: 0.10000;   0/4574 tok/s;   3431 sec
[2019-09-08 18:42:43,408 INFO] Step 13500/100000; acc:  94.26; ppl:  1.25; xent: 0.22; lr: 0.10000;   0/4583 tok/s;   3560 sec
[2019-09-08 18:44:47,914 INFO] Step 14000/100000; acc:  94.32; ppl:  1.25; xent: 0.22; lr: 0.10000;   0/4704 tok/s;   3684 sec
[2019-09-08 18:46:55,550 INFO] Step 14500/100000; acc:  94.30; ppl:  1.25; xent: 0.22; lr: 0.10000;   0/4600 tok/s;   3812 sec
[2019-09-08 18:49:01,514 INFO] Step 15000/100000; acc:  94.49; ppl:  1.23; xent: 0.21; lr: 0.10000;   0/4630 tok/s;   3938 sec
[2019-09-08 18:51:01,777 INFO] Step 15500/100000; acc:  94.61; ppl:  1.23; xent: 0.21; lr: 0.10000;   0/4901 tok/s;   4058 sec
[2019-09-08 18:53:03,057 INFO] Step 16000/100000; acc:  94.83; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/4804 tok/s;   4179 sec
[2019-09-08 18:55:01,630 INFO] Step 16500/100000; acc:  94.89; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/4930 tok/s;   4298 sec
[2019-09-08 18:56:56,088 INFO] Step 17000/100000; acc:  95.04; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/5142 tok/s;   4412 sec
[2019-09-08 18:58:49,267 INFO] Step 17500/100000; acc:  95.06; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/5153 tok/s;   4526 sec
[2019-09-08 19:00:44,560 INFO] Step 18000/100000; acc:  95.11; ppl:  1.20; xent: 0.19; lr: 0.10000;   0/5100 tok/s;   4641 sec
[2019-09-08 19:02:39,007 INFO] Step 18500/100000; acc:  95.18; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/5127 tok/s;   4755 sec
[2019-09-08 19:04:39,302 INFO] Step 19000/100000; acc:  95.30; ppl:  1.19; xent: 0.18; lr: 0.10000;   0/4842 tok/s;   4876 sec
[2019-09-08 19:06:39,530 INFO] Step 19500/100000; acc:  95.32; ppl:  1.19; xent: 0.18; lr: 0.10000;   0/4908 tok/s;   4996 sec
[2019-09-08 19:08:33,842 INFO] Step 20000/100000; acc:  95.53; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/5085 tok/s;   5110 sec
[2019-09-08 19:09:21,051 INFO] Validation perplexity: 1.17928
[2019-09-08 19:09:21,052 INFO] Validation accuracy: 95.7734
[2019-09-08 19:09:21,055 INFO] Saving checkpoint ../results/models/im2latex-26_step_20000.pt
[2019-09-08 19:11:17,930 INFO] Step 20500/100000; acc:  95.52; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/3579 tok/s;   5274 sec
[2019-09-08 19:13:13,598 INFO] Step 21000/100000; acc:  95.62; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/5105 tok/s;   5390 sec
[2019-09-08 19:15:11,275 INFO] Step 21500/100000; acc:  95.63; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/4957 tok/s;   5508 sec
[2019-09-08 19:17:11,396 INFO] Step 22000/100000; acc:  95.63; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/4868 tok/s;   5628 sec
[2019-09-08 19:19:06,154 INFO] Step 22500/100000; acc:  95.70; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/5106 tok/s;   5743 sec
[2019-09-08 19:21:01,343 INFO] Step 23000/100000; acc:  95.77; ppl:  1.17; xent: 0.15; lr: 0.10000;   0/5099 tok/s;   5858 sec
[2019-09-08 19:22:56,191 INFO] Step 23500/100000; acc:  95.87; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/5095 tok/s;   5973 sec
[2019-09-08 19:24:49,333 INFO] Step 24000/100000; acc:  95.89; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/5161 tok/s;   6086 sec
[2019-09-08 19:26:43,970 INFO] Step 24500/100000; acc:  95.98; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/5119 tok/s;   6200 sec
[2019-09-08 19:28:39,708 INFO] Step 25000/100000; acc:  96.09; ppl:  1.16; xent: 0.14; lr: 0.10000;   0/5061 tok/s;   6316 sec
[2019-09-08 19:30:35,972 INFO] Step 25500/100000; acc:  96.04; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/5057 tok/s;   6432 sec
[2019-09-08 19:32:32,914 INFO] Step 26000/100000; acc:  95.97; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/5011 tok/s;   6549 sec
[2019-09-08 19:34:28,635 INFO] Step 26500/100000; acc:  96.11; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/5033 tok/s;   6665 sec
[2019-09-08 19:36:26,375 INFO] Step 27000/100000; acc:  96.08; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/5012 tok/s;   6783 sec
[2019-09-08 19:38:21,966 INFO] Step 27500/100000; acc:  96.27; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/5044 tok/s;   6898 sec
[2019-09-08 19:40:15,590 INFO] Step 28000/100000; acc:  96.22; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/5149 tok/s;   7012 sec
[2019-09-08 19:42:10,158 INFO] Step 28500/100000; acc:  96.32; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/5146 tok/s;   7127 sec
[2019-09-08 19:44:05,084 INFO] Step 29000/100000; acc:  96.29; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/5073 tok/s;   7241 sec
[2019-09-08 19:46:01,064 INFO] Step 29500/100000; acc:  96.36; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/5063 tok/s;   7357 sec
[2019-09-08 19:47:56,120 INFO] Step 30000/100000; acc:  96.33; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/5096 tok/s;   7473 sec
[2019-09-08 19:48:43,492 INFO] Validation perplexity: 1.16294
[2019-09-08 19:48:43,493 INFO] Validation accuracy: 96.2197
[2019-09-08 19:48:43,495 INFO] Saving checkpoint ../results/models/im2latex-26_step_30000.pt
[2019-09-08 19:50:39,449 INFO] Step 30500/100000; acc:  96.38; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/3569 tok/s;   7636 sec
[2019-09-08 19:52:35,496 INFO] Step 31000/100000; acc:  96.38; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/5073 tok/s;   7752 sec
[2019-09-08 19:54:28,902 INFO] Step 31500/100000; acc:  96.48; ppl:  1.13; xent: 0.13; lr: 0.10000;   0/5128 tok/s;   7865 sec
[2019-09-08 19:56:24,456 INFO] Step 32000/100000; acc:  96.56; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/5088 tok/s;   7981 sec
[2019-09-08 19:58:20,448 INFO] Step 32500/100000; acc:  96.54; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/5073 tok/s;   8097 sec
[2019-09-08 20:00:15,262 INFO] Step 33000/100000; acc:  96.59; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/5088 tok/s;   8212 sec
[2019-09-08 20:02:10,910 INFO] Step 33500/100000; acc:  96.56; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/5059 tok/s;   8327 sec
[2019-09-08 20:04:05,885 INFO] Step 34000/100000; acc:  96.59; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/5089 tok/s;   8442 sec
[2019-09-08 20:06:01,301 INFO] Step 34500/100000; acc:  96.65; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/5090 tok/s;   8558 sec
[2019-09-08 20:07:55,626 INFO] Step 35000/100000; acc:  96.67; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/5115 tok/s;   8672 sec
[2019-09-08 20:09:47,673 INFO] Step 35500/100000; acc:  96.72; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/5226 tok/s;   8784 sec
[2019-09-08 20:11:41,051 INFO] Step 36000/100000; acc:  96.76; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/5181 tok/s;   8897 sec
[2019-09-08 20:13:33,872 INFO] Step 36500/100000; acc:  96.72; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/5192 tok/s;   9010 sec
[2019-09-08 20:15:27,565 INFO] Step 37000/100000; acc:  96.76; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/5159 tok/s;   9124 sec
[2019-09-08 20:17:21,295 INFO] Step 37500/100000; acc:  96.80; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/5151 tok/s;   9238 sec
[2019-09-08 20:19:15,488 INFO] Step 38000/100000; acc:  96.85; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/5105 tok/s;   9352 sec
[2019-09-08 20:21:11,741 INFO] Step 38500/100000; acc:  96.72; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/5084 tok/s;   9468 sec
[2019-09-08 20:23:06,023 INFO] Step 39000/100000; acc:  96.95; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/5098 tok/s;   9582 sec
[2019-09-08 20:25:00,062 INFO] Step 39500/100000; acc:  96.89; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/5123 tok/s;   9696 sec
[2019-09-08 20:26:57,155 INFO] Step 40000/100000; acc:  96.92; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/5032 tok/s;   9814 sec
[2019-09-08 20:27:44,357 INFO] Validation perplexity: 1.14079
[2019-09-08 20:27:44,358 INFO] Validation accuracy: 96.7066
[2019-09-08 20:27:44,360 INFO] Saving checkpoint ../results/models/im2latex-26_step_40000.pt
[2019-09-08 20:29:40,157 INFO] Step 40500/100000; acc:  96.91; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/3576 tok/s;   9977 sec
[2019-09-08 20:31:36,027 INFO] Step 41000/100000; acc:  96.93; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/5059 tok/s;  10092 sec
[2019-09-08 20:33:32,110 INFO] Step 41500/100000; acc:  96.88; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/5047 tok/s;  10209 sec
[2019-09-08 20:35:28,449 INFO] Step 42000/100000; acc:  97.01; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/5020 tok/s;  10325 sec
[2019-09-08 20:37:23,564 INFO] Step 42500/100000; acc:  96.96; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/5114 tok/s;  10440 sec
[2019-09-08 20:39:15,997 INFO] Step 43000/100000; acc:  97.04; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/5170 tok/s;  10552 sec
[2019-09-08 20:41:11,167 INFO] Step 43500/100000; acc:  97.12; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/5110 tok/s;  10668 sec
[2019-09-08 20:43:06,701 INFO] Step 44000/100000; acc:  97.06; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/5097 tok/s;  10783 sec
[2019-09-08 20:45:02,224 INFO] Step 44500/100000; acc:  97.15; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/5064 tok/s;  10899 sec
[2019-09-08 20:46:59,209 INFO] Step 45000/100000; acc:  97.05; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/5019 tok/s;  11016 sec
[2019-09-08 20:48:54,833 INFO] Step 45500/100000; acc:  97.09; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/5047 tok/s;  11131 sec
[2019-09-08 20:50:51,594 INFO] Step 46000/100000; acc:  97.13; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/5042 tok/s;  11248 sec
[2019-09-08 20:52:45,675 INFO] Step 46500/100000; acc:  97.18; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/5116 tok/s;  11362 sec
[2019-09-08 20:54:41,156 INFO] Step 47000/100000; acc:  97.16; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/5067 tok/s;  11478 sec
[2019-09-08 20:56:37,885 INFO] Step 47500/100000; acc:  97.20; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/5041 tok/s;  11594 sec
[2019-09-08 20:58:33,239 INFO] Step 48000/100000; acc:  97.19; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/5071 tok/s;  11710 sec
[2019-09-08 21:00:29,450 INFO] Step 48500/100000; acc:  97.19; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/5046 tok/s;  11826 sec
[2019-09-08 21:02:24,459 INFO] Step 49000/100000; acc:  97.15; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/5098 tok/s;  11941 sec
[2019-09-08 21:04:19,008 INFO] Step 49500/100000; acc:  97.22; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/5089 tok/s;  12055 sec
[2019-09-08 21:06:16,338 INFO] Step 50000/100000; acc:  97.20; ppl:  1.10; xent: 0.10; lr: 0.05000;   0/5028 tok/s;  12173 sec
[2019-09-08 21:07:03,626 INFO] Validation perplexity: 1.12952
[2019-09-08 21:07:03,627 INFO] Validation accuracy: 97.0291
[2019-09-08 21:07:03,629 INFO] Saving checkpoint ../results/models/im2latex-26_step_50000.pt
[2019-09-08 21:09:00,481 INFO] Step 50500/100000; acc:  97.62; ppl:  1.08; xent: 0.08; lr: 0.05000;   0/3549 tok/s;  12337 sec
[2019-09-08 21:10:55,634 INFO] Step 51000/100000; acc:  97.73; ppl:  1.08; xent: 0.08; lr: 0.05000;   0/5090 tok/s;  12452 sec
[2019-09-08 21:12:51,632 INFO] Step 51500/100000; acc:  97.81; ppl:  1.08; xent: 0.07; lr: 0.05000;   0/5081 tok/s;  12568 sec
[2019-09-08 21:14:45,233 INFO] Step 52000/100000; acc:  97.87; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/5122 tok/s;  12682 sec
[2019-09-08 21:16:39,725 INFO] Step 52500/100000; acc:  97.87; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/5119 tok/s;  12796 sec
[2019-09-08 21:18:34,010 INFO] Step 53000/100000; acc:  97.90; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/5124 tok/s;  12910 sec
[2019-09-08 21:20:28,847 INFO] Step 53500/100000; acc:  97.98; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/5100 tok/s;  13025 sec
[2019-09-08 21:22:23,644 INFO] Step 54000/100000; acc:  97.97; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/5112 tok/s;  13140 sec
[2019-09-08 21:24:16,025 INFO] Step 54500/100000; acc:  97.98; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/5187 tok/s;  13252 sec
[2019-09-08 21:26:10,808 INFO] Step 55000/100000; acc:  98.00; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/5114 tok/s;  13367 sec
[2019-09-08 21:28:06,742 INFO] Step 55500/100000; acc:  98.06; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/5069 tok/s;  13483 sec
[2019-09-08 21:30:02,117 INFO] Step 56000/100000; acc:  98.05; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/5081 tok/s;  13599 sec
[2019-09-08 21:31:58,443 INFO] Step 56500/100000; acc:  98.05; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/5050 tok/s;  13715 sec
[2019-09-08 21:33:53,311 INFO] Step 57000/100000; acc:  98.08; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/5073 tok/s;  13830 sec
[2019-09-08 21:35:49,583 INFO] Step 57500/100000; acc:  98.11; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/5073 tok/s;  13946 sec
[2019-09-08 21:37:42,808 INFO] Step 58000/100000; acc:  98.11; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/5147 tok/s;  14059 sec
[2019-09-08 21:39:35,889 INFO] Step 58500/100000; acc:  98.08; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/5165 tok/s;  14172 sec
[2019-09-08 21:41:30,443 INFO] Step 59000/100000; acc:  98.13; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/5154 tok/s;  14287 sec
[2019-09-08 21:43:23,282 INFO] Step 59500/100000; acc:  98.15; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/5164 tok/s;  14400 sec
[2019-09-08 21:45:17,649 INFO] Step 60000/100000; acc:  98.15; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/5141 tok/s;  14514 sec
[2019-09-08 21:46:03,947 INFO] Validation perplexity: 1.11356
[2019-09-08 21:46:03,948 INFO] Validation accuracy: 97.4129
[2019-09-08 21:46:03,950 INFO] Saving checkpoint ../results/models/im2latex-26_step_60000.pt
[2019-09-08 21:47:58,809 INFO] Step 60500/100000; acc:  98.18; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/3642 tok/s;  14675 sec
[2019-09-08 21:49:52,733 INFO] Step 61000/100000; acc:  98.28; ppl:  1.06; xent: 0.05; lr: 0.02500;   0/5113 tok/s;  14789 sec
[2019-09-08 21:51:47,196 INFO] Step 61500/100000; acc:  98.30; ppl:  1.06; xent: 0.05; lr: 0.02500;   0/5152 tok/s;  14904 sec
[2019-09-08 21:53:40,229 INFO] Step 62000/100000; acc:  98.32; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/5143 tok/s;  15017 sec
[2019-09-08 21:55:34,456 INFO] Step 62500/100000; acc:  98.37; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/5146 tok/s;  15131 sec
[2019-09-08 21:57:31,094 INFO] Step 63000/100000; acc:  98.38; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/5041 tok/s;  15247 sec
[2019-09-08 21:59:26,875 INFO] Step 63500/100000; acc:  98.44; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/5041 tok/s;  15363 sec
[2019-09-08 22:01:22,938 INFO] Step 64000/100000; acc:  98.41; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/5039 tok/s;  15479 sec
[2019-09-08 22:03:18,779 INFO] Step 64500/100000; acc:  98.34; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/5056 tok/s;  15595 sec
[2019-09-08 22:05:13,711 INFO] Step 65000/100000; acc:  98.42; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/5102 tok/s;  15710 sec
[2019-09-08 22:07:08,059 INFO] Step 65500/100000; acc:  98.40; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/5119 tok/s;  15824 sec
[2019-09-08 22:09:00,844 INFO] Step 66000/100000; acc:  98.43; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/5187 tok/s;  15937 sec
[2019-09-08 22:10:55,822 INFO] Step 66500/100000; acc:  98.44; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/5106 tok/s;  16052 sec
[2019-09-08 22:12:50,618 INFO] Step 67000/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/5109 tok/s;  16167 sec
[2019-09-08 22:14:44,287 INFO] Step 67500/100000; acc:  98.50; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/5168 tok/s;  16281 sec
[2019-09-08 22:16:38,048 INFO] Step 68000/100000; acc:  98.44; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/5145 tok/s;  16394 sec
[2019-09-08 22:18:31,461 INFO] Step 68500/100000; acc:  98.45; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/5137 tok/s;  16508 sec
[2019-09-08 22:20:27,565 INFO] Step 69000/100000; acc:  98.43; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/5088 tok/s;  16624 sec
[2019-09-08 22:22:22,329 INFO] Step 69500/100000; acc:  98.50; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/5080 tok/s;  16739 sec
[2019-09-08 22:24:17,330 INFO] Step 70000/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/5089 tok/s;  16854 sec
[2019-09-08 22:25:03,694 INFO] Validation perplexity: 1.11219
[2019-09-08 22:25:03,695 INFO] Validation accuracy: 97.5287
[2019-09-08 22:25:03,698 INFO] Saving checkpoint ../results/models/im2latex-26_step_70000.pt
[2019-09-08 22:27:00,064 INFO] Step 70500/100000; acc:  98.53; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/3627 tok/s;  17016 sec
[2019-09-08 22:28:53,942 INFO] Step 71000/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/5120 tok/s;  17130 sec
[2019-09-08 22:30:47,817 INFO] Step 71500/100000; acc:  98.58; ppl:  1.05; xent: 0.04; lr: 0.01250;   0/5157 tok/s;  17244 sec
[2019-09-08 22:32:42,144 INFO] Step 72000/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/5128 tok/s;  17359 sec
[2019-09-08 22:34:35,737 INFO] Step 72500/100000; acc:  98.57; ppl:  1.05; xent: 0.04; lr: 0.01250;   0/5127 tok/s;  17472 sec
[2019-09-08 22:36:29,960 INFO] Step 73000/100000; acc:  98.58; ppl:  1.05; xent: 0.04; lr: 0.01250;   0/5154 tok/s;  17586 sec
[2019-09-08 22:38:21,427 INFO] Step 73500/100000; acc:  98.60; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/5215 tok/s;  17698 sec
[2019-09-08 22:40:17,721 INFO] Step 74000/100000; acc:  98.62; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/5063 tok/s;  17814 sec
[2019-09-08 22:42:12,607 INFO] Step 74500/100000; acc:  98.60; ppl:  1.05; xent: 0.04; lr: 0.01250;   0/5105 tok/s;  17929 sec
[2019-09-08 22:44:06,590 INFO] Step 75000/100000; acc:  98.61; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/5127 tok/s;  18043 sec
[2019-09-08 22:46:01,126 INFO] Step 75500/100000; acc:  98.58; ppl:  1.05; xent: 0.04; lr: 0.01250;   0/5114 tok/s;  18158 sec
[2019-09-08 22:47:54,577 INFO] Step 76000/100000; acc:  98.58; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/5155 tok/s;  18271 sec
[2019-09-08 22:49:49,705 INFO] Step 76500/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/5100 tok/s;  18386 sec
[2019-09-08 22:51:42,524 INFO] Step 77000/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/5177 tok/s;  18499 sec
[2019-09-08 22:53:35,224 INFO] Step 77500/100000; acc:  98.63; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/5202 tok/s;  18612 sec
[2019-09-08 22:55:29,655 INFO] Step 78000/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/5135 tok/s;  18726 sec
[2019-09-08 22:57:25,449 INFO] Step 78500/100000; acc:  98.62; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/5057 tok/s;  18842 sec
[2019-09-08 22:59:20,174 INFO] Step 79000/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/5108 tok/s;  18957 sec
[2019-09-08 23:01:14,767 INFO] Step 79500/100000; acc:  98.63; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/5118 tok/s;  19071 sec
[2019-09-08 23:03:08,502 INFO] Step 80000/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/5120 tok/s;  19185 sec
[2019-09-08 23:03:55,560 INFO] Validation perplexity: 1.11293
[2019-09-08 23:03:55,561 INFO] Validation accuracy: 97.5665
[2019-09-08 23:03:55,564 INFO] Saving checkpoint ../results/models/im2latex-26_step_80000.pt
[2019-09-08 23:05:50,812 INFO] Step 80500/100000; acc:  98.65; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3641 tok/s;  19347 sec
[2019-09-08 23:07:43,238 INFO] Step 81000/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/5182 tok/s;  19460 sec
[2019-09-08 23:09:35,156 INFO] Step 81500/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/5216 tok/s;  19572 sec
[2019-09-08 23:11:32,689 INFO] Step 82000/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/5048 tok/s;  19689 sec
[2019-09-08 23:13:27,339 INFO] Step 82500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/5082 tok/s;  19804 sec
[2019-09-08 23:15:23,128 INFO] Step 83000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/5057 tok/s;  19920 sec
[2019-09-08 23:17:18,357 INFO] Step 83500/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/5087 tok/s;  20035 sec
[2019-09-08 23:19:13,577 INFO] Step 84000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/5069 tok/s;  20150 sec
[2019-09-08 23:21:09,717 INFO] Step 84500/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/5067 tok/s;  20266 sec
[2019-09-08 23:23:01,890 INFO] Step 85000/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/5186 tok/s;  20378 sec
[2019-09-08 23:24:56,041 INFO] Step 85500/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/5127 tok/s;  20492 sec
[2019-09-08 23:26:51,300 INFO] Step 86000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/5113 tok/s;  20608 sec
[2019-09-08 23:28:44,971 INFO] Step 86500/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/5147 tok/s;  20721 sec
[2019-09-08 23:30:38,804 INFO] Step 87000/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/5160 tok/s;  20835 sec
[2019-09-08 23:32:32,532 INFO] Step 87500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/5124 tok/s;  20949 sec
[2019-09-08 23:34:28,199 INFO] Step 88000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/5094 tok/s;  21065 sec
[2019-09-08 23:36:23,505 INFO] Step 88500/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/5057 tok/s;  21180 sec
[2019-09-08 23:38:16,590 INFO] Step 89000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/5174 tok/s;  21293 sec
[2019-09-08 23:40:11,670 INFO] Step 89500/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/5118 tok/s;  21408 sec
[2019-09-08 23:42:07,317 INFO] Step 90000/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/5051 tok/s;  21524 sec
[2019-09-08 23:42:54,195 INFO] Validation perplexity: 1.1128
[2019-09-08 23:42:54,196 INFO] Validation accuracy: 97.6055
[2019-09-08 23:42:54,199 INFO] Saving checkpoint ../results/models/im2latex-26_step_90000.pt
[2019-09-08 23:44:51,586 INFO] Step 90500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3574 tok/s;  21688 sec
[2019-09-08 23:46:47,746 INFO] Step 91000/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/5046 tok/s;  21804 sec
[2019-09-08 23:48:41,794 INFO] Step 91500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/5107 tok/s;  21918 sec
[2019-09-08 23:50:36,777 INFO] Step 92000/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/5134 tok/s;  22033 sec
[2019-09-08 23:52:29,706 INFO] Step 92500/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/5159 tok/s;  22146 sec
[2019-09-08 23:54:23,301 INFO] Step 93000/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/5164 tok/s;  22260 sec
[2019-09-08 23:56:18,748 INFO] Step 93500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/5109 tok/s;  22375 sec
[2019-09-08 23:58:12,991 INFO] Step 94000/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/5097 tok/s;  22489 sec
[2019-09-09 00:00:06,763 INFO] Step 94500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/5150 tok/s;  22603 sec
[2019-09-09 00:02:00,615 INFO] Step 95000/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/5143 tok/s;  22717 sec
[2019-09-09 00:03:54,452 INFO] Step 95500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/5146 tok/s;  22831 sec
[2019-09-09 00:05:48,240 INFO] Step 96000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/5154 tok/s;  22945 sec
[2019-09-09 00:07:40,355 INFO] Step 96500/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/5198 tok/s;  23057 sec
[2019-09-09 00:09:36,343 INFO] Step 97000/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/5052 tok/s;  23173 sec
[2019-09-09 00:11:33,218 INFO] Step 97500/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/5023 tok/s;  23290 sec
[2019-09-09 00:13:28,525 INFO] Step 98000/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/5093 tok/s;  23405 sec
[2019-09-09 00:15:23,264 INFO] Step 98500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/5115 tok/s;  23520 sec
[2019-09-09 00:17:16,735 INFO] Step 99000/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/5132 tok/s;  23633 sec
[2019-09-09 00:19:10,955 INFO] Step 99500/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/5164 tok/s;  23747 sec
[2019-09-09 00:21:02,981 INFO] Step 100000/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00156;   0/5204 tok/s;  23859 sec
[2019-09-09 00:21:49,217 INFO] Validation perplexity: 1.11475
[2019-09-09 00:21:49,218 INFO] Validation accuracy: 97.5834
[2019-09-09 00:21:49,220 INFO] Saving checkpoint ../results/models/im2latex-26_step_100000.pt
