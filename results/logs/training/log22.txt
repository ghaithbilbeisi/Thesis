[2019-08-11 15:02:24,934 INFO]  * tgt vocab size = 510
[2019-08-11 15:02:24,934 INFO] Building model...
[2019-08-11 15:02:28,803 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer3): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer5): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer6): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (batch_norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(512, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 512)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-08-11 15:02:28,805 INFO] encoder: 8047424
[2019-08-11 15:02:28,805 INFO] decoder: 5214310
[2019-08-11 15:02:28,805 INFO] * number of parameters: 13261734
[2019-08-11 15:02:29,803 INFO] Starting training on GPU: [0]
[2019-08-11 15:02:29,803 INFO] Start training loop and validate every 10000 steps...
[2019-08-11 15:05:14,036 INFO] Step 500/100000; acc:  28.89; ppl: 39.12; xent: 3.67; lr: 0.10000;   0/3583 tok/s;    164 sec
[2019-08-11 15:07:50,709 INFO] Step 1000/100000; acc:  44.74; ppl: 13.41; xent: 2.60; lr: 0.10000;   0/3710 tok/s;    321 sec
[2019-08-11 15:10:36,654 INFO] Step 1500/100000; acc:  48.45; ppl: 10.55; xent: 2.36; lr: 0.10000;   0/3549 tok/s;    487 sec
[2019-08-11 15:13:25,692 INFO] Step 2000/100000; acc:  52.12; ppl:  8.73; xent: 2.17; lr: 0.10000;   0/3473 tok/s;    656 sec
[2019-08-11 15:16:11,644 INFO] Step 2500/100000; acc:  61.02; ppl:  5.54; xent: 1.71; lr: 0.10000;   0/3519 tok/s;    822 sec
[2019-08-11 15:19:00,035 INFO] Step 3000/100000; acc:  74.79; ppl:  2.89; xent: 1.06; lr: 0.10000;   0/3486 tok/s;    990 sec
[2019-08-11 15:21:45,386 INFO] Step 3500/100000; acc:  83.31; ppl:  2.01; xent: 0.70; lr: 0.10000;   0/3533 tok/s;   1156 sec
[2019-08-11 15:24:37,352 INFO] Step 4000/100000; acc:  86.74; ppl:  1.74; xent: 0.56; lr: 0.10000;   0/3418 tok/s;   1328 sec
[2019-08-11 15:27:24,432 INFO] Step 4500/100000; acc:  88.72; ppl:  1.59; xent: 0.47; lr: 0.10000;   0/3496 tok/s;   1495 sec
[2019-08-11 15:30:09,123 INFO] Step 5000/100000; acc:  90.20; ppl:  1.50; xent: 0.40; lr: 0.10000;   0/3555 tok/s;   1659 sec
[2019-08-11 15:32:56,424 INFO] Step 5500/100000; acc:  91.17; ppl:  1.44; xent: 0.36; lr: 0.10000;   0/3507 tok/s;   1827 sec
[2019-08-11 15:35:44,900 INFO] Step 6000/100000; acc:  91.94; ppl:  1.39; xent: 0.33; lr: 0.10000;   0/3473 tok/s;   1995 sec
[2019-08-11 15:38:32,303 INFO] Step 6500/100000; acc:  92.45; ppl:  1.36; xent: 0.31; lr: 0.10000;   0/3504 tok/s;   2162 sec
[2019-08-11 15:41:18,834 INFO] Step 7000/100000; acc:  93.06; ppl:  1.33; xent: 0.28; lr: 0.10000;   0/3522 tok/s;   2329 sec
[2019-08-11 15:44:05,507 INFO] Step 7500/100000; acc:  93.60; ppl:  1.30; xent: 0.26; lr: 0.10000;   0/3497 tok/s;   2496 sec
[2019-08-11 15:46:59,122 INFO] Step 8000/100000; acc:  93.72; ppl:  1.29; xent: 0.25; lr: 0.10000;   0/3397 tok/s;   2669 sec
[2019-08-11 15:49:45,951 INFO] Step 8500/100000; acc:  94.24; ppl:  1.26; xent: 0.23; lr: 0.10000;   0/3494 tok/s;   2836 sec
[2019-08-11 15:52:30,729 INFO] Step 9000/100000; acc:  94.60; ppl:  1.24; xent: 0.22; lr: 0.10000;   0/3550 tok/s;   3001 sec
[2019-08-11 15:55:26,629 INFO] Step 9500/100000; acc:  94.83; ppl:  1.23; xent: 0.21; lr: 0.10000;   0/3373 tok/s;   3177 sec
[2019-08-11 15:58:24,883 INFO] Step 10000/100000; acc:  94.97; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/3265 tok/s;   3355 sec
[2019-08-11 15:59:43,225 INFO] Validation perplexity: 1.21768
[2019-08-11 15:59:43,227 INFO] Validation accuracy: 95.0369
[2019-08-11 15:59:43,230 INFO] Saving checkpoint ../results/models/im2latex-22_step_10000.pt
[2019-08-11 16:02:45,800 INFO] Step 10500/100000; acc:  95.09; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/2244 tok/s;   3616 sec
[2019-08-11 16:05:46,399 INFO] Step 11000/100000; acc:  95.28; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/3249 tok/s;   3797 sec
[2019-08-11 16:08:45,308 INFO] Step 11500/100000; acc:  95.41; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/3266 tok/s;   3976 sec
[2019-08-11 16:11:50,331 INFO] Step 12000/100000; acc:  95.51; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/3175 tok/s;   4161 sec
[2019-08-11 16:14:43,453 INFO] Step 12500/100000; acc:  95.74; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/3366 tok/s;   4334 sec
[2019-08-11 16:17:40,153 INFO] Step 13000/100000; acc:  95.89; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/3311 tok/s;   4510 sec
[2019-08-11 16:20:41,452 INFO] Step 13500/100000; acc:  96.00; ppl:  1.17; xent: 0.15; lr: 0.10000;   0/3244 tok/s;   4692 sec
[2019-08-11 16:23:45,746 INFO] Step 14000/100000; acc:  96.03; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/3178 tok/s;   4876 sec
[2019-08-11 16:26:47,274 INFO] Step 14500/100000; acc:  96.02; ppl:  1.17; xent: 0.15; lr: 0.10000;   0/3239 tok/s;   5057 sec
[2019-08-11 16:29:45,284 INFO] Step 15000/100000; acc:  96.15; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/3273 tok/s;   5235 sec
[2019-08-11 16:32:45,749 INFO] Step 15500/100000; acc:  96.19; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/3266 tok/s;   5416 sec
[2019-08-11 16:35:45,779 INFO] Step 16000/100000; acc:  96.32; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/3236 tok/s;   5596 sec
[2019-08-11 16:38:44,492 INFO] Step 16500/100000; acc:  96.40; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/3268 tok/s;   5775 sec
[2019-08-11 16:41:48,163 INFO] Step 17000/100000; acc:  96.49; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/3210 tok/s;   5958 sec
[2019-08-11 16:44:33,921 INFO] Step 17500/100000; acc:  96.53; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/3519 tok/s;   6124 sec
[2019-08-11 16:47:23,711 INFO] Step 18000/100000; acc:  96.55; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/3461 tok/s;   6294 sec
[2019-08-11 16:50:11,840 INFO] Step 18500/100000; acc:  96.53; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/3492 tok/s;   6462 sec
[2019-08-11 16:52:57,593 INFO] Step 19000/100000; acc:  96.66; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/3512 tok/s;   6628 sec
[2019-08-11 16:55:47,798 INFO] Step 19500/100000; acc:  96.59; ppl:  1.13; xent: 0.13; lr: 0.10000;   0/3466 tok/s;   6798 sec
[2019-08-11 16:58:36,542 INFO] Step 20000/100000; acc:  96.78; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/3447 tok/s;   6967 sec
[2019-08-11 16:59:53,293 INFO] Validation perplexity: 1.13309
[2019-08-11 16:59:53,294 INFO] Validation accuracy: 96.7557
[2019-08-11 16:59:53,298 INFO] Saving checkpoint ../results/models/im2latex-22_step_20000.pt
[2019-08-11 17:02:42,207 INFO] Step 20500/100000; acc:  96.80; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2392 tok/s;   7212 sec
[2019-08-11 17:05:32,282 INFO] Step 21000/100000; acc:  96.84; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/3470 tok/s;   7382 sec
[2019-08-11 17:08:18,495 INFO] Step 21500/100000; acc:  96.86; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/3508 tok/s;   7549 sec
[2019-08-11 17:11:07,481 INFO] Step 22000/100000; acc:  96.85; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/3460 tok/s;   7718 sec
[2019-08-11 17:13:55,760 INFO] Step 22500/100000; acc:  96.91; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3483 tok/s;   7886 sec
[2019-08-11 17:16:43,995 INFO] Step 23000/100000; acc:  96.97; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3491 tok/s;   8054 sec
[2019-08-11 17:19:33,837 INFO] Step 23500/100000; acc:  96.96; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3445 tok/s;   8224 sec
[2019-08-11 17:22:20,004 INFO] Step 24000/100000; acc:  97.05; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3513 tok/s;   8390 sec
[2019-08-11 17:25:08,299 INFO] Step 24500/100000; acc:  97.11; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/3476 tok/s;   8558 sec
[2019-08-11 17:27:55,080 INFO] Step 25000/100000; acc:  97.15; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/3516 tok/s;   8725 sec
[2019-08-11 17:30:43,798 INFO] Step 25500/100000; acc:  97.17; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/3482 tok/s;   8894 sec
[2019-08-11 17:33:33,610 INFO] Step 26000/100000; acc:  97.11; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/3454 tok/s;   9064 sec
[2019-08-11 17:36:22,959 INFO] Step 26500/100000; acc:  97.19; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/3439 tok/s;   9233 sec
[2019-08-11 17:39:15,216 INFO] Step 27000/100000; acc:  97.13; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/3425 tok/s;   9405 sec
[2019-08-11 17:42:02,866 INFO] Step 27500/100000; acc:  97.26; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/3473 tok/s;   9573 sec
[2019-08-11 17:44:48,533 INFO] Step 28000/100000; acc:  97.26; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/3536 tok/s;   9739 sec
[2019-08-11 17:47:37,519 INFO] Step 28500/100000; acc:  97.33; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/3496 tok/s;   9908 sec
[2019-08-11 17:50:24,031 INFO] Step 29000/100000; acc:  97.34; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/3499 tok/s;  10074 sec
[2019-08-11 17:53:10,914 INFO] Step 29500/100000; acc:  97.33; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/3523 tok/s;  10241 sec
[2019-08-11 17:55:57,417 INFO] Step 30000/100000; acc:  97.33; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/3520 tok/s;  10408 sec
[2019-08-11 17:57:13,793 INFO] Validation perplexity: 1.11143
[2019-08-11 17:57:13,794 INFO] Validation accuracy: 97.3248
[2019-08-11 17:57:13,797 INFO] Saving checkpoint ../results/models/im2latex-22_step_30000.pt
[2019-08-11 17:59:57,901 INFO] Step 30500/100000; acc:  97.38; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/2425 tok/s;  10648 sec
[2019-08-11 18:02:48,430 INFO] Step 31000/100000; acc:  97.35; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/3454 tok/s;  10819 sec
[2019-08-11 18:05:30,538 INFO] Step 31500/100000; acc:  97.40; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/3583 tok/s;  10981 sec
[2019-08-11 18:08:17,285 INFO] Step 32000/100000; acc:  97.48; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3531 tok/s;  11147 sec
[2019-08-11 18:11:04,559 INFO] Step 32500/100000; acc:  97.48; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3518 tok/s;  11315 sec
[2019-08-11 18:13:49,752 INFO] Step 33000/100000; acc:  97.48; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3537 tok/s;  11480 sec
[2019-08-11 18:16:38,678 INFO] Step 33500/100000; acc:  97.45; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3464 tok/s;  11649 sec
[2019-08-11 18:19:24,296 INFO] Step 34000/100000; acc:  97.48; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3532 tok/s;  11814 sec
[2019-08-11 18:22:10,691 INFO] Step 34500/100000; acc:  97.50; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3528 tok/s;  11981 sec
[2019-08-11 18:24:58,040 INFO] Step 35000/100000; acc:  97.50; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3496 tok/s;  12148 sec
[2019-08-11 18:27:40,994 INFO] Step 35500/100000; acc:  97.57; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3594 tok/s;  12311 sec
[2019-08-11 18:30:27,283 INFO] Step 36000/100000; acc:  97.58; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3520 tok/s;  12477 sec
[2019-08-11 18:33:12,090 INFO] Step 36500/100000; acc:  97.62; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3554 tok/s;  12642 sec
[2019-08-11 18:35:59,400 INFO] Step 37000/100000; acc:  97.62; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3507 tok/s;  12810 sec
[2019-08-11 18:38:44,689 INFO] Step 37500/100000; acc:  97.64; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3543 tok/s;  12975 sec
[2019-08-11 18:41:29,825 INFO] Step 38000/100000; acc:  97.63; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3531 tok/s;  13140 sec
[2019-08-11 18:44:18,444 INFO] Step 38500/100000; acc:  97.58; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3506 tok/s;  13309 sec
[2019-08-11 18:47:04,214 INFO] Step 39000/100000; acc:  97.70; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3514 tok/s;  13474 sec
[2019-08-11 18:49:49,009 INFO] Step 39500/100000; acc:  97.72; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3548 tok/s;  13639 sec
[2019-08-11 18:52:37,460 INFO] Step 40000/100000; acc:  97.73; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3510 tok/s;  13808 sec
[2019-08-11 18:53:53,833 INFO] Validation perplexity: 1.10625
[2019-08-11 18:53:53,834 INFO] Validation accuracy: 97.4177
[2019-08-11 18:53:53,837 INFO] Saving checkpoint ../results/models/im2latex-22_step_40000.pt
[2019-08-11 18:56:39,068 INFO] Step 40500/100000; acc:  97.76; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/2413 tok/s;  14049 sec
[2019-08-11 18:59:25,534 INFO] Step 41000/100000; acc:  97.73; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3518 tok/s;  14216 sec
[2019-08-11 19:02:09,955 INFO] Step 41500/100000; acc:  97.70; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3566 tok/s;  14380 sec
[2019-08-11 19:04:52,962 INFO] Step 42000/100000; acc:  97.77; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3582 tok/s;  14543 sec
[2019-08-11 19:07:42,964 INFO] Step 42500/100000; acc:  97.75; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3462 tok/s;  14713 sec
[2019-08-11 19:10:25,728 INFO] Step 43000/100000; acc:  97.79; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3570 tok/s;  14876 sec
[2019-08-11 19:13:12,825 INFO] Step 43500/100000; acc:  97.82; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3517 tok/s;  15043 sec
[2019-08-11 19:15:58,560 INFO] Step 44000/100000; acc:  97.84; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/3558 tok/s;  15209 sec
[2019-08-11 19:18:45,095 INFO] Step 44500/100000; acc:  97.85; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/3513 tok/s;  15375 sec
[2019-08-11 19:21:32,753 INFO] Step 45000/100000; acc:  97.79; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3501 tok/s;  15543 sec
[2019-08-11 19:24:16,681 INFO] Step 45500/100000; acc:  97.82; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/3561 tok/s;  15707 sec
[2019-08-11 19:27:03,381 INFO] Step 46000/100000; acc:  97.84; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/3532 tok/s;  15874 sec
[2019-08-11 19:29:48,576 INFO] Step 46500/100000; acc:  97.87; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/3532 tok/s;  16039 sec
[2019-08-11 19:32:32,684 INFO] Step 47000/100000; acc:  97.88; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/3566 tok/s;  16203 sec
[2019-08-11 19:35:19,490 INFO] Step 47500/100000; acc:  97.90; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/3510 tok/s;  16370 sec
[2019-08-11 19:38:04,975 INFO] Step 48000/100000; acc:  97.90; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/3534 tok/s;  16535 sec
[2019-08-11 19:40:51,417 INFO] Step 48500/100000; acc:  97.87; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/3526 tok/s;  16702 sec
[2019-08-11 19:43:36,545 INFO] Step 49000/100000; acc:  97.87; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/3550 tok/s;  16867 sec
[2019-08-11 19:46:21,570 INFO] Step 49500/100000; acc:  97.92; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/3533 tok/s;  17032 sec
[2019-08-11 19:49:10,181 INFO] Step 50000/100000; acc:  97.94; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/3496 tok/s;  17200 sec
[2019-08-11 19:50:26,750 INFO] Validation perplexity: 1.10067
[2019-08-11 19:50:26,751 INFO] Validation accuracy: 97.6017
[2019-08-11 19:50:26,753 INFO] Saving checkpoint ../results/models/im2latex-22_step_50000.pt
[2019-08-11 19:53:11,633 INFO] Step 50500/100000; acc:  98.14; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/2413 tok/s;  17442 sec
[2019-08-11 19:55:55,448 INFO] Step 51000/100000; acc:  98.21; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/3578 tok/s;  17606 sec
[2019-08-11 19:58:42,546 INFO] Step 51500/100000; acc:  98.26; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/3537 tok/s;  17773 sec
[2019-08-11 20:01:27,340 INFO] Step 52000/100000; acc:  98.34; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/3534 tok/s;  17938 sec
[2019-08-11 20:04:14,290 INFO] Step 52500/100000; acc:  98.32; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/3506 tok/s;  18104 sec
[2019-08-11 20:07:00,873 INFO] Step 53000/100000; acc:  98.35; ppl:  1.06; xent: 0.05; lr: 0.05000;   0/3521 tok/s;  18271 sec
[2019-08-11 20:09:45,807 INFO] Step 53500/100000; acc:  98.40; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3547 tok/s;  18436 sec
[2019-08-11 20:12:35,587 INFO] Step 54000/100000; acc:  98.40; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3459 tok/s;  18606 sec
[2019-08-11 20:15:17,113 INFO] Step 54500/100000; acc:  98.38; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3605 tok/s;  18767 sec
[2019-08-11 20:18:03,109 INFO] Step 55000/100000; acc:  98.40; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3541 tok/s;  18933 sec
[2019-08-11 20:20:49,187 INFO] Step 55500/100000; acc:  98.46; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3539 tok/s;  19099 sec
[2019-08-11 20:23:34,230 INFO] Step 56000/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3550 tok/s;  19264 sec
[2019-08-11 20:26:22,510 INFO] Step 56500/100000; acc:  98.45; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3493 tok/s;  19433 sec
[2019-08-11 20:29:06,043 INFO] Step 57000/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3563 tok/s;  19596 sec
[2019-08-11 20:31:54,250 INFO] Step 57500/100000; acc:  98.48; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3506 tok/s;  19764 sec
[2019-08-11 20:34:42,552 INFO] Step 58000/100000; acc:  98.48; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3463 tok/s;  19933 sec
[2019-08-11 20:37:28,184 INFO] Step 58500/100000; acc:  98.48; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3524 tok/s;  20098 sec
[2019-08-11 20:40:17,073 INFO] Step 59000/100000; acc:  98.50; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3484 tok/s;  20267 sec
[2019-08-11 20:43:02,550 INFO] Step 59500/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/3521 tok/s;  20433 sec
[2019-08-11 20:45:52,286 INFO] Step 60000/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/3466 tok/s;  20602 sec
[2019-08-11 20:47:09,734 INFO] Validation perplexity: 1.09245
[2019-08-11 20:47:09,735 INFO] Validation accuracy: 97.8297
[2019-08-11 20:47:09,738 INFO] Saving checkpoint ../results/models/im2latex-22_step_60000.pt
[2019-08-11 20:50:00,143 INFO] Step 60500/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/2368 tok/s;  20850 sec
[2019-08-11 20:52:47,023 INFO] Step 61000/100000; acc:  98.59; ppl:  1.05; xent: 0.04; lr: 0.02500;   0/3491 tok/s;  21017 sec
[2019-08-11 20:55:40,403 INFO] Step 61500/100000; acc:  98.62; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3402 tok/s;  21191 sec
[2019-08-11 20:58:26,956 INFO] Step 62000/100000; acc:  98.63; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3489 tok/s;  21357 sec
[2019-08-11 21:01:14,453 INFO] Step 62500/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3509 tok/s;  21525 sec
[2019-08-11 21:04:05,007 INFO] Step 63000/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3455 tok/s;  21695 sec
[2019-08-11 21:06:51,918 INFO] Step 63500/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3492 tok/s;  21862 sec
[2019-08-11 21:09:40,205 INFO] Step 64000/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3479 tok/s;  22030 sec
[2019-08-11 21:12:27,823 INFO] Step 64500/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3499 tok/s;  22198 sec
[2019-08-11 21:15:17,198 INFO] Step 65000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3461 tok/s;  22367 sec
[2019-08-11 21:18:08,071 INFO] Step 65500/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3426 tok/s;  22538 sec
[2019-08-11 21:20:52,031 INFO] Step 66000/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3563 tok/s;  22702 sec
[2019-08-11 21:23:40,400 INFO] Step 66500/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3487 tok/s;  22871 sec
[2019-08-11 21:26:27,940 INFO] Step 67000/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3500 tok/s;  23038 sec
[2019-08-11 21:29:17,709 INFO] Step 67500/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3458 tok/s;  23208 sec
[2019-08-11 21:32:06,632 INFO] Step 68000/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3469 tok/s;  23377 sec
[2019-08-11 21:34:54,145 INFO] Step 68500/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3478 tok/s;  23544 sec
[2019-08-11 21:37:44,129 INFO] Step 69000/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3472 tok/s;  23714 sec
[2019-08-11 21:40:32,159 INFO] Step 69500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3470 tok/s;  23882 sec
[2019-08-11 21:43:18,403 INFO] Step 70000/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3520 tok/s;  24049 sec
[2019-08-11 21:44:35,235 INFO] Validation perplexity: 1.09306
[2019-08-11 21:44:35,236 INFO] Validation accuracy: 97.9083
[2019-08-11 21:44:35,239 INFO] Saving checkpoint ../results/models/im2latex-22_step_70000.pt
[2019-08-11 21:47:24,113 INFO] Step 70500/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/2399 tok/s;  24294 sec
[2019-08-11 21:50:11,445 INFO] Step 71000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3484 tok/s;  24462 sec
[2019-08-11 21:53:00,308 INFO] Step 71500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3478 tok/s;  24631 sec
[2019-08-11 21:55:47,529 INFO] Step 72000/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3505 tok/s;  24798 sec
[2019-08-11 21:58:34,665 INFO] Step 72500/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3487 tok/s;  24965 sec
[2019-08-11 22:01:27,437 INFO] Step 73000/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3405 tok/s;  25138 sec
[2019-08-11 22:04:12,907 INFO] Step 73500/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3513 tok/s;  25303 sec
[2019-08-11 22:07:03,058 INFO] Step 74000/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3461 tok/s;  25473 sec
[2019-08-11 22:09:50,122 INFO] Step 74500/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3518 tok/s;  25640 sec
[2019-08-11 22:12:37,543 INFO] Step 75000/100000; acc:  98.87; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/3492 tok/s;  25808 sec
[2019-08-11 22:15:27,827 INFO] Step 75500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3438 tok/s;  25978 sec
[2019-08-11 22:18:15,714 INFO] Step 76000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3484 tok/s;  26146 sec
[2019-08-11 22:21:05,031 INFO] Step 76500/100000; acc:  98.90; ppl:  1.04; xent: 0.03; lr: 0.01250;   0/3471 tok/s;  26315 sec
[2019-08-11 22:23:53,572 INFO] Step 77000/100000; acc:  98.87; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/3470 tok/s;  26484 sec
[2019-08-11 22:26:39,942 INFO] Step 77500/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.01250;   0/3518 tok/s;  26650 sec
[2019-08-11 22:29:29,571 INFO] Step 78000/100000; acc:  98.85; ppl:  1.04; xent: 0.03; lr: 0.01250;   0/3463 tok/s;  26820 sec
[2019-08-11 22:32:16,621 INFO] Step 78500/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/3504 tok/s;  26987 sec
[2019-08-11 22:35:06,718 INFO] Step 79000/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/3446 tok/s;  27157 sec
[2019-08-11 22:37:55,219 INFO] Step 79500/100000; acc:  98.85; ppl:  1.04; xent: 0.03; lr: 0.01250;   0/3483 tok/s;  27325 sec
[2019-08-11 22:40:41,363 INFO] Step 80000/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3503 tok/s;  27492 sec
[2019-08-11 22:41:58,241 INFO] Validation perplexity: 1.09409
[2019-08-11 22:41:58,242 INFO] Validation accuracy: 97.9284
[2019-08-11 22:41:58,245 INFO] Saving checkpoint ../results/models/im2latex-22_step_80000.pt
[2019-08-11 22:44:49,553 INFO] Step 80500/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/2381 tok/s;  27740 sec
[2019-08-11 22:47:37,924 INFO] Step 81000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3461 tok/s;  27908 sec
[2019-08-11 22:50:22,083 INFO] Step 81500/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3558 tok/s;  28072 sec
[2019-08-11 22:53:11,459 INFO] Step 82000/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3494 tok/s;  28242 sec
[2019-08-11 22:56:00,393 INFO] Step 82500/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3451 tok/s;  28411 sec
[2019-08-11 22:58:47,334 INFO] Step 83000/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3508 tok/s;  28578 sec
[2019-08-11 23:01:32,263 INFO] Step 83500/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3553 tok/s;  28742 sec
[2019-08-11 23:04:18,224 INFO] Step 84000/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3517 tok/s;  28908 sec
[2019-08-11 23:07:09,159 INFO] Step 84500/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3445 tok/s;  29079 sec
[2019-08-11 23:09:51,086 INFO] Step 85000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3591 tok/s;  29241 sec
[2019-08-11 23:12:41,583 INFO] Step 85500/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3443 tok/s;  29412 sec
[2019-08-11 23:15:28,698 INFO] Step 86000/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3525 tok/s;  29579 sec
[2019-08-11 23:18:15,194 INFO] Step 86500/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3513 tok/s;  29745 sec
[2019-08-11 23:21:03,354 INFO] Step 87000/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3491 tok/s;  29914 sec
[2019-08-11 23:23:48,318 INFO] Step 87500/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3539 tok/s;  30079 sec
[2019-08-11 23:26:36,993 INFO] Step 88000/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3490 tok/s;  30247 sec
[2019-08-11 23:29:21,672 INFO] Step 88500/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3544 tok/s;  30412 sec
[2019-08-11 23:32:06,016 INFO] Step 89000/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3557 tok/s;  30576 sec
[2019-08-11 23:34:56,637 INFO] Step 89500/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3442 tok/s;  30747 sec
[2019-08-11 23:37:41,731 INFO] Step 90000/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3537 tok/s;  30912 sec
[2019-08-11 23:38:58,702 INFO] Validation perplexity: 1.0953
[2019-08-11 23:38:58,703 INFO] Validation accuracy: 97.9356
[2019-08-11 23:38:58,706 INFO] Saving checkpoint ../results/models/im2latex-22_step_90000.pt
[2019-08-11 23:41:47,883 INFO] Step 90500/100000; acc:  98.98; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2383 tok/s;  31158 sec
[2019-08-11 23:44:33,604 INFO] Step 91000/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3541 tok/s;  31324 sec
[2019-08-11 23:47:19,145 INFO] Step 91500/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3516 tok/s;  31489 sec
[2019-08-11 23:50:10,364 INFO] Step 92000/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3448 tok/s;  31661 sec
[2019-08-11 23:52:57,119 INFO] Step 92500/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3494 tok/s;  31827 sec
[2019-08-11 23:55:43,121 INFO] Step 93000/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3536 tok/s;  31993 sec
[2019-08-11 23:58:33,486 INFO] Step 93500/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3468 tok/s;  32164 sec
[2019-08-12 00:01:20,175 INFO] Step 94000/100000; acc:  98.99; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3493 tok/s;  32330 sec
[2019-08-12 00:04:09,304 INFO] Step 94500/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3464 tok/s;  32500 sec
[2019-08-12 00:06:55,257 INFO] Step 95000/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3528 tok/s;  32665 sec
[2019-08-12 00:09:41,638 INFO] Step 95500/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3521 tok/s;  32832 sec
[2019-08-12 00:12:30,586 INFO] Step 96000/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3472 tok/s;  33001 sec
[2019-08-12 00:15:15,707 INFO] Step 96500/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3529 tok/s;  33166 sec
[2019-08-12 00:18:02,728 INFO] Step 97000/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3513 tok/s;  33333 sec
[2019-08-12 00:20:47,730 INFO] Step 97500/100000; acc:  98.98; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3559 tok/s;  33498 sec
[2019-08-12 00:23:38,662 INFO] Step 98000/100000; acc:  99.00; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3432 tok/s;  33669 sec
[2019-08-12 00:26:28,390 INFO] Step 98500/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3459 tok/s;  33839 sec
[2019-08-12 00:29:14,485 INFO] Step 99000/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3506 tok/s;  34005 sec
[2019-08-12 00:32:06,121 INFO] Step 99500/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3440 tok/s;  34176 sec
[2019-08-12 00:34:54,565 INFO] Step 100000/100000; acc:  98.99; ppl:  1.03; xent: 0.03; lr: 0.00156;   0/3458 tok/s;  34345 sec
[2019-08-12 00:36:11,248 INFO] Validation perplexity: 1.09587
[2019-08-12 00:36:11,249 INFO] Validation accuracy: 97.9334
[2019-08-12 00:36:11,252 INFO] Saving checkpoint ../results/models/im2latex-22_step_100000.pt
