[2019-12-07 12:39:13,433 INFO]  * tgt vocab size = 510
[2019-12-07 12:39:13,434 INFO] Building model...
[2019-12-07 12:39:17,598 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer3): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer5): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer6): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (batch_norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(512, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 512)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-12-07 12:39:17,600 INFO] encoder: 8047424
[2019-12-07 12:39:17,600 INFO] decoder: 5214310
[2019-12-07 12:39:17,600 INFO] * number of parameters: 13261734
[2019-12-07 12:39:18,192 INFO] Starting training on GPU: [0]
[2019-12-07 12:39:18,192 INFO] Start training loop and validate every 10000 steps...
[2019-12-07 12:42:06,131 INFO] Step 500/100000; acc:  28.12; ppl: 39.95; xent: 3.69; lr: 0.10000;   0/3504 tok/s;    168 sec
[2019-12-07 12:44:45,353 INFO] Step 1000/100000; acc:  44.40; ppl: 13.53; xent: 2.60; lr: 0.10000;   0/3651 tok/s;    327 sec
[2019-12-07 12:47:28,502 INFO] Step 1500/100000; acc:  48.09; ppl: 10.61; xent: 2.36; lr: 0.10000;   0/3610 tok/s;    490 sec
[2019-12-07 12:50:13,622 INFO] Step 2000/100000; acc:  50.95; ppl:  9.01; xent: 2.20; lr: 0.10000;   0/3561 tok/s;    655 sec
[2019-12-07 12:52:58,554 INFO] Step 2500/100000; acc:  56.69; ppl:  6.60; xent: 1.89; lr: 0.10000;   0/3540 tok/s;    820 sec
[2019-12-07 12:55:46,426 INFO] Step 3000/100000; acc:  71.16; ppl:  3.34; xent: 1.20; lr: 0.10000;   0/3496 tok/s;    988 sec
[2019-12-07 12:58:36,885 INFO] Step 3500/100000; acc:  81.46; ppl:  2.16; xent: 0.77; lr: 0.10000;   0/3429 tok/s;   1159 sec
[2019-12-07 13:01:28,576 INFO] Step 4000/100000; acc:  85.99; ppl:  1.80; xent: 0.59; lr: 0.10000;   0/3426 tok/s;   1330 sec
[2019-12-07 13:04:17,560 INFO] Step 4500/100000; acc:  88.28; ppl:  1.62; xent: 0.48; lr: 0.10000;   0/3452 tok/s;   1499 sec
[2019-12-07 13:07:04,474 INFO] Step 5000/100000; acc:  89.90; ppl:  1.52; xent: 0.42; lr: 0.10000;   0/3512 tok/s;   1666 sec
[2019-12-07 13:09:56,773 INFO] Step 5500/100000; acc:  90.94; ppl:  1.45; xent: 0.37; lr: 0.10000;   0/3413 tok/s;   1839 sec
[2019-12-07 13:12:43,375 INFO] Step 6000/100000; acc:  91.75; ppl:  1.40; xent: 0.34; lr: 0.10000;   0/3514 tok/s;   2005 sec
[2019-12-07 13:15:30,890 INFO] Step 6500/100000; acc:  92.36; ppl:  1.36; xent: 0.31; lr: 0.10000;   0/3501 tok/s;   2173 sec
[2019-12-07 13:18:23,835 INFO] Step 7000/100000; acc:  92.84; ppl:  1.34; xent: 0.29; lr: 0.10000;   0/3393 tok/s;   2346 sec
[2019-12-07 13:21:08,238 INFO] Step 7500/100000; acc:  93.49; ppl:  1.30; xent: 0.26; lr: 0.10000;   0/3544 tok/s;   2510 sec
[2019-12-07 13:23:56,170 INFO] Step 8000/100000; acc:  93.62; ppl:  1.29; xent: 0.26; lr: 0.10000;   0/3511 tok/s;   2678 sec
[2019-12-07 13:26:42,537 INFO] Step 8500/100000; acc:  94.15; ppl:  1.26; xent: 0.23; lr: 0.10000;   0/3501 tok/s;   2844 sec
[2019-12-07 13:29:32,776 INFO] Step 9000/100000; acc:  94.48; ppl:  1.25; xent: 0.22; lr: 0.10000;   0/3439 tok/s;   3015 sec
[2019-12-07 13:32:18,893 INFO] Step 9500/100000; acc:  94.74; ppl:  1.23; xent: 0.21; lr: 0.10000;   0/3554 tok/s;   3181 sec
[2019-12-07 13:35:00,068 INFO] Step 10000/100000; acc:  94.83; ppl:  1.23; xent: 0.20; lr: 0.10000;   0/3612 tok/s;   3342 sec
[2019-12-07 13:36:16,371 INFO] Validation perplexity: 1.22573
[2019-12-07 13:36:16,372 INFO] Validation accuracy: 94.8423
[2019-12-07 13:36:16,374 INFO] Saving checkpoint ../results/models/im2latex-58_step_10000.pt
[2019-12-07 13:39:02,458 INFO] Step 10500/100000; acc:  94.98; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/2416 tok/s;   3584 sec
[2019-12-07 13:41:47,800 INFO] Step 11000/100000; acc:  95.09; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/3549 tok/s;   3750 sec
[2019-12-07 13:44:32,071 INFO] Step 11500/100000; acc:  95.28; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/3557 tok/s;   3914 sec
[2019-12-07 13:47:19,933 INFO] Step 12000/100000; acc:  95.38; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/3499 tok/s;   4082 sec
[2019-12-07 13:50:01,607 INFO] Step 12500/100000; acc:  95.64; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/3604 tok/s;   4243 sec
[2019-12-07 13:52:45,828 INFO] Step 13000/100000; acc:  95.75; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/3569 tok/s;   4408 sec
[2019-12-07 13:55:27,965 INFO] Step 13500/100000; acc:  95.90; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/3632 tok/s;   4570 sec
[2019-12-07 13:58:10,543 INFO] Step 14000/100000; acc:  95.96; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/3597 tok/s;   4732 sec
[2019-12-07 14:00:57,218 INFO] Step 14500/100000; acc:  95.86; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/3527 tok/s;   4899 sec
[2019-12-07 14:03:39,554 INFO] Step 15000/100000; acc:  96.11; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/3591 tok/s;   5061 sec
[2019-12-07 14:06:24,653 INFO] Step 15500/100000; acc:  96.15; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/3569 tok/s;   5226 sec
[2019-12-07 14:09:07,470 INFO] Step 16000/100000; acc:  96.28; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/3581 tok/s;   5389 sec
[2019-12-07 14:11:47,994 INFO] Step 16500/100000; acc:  96.36; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/3638 tok/s;   5550 sec
[2019-12-07 14:14:32,478 INFO] Step 17000/100000; acc:  96.49; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/3592 tok/s;   5714 sec
[2019-12-07 14:18:16,496 INFO] Step 17500/100000; acc:  96.47; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2602 tok/s;   5938 sec
[2019-12-07 14:22:54,331 INFO] Step 18000/100000; acc:  96.49; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2116 tok/s;   6216 sec
[2019-12-07 14:27:28,671 INFO] Step 18500/100000; acc:  96.51; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2139 tok/s;   6490 sec
[2019-12-07 14:31:59,350 INFO] Step 19000/100000; acc:  96.63; ppl:  1.13; xent: 0.13; lr: 0.10000;   0/2150 tok/s;   6761 sec
[2019-12-07 14:36:43,739 INFO] Step 19500/100000; acc:  96.60; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2076 tok/s;   7046 sec
[2019-12-07 14:41:13,329 INFO] Step 20000/100000; acc:  96.74; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2159 tok/s;   7315 sec
[2019-12-07 14:43:11,473 INFO] Validation perplexity: 1.13705
[2019-12-07 14:43:11,474 INFO] Validation accuracy: 96.6825
[2019-12-07 14:43:11,477 INFO] Saving checkpoint ../results/models/im2latex-58_step_20000.pt
[2019-12-07 14:47:13,889 INFO] Step 20500/100000; acc:  96.81; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1628 tok/s;   7676 sec
[2019-12-07 14:51:00,534 INFO] Step 21000/100000; acc:  96.86; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/2592 tok/s;   7902 sec
[2019-12-07 14:54:44,015 INFO] Step 21500/100000; acc:  96.88; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/2610 tok/s;   8126 sec
[2019-12-07 14:58:30,192 INFO] Step 22000/100000; acc:  96.83; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/2587 tok/s;   8352 sec
[2019-12-07 15:02:15,554 INFO] Step 22500/100000; acc:  96.88; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/2600 tok/s;   8577 sec
[2019-12-07 15:06:01,051 INFO] Step 23000/100000; acc:  97.00; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/2603 tok/s;   8803 sec
[2019-12-07 15:09:47,301 INFO] Step 23500/100000; acc:  96.99; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/2586 tok/s;   9029 sec
[2019-12-07 15:13:29,611 INFO] Step 24000/100000; acc:  97.03; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/2627 tok/s;   9251 sec
[2019-12-07 15:17:15,941 INFO] Step 24500/100000; acc:  97.08; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/2594 tok/s;   9478 sec
[2019-12-07 15:20:59,388 INFO] Step 25000/100000; acc:  97.17; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/2622 tok/s;   9701 sec
[2019-12-07 15:24:46,796 INFO] Step 25500/100000; acc:  97.12; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/2586 tok/s;   9929 sec
[2019-12-07 15:28:33,695 INFO] Step 26000/100000; acc:  97.08; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/2584 tok/s;  10156 sec
[2019-12-07 15:32:18,549 INFO] Step 26500/100000; acc:  97.23; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/2589 tok/s;  10380 sec
[2019-12-07 15:36:10,105 INFO] Step 27000/100000; acc:  97.14; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/2547 tok/s;  10612 sec
[2019-12-07 15:39:52,016 INFO] Step 27500/100000; acc:  97.28; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/2628 tok/s;  10834 sec
[2019-12-07 15:43:34,952 INFO] Step 28000/100000; acc:  97.30; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/2625 tok/s;  11057 sec
[2019-12-07 15:47:20,707 INFO] Step 28500/100000; acc:  97.36; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/2621 tok/s;  11283 sec
[2019-12-07 15:51:01,378 INFO] Step 29000/100000; acc:  97.33; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/2637 tok/s;  11503 sec
[2019-12-07 15:54:49,241 INFO] Step 29500/100000; acc:  97.33; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/2583 tok/s;  11731 sec
[2019-12-07 15:58:35,895 INFO] Step 30000/100000; acc:  97.31; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/2585 tok/s;  11958 sec
[2019-12-07 16:00:19,696 INFO] Validation perplexity: 1.11618
[2019-12-07 16:00:19,697 INFO] Validation accuracy: 97.1242
[2019-12-07 16:00:19,700 INFO] Saving checkpoint ../results/models/im2latex-58_step_30000.pt
[2019-12-07 16:04:04,968 INFO] Step 30500/100000; acc:  97.39; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1771 tok/s;  12287 sec
[2019-12-07 16:07:54,031 INFO] Step 31000/100000; acc:  97.34; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/2571 tok/s;  12516 sec
[2019-12-07 16:11:37,402 INFO] Step 31500/100000; acc:  97.44; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/2601 tok/s;  12739 sec
[2019-12-07 16:15:24,480 INFO] Step 32000/100000; acc:  97.53; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/2592 tok/s;  12966 sec
[2019-12-07 16:19:09,932 INFO] Step 32500/100000; acc:  97.48; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/2602 tok/s;  13192 sec
[2019-12-07 16:22:54,356 INFO] Step 33000/100000; acc:  97.50; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/2604 tok/s;  13416 sec
[2019-12-07 16:26:38,934 INFO] Step 33500/100000; acc:  97.48; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/2604 tok/s;  13641 sec
[2019-12-07 16:30:21,250 INFO] Step 34000/100000; acc:  97.50; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/2632 tok/s;  13863 sec
[2019-12-07 16:34:06,128 INFO] Step 34500/100000; acc:  97.58; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/2611 tok/s;  14088 sec
[2019-12-07 16:37:51,871 INFO] Step 35000/100000; acc:  97.53; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/2592 tok/s;  14314 sec
[2019-12-07 16:41:40,878 INFO] Step 35500/100000; acc:  97.60; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/2557 tok/s;  14543 sec
[2019-12-07 16:45:28,660 INFO] Step 36000/100000; acc:  97.62; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/2576 tok/s;  14770 sec
[2019-12-07 16:49:14,748 INFO] Step 36500/100000; acc:  97.66; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/2592 tok/s;  14997 sec
[2019-12-07 16:53:03,589 INFO] Step 37000/100000; acc:  97.62; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/2562 tok/s;  15225 sec
[2019-12-07 16:56:49,914 INFO] Step 37500/100000; acc:  97.65; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/2588 tok/s;  15452 sec
[2019-12-07 17:00:34,477 INFO] Step 38000/100000; acc:  97.71; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/2597 tok/s;  15676 sec
[2019-12-07 17:04:21,233 INFO] Step 38500/100000; acc:  97.63; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/2609 tok/s;  15903 sec
[2019-12-07 17:08:03,197 INFO] Step 39000/100000; acc:  97.75; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/2623 tok/s;  16125 sec
[2019-12-07 17:11:45,047 INFO] Step 39500/100000; acc:  97.72; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/2633 tok/s;  16347 sec
[2019-12-07 17:15:31,229 INFO] Step 40000/100000; acc:  97.76; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/2618 tok/s;  16573 sec
[2019-12-07 17:17:14,890 INFO] Validation perplexity: 1.10163
[2019-12-07 17:17:14,891 INFO] Validation accuracy: 97.516
[2019-12-07 17:17:14,895 INFO] Saving checkpoint ../results/models/im2latex-58_step_40000.pt
[2019-12-07 17:21:00,059 INFO] Step 40500/100000; acc:  97.77; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1773 tok/s;  16902 sec
[2019-12-07 17:24:47,679 INFO] Step 41000/100000; acc:  97.77; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/2573 tok/s;  17129 sec
[2019-12-07 17:28:36,771 INFO] Step 41500/100000; acc:  97.75; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/2557 tok/s;  17359 sec
[2019-12-07 17:32:27,134 INFO] Step 42000/100000; acc:  97.79; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/2536 tok/s;  17589 sec
[2019-12-07 17:36:22,065 INFO] Step 42500/100000; acc:  97.77; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/2505 tok/s;  17824 sec
[2019-12-07 17:40:07,834 INFO] Step 43000/100000; acc:  97.84; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/2576 tok/s;  18050 sec
[2019-12-07 17:44:00,736 INFO] Step 43500/100000; acc:  97.87; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/2516 tok/s;  18283 sec
[2019-12-07 17:47:51,869 INFO] Step 44000/100000; acc:  97.88; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/2552 tok/s;  18514 sec
[2019-12-07 17:51:42,232 INFO] Step 44500/100000; acc:  97.86; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/2538 tok/s;  18744 sec
[2019-12-07 17:55:37,779 INFO] Step 45000/100000; acc:  97.82; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/2493 tok/s;  18980 sec
[2019-12-07 17:59:28,212 INFO] Step 45500/100000; acc:  97.85; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/2534 tok/s;  19210 sec
[2019-12-07 18:03:22,473 INFO] Step 46000/100000; acc:  97.88; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/2513 tok/s;  19444 sec
[2019-12-07 18:07:11,746 INFO] Step 46500/100000; acc:  97.88; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/2544 tok/s;  19674 sec
[2019-12-07 18:11:04,546 INFO] Step 47000/100000; acc:  97.88; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/2515 tok/s;  19906 sec
[2019-12-07 18:14:57,072 INFO] Step 47500/100000; acc:  97.95; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/2526 tok/s;  20139 sec
[2019-12-07 18:18:49,751 INFO] Step 48000/100000; acc:  97.91; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/2513 tok/s;  20372 sec
[2019-12-07 18:22:44,348 INFO] Step 48500/100000; acc:  97.95; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/2500 tok/s;  20606 sec
[2019-12-07 18:26:38,269 INFO] Step 49000/100000; acc:  97.88; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/2509 tok/s;  20840 sec
[2019-12-07 18:30:29,091 INFO] Step 49500/100000; acc:  97.97; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/2524 tok/s;  21071 sec
[2019-12-07 18:34:22,668 INFO] Step 50000/100000; acc:  97.91; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/2525 tok/s;  21304 sec
[2019-12-07 18:36:10,547 INFO] Validation perplexity: 1.10646
[2019-12-07 18:36:10,548 INFO] Validation accuracy: 97.5569
[2019-12-07 18:36:10,551 INFO] Saving checkpoint ../results/models/im2latex-58_step_50000.pt
[2019-12-07 18:40:00,421 INFO] Step 50500/100000; acc:  98.16; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1724 tok/s;  21642 sec
[2019-12-07 18:43:49,994 INFO] Step 51000/100000; acc:  98.24; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/2555 tok/s;  21872 sec
[2019-12-07 18:47:41,796 INFO] Step 51500/100000; acc:  98.27; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/2547 tok/s;  22104 sec
[2019-12-07 18:51:31,079 INFO] Step 52000/100000; acc:  98.33; ppl:  1.06; xent: 0.05; lr: 0.05000;   0/2541 tok/s;  22333 sec
[2019-12-07 18:55:24,889 INFO] Step 52500/100000; acc:  98.33; ppl:  1.06; xent: 0.05; lr: 0.05000;   0/2504 tok/s;  22567 sec
[2019-12-07 18:59:17,484 INFO] Step 53000/100000; acc:  98.37; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2521 tok/s;  22799 sec
[2019-12-07 19:03:08,951 INFO] Step 53500/100000; acc:  98.45; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2528 tok/s;  23031 sec
[2019-12-07 19:07:01,447 INFO] Step 54000/100000; acc:  98.43; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2524 tok/s;  23263 sec
[2019-12-07 19:10:49,667 INFO] Step 54500/100000; acc:  98.41; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2553 tok/s;  23491 sec
[2019-12-07 19:14:42,582 INFO] Step 55000/100000; acc:  98.42; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2521 tok/s;  23724 sec
[2019-12-07 19:18:34,396 INFO] Step 55500/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2536 tok/s;  23956 sec
[2019-12-07 19:22:30,698 INFO] Step 56000/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2479 tok/s;  24193 sec
[2019-12-07 19:26:26,139 INFO] Step 56500/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2495 tok/s;  24428 sec
[2019-12-07 19:30:17,183 INFO] Step 57000/100000; acc:  98.50; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2522 tok/s;  24659 sec
[2019-12-07 19:34:13,933 INFO] Step 57500/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2494 tok/s;  24896 sec
[2019-12-07 19:38:03,666 INFO] Step 58000/100000; acc:  98.50; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2536 tok/s;  25125 sec
[2019-12-07 19:41:50,621 INFO] Step 58500/100000; acc:  98.50; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2572 tok/s;  25352 sec
[2019-12-07 19:45:42,476 INFO] Step 59000/100000; acc:  98.53; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2542 tok/s;  25584 sec
[2019-12-07 19:49:31,604 INFO] Step 59500/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2542 tok/s;  25813 sec
[2019-12-07 19:53:25,945 INFO] Step 60000/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/2509 tok/s;  26048 sec
[2019-12-07 19:55:13,083 INFO] Validation perplexity: 1.09326
[2019-12-07 19:55:13,084 INFO] Validation accuracy: 97.8425
[2019-12-07 19:55:13,089 INFO] Saving checkpoint ../results/models/im2latex-58_step_60000.pt
[2019-12-07 19:59:04,898 INFO] Step 60500/100000; acc:  98.58; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1732 tok/s;  26387 sec
[2019-12-07 20:02:53,227 INFO] Step 61000/100000; acc:  98.63; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/2552 tok/s;  26615 sec
[2019-12-07 20:06:47,045 INFO] Step 61500/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/2522 tok/s;  26849 sec
[2019-12-07 20:10:33,363 INFO] Step 62000/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/2569 tok/s;  27075 sec
[2019-12-07 20:14:23,078 INFO] Step 62500/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/2557 tok/s;  27305 sec
[2019-12-07 20:18:14,306 INFO] Step 63000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/2546 tok/s;  27536 sec
[2019-12-07 20:22:06,540 INFO] Step 63500/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/2512 tok/s;  27768 sec
[2019-12-07 20:26:01,320 INFO] Step 64000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/2492 tok/s;  28003 sec
[2019-12-07 20:29:55,362 INFO] Step 64500/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/2504 tok/s;  28237 sec
[2019-12-07 20:33:46,064 INFO] Step 65000/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/2543 tok/s;  28468 sec
[2019-12-07 20:37:37,011 INFO] Step 65500/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/2535 tok/s;  28699 sec
[2019-12-07 20:41:27,924 INFO] Step 66000/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/2530 tok/s;  28930 sec
[2019-12-07 20:45:23,274 INFO] Step 66500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/2497 tok/s;  29165 sec
[2019-12-07 20:49:16,439 INFO] Step 67000/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/2515 tok/s;  29398 sec
[2019-12-07 20:53:07,626 INFO] Step 67500/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/2539 tok/s;  29629 sec
[2019-12-07 20:57:03,262 INFO] Step 68000/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/2487 tok/s;  29865 sec
[2019-12-07 21:00:55,931 INFO] Step 68500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/2503 tok/s;  30098 sec
[2019-12-07 21:04:48,349 INFO] Step 69000/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/2540 tok/s;  30330 sec
[2019-12-07 21:08:40,123 INFO] Step 69500/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/2518 tok/s;  30562 sec
[2019-12-07 21:12:28,125 INFO] Step 70000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/2566 tok/s;  30790 sec
[2019-12-07 21:14:16,329 INFO] Validation perplexity: 1.09374
[2019-12-07 21:14:16,330 INFO] Validation accuracy: 97.9093
[2019-12-07 21:14:16,333 INFO] Saving checkpoint ../results/models/im2latex-58_step_70000.pt
[2019-12-07 21:18:12,716 INFO] Step 70500/100000; acc:  98.80; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1712 tok/s;  31135 sec
[2019-12-07 21:22:01,083 INFO] Step 71000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/2552 tok/s;  31363 sec
[2019-12-07 21:25:52,358 INFO] Step 71500/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/2540 tok/s;  31594 sec
[2019-12-07 21:29:43,138 INFO] Step 72000/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/2539 tok/s;  31825 sec
[2019-12-07 21:33:33,712 INFO] Step 72500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/2526 tok/s;  32056 sec
[2019-12-07 21:37:26,726 INFO] Step 73000/100000; acc:  98.87; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/2527 tok/s;  32289 sec
[2019-12-07 21:41:13,363 INFO] Step 73500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/2566 tok/s;  32515 sec
[2019-12-07 21:45:04,879 INFO] Step 74000/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/2543 tok/s;  32747 sec
[2019-12-07 21:48:56,868 INFO] Step 74500/100000; acc:  98.85; ppl:  1.04; xent: 0.03; lr: 0.01250;   0/2533 tok/s;  32979 sec
[2019-12-07 21:52:45,259 INFO] Step 75000/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/2558 tok/s;  33207 sec
[2019-12-07 21:56:37,676 INFO] Step 75500/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.01250;   0/2520 tok/s;  33439 sec
[2019-12-07 22:00:28,587 INFO] Step 76000/100000; acc:  98.84; ppl:  1.04; xent: 0.03; lr: 0.01250;   0/2533 tok/s;  33670 sec
[2019-12-07 22:04:23,128 INFO] Step 76500/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/2504 tok/s;  33905 sec
[2019-12-07 22:08:13,894 INFO] Step 77000/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/2534 tok/s;  34136 sec
[2019-12-07 22:12:01,906 INFO] Step 77500/100000; acc:  98.88; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/2571 tok/s;  34364 sec
[2019-12-07 22:15:57,463 INFO] Step 78000/100000; acc:  98.87; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/2496 tok/s;  34599 sec
[2019-12-07 22:19:49,689 INFO] Step 78500/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/2521 tok/s;  34831 sec
[2019-12-07 22:23:41,309 INFO] Step 79000/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/2532 tok/s;  35063 sec
[2019-12-07 22:27:31,199 INFO] Step 79500/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/2551 tok/s;  35293 sec
[2019-12-07 22:31:22,151 INFO] Step 80000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/2522 tok/s;  35524 sec
[2019-12-07 22:33:11,267 INFO] Validation perplexity: 1.0953
[2019-12-07 22:33:11,269 INFO] Validation accuracy: 97.9262
[2019-12-07 22:33:11,272 INFO] Saving checkpoint ../results/models/im2latex-58_step_80000.pt
[2019-12-07 22:37:04,236 INFO] Step 80500/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1727 tok/s;  35866 sec
[2019-12-07 22:40:52,092 INFO] Step 81000/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/2557 tok/s;  36094 sec
[2019-12-07 22:44:41,055 INFO] Step 81500/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/2550 tok/s;  36323 sec
[2019-12-07 22:48:32,035 INFO] Step 82000/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/2553 tok/s;  36554 sec
[2019-12-07 22:52:19,788 INFO] Step 82500/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/2560 tok/s;  36782 sec
[2019-12-07 22:56:10,347 INFO] Step 83000/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/2538 tok/s;  37012 sec
[2019-12-07 23:00:03,673 INFO] Step 83500/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/2511 tok/s;  37245 sec
[2019-12-07 23:03:55,403 INFO] Step 84000/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/2521 tok/s;  37477 sec
[2019-12-07 23:07:51,454 INFO] Step 84500/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/2494 tok/s;  37713 sec
[2019-12-07 23:11:38,159 INFO] Step 85000/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/2564 tok/s;  37940 sec
[2019-12-07 23:15:28,595 INFO] Step 85500/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/2548 tok/s;  38170 sec
[2019-12-07 23:19:21,182 INFO] Step 86000/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/2532 tok/s;  38403 sec
[2019-12-07 23:23:12,515 INFO] Step 86500/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/2529 tok/s;  38634 sec
[2019-12-07 23:27:07,987 INFO] Step 87000/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/2494 tok/s;  38870 sec
[2019-12-07 23:30:55,496 INFO] Step 87500/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/2564 tok/s;  39097 sec
[2019-12-07 23:34:48,380 INFO] Step 88000/100000; acc:  98.98; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/2529 tok/s;  39330 sec
[2019-12-07 23:38:39,156 INFO] Step 88500/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/2527 tok/s;  39561 sec
[2019-12-07 23:42:28,038 INFO] Step 89000/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/2555 tok/s;  39790 sec
[2019-12-07 23:46:22,388 INFO] Step 89500/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/2520 tok/s;  40024 sec
[2019-12-07 23:50:12,249 INFO] Step 90000/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2542 tok/s;  40254 sec
[2019-12-07 23:51:56,880 INFO] Validation perplexity: 1.0955
[2019-12-07 23:51:56,882 INFO] Validation accuracy: 97.935
[2019-12-07 23:51:56,890 INFO] Saving checkpoint ../results/models/im2latex-58_step_90000.pt
[2019-12-07 23:55:52,932 INFO] Step 90500/100000; acc:  98.99; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1722 tok/s;  40595 sec
[2019-12-07 23:59:46,576 INFO] Step 91000/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2511 tok/s;  40828 sec
[2019-12-08 00:03:38,120 INFO] Step 91500/100000; acc:  98.99; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2515 tok/s;  41060 sec
[2019-12-08 00:07:33,406 INFO] Step 92000/100000; acc:  98.98; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2507 tok/s;  41295 sec
[2019-12-08 00:11:21,705 INFO] Step 92500/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2553 tok/s;  41524 sec
[2019-12-08 00:15:10,825 INFO] Step 93000/100000; acc:  98.99; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2561 tok/s;  41753 sec
[2019-12-08 00:19:02,803 INFO] Step 93500/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2534 tok/s;  41985 sec
[2019-12-08 00:22:50,888 INFO] Step 94000/100000; acc:  99.02; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2553 tok/s;  42213 sec
[2019-12-08 00:26:45,342 INFO] Step 94500/100000; acc:  99.00; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2499 tok/s;  42447 sec
[2019-12-08 00:30:34,577 INFO] Step 95000/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2554 tok/s;  42676 sec
[2019-12-08 00:34:23,916 INFO] Step 95500/100000; acc:  98.98; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2554 tok/s;  42906 sec
[2019-12-08 00:38:14,175 INFO] Step 96000/100000; acc:  99.00; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2547 tok/s;  43136 sec
[2019-12-08 00:42:00,354 INFO] Step 96500/100000; acc:  98.98; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2577 tok/s;  43362 sec
[2019-12-08 00:45:48,752 INFO] Step 97000/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2572 tok/s;  43591 sec
[2019-12-08 00:49:40,687 INFO] Step 97500/100000; acc:  99.02; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2532 tok/s;  43822 sec
[2019-12-08 00:53:34,000 INFO] Step 98000/100000; acc:  99.01; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2515 tok/s;  44056 sec
[2019-12-08 00:57:28,095 INFO] Step 98500/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2511 tok/s;  44290 sec
[2019-12-08 01:01:16,389 INFO] Step 99000/100000; acc:  98.99; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2550 tok/s;  44518 sec
[2019-12-08 01:05:09,763 INFO] Step 99500/100000; acc:  99.00; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2528 tok/s;  44752 sec
[2019-12-08 01:09:00,685 INFO] Step 100000/100000; acc:  99.01; ppl:  1.03; xent: 0.03; lr: 0.00156;   0/2523 tok/s;  44982 sec
[2019-12-08 01:10:48,680 INFO] Validation perplexity: 1.09683
[2019-12-08 01:10:48,681 INFO] Validation accuracy: 97.932
[2019-12-08 01:10:48,684 INFO] Saving checkpoint ../results/models/im2latex-58_step_100000.pt
