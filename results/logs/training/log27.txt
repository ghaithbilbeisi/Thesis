[2019-09-09 16:50:53,070 INFO]  * tgt vocab size = 510
[2019-09-09 16:50:53,070 INFO] Building model...
[2019-09-09 16:50:56,965 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds1): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (layer2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds2): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (layer3): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds3): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (layer4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds4): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (layer5): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds5): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (layer6): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds6): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (batch_norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(512, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 512)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-09-09 16:50:56,967 INFO] encoder: 8047424
[2019-09-09 16:50:56,967 INFO] decoder: 5214310
[2019-09-09 16:50:56,967 INFO] * number of parameters: 13261734
[2019-09-09 16:50:59,692 INFO] Starting training on GPU: [0]
[2019-09-09 16:50:59,692 INFO] Start training loop and validate every 10000 steps...
[2019-09-09 16:58:15,756 INFO] Step 500/100000; acc:  29.26; ppl: 36.57; xent: 3.60; lr: 0.10000;   0/1349 tok/s;    436 sec
[2019-09-09 17:05:04,889 INFO] Step 1000/100000; acc:  44.80; ppl: 13.19; xent: 2.58; lr: 0.10000;   0/1421 tok/s;    845 sec
[2019-09-09 17:12:14,078 INFO] Step 1500/100000; acc:  48.10; ppl: 10.64; xent: 2.36; lr: 0.10000;   0/1372 tok/s;   1274 sec
[2019-09-09 17:19:13,811 INFO] Step 2000/100000; acc:  50.66; ppl:  9.12; xent: 2.21; lr: 0.10000;   0/1396 tok/s;   1694 sec
[2019-09-09 17:26:09,352 INFO] Step 2500/100000; acc:  59.60; ppl:  5.69; xent: 1.74; lr: 0.10000;   0/1405 tok/s;   2110 sec
[2019-09-09 17:33:20,009 INFO] Step 3000/100000; acc:  79.29; ppl:  2.39; xent: 0.87; lr: 0.10000;   0/1364 tok/s;   2540 sec
[2019-09-09 17:40:21,146 INFO] Step 3500/100000; acc:  86.84; ppl:  1.74; xent: 0.56; lr: 0.10000;   0/1387 tok/s;   2961 sec
[2019-09-09 17:47:24,964 INFO] Step 4000/100000; acc:  89.55; ppl:  1.55; xent: 0.44; lr: 0.10000;   0/1387 tok/s;   3385 sec
[2019-09-09 17:54:19,724 INFO] Step 4500/100000; acc:  91.04; ppl:  1.45; xent: 0.37; lr: 0.10000;   0/1408 tok/s;   3800 sec
[2019-09-09 18:01:02,879 INFO] Step 5000/100000; acc:  92.13; ppl:  1.39; xent: 0.33; lr: 0.10000;   0/1454 tok/s;   4203 sec
[2019-09-09 18:07:59,446 INFO] Step 5500/100000; acc:  92.97; ppl:  1.34; xent: 0.29; lr: 0.10000;   0/1413 tok/s;   4620 sec
[2019-09-09 18:14:45,961 INFO] Step 6000/100000; acc:  93.53; ppl:  1.31; xent: 0.27; lr: 0.10000;   0/1439 tok/s;   5026 sec
[2019-09-09 18:21:40,484 INFO] Step 6500/100000; acc:  94.01; ppl:  1.28; xent: 0.25; lr: 0.10000;   0/1414 tok/s;   5441 sec
[2019-09-09 18:28:30,898 INFO] Step 7000/100000; acc:  94.37; ppl:  1.26; xent: 0.23; lr: 0.10000;   0/1430 tok/s;   5851 sec
[2019-09-09 18:35:18,867 INFO] Step 7500/100000; acc:  94.76; ppl:  1.24; xent: 0.21; lr: 0.10000;   0/1428 tok/s;   6259 sec
[2019-09-09 18:42:17,776 INFO] Step 8000/100000; acc:  94.89; ppl:  1.23; xent: 0.21; lr: 0.10000;   0/1408 tok/s;   6678 sec
[2019-09-09 18:49:05,404 INFO] Step 8500/100000; acc:  95.25; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/1430 tok/s;   7086 sec
[2019-09-09 18:55:51,597 INFO] Step 9000/100000; acc:  95.51; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/1440 tok/s;   7492 sec
[2019-09-09 19:02:49,106 INFO] Step 9500/100000; acc:  95.71; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/1417 tok/s;   7909 sec
[2019-09-09 19:09:35,648 INFO] Step 10000/100000; acc:  95.78; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/1432 tok/s;   8316 sec
[2019-09-09 19:13:51,248 INFO] Validation perplexity: 1.1636
[2019-09-09 19:13:51,254 INFO] Validation accuracy: 96.1169
[2019-09-09 19:13:51,256 INFO] Saving checkpoint ../results/models/im2latex-27_step_10000.pt
[2019-09-09 19:20:46,269 INFO] Step 10500/100000; acc:  95.91; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/873 tok/s;   8987 sec
[2019-09-09 19:27:37,919 INFO] Step 11000/100000; acc:  96.02; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/1425 tok/s;   9398 sec
[2019-09-09 19:34:28,902 INFO] Step 11500/100000; acc:  96.13; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/1422 tok/s;   9809 sec
[2019-09-09 19:41:30,544 INFO] Step 12000/100000; acc:  96.17; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/1393 tok/s;  10231 sec
[2019-09-09 19:48:07,842 INFO] Step 12500/100000; acc:  96.41; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/1467 tok/s;  10628 sec
[2019-09-09 19:54:57,989 INFO] Step 13000/100000; acc:  96.45; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/1426 tok/s;  11038 sec
[2019-09-09 20:01:47,762 INFO] Step 13500/100000; acc:  96.61; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1437 tok/s;  11448 sec
[2019-09-09 20:08:39,900 INFO] Step 14000/100000; acc:  96.60; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1421 tok/s;  11860 sec
[2019-09-09 20:15:34,241 INFO] Step 14500/100000; acc:  96.56; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1417 tok/s;  12275 sec
[2019-09-09 20:22:22,857 INFO] Step 15000/100000; acc:  96.70; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1427 tok/s;  12683 sec
[2019-09-09 20:29:20,483 INFO] Step 15500/100000; acc:  96.74; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1411 tok/s;  13101 sec
[2019-09-09 20:36:10,539 INFO] Step 16000/100000; acc:  96.79; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1420 tok/s;  13511 sec
[2019-09-09 20:42:51,293 INFO] Step 16500/100000; acc:  96.90; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1458 tok/s;  13912 sec
[2019-09-09 20:49:46,416 INFO] Step 17000/100000; acc:  96.98; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1422 tok/s;  14327 sec
[2019-09-09 20:56:33,862 INFO] Step 17500/100000; acc:  96.93; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/1432 tok/s;  14734 sec
[2019-09-09 21:03:29,100 INFO] Step 18000/100000; acc:  96.96; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1415 tok/s;  15149 sec
[2019-09-09 21:10:19,976 INFO] Step 18500/100000; acc:  97.02; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1428 tok/s;  15560 sec
[2019-09-09 21:17:07,337 INFO] Step 19000/100000; acc:  97.07; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1429 tok/s;  15968 sec
[2019-09-09 21:24:09,677 INFO] Step 19500/100000; acc:  97.09; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1397 tok/s;  16390 sec
[2019-09-09 21:30:50,691 INFO] Step 20000/100000; acc:  97.17; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1452 tok/s;  16791 sec
[2019-09-09 21:34:57,796 INFO] Validation perplexity: 1.1364
[2019-09-09 21:34:57,796 INFO] Validation accuracy: 96.6278
[2019-09-09 21:34:57,799 INFO] Saving checkpoint ../results/models/im2latex-27_step_20000.pt
[2019-09-09 21:41:49,253 INFO] Step 20500/100000; acc:  97.21; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/892 tok/s;  17450 sec
[2019-09-09 21:48:44,196 INFO] Step 21000/100000; acc:  97.30; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1421 tok/s;  17865 sec
[2019-09-09 21:55:30,084 INFO] Step 21500/100000; acc:  97.27; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1437 tok/s;  18270 sec
[2019-09-09 22:02:21,900 INFO] Step 22000/100000; acc:  97.25; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1420 tok/s;  18682 sec
[2019-09-09 22:09:13,227 INFO] Step 22500/100000; acc:  97.26; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1425 tok/s;  19094 sec
[2019-09-09 22:16:08,038 INFO] Step 23000/100000; acc:  97.34; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1416 tok/s;  19508 sec
[2019-09-09 22:23:04,341 INFO] Step 23500/100000; acc:  97.36; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1405 tok/s;  19925 sec
[2019-09-09 22:29:44,808 INFO] Step 24000/100000; acc:  97.41; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1458 tok/s;  20325 sec
[2019-09-09 22:36:36,915 INFO] Step 24500/100000; acc:  97.45; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1422 tok/s;  20737 sec
[2019-09-09 22:43:24,281 INFO] Step 25000/100000; acc:  97.53; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1438 tok/s;  21145 sec
[2019-09-09 22:50:20,301 INFO] Step 25500/100000; acc:  97.50; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1412 tok/s;  21561 sec
[2019-09-09 22:57:13,980 INFO] Step 26000/100000; acc:  97.43; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1419 tok/s;  21974 sec
[2019-09-09 23:04:01,806 INFO] Step 26500/100000; acc:  97.53; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1426 tok/s;  22382 sec
[2019-09-09 23:10:59,221 INFO] Step 27000/100000; acc:  97.46; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1414 tok/s;  22800 sec
[2019-09-09 23:17:47,843 INFO] Step 27500/100000; acc:  97.59; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1426 tok/s;  23208 sec
[2019-09-09 23:24:31,240 INFO] Step 28000/100000; acc:  97.59; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1452 tok/s;  23612 sec
[2019-09-09 23:31:26,596 INFO] Step 28500/100000; acc:  97.68; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1421 tok/s;  24027 sec
[2019-09-09 23:38:13,584 INFO] Step 29000/100000; acc:  97.62; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1431 tok/s;  24434 sec
[2019-09-09 23:45:04,951 INFO] Step 29500/100000; acc:  97.67; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1428 tok/s;  24845 sec
[2019-09-09 23:52:00,657 INFO] Step 30000/100000; acc:  97.60; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1411 tok/s;  25261 sec
[2019-09-09 23:56:07,980 INFO] Validation perplexity: 1.09691
[2019-09-09 23:56:07,981 INFO] Validation accuracy: 97.6282
[2019-09-09 23:56:07,984 INFO] Saving checkpoint ../results/models/im2latex-27_step_30000.pt
[2019-09-10 00:02:55,825 INFO] Step 30500/100000; acc:  97.70; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/889 tok/s;  25916 sec
[2019-09-10 00:09:56,857 INFO] Step 31000/100000; acc:  97.70; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1400 tok/s;  26337 sec
[2019-09-10 00:16:36,362 INFO] Step 31500/100000; acc:  97.74; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1455 tok/s;  26737 sec
[2019-09-10 00:23:31,573 INFO] Step 32000/100000; acc:  97.76; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1417 tok/s;  27152 sec
[2019-09-10 00:30:22,674 INFO] Step 32500/100000; acc:  97.77; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1430 tok/s;  27563 sec
[2019-09-10 00:37:07,033 INFO] Step 33000/100000; acc:  97.77; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1445 tok/s;  27967 sec
[2019-09-10 00:44:01,786 INFO] Step 33500/100000; acc:  97.76; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1410 tok/s;  28382 sec
[2019-09-10 00:50:51,490 INFO] Step 34000/100000; acc:  97.75; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1429 tok/s;  28792 sec
[2019-09-10 00:57:47,194 INFO] Step 34500/100000; acc:  97.81; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1412 tok/s;  29208 sec
[2019-09-10 01:04:42,079 INFO] Step 35000/100000; acc:  97.75; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1410 tok/s;  29622 sec
[2019-09-10 01:11:23,280 INFO] Step 35500/100000; acc:  97.85; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1460 tok/s;  30024 sec
[2019-09-10 01:18:15,428 INFO] Step 36000/100000; acc:  97.84; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1421 tok/s;  30436 sec
[2019-09-10 01:25:01,880 INFO] Step 36500/100000; acc:  97.86; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1441 tok/s;  30842 sec
[2019-09-10 01:31:57,794 INFO] Step 37000/100000; acc:  97.89; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1411 tok/s;  31258 sec
[2019-09-10 01:38:51,408 INFO] Step 37500/100000; acc:  97.81; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1416 tok/s;  31672 sec
[2019-09-10 01:45:41,648 INFO] Step 38000/100000; acc:  97.88; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1422 tok/s;  32082 sec
[2019-09-10 01:52:39,639 INFO] Step 38500/100000; acc:  97.83; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1414 tok/s;  32500 sec
[2019-09-10 01:59:29,473 INFO] Step 39000/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1422 tok/s;  32910 sec
[2019-09-10 02:06:13,368 INFO] Step 39500/100000; acc:  97.92; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1446 tok/s;  33314 sec
[2019-09-10 02:13:14,320 INFO] Step 40000/100000; acc:  97.97; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1406 tok/s;  33735 sec
[2019-09-10 02:17:20,631 INFO] Validation perplexity: 1.09235
[2019-09-10 02:17:20,632 INFO] Validation accuracy: 97.7501
[2019-09-10 02:17:20,635 INFO] Saving checkpoint ../results/models/im2latex-27_step_40000.pt
[2019-09-10 02:24:10,254 INFO] Step 40500/100000; acc:  97.99; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/889 tok/s;  34391 sec
[2019-09-10 02:31:02,173 INFO] Step 41000/100000; acc:  97.99; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1423 tok/s;  34802 sec
[2019-09-10 02:37:54,074 INFO] Step 41500/100000; acc:  97.94; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1423 tok/s;  35214 sec
[2019-09-10 02:44:41,974 INFO] Step 42000/100000; acc:  97.96; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1430 tok/s;  35622 sec
[2019-09-10 02:51:44,031 INFO] Step 42500/100000; acc:  97.98; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1395 tok/s;  36044 sec
[2019-09-10 02:58:20,836 INFO] Step 43000/100000; acc:  98.02; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1465 tok/s;  36441 sec
[2019-09-10 03:05:13,306 INFO] Step 43500/100000; acc:  98.04; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1422 tok/s;  36854 sec
[2019-09-10 03:12:05,201 INFO] Step 44000/100000; acc:  98.04; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1432 tok/s;  37266 sec
[2019-09-10 03:18:54,723 INFO] Step 44500/100000; acc:  98.07; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1428 tok/s;  37675 sec
[2019-09-10 03:25:49,270 INFO] Step 45000/100000; acc:  98.04; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1416 tok/s;  38090 sec
[2019-09-10 03:32:36,577 INFO] Step 45500/100000; acc:  98.02; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1433 tok/s;  38497 sec
[2019-09-10 03:39:34,172 INFO] Step 46000/100000; acc:  98.03; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1410 tok/s;  38914 sec
[2019-09-10 03:46:22,804 INFO] Step 46500/100000; acc:  98.07; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1428 tok/s;  39323 sec
[2019-09-10 03:53:05,323 INFO] Step 47000/100000; acc:  98.09; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1453 tok/s;  39726 sec
[2019-09-10 04:00:00,653 INFO] Step 47500/100000; acc:  98.14; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1410 tok/s;  40141 sec
[2019-09-10 04:06:46,511 INFO] Step 48000/100000; acc:  98.09; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1441 tok/s;  40547 sec
[2019-09-10 04:13:41,287 INFO] Step 48500/100000; acc:  98.12; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1414 tok/s;  40962 sec
[2019-09-10 04:20:31,458 INFO] Step 49000/100000; acc:  98.08; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1429 tok/s;  41372 sec
[2019-09-10 04:27:19,799 INFO] Step 49500/100000; acc:  98.13; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1428 tok/s;  41780 sec
[2019-09-10 04:34:19,308 INFO] Step 50000/100000; acc:  98.10; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/1406 tok/s;  42200 sec
[2019-09-10 04:38:26,568 INFO] Validation perplexity: 1.08895
[2019-09-10 04:38:26,569 INFO] Validation accuracy: 97.8556
[2019-09-10 04:38:26,571 INFO] Saving checkpoint ../results/models/im2latex-27_step_50000.pt
[2019-09-10 04:45:13,710 INFO] Step 50500/100000; acc:  98.29; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/890 tok/s;  42854 sec
[2019-09-10 04:51:59,938 INFO] Step 51000/100000; acc:  98.39; ppl:  1.06; xent: 0.05; lr: 0.05000;   0/1443 tok/s;  43260 sec
[2019-09-10 04:58:54,888 INFO] Step 51500/100000; acc:  98.40; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1428 tok/s;  43675 sec
[2019-09-10 05:05:36,665 INFO] Step 52000/100000; acc:  98.44; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1450 tok/s;  44077 sec
[2019-09-10 05:12:32,186 INFO] Step 52500/100000; acc:  98.43; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1409 tok/s;  44492 sec
[2019-09-10 05:19:21,593 INFO] Step 53000/100000; acc:  98.46; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1430 tok/s;  44902 sec
[2019-09-10 05:26:10,919 INFO] Step 53500/100000; acc:  98.48; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1429 tok/s;  45311 sec
[2019-09-10 05:33:08,416 INFO] Step 54000/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1407 tok/s;  45729 sec
[2019-09-10 05:39:44,801 INFO] Step 54500/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1471 tok/s;  46125 sec
[2019-09-10 05:46:35,053 INFO] Step 55000/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1428 tok/s;  46535 sec
[2019-09-10 05:53:23,252 INFO] Step 55500/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1441 tok/s;  46944 sec
[2019-09-10 06:00:12,765 INFO] Step 56000/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1431 tok/s;  47353 sec
[2019-09-10 06:07:06,961 INFO] Step 56500/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1417 tok/s;  47767 sec
[2019-09-10 06:13:52,815 INFO] Step 57000/100000; acc:  98.57; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1436 tok/s;  48173 sec
[2019-09-10 06:20:49,125 INFO] Step 57500/100000; acc:  98.58; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1418 tok/s;  48589 sec
[2019-09-10 06:27:38,303 INFO] Step 58000/100000; acc:  98.60; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1423 tok/s;  48999 sec
[2019-09-10 06:34:19,147 INFO] Step 58500/100000; acc:  98.58; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1457 tok/s;  49399 sec
[2019-09-10 06:41:11,200 INFO] Step 59000/100000; acc:  98.63; ppl:  1.05; xent: 0.04; lr: 0.05000;   0/1427 tok/s;  49812 sec
[2019-09-10 06:47:56,181 INFO] Step 59500/100000; acc:  98.60; ppl:  1.05; xent: 0.04; lr: 0.05000;   0/1438 tok/s;  50216 sec
[2019-09-10 06:54:50,977 INFO] Step 60000/100000; acc:  98.63; ppl:  1.05; xent: 0.04; lr: 0.02500;   0/1418 tok/s;  50631 sec
[2019-09-10 06:58:54,634 INFO] Validation perplexity: 1.08156
[2019-09-10 06:58:54,634 INFO] Validation accuracy: 98.082
[2019-09-10 06:58:54,637 INFO] Saving checkpoint ../results/models/im2latex-27_step_60000.pt
[2019-09-10 07:05:48,475 INFO] Step 60500/100000; acc:  98.62; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/893 tok/s;  51289 sec
[2019-09-10 07:12:32,838 INFO] Step 61000/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1440 tok/s;  51693 sec
[2019-09-10 07:19:39,386 INFO] Step 61500/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1383 tok/s;  52120 sec
[2019-09-10 07:26:21,781 INFO] Step 62000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1445 tok/s;  52522 sec
[2019-09-10 07:33:10,621 INFO] Step 62500/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1437 tok/s;  52931 sec
[2019-09-10 07:40:03,942 INFO] Step 63000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1429 tok/s;  53344 sec
[2019-09-10 07:46:47,080 INFO] Step 63500/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1447 tok/s;  53747 sec
[2019-09-10 07:53:38,446 INFO] Step 64000/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1423 tok/s;  54159 sec
[2019-09-10 08:00:28,908 INFO] Step 64500/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1428 tok/s;  54569 sec
[2019-09-10 08:07:21,864 INFO] Step 65000/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1421 tok/s;  54982 sec
[2019-09-10 08:14:16,280 INFO] Step 65500/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1412 tok/s;  55397 sec
[2019-09-10 08:20:57,077 INFO] Step 66000/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1459 tok/s;  55797 sec
[2019-09-10 08:27:44,665 INFO] Step 66500/100000; acc:  98.80; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1439 tok/s;  56205 sec
[2019-09-10 08:34:32,189 INFO] Step 67000/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1438 tok/s;  56612 sec
[2019-09-10 08:41:24,723 INFO] Step 67500/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1423 tok/s;  57025 sec
[2019-09-10 08:48:15,863 INFO] Step 68000/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1425 tok/s;  57436 sec
[2019-09-10 08:55:02,697 INFO] Step 68500/100000; acc:  98.80; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1432 tok/s;  57843 sec
[2019-09-10 09:01:57,083 INFO] Step 69000/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1425 tok/s;  58257 sec
[2019-09-10 09:08:45,659 INFO] Step 69500/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1429 tok/s;  58666 sec
[2019-09-10 09:15:26,727 INFO] Step 70000/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1458 tok/s;  59067 sec
[2019-09-10 09:19:33,341 INFO] Validation perplexity: 1.07989
[2019-09-10 09:19:33,342 INFO] Validation accuracy: 98.1576
[2019-09-10 09:19:33,345 INFO] Saving checkpoint ../results/models/im2latex-27_step_70000.pt
[2019-09-10 09:26:24,293 INFO] Step 70500/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/895 tok/s;  59725 sec
[2019-09-10 09:33:09,585 INFO] Step 71000/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1439 tok/s;  60130 sec
[2019-09-10 09:40:00,714 INFO] Step 71500/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1428 tok/s;  60541 sec
[2019-09-10 09:46:51,182 INFO] Step 72000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1428 tok/s;  60951 sec
[2019-09-10 09:53:34,559 INFO] Step 72500/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1444 tok/s;  61355 sec
[2019-09-10 10:00:33,205 INFO] Step 73000/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/1406 tok/s;  61774 sec
[2019-09-10 10:07:09,856 INFO] Step 73500/100000; acc:  98.87; ppl:  1.04; xent: 0.03; lr: 0.01250;   0/1465 tok/s;  62170 sec
[2019-09-10 10:14:03,409 INFO] Step 74000/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.01250;   0/1424 tok/s;  62584 sec
[2019-09-10 10:20:52,204 INFO] Step 74500/100000; acc:  98.87; ppl:  1.04; xent: 0.03; lr: 0.01250;   0/1439 tok/s;  62993 sec
[2019-09-10 10:27:36,732 INFO] Step 75000/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/1443 tok/s;  63397 sec
[2019-09-10 10:34:30,554 INFO] Step 75500/100000; acc:  98.89; ppl:  1.04; xent: 0.03; lr: 0.01250;   0/1415 tok/s;  63811 sec
[2019-09-10 10:41:19,072 INFO] Step 76000/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1432 tok/s;  64219 sec
[2019-09-10 10:48:12,311 INFO] Step 76500/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/1422 tok/s;  64633 sec
[2019-09-10 10:55:04,674 INFO] Step 77000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/1418 tok/s;  65045 sec
[2019-09-10 11:01:55,554 INFO] Step 77500/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/1425 tok/s;  65456 sec
[2019-09-10 11:09:02,157 INFO] Step 78000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/1378 tok/s;  65882 sec
[2019-09-10 11:16:01,293 INFO] Step 78500/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/1396 tok/s;  66302 sec
[2019-09-10 11:23:09,810 INFO] Step 79000/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/1368 tok/s;  66730 sec
[2019-09-10 11:30:18,400 INFO] Step 79500/100000; acc:  98.88; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/1370 tok/s;  67159 sec
[2019-09-10 11:37:21,745 INFO] Step 80000/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1375 tok/s;  67582 sec
[2019-09-10 11:41:30,166 INFO] Validation perplexity: 1.08037
[2019-09-10 11:41:30,167 INFO] Validation accuracy: 98.1815
[2019-09-10 11:41:30,171 INFO] Saving checkpoint ../results/models/im2latex-27_step_80000.pt
[2019-09-10 11:48:44,500 INFO] Step 80500/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/866 tok/s;  68265 sec
[2019-09-10 11:55:46,161 INFO] Step 81000/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1382 tok/s;  68686 sec
[2019-09-10 12:02:46,188 INFO] Step 81500/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1389 tok/s;  69106 sec
[2019-09-10 12:10:00,905 INFO] Step 82000/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1361 tok/s;  69541 sec
[2019-09-10 12:17:04,601 INFO] Step 82500/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1376 tok/s;  69965 sec
[2019-09-10 12:24:13,866 INFO] Step 83000/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1364 tok/s;  70394 sec
[2019-09-10 12:31:22,648 INFO] Step 83500/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1366 tok/s;  70823 sec
[2019-09-10 12:38:26,997 INFO] Step 84000/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1376 tok/s;  71247 sec
[2019-09-10 12:45:48,829 INFO] Step 84500/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1333 tok/s;  71689 sec
[2019-09-10 12:52:43,779 INFO] Step 85000/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1401 tok/s;  72104 sec
[2019-09-10 12:59:53,871 INFO] Step 85500/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1365 tok/s;  72534 sec
[2019-09-10 13:07:02,766 INFO] Step 86000/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1372 tok/s;  72963 sec
[2019-09-10 13:14:11,817 INFO] Step 86500/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1362 tok/s;  73392 sec
[2019-09-10 13:21:28,575 INFO] Step 87000/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1344 tok/s;  73829 sec
[2019-09-10 13:28:34,313 INFO] Step 87500/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1372 tok/s;  74255 sec
[2019-09-10 13:35:51,904 INFO] Step 88000/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1345 tok/s;  74692 sec
[2019-09-10 13:43:00,455 INFO] Step 88500/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1361 tok/s;  75121 sec
[2019-09-10 13:50:03,171 INFO] Step 89000/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1385 tok/s;  75543 sec
[2019-09-10 13:57:22,848 INFO] Step 89500/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1340 tok/s;  75983 sec
[2019-09-10 14:04:30,569 INFO] Step 90000/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1366 tok/s;  76411 sec
[2019-09-10 14:08:42,479 INFO] Validation perplexity: 1.08048
[2019-09-10 14:08:42,480 INFO] Validation accuracy: 98.1984
[2019-09-10 14:08:42,484 INFO] Saving checkpoint ../results/models/im2latex-27_step_90000.pt
[2019-09-10 14:15:55,492 INFO] Step 90500/100000; acc:  98.99; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/856 tok/s;  77096 sec
[2019-09-10 14:23:08,263 INFO] Step 91000/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1356 tok/s;  77529 sec
[2019-09-10 14:30:12,046 INFO] Step 91500/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1374 tok/s;  77952 sec
[2019-09-10 14:37:12,845 INFO] Step 92000/100000; acc:  98.98; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1402 tok/s;  78373 sec
[2019-09-10 14:43:55,180 INFO] Step 92500/100000; acc:  98.98; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1448 tok/s;  78775 sec
[2019-09-10 14:50:43,957 INFO] Step 93000/100000; acc:  98.99; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1436 tok/s;  79184 sec
[2019-09-10 14:57:37,204 INFO] Step 93500/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1428 tok/s;  79598 sec
[2019-09-10 15:04:20,101 INFO] Step 94000/100000; acc:  99.03; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1445 tok/s;  80000 sec
[2019-09-10 15:11:13,202 INFO] Step 94500/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1418 tok/s;  80414 sec
[2019-09-10 15:18:02,665 INFO] Step 95000/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1430 tok/s;  80823 sec
[2019-09-10 15:24:51,772 INFO] Step 95500/100000; acc:  99.00; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1432 tok/s;  81232 sec
[2019-09-10 15:31:48,799 INFO] Step 96000/100000; acc:  98.99; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1406 tok/s;  81649 sec
[2019-09-10 15:38:24,032 INFO] Step 96500/100000; acc:  98.98; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1475 tok/s;  82044 sec
[2019-09-10 15:45:12,997 INFO] Step 97000/100000; acc:  98.98; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1433 tok/s;  82453 sec
[2019-09-10 15:52:05,496 INFO] Step 97500/100000; acc:  98.99; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1424 tok/s;  82866 sec
[2019-09-10 15:59:00,529 INFO] Step 98000/100000; acc:  99.01; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1414 tok/s;  83281 sec
[2019-09-10 16:05:59,266 INFO] Step 98500/100000; acc:  98.98; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1403 tok/s;  83700 sec
[2019-09-10 16:12:49,008 INFO] Step 99000/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1421 tok/s;  84109 sec
[2019-09-10 16:19:46,299 INFO] Step 99500/100000; acc:  98.98; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1414 tok/s;  84527 sec
[2019-09-10 16:26:35,812 INFO] Step 100000/100000; acc:  98.99; ppl:  1.03; xent: 0.03; lr: 0.00156;   0/1424 tok/s;  84936 sec
[2019-09-10 16:30:42,480 INFO] Validation perplexity: 1.08136
[2019-09-10 16:30:42,481 INFO] Validation accuracy: 98.1843
[2019-09-10 16:30:42,484 INFO] Saving checkpoint ../results/models/im2latex-27_step_100000.pt
