[2019-10-04 15:50:24,354 INFO]  * tgt vocab size = 510
[2019-10-04 15:50:24,355 INFO] Building model...
[2019-10-04 15:50:28,254 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds1): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (layer2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds2): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (layer3): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds3): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (layer4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds4): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (layer5): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds5): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (layer6): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds6): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (batch_norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(512, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 512)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-10-04 15:50:28,255 INFO] encoder: 8047424
[2019-10-04 15:50:28,255 INFO] decoder: 5214310
[2019-10-04 15:50:28,255 INFO] * number of parameters: 13261734
[2019-10-04 15:50:29,506 INFO] Starting training on GPU: [0]
[2019-10-04 15:50:29,507 INFO] Start training loop and validate every 10000 steps...
[2019-10-04 15:53:24,047 INFO] Step 500/100000; acc:  28.69; ppl: 39.39; xent: 3.67; lr: 0.10000;   0/3372 tok/s;    175 sec
[2019-10-04 15:56:11,293 INFO] Step 1000/100000; acc:  44.78; ppl: 13.21; xent: 2.58; lr: 0.10000;   0/3475 tok/s;    342 sec
[2019-10-04 15:59:02,319 INFO] Step 1500/100000; acc:  48.78; ppl: 10.26; xent: 2.33; lr: 0.10000;   0/3444 tok/s;    513 sec
[2019-10-04 16:01:52,802 INFO] Step 2000/100000; acc:  55.55; ppl:  6.94; xent: 1.94; lr: 0.10000;   0/3438 tok/s;    683 sec
[2019-10-04 16:04:43,018 INFO] Step 2500/100000; acc:  72.54; ppl:  3.19; xent: 1.16; lr: 0.10000;   0/3433 tok/s;    854 sec
[2019-10-04 16:07:34,664 INFO] Step 3000/100000; acc:  82.26; ppl:  2.12; xent: 0.75; lr: 0.10000;   0/3418 tok/s;   1025 sec
[2019-10-04 16:10:24,816 INFO] Step 3500/100000; acc:  86.42; ppl:  1.77; xent: 0.57; lr: 0.10000;   0/3436 tok/s;   1195 sec
[2019-10-04 16:13:18,597 INFO] Step 4000/100000; acc:  88.63; ppl:  1.61; xent: 0.48; lr: 0.10000;   0/3385 tok/s;   1369 sec
[2019-10-04 16:16:10,522 INFO] Step 4500/100000; acc:  90.02; ppl:  1.51; xent: 0.41; lr: 0.10000;   0/3392 tok/s;   1541 sec
[2019-10-04 16:18:59,786 INFO] Step 5000/100000; acc:  91.06; ppl:  1.44; xent: 0.37; lr: 0.10000;   0/3463 tok/s;   1710 sec
[2019-10-04 16:21:53,832 INFO] Step 5500/100000; acc:  91.88; ppl:  1.39; xent: 0.33; lr: 0.10000;   0/3376 tok/s;   1884 sec
[2019-10-04 16:24:53,847 INFO] Step 6000/100000; acc:  92.52; ppl:  1.36; xent: 0.31; lr: 0.10000;   0/3251 tok/s;   2064 sec
[2019-10-04 16:27:55,546 INFO] Step 6500/100000; acc:  93.09; ppl:  1.32; xent: 0.28; lr: 0.10000;   0/3226 tok/s;   2246 sec
[2019-10-04 16:30:55,510 INFO] Step 7000/100000; acc:  93.51; ppl:  1.30; xent: 0.26; lr: 0.10000;   0/3257 tok/s;   2426 sec
[2019-10-04 16:33:52,255 INFO] Step 7500/100000; acc:  93.98; ppl:  1.27; xent: 0.24; lr: 0.10000;   0/3298 tok/s;   2603 sec
[2019-10-04 16:36:44,710 INFO] Step 8000/100000; acc:  94.13; ppl:  1.26; xent: 0.23; lr: 0.10000;   0/3423 tok/s;   2775 sec
[2019-10-04 16:39:33,746 INFO] Step 8500/100000; acc:  94.63; ppl:  1.24; xent: 0.21; lr: 0.10000;   0/3446 tok/s;   2944 sec
[2019-10-04 16:42:22,601 INFO] Step 9000/100000; acc:  94.89; ppl:  1.23; xent: 0.20; lr: 0.10000;   0/3467 tok/s;   3113 sec
[2019-10-04 16:45:13,792 INFO] Step 9500/100000; acc:  95.10; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/3454 tok/s;   3284 sec
[2019-10-04 16:48:02,430 INFO] Step 10000/100000; acc:  95.14; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/3452 tok/s;   3453 sec
[2019-10-04 16:49:22,624 INFO] Validation perplexity: 1.19508
[2019-10-04 16:49:22,624 INFO] Validation accuracy: 95.513
[2019-10-04 16:49:22,627 INFO] Saving checkpoint ../results/models/im2latex-27_step_10000.pt
[2019-10-04 16:52:16,072 INFO] Step 10500/100000; acc:  95.27; ppl:  1.20; xent: 0.19; lr: 0.10000;   0/2309 tok/s;   3707 sec
[2019-10-04 16:55:10,600 INFO] Step 11000/100000; acc:  95.43; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/3362 tok/s;   3881 sec
[2019-10-04 16:58:07,025 INFO] Step 11500/100000; acc:  95.60; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/3313 tok/s;   4058 sec
[2019-10-04 17:01:00,403 INFO] Step 12000/100000; acc:  95.63; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/3388 tok/s;   4231 sec
[2019-10-04 17:03:52,812 INFO] Step 12500/100000; acc:  95.87; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/3380 tok/s;   4403 sec
[2019-10-04 17:06:50,203 INFO] Step 13000/100000; acc:  95.95; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/3305 tok/s;   4581 sec
[2019-10-04 17:09:40,577 INFO] Step 13500/100000; acc:  96.06; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/3457 tok/s;   4751 sec
[2019-10-04 17:12:39,295 INFO] Step 14000/100000; acc:  96.09; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/3274 tok/s;   4930 sec
[2019-10-04 17:15:40,206 INFO] Step 14500/100000; acc:  96.08; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/3248 tok/s;   5111 sec
[2019-10-04 17:18:38,475 INFO] Step 15000/100000; acc:  96.22; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/3272 tok/s;   5289 sec
[2019-10-04 17:21:39,819 INFO] Step 15500/100000; acc:  96.31; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/3250 tok/s;   5470 sec
[2019-10-04 17:24:37,052 INFO] Step 16000/100000; acc:  96.41; ppl:  1.14; xent: 0.14; lr: 0.10000;   0/3286 tok/s;   5648 sec
[2019-10-04 17:27:25,558 INFO] Step 16500/100000; acc:  96.48; ppl:  1.14; xent: 0.14; lr: 0.10000;   0/3466 tok/s;   5816 sec
[2019-10-04 17:30:18,541 INFO] Step 17000/100000; acc:  96.53; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/3409 tok/s;   5989 sec
[2019-10-04 17:33:08,832 INFO] Step 17500/100000; acc:  96.57; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/3423 tok/s;   6159 sec
[2019-10-04 17:36:00,535 INFO] Step 18000/100000; acc:  96.61; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/3423 tok/s;   6331 sec
[2019-10-04 17:38:52,242 INFO] Step 18500/100000; acc:  96.63; ppl:  1.13; xent: 0.13; lr: 0.10000;   0/3419 tok/s;   6503 sec
[2019-10-04 17:41:40,637 INFO] Step 19000/100000; acc:  96.69; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/3458 tok/s;   6671 sec
[2019-10-04 17:44:35,175 INFO] Step 19500/100000; acc:  96.72; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/3379 tok/s;   6846 sec
[2019-10-04 17:47:23,844 INFO] Step 20000/100000; acc:  96.83; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/3450 tok/s;   7014 sec
[2019-10-04 17:48:44,096 INFO] Validation perplexity: 1.12556
[2019-10-04 17:48:44,097 INFO] Validation accuracy: 96.9515
[2019-10-04 17:48:44,099 INFO] Saving checkpoint ../results/models/im2latex-27_step_20000.pt
[2019-10-04 17:51:35,236 INFO] Step 20500/100000; acc:  96.88; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/2337 tok/s;   7266 sec
[2019-10-04 17:54:25,353 INFO] Step 21000/100000; acc:  96.96; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3462 tok/s;   7436 sec
[2019-10-04 17:57:14,685 INFO] Step 21500/100000; acc:  96.95; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3443 tok/s;   7605 sec
[2019-10-04 18:00:05,738 INFO] Step 22000/100000; acc:  96.90; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3418 tok/s;   7776 sec
[2019-10-04 18:02:55,769 INFO] Step 22500/100000; acc:  96.97; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3446 tok/s;   7946 sec
[2019-10-04 18:05:47,554 INFO] Step 23000/100000; acc:  97.02; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3420 tok/s;   8118 sec
[2019-10-04 18:08:39,085 INFO] Step 23500/100000; acc:  97.04; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/3411 tok/s;   8290 sec
[2019-10-04 18:11:31,669 INFO] Step 24000/100000; acc:  97.07; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/3382 tok/s;   8462 sec
[2019-10-04 18:14:29,398 INFO] Step 24500/100000; acc:  97.15; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/3306 tok/s;   8640 sec
[2019-10-04 18:17:21,049 INFO] Step 25000/100000; acc:  97.22; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/3414 tok/s;   8812 sec
[2019-10-04 18:20:21,060 INFO] Step 25500/100000; acc:  97.18; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/3266 tok/s;   8992 sec
[2019-10-04 18:23:21,263 INFO] Step 26000/100000; acc:  97.14; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/3253 tok/s;   9172 sec
[2019-10-04 18:26:11,508 INFO] Step 26500/100000; acc:  97.24; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/3422 tok/s;   9342 sec
[2019-10-04 18:29:04,562 INFO] Step 27000/100000; acc:  97.15; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/3408 tok/s;   9515 sec
[2019-10-04 18:31:55,845 INFO] Step 27500/100000; acc:  97.31; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/3401 tok/s;   9686 sec
[2019-10-04 18:34:45,049 INFO] Step 28000/100000; acc:  97.27; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/3460 tok/s;   9856 sec
[2019-10-04 18:37:35,826 INFO] Step 28500/100000; acc:  97.36; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/3456 tok/s;  10026 sec
[2019-10-04 18:40:25,114 INFO] Step 29000/100000; acc:  97.34; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/3444 tok/s;  10196 sec
[2019-10-04 18:43:16,378 INFO] Step 29500/100000; acc:  97.38; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/3430 tok/s;  10367 sec
[2019-10-04 18:46:06,448 INFO] Step 30000/100000; acc:  97.37; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/3445 tok/s;  10537 sec
[2019-10-04 18:47:26,837 INFO] Validation perplexity: 1.10833
[2019-10-04 18:47:26,838 INFO] Validation accuracy: 97.3375
[2019-10-04 18:47:26,840 INFO] Saving checkpoint ../results/models/im2latex-27_step_30000.pt
[2019-10-04 18:50:16,024 INFO] Step 30500/100000; acc:  97.42; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/2334 tok/s;  10787 sec
[2019-10-04 18:53:08,824 INFO] Step 31000/100000; acc:  97.39; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/3407 tok/s;  10959 sec
[2019-10-04 18:55:55,912 INFO] Step 31500/100000; acc:  97.44; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/3482 tok/s;  11126 sec
[2019-10-04 18:58:46,620 INFO] Step 32000/100000; acc:  97.53; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3447 tok/s;  11297 sec
[2019-10-04 19:01:36,691 INFO] Step 32500/100000; acc:  97.50; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3454 tok/s;  11467 sec
[2019-10-04 19:04:27,144 INFO] Step 33000/100000; acc:  97.53; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3429 tok/s;  11638 sec
[2019-10-04 19:07:18,747 INFO] Step 33500/100000; acc:  97.52; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3408 tok/s;  11809 sec
[2019-10-04 19:10:08,333 INFO] Step 34000/100000; acc:  97.51; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3451 tok/s;  11979 sec
[2019-10-04 19:13:00,327 INFO] Step 34500/100000; acc:  97.58; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3413 tok/s;  12151 sec
[2019-10-04 19:15:54,346 INFO] Step 35000/100000; acc:  97.54; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3362 tok/s;  12325 sec
[2019-10-04 19:18:43,031 INFO] Step 35500/100000; acc:  97.60; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3472 tok/s;  12494 sec
[2019-10-04 19:21:35,343 INFO] Step 36000/100000; acc:  97.63; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3410 tok/s;  12666 sec
[2019-10-04 19:24:25,563 INFO] Step 36500/100000; acc:  97.64; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3443 tok/s;  12836 sec
[2019-10-04 19:27:18,385 INFO] Step 37000/100000; acc:  97.68; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3396 tok/s;  13009 sec
[2019-10-04 19:30:09,125 INFO] Step 37500/100000; acc:  97.61; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3427 tok/s;  13180 sec
[2019-10-04 19:32:59,650 INFO] Step 38000/100000; acc:  97.64; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3425 tok/s;  13350 sec
[2019-10-04 19:35:52,771 INFO] Step 38500/100000; acc:  97.59; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3410 tok/s;  13523 sec
[2019-10-04 19:38:43,492 INFO] Step 39000/100000; acc:  97.71; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3413 tok/s;  13694 sec
[2019-10-04 19:41:31,623 INFO] Step 39500/100000; acc:  97.71; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3475 tok/s;  13862 sec
[2019-10-04 19:44:52,619 INFO] Step 40000/100000; acc:  97.75; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/2938 tok/s;  14063 sec
[2019-10-04 19:46:42,370 INFO] Validation perplexity: 1.10439
[2019-10-04 19:46:42,371 INFO] Validation accuracy: 97.4724
[2019-10-04 19:46:42,373 INFO] Saving checkpoint ../results/models/im2latex-27_step_40000.pt
[2019-10-04 19:50:23,092 INFO] Step 40500/100000; acc:  97.76; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1762 tok/s;  14394 sec
[2019-10-04 19:54:05,335 INFO] Step 41000/100000; acc:  97.74; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/2638 tok/s;  14616 sec
[2019-10-04 19:57:46,510 INFO] Step 41500/100000; acc:  97.73; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/2649 tok/s;  14837 sec
[2019-10-04 20:01:24,595 INFO] Step 42000/100000; acc:  97.81; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/2677 tok/s;  15055 sec
[2019-10-04 20:05:08,239 INFO] Step 42500/100000; acc:  97.75; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/2633 tok/s;  15279 sec
[2019-10-04 20:08:45,310 INFO] Step 43000/100000; acc:  97.82; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/2678 tok/s;  15496 sec
[2019-10-04 20:12:25,240 INFO] Step 43500/100000; acc:  97.82; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/2677 tok/s;  15716 sec
[2019-10-04 20:16:04,553 INFO] Step 44000/100000; acc:  97.82; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/2673 tok/s;  15935 sec
[2019-10-04 20:19:45,235 INFO] Step 44500/100000; acc:  97.86; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/2649 tok/s;  16156 sec
[2019-10-04 20:23:25,443 INFO] Step 45000/100000; acc:  97.80; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/2665 tok/s;  16376 sec
[2019-10-04 20:27:05,228 INFO] Step 45500/100000; acc:  97.81; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/2657 tok/s;  16596 sec
[2019-10-04 20:30:46,118 INFO] Step 46000/100000; acc:  97.84; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/2665 tok/s;  16817 sec
[2019-10-04 20:34:24,691 INFO] Step 46500/100000; acc:  97.88; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/2669 tok/s;  17035 sec
[2019-10-04 20:37:59,820 INFO] Step 47000/100000; acc:  97.88; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/2722 tok/s;  17250 sec
[2019-10-04 20:41:41,724 INFO] Step 47500/100000; acc:  97.90; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/2657 tok/s;  17472 sec
[2019-10-04 20:45:21,264 INFO] Step 48000/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/2665 tok/s;  17692 sec
[2019-10-04 20:49:00,661 INFO] Step 48500/100000; acc:  97.94; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/2674 tok/s;  17911 sec
[2019-10-04 20:52:39,508 INFO] Step 49000/100000; acc:  97.92; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/2679 tok/s;  18130 sec
[2019-10-04 20:56:16,477 INFO] Step 49500/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/2687 tok/s;  18347 sec
[2019-10-04 20:59:57,759 INFO] Step 50000/100000; acc:  97.92; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/2664 tok/s;  18568 sec
[2019-10-04 21:01:50,087 INFO] Validation perplexity: 1.09879
[2019-10-04 21:01:50,088 INFO] Validation accuracy: 97.6329
[2019-10-04 21:01:50,091 INFO] Saving checkpoint ../results/models/im2latex-27_step_50000.pt
[2019-10-04 21:05:27,284 INFO] Step 50500/100000; acc:  98.17; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1768 tok/s;  18898 sec
[2019-10-04 21:09:05,994 INFO] Step 51000/100000; acc:  98.23; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/2680 tok/s;  19116 sec
[2019-10-04 21:12:45,437 INFO] Step 51500/100000; acc:  98.25; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/2688 tok/s;  19336 sec
[2019-10-04 21:16:23,899 INFO] Step 52000/100000; acc:  98.33; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/2666 tok/s;  19554 sec
[2019-10-04 21:20:02,432 INFO] Step 52500/100000; acc:  98.32; ppl:  1.06; xent: 0.05; lr: 0.05000;   0/2680 tok/s;  19773 sec
[2019-10-04 21:23:41,652 INFO] Step 53000/100000; acc:  98.34; ppl:  1.06; xent: 0.05; lr: 0.05000;   0/2672 tok/s;  19992 sec
[2019-10-04 21:27:18,571 INFO] Step 53500/100000; acc:  98.40; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2697 tok/s;  20209 sec
[2019-10-04 21:31:01,382 INFO] Step 54000/100000; acc:  98.42; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2635 tok/s;  20432 sec
[2019-10-04 21:34:33,511 INFO] Step 54500/100000; acc:  98.38; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2746 tok/s;  20644 sec
[2019-10-04 21:38:12,329 INFO] Step 55000/100000; acc:  98.40; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2676 tok/s;  20863 sec
[2019-10-04 21:41:50,438 INFO] Step 55500/100000; acc:  98.44; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2696 tok/s;  21081 sec
[2019-10-04 21:45:30,189 INFO] Step 56000/100000; acc:  98.45; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2667 tok/s;  21301 sec
[2019-10-04 21:49:10,027 INFO] Step 56500/100000; acc:  98.42; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2671 tok/s;  21521 sec
[2019-10-04 21:52:48,299 INFO] Step 57000/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2671 tok/s;  21739 sec
[2019-10-04 21:56:30,493 INFO] Step 57500/100000; acc:  98.48; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2655 tok/s;  21961 sec
[2019-10-04 22:00:08,227 INFO] Step 58000/100000; acc:  98.46; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2676 tok/s;  22179 sec
[2019-10-04 22:03:45,400 INFO] Step 58500/100000; acc:  98.46; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2690 tok/s;  22396 sec
[2019-10-04 22:07:27,156 INFO] Step 59000/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2666 tok/s;  22618 sec
[2019-10-04 22:11:05,067 INFO] Step 59500/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/2675 tok/s;  22836 sec
[2019-10-04 22:14:43,869 INFO] Step 60000/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/2686 tok/s;  23054 sec
[2019-10-04 22:16:36,314 INFO] Validation perplexity: 1.09063
[2019-10-04 22:16:36,315 INFO] Validation accuracy: 97.8894
[2019-10-04 22:16:36,318 INFO] Saving checkpoint ../results/models/im2latex-27_step_60000.pt
[2019-10-04 22:20:15,964 INFO] Step 60500/100000; acc:  98.53; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1768 tok/s;  23386 sec
[2019-10-04 22:23:53,083 INFO] Step 61000/100000; acc:  98.59; ppl:  1.05; xent: 0.04; lr: 0.02500;   0/2684 tok/s;  23604 sec
[2019-10-04 22:27:36,241 INFO] Step 61500/100000; acc:  98.61; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/2643 tok/s;  23827 sec
[2019-10-04 22:31:05,465 INFO] Step 62000/100000; acc:  98.61; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/2778 tok/s;  24036 sec
[2019-10-04 22:33:53,862 INFO] Step 62500/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3489 tok/s;  24204 sec
[2019-10-04 22:36:42,467 INFO] Step 63000/100000; acc:  98.65; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3483 tok/s;  24373 sec
[2019-10-04 22:39:30,848 INFO] Step 63500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3465 tok/s;  24541 sec
[2019-10-04 22:42:20,522 INFO] Step 64000/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3446 tok/s;  24711 sec
[2019-10-04 22:45:09,565 INFO] Step 64500/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3468 tok/s;  24880 sec
[2019-10-04 22:47:59,229 INFO] Step 65000/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3459 tok/s;  25050 sec
[2019-10-04 22:50:49,597 INFO] Step 65500/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3433 tok/s;  25220 sec
[2019-10-04 22:53:36,184 INFO] Step 66000/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3511 tok/s;  25387 sec
[2019-10-04 22:56:25,029 INFO] Step 66500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3472 tok/s;  25556 sec
[2019-10-04 22:59:13,814 INFO] Step 67000/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3476 tok/s;  25724 sec
[2019-10-04 23:02:03,822 INFO] Step 67500/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3455 tok/s;  25894 sec
[2019-10-04 23:04:53,328 INFO] Step 68000/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3451 tok/s;  26064 sec
[2019-10-04 23:07:41,190 INFO] Step 68500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3473 tok/s;  26232 sec
[2019-10-04 23:10:31,066 INFO] Step 69000/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3477 tok/s;  26402 sec
[2019-10-04 23:13:20,084 INFO] Step 69500/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/3450 tok/s;  26571 sec
[2019-10-04 23:16:07,237 INFO] Step 70000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3499 tok/s;  26738 sec
[2019-10-04 23:17:27,552 INFO] Validation perplexity: 1.09005
[2019-10-04 23:17:27,554 INFO] Validation accuracy: 97.9539
[2019-10-04 23:17:27,556 INFO] Saving checkpoint ../results/models/im2latex-27_step_70000.pt
[2019-10-04 23:20:18,485 INFO] Step 70500/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/2356 tok/s;  26989 sec
[2019-10-04 23:23:06,303 INFO] Step 71000/100000; acc:  98.80; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3472 tok/s;  27157 sec
[2019-10-04 23:25:58,408 INFO] Step 71500/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3414 tok/s;  27329 sec
[2019-10-04 23:28:55,317 INFO] Step 72000/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3312 tok/s;  27506 sec
[2019-10-04 23:31:45,243 INFO] Step 72500/100000; acc:  98.80; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3430 tok/s;  27676 sec
[2019-10-04 23:34:35,008 INFO] Step 73000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3467 tok/s;  27846 sec
[2019-10-04 23:37:19,029 INFO] Step 73500/100000; acc:  98.80; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3544 tok/s;  28010 sec
[2019-10-04 23:40:07,594 INFO] Step 74000/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3494 tok/s;  28178 sec
[2019-10-04 23:42:55,294 INFO] Step 74500/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3498 tok/s;  28346 sec
[2019-10-04 23:45:42,893 INFO] Step 75000/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3486 tok/s;  28513 sec
[2019-10-04 23:48:32,254 INFO] Step 75500/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3457 tok/s;  28683 sec
[2019-10-04 23:51:18,516 INFO] Step 76000/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3520 tok/s;  28849 sec
[2019-10-04 23:54:06,533 INFO] Step 76500/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3495 tok/s;  29017 sec
[2019-10-04 23:56:55,357 INFO] Step 77000/100000; acc:  98.84; ppl:  1.04; xent: 0.03; lr: 0.01250;   0/3461 tok/s;  29186 sec
[2019-10-04 23:59:41,404 INFO] Step 77500/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3529 tok/s;  29352 sec
[2019-10-05 00:02:29,256 INFO] Step 78000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3494 tok/s;  29520 sec
[2019-10-05 00:05:15,740 INFO] Step 78500/100000; acc:  98.86; ppl:  1.04; xent: 0.03; lr: 0.01250;   0/3518 tok/s;  29686 sec
[2019-10-05 00:08:05,875 INFO] Step 79000/100000; acc:  98.87; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/3445 tok/s;  29856 sec
[2019-10-05 00:10:53,049 INFO] Step 79500/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3510 tok/s;  30024 sec
[2019-10-05 00:13:39,150 INFO] Step 80000/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3507 tok/s;  30190 sec
[2019-10-05 00:14:59,293 INFO] Validation perplexity: 1.09093
[2019-10-05 00:14:59,294 INFO] Validation accuracy: 97.9805
[2019-10-05 00:14:59,297 INFO] Saving checkpoint ../results/models/im2latex-27_step_80000.pt
[2019-10-05 00:17:50,037 INFO] Step 80500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/2354 tok/s;  30441 sec
[2019-10-05 00:20:45,846 INFO] Step 81000/100000; acc:  98.85; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/3315 tok/s;  30616 sec
[2019-10-05 00:23:40,051 INFO] Step 81500/100000; acc:  98.86; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3351 tok/s;  30791 sec
[2019-10-05 00:26:38,786 INFO] Step 82000/100000; acc:  98.87; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3322 tok/s;  30969 sec
[2019-10-05 00:29:34,496 INFO] Step 82500/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3319 tok/s;  31145 sec
[2019-10-05 00:32:31,800 INFO] Step 83000/100000; acc:  98.88; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3302 tok/s;  31322 sec
[2019-10-05 00:35:21,230 INFO] Step 83500/100000; acc:  98.87; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/3458 tok/s;  31492 sec
[2019-10-05 00:38:08,345 INFO] Step 84000/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3494 tok/s;  31659 sec
[2019-10-05 00:40:59,663 INFO] Step 84500/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3436 tok/s;  31830 sec
[2019-10-05 00:43:42,910 INFO] Step 85000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3564 tok/s;  31993 sec
[2019-10-05 00:46:29,540 INFO] Step 85500/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3519 tok/s;  32160 sec
[2019-10-05 00:49:21,114 INFO] Step 86000/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3429 tok/s;  32332 sec
[2019-10-05 00:52:18,445 INFO] Step 86500/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3299 tok/s;  32509 sec
[2019-10-05 00:55:16,669 INFO] Step 87000/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3294 tok/s;  32687 sec
[2019-10-05 00:58:04,045 INFO] Step 87500/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3489 tok/s;  32855 sec
[2019-10-05 01:00:54,308 INFO] Step 88000/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3456 tok/s;  33025 sec
[2019-10-05 01:03:42,596 INFO] Step 88500/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3467 tok/s;  33193 sec
[2019-10-05 01:06:27,797 INFO] Step 89000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3541 tok/s;  33358 sec
[2019-10-05 01:09:17,300 INFO] Step 89500/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/3469 tok/s;  33528 sec
[2019-10-05 01:12:04,746 INFO] Step 90000/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3487 tok/s;  33695 sec
[2019-10-05 01:13:25,002 INFO] Validation perplexity: 1.0922
[2019-10-05 01:13:25,003 INFO] Validation accuracy: 97.9891
[2019-10-05 01:13:25,005 INFO] Saving checkpoint ../results/models/im2latex-27_step_90000.pt
[2019-10-05 01:16:15,585 INFO] Step 90500/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/2341 tok/s;  33946 sec
[2019-10-05 01:19:02,730 INFO] Step 91000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3508 tok/s;  34113 sec
[2019-10-05 01:21:48,380 INFO] Step 91500/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3518 tok/s;  34279 sec
[2019-10-05 01:24:38,364 INFO] Step 92000/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3469 tok/s;  34449 sec
[2019-10-05 01:27:23,974 INFO] Step 92500/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3518 tok/s;  34614 sec
[2019-10-05 01:30:09,847 INFO] Step 93000/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3537 tok/s;  34780 sec
[2019-10-05 01:32:57,376 INFO] Step 93500/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3529 tok/s;  34948 sec
[2019-10-05 01:35:43,458 INFO] Step 94000/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3506 tok/s;  35114 sec
[2019-10-05 01:38:40,760 INFO] Step 94500/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3304 tok/s;  35291 sec
[2019-10-05 01:41:37,302 INFO] Step 95000/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3317 tok/s;  35468 sec
[2019-10-05 01:44:34,633 INFO] Step 95500/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3303 tok/s;  35645 sec
[2019-10-05 01:47:34,491 INFO] Step 96000/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3261 tok/s;  35825 sec
[2019-10-05 01:50:28,742 INFO] Step 96500/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3345 tok/s;  35999 sec
[2019-10-05 01:53:26,309 INFO] Step 97000/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3301 tok/s;  36177 sec
[2019-10-05 01:56:24,276 INFO] Step 97500/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3301 tok/s;  36355 sec
[2019-10-05 01:59:22,512 INFO] Step 98000/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3292 tok/s;  36533 sec
[2019-10-05 02:02:21,313 INFO] Step 98500/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3282 tok/s;  36712 sec
[2019-10-05 02:05:17,676 INFO] Step 99000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3303 tok/s;  36888 sec
[2019-10-05 02:08:09,320 INFO] Step 99500/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/3438 tok/s;  37060 sec
[2019-10-05 02:10:56,985 INFO] Step 100000/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00156;   0/3474 tok/s;  37227 sec
[2019-10-05 02:12:17,309 INFO] Validation perplexity: 1.09222
[2019-10-05 02:12:17,310 INFO] Validation accuracy: 97.9764
[2019-10-05 02:12:17,313 INFO] Saving checkpoint ../results/models/im2latex-27_step_100000.pt
