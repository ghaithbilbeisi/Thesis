[2019-09-17 14:02:38,579 INFO]  * tgt vocab size = 510
[2019-09-17 14:02:38,579 INFO] Building model...
[2019-09-17 14:02:42,449 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds1): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (layer2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds2): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (layer3): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds3): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (layer4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds4): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (layer5): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds5): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (layer6): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds6): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (batch_norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(512, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 512)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-09-17 14:02:42,451 INFO] encoder: 8047424
[2019-09-17 14:02:42,451 INFO] decoder: 5214310
[2019-09-17 14:02:42,451 INFO] * number of parameters: 13261734
[2019-09-17 14:02:43,334 INFO] Starting training on GPU: [0]
[2019-09-17 14:02:43,334 INFO] Start training loop and validate every 10000 steps...
[2019-09-17 14:04:53,447 INFO] Step 500/100000; acc:  29.27; ppl: 37.74; xent: 3.63; lr: 0.10000;   0/4523 tok/s;    130 sec
[2019-09-17 14:06:58,357 INFO] Step 1000/100000; acc:  45.31; ppl: 12.88; xent: 2.56; lr: 0.10000;   0/4653 tok/s;    255 sec
[2019-09-17 14:09:11,643 INFO] Step 1500/100000; acc:  51.91; ppl:  8.80; xent: 2.17; lr: 0.10000;   0/4419 tok/s;    388 sec
[2019-09-17 14:11:23,452 INFO] Step 2000/100000; acc:  63.15; ppl:  4.92; xent: 1.59; lr: 0.10000;   0/4459 tok/s;    520 sec
[2019-09-17 14:13:33,027 INFO] Step 2500/100000; acc:  72.38; ppl:  3.18; xent: 1.16; lr: 0.10000;   0/4512 tok/s;    650 sec
[2019-09-17 14:15:43,522 INFO] Step 3000/100000; acc:  77.78; ppl:  2.51; xent: 0.92; lr: 0.10000;   0/4499 tok/s;    780 sec
[2019-09-17 14:17:52,856 INFO] Step 3500/100000; acc:  81.47; ppl:  2.14; xent: 0.76; lr: 0.10000;   0/4515 tok/s;    910 sec
[2019-09-17 14:20:01,693 INFO] Step 4000/100000; acc:  83.55; ppl:  1.96; xent: 0.67; lr: 0.10000;   0/4562 tok/s;   1038 sec
[2019-09-17 14:22:09,207 INFO] Step 4500/100000; acc:  85.28; ppl:  1.81; xent: 0.59; lr: 0.10000;   0/4579 tok/s;   1166 sec
[2019-09-17 14:24:14,234 INFO] Step 5000/100000; acc:  86.67; ppl:  1.71; xent: 0.54; lr: 0.10000;   0/4688 tok/s;   1291 sec
[2019-09-17 14:26:21,169 INFO] Step 5500/100000; acc:  87.72; ppl:  1.63; xent: 0.49; lr: 0.10000;   0/4629 tok/s;   1418 sec
[2019-09-17 14:28:27,164 INFO] Step 6000/100000; acc:  88.57; ppl:  1.58; xent: 0.46; lr: 0.10000;   0/4644 tok/s;   1544 sec
[2019-09-17 14:30:35,549 INFO] Step 6500/100000; acc:  89.24; ppl:  1.54; xent: 0.43; lr: 0.10000;   0/4570 tok/s;   1672 sec
[2019-09-17 14:32:45,562 INFO] Step 7000/100000; acc:  89.90; ppl:  1.49; xent: 0.40; lr: 0.10000;   0/4511 tok/s;   1802 sec
[2019-09-17 14:34:57,375 INFO] Step 7500/100000; acc:  90.50; ppl:  1.45; xent: 0.37; lr: 0.10000;   0/4420 tok/s;   1934 sec
[2019-09-17 14:37:06,933 INFO] Step 8000/100000; acc:  90.87; ppl:  1.43; xent: 0.36; lr: 0.10000;   0/4556 tok/s;   2064 sec
[2019-09-17 14:39:13,557 INFO] Step 8500/100000; acc:  91.55; ppl:  1.40; xent: 0.33; lr: 0.10000;   0/4593 tok/s;   2190 sec
[2019-09-17 14:41:19,119 INFO] Step 9000/100000; acc:  91.82; ppl:  1.38; xent: 0.32; lr: 0.10000;   0/4664 tok/s;   2316 sec
[2019-09-17 14:43:26,748 INFO] Step 9500/100000; acc:  92.15; ppl:  1.36; xent: 0.31; lr: 0.10000;   0/4632 tok/s;   2443 sec
[2019-09-17 14:45:33,480 INFO] Step 10000/100000; acc:  92.40; ppl:  1.35; xent: 0.30; lr: 0.10000;   0/4594 tok/s;   2570 sec
[2019-09-17 14:46:21,917 INFO] Validation perplexity: 1.35931
[2019-09-17 14:46:21,917 INFO] Validation accuracy: 92.174
[2019-09-17 14:46:21,920 INFO] Saving checkpoint ../results/models/im2latex-29_step_10000.pt
[2019-09-17 14:48:33,359 INFO] Step 10500/100000; acc:  92.66; ppl:  1.33; xent: 0.29; lr: 0.10000;   0/3255 tok/s;   2750 sec
[2019-09-17 14:50:43,658 INFO] Step 11000/100000; acc:  92.89; ppl:  1.32; xent: 0.28; lr: 0.10000;   0/4503 tok/s;   2880 sec
[2019-09-17 14:52:49,479 INFO] Step 11500/100000; acc:  93.15; ppl:  1.30; xent: 0.27; lr: 0.10000;   0/4644 tok/s;   3006 sec
[2019-09-17 14:55:00,067 INFO] Step 12000/100000; acc:  93.28; ppl:  1.30; xent: 0.26; lr: 0.10000;   0/4499 tok/s;   3137 sec
[2019-09-17 14:57:09,989 INFO] Step 12500/100000; acc:  93.66; ppl:  1.28; xent: 0.25; lr: 0.10000;   0/4485 tok/s;   3267 sec
[2019-09-17 14:59:17,933 INFO] Step 13000/100000; acc:  93.75; ppl:  1.27; xent: 0.24; lr: 0.10000;   0/4585 tok/s;   3395 sec
[2019-09-17 15:01:24,547 INFO] Step 13500/100000; acc:  93.93; ppl:  1.26; xent: 0.23; lr: 0.10000;   0/4649 tok/s;   3521 sec
[2019-09-17 15:03:32,171 INFO] Step 14000/100000; acc:  94.03; ppl:  1.26; xent: 0.23; lr: 0.10000;   0/4586 tok/s;   3649 sec
[2019-09-17 15:05:40,958 INFO] Step 14500/100000; acc:  94.08; ppl:  1.25; xent: 0.23; lr: 0.10000;   0/4565 tok/s;   3778 sec
[2019-09-17 15:07:47,316 INFO] Step 15000/100000; acc:  94.31; ppl:  1.24; xent: 0.22; lr: 0.10000;   0/4612 tok/s;   3904 sec
[2019-09-17 15:09:54,641 INFO] Step 15500/100000; acc:  94.34; ppl:  1.24; xent: 0.21; lr: 0.10000;   0/4629 tok/s;   4031 sec
[2019-09-17 15:12:01,376 INFO] Step 16000/100000; acc:  94.60; ppl:  1.23; xent: 0.21; lr: 0.10000;   0/4597 tok/s;   4158 sec
[2019-09-17 15:14:07,925 INFO] Step 16500/100000; acc:  94.69; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/4616 tok/s;   4285 sec
[2019-09-17 15:16:15,208 INFO] Step 17000/100000; acc:  94.78; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/4638 tok/s;   4412 sec
[2019-09-17 15:18:22,559 INFO] Step 17500/100000; acc:  94.82; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/4575 tok/s;   4539 sec
[2019-09-17 15:20:28,193 INFO] Step 18000/100000; acc:  94.91; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/4683 tok/s;   4665 sec
[2019-09-17 15:22:35,202 INFO] Step 18500/100000; acc:  94.88; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/4621 tok/s;   4792 sec
[2019-09-17 15:24:38,074 INFO] Step 19000/100000; acc:  95.09; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/4736 tok/s;   4915 sec
[2019-09-17 15:26:47,357 INFO] Step 19500/100000; acc:  95.07; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/4566 tok/s;   5044 sec
[2019-09-17 15:28:58,686 INFO] Step 20000/100000; acc:  95.35; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/4428 tok/s;   5175 sec
[2019-09-17 15:29:47,785 INFO] Validation perplexity: 1.20227
[2019-09-17 15:29:47,785 INFO] Validation accuracy: 95.4382
[2019-09-17 15:29:47,788 INFO] Saving checkpoint ../results/models/im2latex-29_step_20000.pt
[2019-09-17 15:31:57,388 INFO] Step 20500/100000; acc:  95.36; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/3288 tok/s;   5354 sec
[2019-09-17 15:34:04,188 INFO] Step 21000/100000; acc:  95.44; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/4641 tok/s;   5481 sec
[2019-09-17 15:36:08,523 INFO] Step 21500/100000; acc:  95.44; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/4691 tok/s;   5605 sec
[2019-09-17 15:38:17,382 INFO] Step 22000/100000; acc:  95.47; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/4537 tok/s;   5734 sec
[2019-09-17 15:40:23,137 INFO] Step 22500/100000; acc:  95.50; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/4661 tok/s;   5860 sec
[2019-09-17 15:42:31,584 INFO] Step 23000/100000; acc:  95.58; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/4572 tok/s;   5988 sec
[2019-09-17 15:44:38,385 INFO] Step 23500/100000; acc:  95.62; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/4614 tok/s;   6115 sec
[2019-09-17 15:46:46,725 INFO] Step 24000/100000; acc:  95.75; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/4549 tok/s;   6243 sec
[2019-09-17 15:48:52,485 INFO] Step 24500/100000; acc:  95.75; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/4672 tok/s;   6369 sec
[2019-09-17 15:50:59,754 INFO] Step 25000/100000; acc:  95.91; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/4602 tok/s;   6496 sec
[2019-09-17 15:53:05,385 INFO] Step 25500/100000; acc:  95.85; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/4678 tok/s;   6622 sec
[2019-09-17 15:55:15,108 INFO] Step 26000/100000; acc:  95.87; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/4524 tok/s;   6752 sec
[2019-09-17 15:57:18,081 INFO] Step 26500/100000; acc:  95.93; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/4731 tok/s;   6875 sec
[2019-09-17 15:59:26,346 INFO] Step 27000/100000; acc:  95.88; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/4600 tok/s;   7003 sec
[2019-09-17 16:01:32,874 INFO] Step 27500/100000; acc:  96.12; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/4606 tok/s;   7130 sec
[2019-09-17 16:03:42,189 INFO] Step 28000/100000; acc:  96.08; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/4528 tok/s;   7259 sec
[2019-09-17 16:05:47,495 INFO] Step 28500/100000; acc:  96.22; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/4702 tok/s;   7384 sec
[2019-09-17 16:07:58,226 INFO] Step 29000/100000; acc:  96.16; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/4455 tok/s;   7515 sec
[2019-09-17 16:10:11,873 INFO] Step 29500/100000; acc:  96.17; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/4398 tok/s;   7649 sec
[2019-09-17 16:12:20,267 INFO] Step 30000/100000; acc:  96.16; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/4563 tok/s;   7777 sec
[2019-09-17 16:13:09,279 INFO] Validation perplexity: 1.15237
[2019-09-17 16:13:09,280 INFO] Validation accuracy: 96.3849
[2019-09-17 16:13:09,283 INFO] Saving checkpoint ../results/models/im2latex-29_step_30000.pt
[2019-09-17 16:15:14,210 INFO] Step 30500/100000; acc:  96.25; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/3352 tok/s;   7951 sec
[2019-09-17 16:17:19,961 INFO] Step 31000/100000; acc:  96.20; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/4687 tok/s;   8077 sec
[2019-09-17 16:19:22,558 INFO] Step 31500/100000; acc:  96.36; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/4738 tok/s;   8199 sec
[2019-09-17 16:21:26,278 INFO] Step 32000/100000; acc:  96.40; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/4756 tok/s;   8323 sec
[2019-09-17 16:23:37,279 INFO] Step 32500/100000; acc:  96.37; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/4495 tok/s;   8454 sec
[2019-09-17 16:25:44,982 INFO] Step 33000/100000; acc:  96.45; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/4575 tok/s;   8582 sec
[2019-09-17 16:27:54,496 INFO] Step 33500/100000; acc:  96.39; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/4516 tok/s;   8711 sec
[2019-09-17 16:29:59,061 INFO] Step 34000/100000; acc:  96.40; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/4698 tok/s;   8836 sec
[2019-09-17 16:32:06,294 INFO] Step 34500/100000; acc:  96.51; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/4617 tok/s;   8963 sec
[2019-09-17 16:34:13,243 INFO] Step 35000/100000; acc:  96.51; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/4607 tok/s;   9090 sec
[2019-09-17 16:36:22,389 INFO] Step 35500/100000; acc:  96.57; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/4536 tok/s;   9219 sec
[2019-09-17 16:38:31,472 INFO] Step 36000/100000; acc:  96.57; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/4546 tok/s;   9348 sec
[2019-09-17 16:40:35,149 INFO] Step 36500/100000; acc:  96.61; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/4734 tok/s;   9472 sec
[2019-09-17 16:42:42,012 INFO] Step 37000/100000; acc:  96.61; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/4625 tok/s;   9599 sec
[2019-09-17 16:44:50,314 INFO] Step 37500/100000; acc:  96.62; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/4564 tok/s;   9727 sec
[2019-09-17 16:46:55,002 INFO] Step 38000/100000; acc:  96.61; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/4678 tok/s;   9852 sec
[2019-09-17 16:49:04,801 INFO] Step 38500/100000; acc:  96.52; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/4554 tok/s;   9981 sec
[2019-09-17 16:51:11,336 INFO] Step 39000/100000; acc:  96.77; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/4604 tok/s;  10108 sec
[2019-09-17 16:53:22,814 INFO] Step 39500/100000; acc:  96.73; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/4446 tok/s;  10239 sec
[2019-09-17 16:55:43,053 INFO] Step 40000/100000; acc:  96.79; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/4216 tok/s;  10380 sec
[2019-09-17 16:56:31,720 INFO] Validation perplexity: 1.16141
[2019-09-17 16:56:31,721 INFO] Validation accuracy: 96.0637
[2019-09-17 16:56:31,724 INFO] Saving checkpoint ../results/models/im2latex-29_step_40000.pt
[2019-09-17 16:58:42,309 INFO] Step 40500/100000; acc:  96.89; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3248 tok/s;  10559 sec
[2019-09-17 17:00:52,170 INFO] Step 41000/100000; acc:  96.78; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/4514 tok/s;  10689 sec
[2019-09-17 17:02:58,509 INFO] Step 41500/100000; acc:  96.76; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/4636 tok/s;  10815 sec
[2019-09-17 17:05:22,077 INFO] Step 42000/100000; acc:  96.85; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/4068 tok/s;  10959 sec
[2019-09-17 17:07:52,865 INFO] Step 42500/100000; acc:  96.83; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3903 tok/s;  11110 sec
[2019-09-17 17:10:19,387 INFO] Step 43000/100000; acc:  96.88; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/3968 tok/s;  11256 sec
[2019-09-17 17:12:36,879 INFO] Step 43500/100000; acc:  96.96; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/4259 tok/s;  11394 sec
[2019-09-17 17:14:45,592 INFO] Step 44000/100000; acc:  96.98; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/4590 tok/s;  11522 sec
[2019-09-17 17:16:53,706 INFO] Step 44500/100000; acc:  96.97; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/4565 tok/s;  11650 sec
[2019-09-17 17:19:04,513 INFO] Step 45000/100000; acc:  96.90; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/4488 tok/s;  11781 sec
[2019-09-17 17:21:18,530 INFO] Step 45500/100000; acc:  96.99; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/4356 tok/s;  11915 sec
[2019-09-17 17:23:32,590 INFO] Step 46000/100000; acc:  96.98; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/4391 tok/s;  12049 sec
[2019-09-17 17:25:40,626 INFO] Step 46500/100000; acc:  97.06; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/4557 tok/s;  12177 sec
[2019-09-17 17:27:49,038 INFO] Step 47000/100000; acc:  97.03; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/4559 tok/s;  12306 sec
[2019-09-17 17:30:04,802 INFO] Step 47500/100000; acc:  97.09; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/4318 tok/s;  12441 sec
[2019-09-17 17:32:15,116 INFO] Step 48000/100000; acc:  97.11; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/4491 tok/s;  12572 sec
[2019-09-17 17:34:27,690 INFO] Step 48500/100000; acc:  97.05; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/4424 tok/s;  12704 sec
[2019-09-17 17:36:45,894 INFO] Step 49000/100000; acc:  97.07; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/4243 tok/s;  12843 sec
[2019-09-17 17:39:00,975 INFO] Step 49500/100000; acc:  97.10; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/4314 tok/s;  12978 sec
[2019-09-17 17:41:10,909 INFO] Step 50000/100000; acc:  97.10; ppl:  1.10; xent: 0.10; lr: 0.05000;   0/4541 tok/s;  13108 sec
[2019-09-17 17:42:03,231 INFO] Validation perplexity: 1.1359
[2019-09-17 17:42:03,232 INFO] Validation accuracy: 96.9429
[2019-09-17 17:42:03,235 INFO] Saving checkpoint ../results/models/im2latex-29_step_50000.pt
[2019-09-17 17:44:20,475 INFO] Step 50500/100000; acc:  97.54; ppl:  1.09; xent: 0.08; lr: 0.05000;   0/3073 tok/s;  13297 sec
[2019-09-17 17:46:29,630 INFO] Step 51000/100000; acc:  97.66; ppl:  1.08; xent: 0.08; lr: 0.05000;   0/4538 tok/s;  13426 sec
[2019-09-17 17:48:35,193 INFO] Step 51500/100000; acc:  97.74; ppl:  1.08; xent: 0.08; lr: 0.05000;   0/4710 tok/s;  13552 sec
[2019-09-17 17:50:46,356 INFO] Step 52000/100000; acc:  97.81; ppl:  1.08; xent: 0.07; lr: 0.05000;   0/4437 tok/s;  13683 sec
[2019-09-17 17:52:55,604 INFO] Step 52500/100000; acc:  97.81; ppl:  1.08; xent: 0.07; lr: 0.05000;   0/4532 tok/s;  13812 sec
[2019-09-17 17:54:59,786 INFO] Step 53000/100000; acc:  97.84; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/4719 tok/s;  13936 sec
[2019-09-17 17:57:03,774 INFO] Step 53500/100000; acc:  97.92; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/4721 tok/s;  14060 sec
[2019-09-17 17:59:14,511 INFO] Step 54000/100000; acc:  97.89; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/4488 tok/s;  14191 sec
[2019-09-17 18:01:18,786 INFO] Step 54500/100000; acc:  97.90; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/4690 tok/s;  14315 sec
[2019-09-17 18:03:28,995 INFO] Step 55000/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/4511 tok/s;  14446 sec
[2019-09-17 18:05:34,426 INFO] Step 55500/100000; acc:  97.98; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/4687 tok/s;  14571 sec
[2019-09-17 18:07:39,008 INFO] Step 56000/100000; acc:  97.97; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/4704 tok/s;  14696 sec
[2019-09-17 18:09:44,185 INFO] Step 56500/100000; acc:  97.99; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/4695 tok/s;  14821 sec
[2019-09-17 18:11:46,872 INFO] Step 57000/100000; acc:  98.00; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/4749 tok/s;  14944 sec
[2019-09-17 18:14:03,544 INFO] Step 57500/100000; acc:  98.05; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/4316 tok/s;  15080 sec
[2019-09-17 18:16:20,907 INFO] Step 58000/100000; acc:  98.04; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/4242 tok/s;  15218 sec
[2019-09-17 18:18:27,786 INFO] Step 58500/100000; acc:  98.02; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/4604 tok/s;  15344 sec
[2019-09-17 18:20:35,321 INFO] Step 59000/100000; acc:  98.05; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/4605 tok/s;  15472 sec
[2019-09-17 18:22:38,285 INFO] Step 59500/100000; acc:  98.06; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/4741 tok/s;  15595 sec
[2019-09-17 18:24:45,657 INFO] Step 60000/100000; acc:  98.11; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/4616 tok/s;  15722 sec
[2019-09-17 18:25:39,657 INFO] Validation perplexity: 1.11837
[2019-09-17 18:25:39,658 INFO] Validation accuracy: 97.3375
[2019-09-17 18:25:39,661 INFO] Saving checkpoint ../results/models/im2latex-29_step_60000.pt
[2019-09-17 18:27:53,740 INFO] Step 60500/100000; acc:  98.14; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/3121 tok/s;  15910 sec
[2019-09-17 18:29:58,892 INFO] Step 61000/100000; acc:  98.21; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/4655 tok/s;  16036 sec
[2019-09-17 18:32:09,724 INFO] Step 61500/100000; acc:  98.22; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/4509 tok/s;  16166 sec
[2019-09-17 18:34:18,509 INFO] Step 62000/100000; acc:  98.26; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/4512 tok/s;  16295 sec
[2019-09-17 18:36:25,360 INFO] Step 62500/100000; acc:  98.30; ppl:  1.06; xent: 0.05; lr: 0.02500;   0/4632 tok/s;  16422 sec
[2019-09-17 18:38:36,420 INFO] Step 63000/100000; acc:  98.34; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/4504 tok/s;  16553 sec
[2019-09-17 18:40:40,392 INFO] Step 63500/100000; acc:  98.39; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/4701 tok/s;  16677 sec
[2019-09-17 18:42:57,766 INFO] Step 64000/100000; acc:  98.37; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/4260 tok/s;  16814 sec
[2019-09-17 18:45:05,337 INFO] Step 64500/100000; acc:  98.32; ppl:  1.06; xent: 0.05; lr: 0.02500;   0/4599 tok/s;  16942 sec
[2019-09-17 18:47:12,488 INFO] Step 65000/100000; acc:  98.38; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/4610 tok/s;  17069 sec
[2019-09-17 18:49:20,906 INFO] Step 65500/100000; acc:  98.37; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/4557 tok/s;  17198 sec
[2019-09-17 18:51:26,294 INFO] Step 66000/100000; acc:  98.34; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/4663 tok/s;  17323 sec
[2019-09-17 18:53:30,745 INFO] Step 66500/100000; acc:  98.38; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/4718 tok/s;  17447 sec
[2019-09-17 18:55:36,112 INFO] Step 67000/100000; acc:  98.44; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/4678 tok/s;  17573 sec
[2019-09-17 18:57:41,817 INFO] Step 67500/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/4671 tok/s;  17698 sec
[2019-09-17 18:59:47,516 INFO] Step 68000/100000; acc:  98.41; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/4658 tok/s;  17824 sec
[2019-09-17 19:01:50,346 INFO] Step 68500/100000; acc:  98.38; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/4740 tok/s;  17947 sec
[2019-09-17 19:04:02,776 INFO] Step 69000/100000; acc:  98.39; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/4462 tok/s;  18079 sec
[2019-09-17 19:06:09,427 INFO] Step 69500/100000; acc:  98.44; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/4604 tok/s;  18206 sec
[2019-09-17 19:08:13,254 INFO] Step 70000/100000; acc:  98.40; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4727 tok/s;  18330 sec
[2019-09-17 19:09:00,951 INFO] Validation perplexity: 1.11346
[2019-09-17 19:09:00,952 INFO] Validation accuracy: 97.5026
[2019-09-17 19:09:00,954 INFO] Saving checkpoint ../results/models/im2latex-29_step_70000.pt
[2019-09-17 19:11:11,940 INFO] Step 70500/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/3296 tok/s;  18509 sec
[2019-09-17 19:13:20,675 INFO] Step 71000/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4530 tok/s;  18637 sec
[2019-09-17 19:15:29,193 INFO] Step 71500/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4568 tok/s;  18766 sec
[2019-09-17 19:17:33,397 INFO] Step 72000/100000; acc:  98.48; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4720 tok/s;  18890 sec
[2019-09-17 19:19:39,209 INFO] Step 72500/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4630 tok/s;  19016 sec
[2019-09-17 19:21:48,389 INFO] Step 73000/100000; acc:  98.57; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4556 tok/s;  19145 sec
[2019-09-17 19:23:52,108 INFO] Step 73500/100000; acc:  98.55; ppl:  1.05; xent: 0.04; lr: 0.01250;   0/4699 tok/s;  19269 sec
[2019-09-17 19:25:59,171 INFO] Step 74000/100000; acc:  98.57; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4633 tok/s;  19396 sec
[2019-09-17 19:28:07,442 INFO] Step 74500/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4587 tok/s;  19524 sec
[2019-09-17 19:30:13,218 INFO] Step 75000/100000; acc:  98.60; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/4642 tok/s;  19650 sec
[2019-09-17 19:32:18,683 INFO] Step 75500/100000; acc:  98.57; ppl:  1.05; xent: 0.04; lr: 0.01250;   0/4669 tok/s;  19775 sec
[2019-09-17 19:34:22,373 INFO] Step 76000/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/4729 tok/s;  19899 sec
[2019-09-17 19:36:27,768 INFO] Step 76500/100000; acc:  98.58; ppl:  1.05; xent: 0.04; lr: 0.01250;   0/4684 tok/s;  20024 sec
[2019-09-17 19:38:44,628 INFO] Step 77000/100000; acc:  98.58; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/4273 tok/s;  20161 sec
[2019-09-17 19:40:53,742 INFO] Step 77500/100000; acc:  98.59; ppl:  1.05; xent: 0.04; lr: 0.01250;   0/4536 tok/s;  20290 sec
[2019-09-17 19:43:00,414 INFO] Step 78000/100000; acc:  98.60; ppl:  1.05; xent: 0.04; lr: 0.01250;   0/4639 tok/s;  20417 sec
[2019-09-17 19:45:06,087 INFO] Step 78500/100000; acc:  98.60; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/4658 tok/s;  20543 sec
[2019-09-17 19:47:11,054 INFO] Step 79000/100000; acc:  98.62; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/4693 tok/s;  20668 sec
[2019-09-17 19:49:19,103 INFO] Step 79500/100000; acc:  98.58; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/4579 tok/s;  20796 sec
[2019-09-17 19:51:23,185 INFO] Step 80000/100000; acc:  98.60; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/4697 tok/s;  20920 sec
[2019-09-17 19:52:11,187 INFO] Validation perplexity: 1.11484
[2019-09-17 19:52:11,188 INFO] Validation accuracy: 97.5136
[2019-09-17 19:52:11,190 INFO] Saving checkpoint ../results/models/im2latex-29_step_80000.pt
[2019-09-17 19:54:22,856 INFO] Step 80500/100000; acc:  98.59; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3287 tok/s;  21100 sec
[2019-09-17 19:56:28,601 INFO] Step 81000/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/4635 tok/s;  21225 sec
[2019-09-17 19:58:32,520 INFO] Step 81500/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/4711 tok/s;  21349 sec
[2019-09-17 20:00:39,530 INFO] Step 82000/100000; acc:  98.63; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/4655 tok/s;  21476 sec
[2019-09-17 20:02:45,552 INFO] Step 82500/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/4626 tok/s;  21602 sec
[2019-09-17 20:04:52,858 INFO] Step 83000/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/4599 tok/s;  21730 sec
[2019-09-17 20:06:58,653 INFO] Step 83500/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/4661 tok/s;  21855 sec
[2019-09-17 20:09:08,689 INFO] Step 84000/100000; acc:  98.65; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/4490 tok/s;  21985 sec
[2019-09-17 20:11:14,635 INFO] Step 84500/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/4674 tok/s;  22111 sec
[2019-09-17 20:13:17,951 INFO] Step 85000/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/4716 tok/s;  22235 sec
[2019-09-17 20:15:24,665 INFO] Step 85500/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/4634 tok/s;  22361 sec
[2019-09-17 20:17:32,846 INFO] Step 86000/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/4596 tok/s;  22490 sec
[2019-09-17 20:19:40,575 INFO] Step 86500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/4580 tok/s;  22617 sec
[2019-09-17 20:21:48,555 INFO] Step 87000/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/4588 tok/s;  22745 sec
[2019-09-17 20:23:52,901 INFO] Step 87500/100000; acc:  98.65; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/4694 tok/s;  22870 sec
[2019-09-17 20:26:00,825 INFO] Step 88000/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/4601 tok/s;  22997 sec
[2019-09-17 20:28:09,320 INFO] Step 88500/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/4538 tok/s;  23126 sec
[2019-09-17 20:30:18,496 INFO] Step 89000/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/4527 tok/s;  23255 sec
[2019-09-17 20:32:28,036 INFO] Step 89500/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/4552 tok/s;  23385 sec
[2019-09-17 20:34:31,874 INFO] Step 90000/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/4716 tok/s;  23509 sec
[2019-09-17 20:35:24,227 INFO] Validation perplexity: 1.11486
[2019-09-17 20:35:24,228 INFO] Validation accuracy: 97.5603
[2019-09-17 20:35:24,231 INFO] Saving checkpoint ../results/models/im2latex-29_step_90000.pt
[2019-09-17 20:37:30,305 INFO] Step 90500/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3288 tok/s;  23687 sec
[2019-09-17 20:39:35,555 INFO] Step 91000/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/4683 tok/s;  23812 sec
[2019-09-17 20:41:41,508 INFO] Step 91500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/4624 tok/s;  23938 sec
[2019-09-17 20:43:48,639 INFO] Step 92000/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/4641 tok/s;  24065 sec
[2019-09-17 20:45:56,613 INFO] Step 92500/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/4555 tok/s;  24193 sec
[2019-09-17 20:47:59,000 INFO] Step 93000/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/4791 tok/s;  24316 sec
[2019-09-17 20:50:06,392 INFO] Step 93500/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/4622 tok/s;  24443 sec
[2019-09-17 20:52:19,373 INFO] Step 94000/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/4379 tok/s;  24576 sec
[2019-09-17 20:54:49,347 INFO] Step 94500/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3907 tok/s;  24726 sec
[2019-09-17 20:57:17,214 INFO] Step 95000/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3960 tok/s;  24874 sec
[2019-09-17 20:59:45,372 INFO] Step 95500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3954 tok/s;  25022 sec
[2019-09-17 21:02:13,788 INFO] Step 96000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3952 tok/s;  25170 sec
[2019-09-17 21:04:39,471 INFO] Step 96500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/4000 tok/s;  25316 sec
[2019-09-17 21:07:07,099 INFO] Step 97000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3983 tok/s;  25464 sec
[2019-09-17 21:09:21,739 INFO] Step 97500/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/4360 tok/s;  25598 sec
[2019-09-17 21:11:32,022 INFO] Step 98000/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/4506 tok/s;  25729 sec
[2019-09-17 21:13:49,363 INFO] Step 98500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/4274 tok/s;  25866 sec
[2019-09-17 21:16:02,275 INFO] Step 99000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/4381 tok/s;  25999 sec
[2019-09-17 21:18:18,993 INFO] Step 99500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/4317 tok/s;  26136 sec
[2019-09-17 21:20:32,337 INFO] Step 100000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.00156;   0/4372 tok/s;  26269 sec
[2019-09-17 21:21:21,579 INFO] Validation perplexity: 1.11603
[2019-09-17 21:21:21,580 INFO] Validation accuracy: 97.5434
[2019-09-17 21:21:21,583 INFO] Saving checkpoint ../results/models/im2latex-29_step_100000.pt
