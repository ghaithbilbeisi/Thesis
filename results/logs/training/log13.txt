[2019-08-01 00:50:34,132 INFO]  * tgt vocab size = 510
[2019-08-01 00:50:34,132 INFO] Building model...
[2019-08-01 00:50:39,723 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer3): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer5): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer6): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (batch_norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(512, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 512)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-08-01 00:50:39,725 INFO] encoder: 8047424
[2019-08-01 00:50:39,725 INFO] decoder: 5214310
[2019-08-01 00:50:39,725 INFO] * number of parameters: 13261734
[2019-08-01 00:50:40,645 INFO] Starting training on GPU: [0]
[2019-08-01 00:50:40,645 INFO] Start training loop and validate every 10000 steps...
[2019-08-01 00:54:49,976 INFO] Step 500/100000; acc:   6.01; ppl: 26881171418161356094253400435962903554686976.00; xent: 113.43; lr: 0.10000;   0/1193 tok/s;    249 sec
[2019-08-01 00:58:50,467 INFO] Step 1000/100000; acc:   6.48; ppl: 89611015255523194722039343894758198083584.00; xent: 94.30; lr: 0.10000;   0/1210 tok/s;    490 sec
[2019-08-01 01:02:49,259 INFO] Step 1500/100000; acc:   6.42; ppl: 26881171418161356094253400435962903554686976.00; xent: 104.49; lr: 0.10000;   0/1222 tok/s;    729 sec
[2019-08-01 01:06:49,400 INFO] Step 2000/100000; acc:   6.41; ppl: 26881171418161356094253400435962903554686976.00; xent: 107.47; lr: 0.10000;   0/1206 tok/s;    969 sec
[2019-08-01 01:10:52,708 INFO] Step 2500/100000; acc:   6.56; ppl: 26881171418161356094253400435962903554686976.00; xent: 109.67; lr: 0.10000;   0/1210 tok/s;   1212 sec
[2019-08-01 01:14:55,424 INFO] Step 3000/100000; acc:   6.52; ppl: 26881171418161356094253400435962903554686976.00; xent: 108.20; lr: 0.10000;   0/1214 tok/s;   1455 sec
[2019-08-01 01:18:59,701 INFO] Step 3500/100000; acc:   6.46; ppl: 26881171418161356094253400435962903554686976.00; xent: 109.55; lr: 0.10000;   0/1209 tok/s;   1699 sec
[2019-08-01 01:23:31,783 INFO] Step 4000/100000; acc:   6.67; ppl: 26881171418161356094253400435962903554686976.00; xent: 105.47; lr: 0.10000;   0/1074 tok/s;   1971 sec
[2019-08-01 01:27:29,296 INFO] Step 4500/100000; acc:   6.26; ppl: 26881171418161356094253400435962903554686976.00; xent: 106.99; lr: 0.10000;   0/1223 tok/s;   2209 sec
[2019-08-01 01:31:34,500 INFO] Step 5000/100000; acc:   6.37; ppl: 26881171418161356094253400435962903554686976.00; xent: 110.68; lr: 0.10000;   0/1197 tok/s;   2454 sec
[2019-08-01 01:35:39,242 INFO] Step 5500/100000; acc:   6.47; ppl: 26881171418161356094253400435962903554686976.00; xent: 105.57; lr: 0.10000;   0/1203 tok/s;   2699 sec
[2019-08-01 01:39:44,409 INFO] Step 6000/100000; acc:   6.55; ppl: 26881171418161356094253400435962903554686976.00; xent: 110.74; lr: 0.10000;   0/1193 tok/s;   2944 sec
[2019-08-01 01:43:48,699 INFO] Step 6500/100000; acc:   6.52; ppl: 26881171418161356094253400435962903554686976.00; xent: 108.73; lr: 0.10000;   0/1203 tok/s;   3188 sec
[2019-08-01 01:47:48,150 INFO] Step 7000/100000; acc:   6.67; ppl: 26881171418161356094253400435962903554686976.00; xent: 102.38; lr: 0.10000;   0/1214 tok/s;   3428 sec
[2019-08-01 01:51:51,549 INFO] Step 7500/100000; acc:   6.47; ppl: 26881171418161356094253400435962903554686976.00; xent: 108.97; lr: 0.10000;   0/1200 tok/s;   3671 sec
[2019-08-01 01:56:00,155 INFO] Step 8000/100000; acc:   6.59; ppl: 26881171418161356094253400435962903554686976.00; xent: 108.64; lr: 0.10000;   0/1188 tok/s;   3920 sec
[2019-08-01 02:00:03,722 INFO] Step 8500/100000; acc:   6.47; ppl: 26881171418161356094253400435962903554686976.00; xent: 107.79; lr: 0.10000;   0/1209 tok/s;   4163 sec
[2019-08-01 02:04:00,848 INFO] Step 9000/100000; acc:   6.49; ppl: 26881171418161356094253400435962903554686976.00; xent: 109.29; lr: 0.10000;   0/1221 tok/s;   4400 sec
[2019-08-01 02:08:02,874 INFO] Step 9500/100000; acc:   6.58; ppl: 26881171418161356094253400435962903554686976.00; xent: 103.44; lr: 0.10000;   0/1204 tok/s;   4642 sec
[2019-08-01 02:12:02,325 INFO] Step 10000/100000; acc:   6.47; ppl: 26881171418161356094253400435962903554686976.00; xent: 109.44; lr: 0.10000;   0/1230 tok/s;   4882 sec
[2019-08-01 02:14:20,817 INFO] Validation perplexity: 2.68812e+43
[2019-08-01 02:14:20,819 INFO] Validation accuracy: 5.32397
[2019-08-01 02:14:20,822 INFO] Saving checkpoint ../results/models/im2latex-13_step_10000.pt
[2019-08-01 02:18:28,619 INFO] Step 10500/100000; acc:   6.48; ppl: 26881171418161356094253400435962903554686976.00; xent: 111.81; lr: 0.10000;   0/760 tok/s;   5268 sec
[2019-08-01 02:22:34,807 INFO] Step 11000/100000; acc:   6.39; ppl: 26881171418161356094253400435962903554686976.00; xent: 105.93; lr: 0.10000;   0/1199 tok/s;   5514 sec
[2019-08-01 02:26:38,361 INFO] Step 11500/100000; acc:   6.59; ppl: 26881171418161356094253400435962903554686976.00; xent: 110.20; lr: 0.10000;   0/1211 tok/s;   5758 sec
[2019-08-01 02:30:38,932 INFO] Step 12000/100000; acc:   6.31; ppl: 26881171418161356094253400435962903554686976.00; xent: 110.11; lr: 0.10000;   0/1207 tok/s;   5998 sec
[2019-08-01 02:34:42,681 INFO] Step 12500/100000; acc:   6.63; ppl: 26881171418161356094253400435962903554686976.00; xent: 108.85; lr: 0.10000;   0/1203 tok/s;   6242 sec
[2019-08-01 02:38:49,798 INFO] Step 13000/100000; acc:   6.60; ppl: 26881171418161356094253400435962903554686976.00; xent: 111.08; lr: 0.10000;   0/1187 tok/s;   6489 sec
[2019-08-01 02:42:53,408 INFO] Step 13500/100000; acc:   6.49; ppl: 26881171418161356094253400435962903554686976.00; xent: 107.78; lr: 0.10000;   0/1199 tok/s;   6733 sec
[2019-08-01 02:47:23,806 INFO] Step 14000/100000; acc:   6.70; ppl: 26881171418161356094253400435962903554686976.00; xent: 106.69; lr: 0.10000;   0/1088 tok/s;   7003 sec
[2019-08-01 02:51:23,502 INFO] Step 14500/100000; acc:   6.61; ppl: 26881171418161356094253400435962903554686976.00; xent: 107.36; lr: 0.10000;   0/1218 tok/s;   7243 sec
[2019-08-01 02:55:25,837 INFO] Step 15000/100000; acc:   6.48; ppl: 26881171418161356094253400435962903554686976.00; xent: 105.45; lr: 0.10000;   0/1200 tok/s;   7485 sec
[2019-08-01 02:59:34,865 INFO] Step 15500/100000; acc:   6.53; ppl: 26881171418161356094253400435962903554686976.00; xent: 111.67; lr: 0.10000;   0/1185 tok/s;   7734 sec
[2019-08-01 03:03:39,588 INFO] Step 16000/100000; acc:   6.63; ppl: 26881171418161356094253400435962903554686976.00; xent: 110.65; lr: 0.10000;   0/1205 tok/s;   7979 sec
[2019-08-01 03:07:40,573 INFO] Step 16500/100000; acc:   6.80; ppl: 26881171418161356094253400435962903554686976.00; xent: 105.78; lr: 0.10000;   0/1206 tok/s;   8220 sec
[2019-08-01 03:11:44,459 INFO] Step 17000/100000; acc:   6.50; ppl: 26881171418161356094253400435962903554686976.00; xent: 113.66; lr: 0.10000;   0/1198 tok/s;   8464 sec
[2019-08-01 03:15:45,612 INFO] Step 17500/100000; acc:   6.61; ppl: 26881171418161356094253400435962903554686976.00; xent: 105.62; lr: 0.10000;   0/1215 tok/s;   8705 sec
[2019-08-01 03:19:47,412 INFO] Step 18000/100000; acc:   6.58; ppl: 26881171418161356094253400435962903554686976.00; xent: 109.29; lr: 0.10000;   0/1208 tok/s;   8947 sec
[2019-08-01 03:23:52,083 INFO] Step 18500/100000; acc:   6.44; ppl: 26881171418161356094253400435962903554686976.00; xent: 108.43; lr: 0.10000;   0/1200 tok/s;   9191 sec
[2019-08-01 03:27:57,261 INFO] Step 19000/100000; acc:   6.57; ppl: 26881171418161356094253400435962903554686976.00; xent: 107.56; lr: 0.10000;   0/1214 tok/s;   9437 sec
[2019-08-01 03:31:55,890 INFO] Step 19500/100000; acc:   6.17; ppl: 26881171418161356094253400435962903554686976.00; xent: 111.80; lr: 0.10000;   0/1212 tok/s;   9675 sec
[2019-08-01 03:35:57,602 INFO] Step 20000/100000; acc:   6.21; ppl: 26881171418161356094253400435962903554686976.00; xent: 110.95; lr: 0.10000;   0/1213 tok/s;   9917 sec
[2019-08-01 03:38:16,787 INFO] Validation perplexity: 2.68812e+43
[2019-08-01 03:38:16,788 INFO] Validation accuracy: 0.789317
[2019-08-01 03:38:16,791 INFO] Saving checkpoint ../results/models/im2latex-13_step_20000.pt
[2019-08-01 03:42:26,035 INFO] Step 20500/100000; acc:   6.39; ppl: 26881171418161356094253400435962903554686976.00; xent: 109.02; lr: 0.10000;   0/756 tok/s;  10305 sec
[2019-08-01 03:46:29,784 INFO] Step 21000/100000; acc:   6.64; ppl: 26881171418161356094253400435962903554686976.00; xent: 105.21; lr: 0.10000;   0/1197 tok/s;  10549 sec
[2019-08-01 03:50:34,734 INFO] Step 21500/100000; acc:   6.42; ppl: 26881171418161356094253400435962903554686976.00; xent: 108.68; lr: 0.10000;   0/1199 tok/s;  10794 sec
[2019-08-01 03:54:37,010 INFO] Step 22000/100000; acc:   6.60; ppl: 26881171418161356094253400435962903554686976.00; xent: 103.34; lr: 0.10000;   0/1210 tok/s;  11036 sec
[2019-08-01 03:58:37,514 INFO] Step 22500/100000; acc:   6.31; ppl: 26881171418161356094253400435962903554686976.00; xent: 110.16; lr: 0.10000;   0/1203 tok/s;  11277 sec
[2019-08-01 04:02:42,205 INFO] Step 23000/100000; acc:   6.59; ppl: 26881171418161356094253400435962903554686976.00; xent: 110.49; lr: 0.10000;   0/1206 tok/s;  11522 sec
[2019-08-01 04:07:02,146 INFO] Step 23500/100000; acc:   6.46; ppl: 26881171418161356094253400435962903554686976.00; xent: 107.67; lr: 0.10000;   0/1138 tok/s;  11781 sec
[2019-08-01 04:11:18,857 INFO] Step 24000/100000; acc:   6.48; ppl: 26881171418161356094253400435962903554686976.00; xent: 109.79; lr: 0.10000;   0/1136 tok/s;  12038 sec
[2019-08-01 04:15:19,676 INFO] Step 24500/100000; acc:   6.55; ppl: 26881171418161356094253400435962903554686976.00; xent: 109.60; lr: 0.10000;   0/1211 tok/s;  12279 sec
[2019-08-01 04:19:20,899 INFO] Step 25000/100000; acc:   6.44; ppl: 26881171418161356094253400435962903554686976.00; xent: 110.69; lr: 0.10000;   0/1207 tok/s;  12520 sec
[2019-08-01 04:23:24,948 INFO] Step 25500/100000; acc:   6.23; ppl: 26881171418161356094253400435962903554686976.00; xent: 108.31; lr: 0.10000;   0/1204 tok/s;  12764 sec
[2019-08-01 04:27:28,129 INFO] Step 26000/100000; acc:   6.41; ppl: 26881171418161356094253400435962903554686976.00; xent: 106.60; lr: 0.10000;   0/1204 tok/s;  13007 sec
[2019-08-01 04:31:36,549 INFO] Step 26500/100000; acc:   6.82; ppl: 26881171418161356094253400435962903554686976.00; xent: 106.31; lr: 0.10000;   0/1200 tok/s;  13256 sec
[2019-08-01 04:35:36,354 INFO] Step 27000/100000; acc:   6.70; ppl: 26881171418161356094253400435962903554686976.00; xent: 107.59; lr: 0.10000;   0/1212 tok/s;  13496 sec
[2019-08-01 04:39:38,726 INFO] Step 27500/100000; acc:   6.46; ppl: 26881171418161356094253400435962903554686976.00; xent: 108.65; lr: 0.10000;   0/1206 tok/s;  13738 sec
[2019-08-01 04:43:44,044 INFO] Step 28000/100000; acc:   6.44; ppl: 26881171418161356094253400435962903554686976.00; xent: 108.74; lr: 0.10000;   0/1195 tok/s;  13983 sec
[2019-08-01 04:47:50,767 INFO] Step 28500/100000; acc:   6.48; ppl: 26881171418161356094253400435962903554686976.00; xent: 110.31; lr: 0.10000;   0/1191 tok/s;  14230 sec
[2019-08-01 04:51:55,126 INFO] Step 29000/100000; acc:   6.66; ppl: 26881171418161356094253400435962903554686976.00; xent: 110.07; lr: 0.10000;   0/1202 tok/s;  14474 sec
[2019-08-01 04:55:55,330 INFO] Step 29500/100000; acc:   6.62; ppl: 26881171418161356094253400435962903554686976.00; xent: 104.36; lr: 0.10000;   0/1218 tok/s;  14715 sec
[2019-08-01 04:59:52,699 INFO] Step 30000/100000; acc:   6.59; ppl: 26881171418161356094253400435962903554686976.00; xent: 108.22; lr: 0.10000;   0/1223 tok/s;  14952 sec
[2019-08-01 05:02:10,743 INFO] Validation perplexity: 3.53269e+41
[2019-08-01 05:02:10,744 INFO] Validation accuracy: 0.367316
[2019-08-01 05:02:10,747 INFO] Saving checkpoint ../results/models/im2latex-13_step_30000.pt
[2019-08-01 05:06:18,366 INFO] Step 30500/100000; acc:   6.25; ppl: 26881171418161356094253400435962903554686976.00; xent: 110.21; lr: 0.10000;   0/759 tok/s;  15338 sec
[2019-08-01 05:10:29,287 INFO] Step 31000/100000; acc:   6.71; ppl: 26881171418161356094253400435962903554686976.00; xent: 109.85; lr: 0.10000;   0/1184 tok/s;  15589 sec
[2019-08-01 05:14:31,262 INFO] Step 31500/100000; acc:   6.36; ppl: 26881171418161356094253400435962903554686976.00; xent: 105.41; lr: 0.10000;   0/1205 tok/s;  15831 sec
[2019-08-01 05:18:34,018 INFO] Step 32000/100000; acc:   6.77; ppl: 26881171418161356094253400435962903554686976.00; xent: 112.38; lr: 0.10000;   0/1199 tok/s;  16073 sec
[2019-08-01 05:22:36,159 INFO] Step 32500/100000; acc:   6.53; ppl: 26881171418161356094253400435962903554686976.00; xent: 108.07; lr: 0.10000;   0/1198 tok/s;  16316 sec
[2019-08-01 05:26:36,067 INFO] Step 33000/100000; acc:   6.63; ppl: 26881171418161356094253400435962903554686976.00; xent: 105.86; lr: 0.10000;   0/1226 tok/s;  16555 sec
[2019-08-01 05:31:00,086 INFO] Step 33500/100000; acc:   6.49; ppl: 26881171418161356094253400435962903554686976.00; xent: 107.76; lr: 0.10000;   0/1117 tok/s;  16819 sec
[2019-08-01 05:35:12,192 INFO] Step 34000/100000; acc:   6.65; ppl: 26881171418161356094253400435962903554686976.00; xent: 106.12; lr: 0.10000;   0/1174 tok/s;  17072 sec
[2019-08-01 05:39:16,831 INFO] Step 34500/100000; acc:   6.60; ppl: 26881171418161356094253400435962903554686976.00; xent: 108.31; lr: 0.10000;   0/1196 tok/s;  17316 sec
[2019-08-01 05:43:17,694 INFO] Step 35000/100000; acc:   6.34; ppl: 26881171418161356094253400435962903554686976.00; xent: 106.75; lr: 0.10000;   0/1205 tok/s;  17557 sec
[2019-08-01 05:47:22,697 INFO] Step 35500/100000; acc:   6.48; ppl: 26881171418161356094253400435962903554686976.00; xent: 111.56; lr: 0.10000;   0/1199 tok/s;  17802 sec
[2019-08-01 05:51:31,997 INFO] Step 36000/100000; acc:   6.55; ppl: 26881171418161356094253400435962903554686976.00; xent: 107.43; lr: 0.10000;   0/1178 tok/s;  18051 sec
[2019-08-01 05:55:32,738 INFO] Step 36500/100000; acc:   6.44; ppl: 26881171418161356094253400435962903554686976.00; xent: 105.99; lr: 0.10000;   0/1215 tok/s;  18292 sec
[2019-08-01 05:59:34,406 INFO] Step 37000/100000; acc:   6.42; ppl: 26881171418161356094253400435962903554686976.00; xent: 109.15; lr: 0.10000;   0/1219 tok/s;  18534 sec
[2019-08-01 06:03:35,485 INFO] Step 37500/100000; acc:   6.50; ppl: 26881171418161356094253400435962903554686976.00; xent: 109.49; lr: 0.10000;   0/1203 tok/s;  18775 sec
[2019-08-01 06:07:40,232 INFO] Step 38000/100000; acc:   6.77; ppl: 26881171418161356094253400435962903554686976.00; xent: 107.44; lr: 0.10000;   0/1196 tok/s;  19020 sec
[2019-08-01 06:11:45,317 INFO] Step 38500/100000; acc:   6.57; ppl: 26881171418161356094253400435962903554686976.00; xent: 104.73; lr: 0.10000;   0/1204 tok/s;  19265 sec
[2019-08-01 06:15:51,058 INFO] Step 39000/100000; acc:   6.53; ppl: 26881171418161356094253400435962903554686976.00; xent: 111.47; lr: 0.10000;   0/1201 tok/s;  19510 sec
[2019-08-01 06:19:49,088 INFO] Step 39500/100000; acc:   6.49; ppl: 26881171418161356094253400435962903554686976.00; xent: 107.09; lr: 0.10000;   0/1216 tok/s;  19748 sec
[2019-08-01 06:23:49,747 INFO] Step 40000/100000; acc:   6.75; ppl: 26881171418161356094253400435962903554686976.00; xent: 109.40; lr: 0.10000;   0/1214 tok/s;  19989 sec
[2019-08-01 06:26:12,079 INFO] Validation perplexity: 2.68812e+43
[2019-08-01 06:26:12,080 INFO] Validation accuracy: 16.2855
[2019-08-01 06:26:12,086 INFO] Saving checkpoint ../results/models/im2latex-13_step_40000.pt
[2019-08-01 06:30:16,604 INFO] Step 40500/100000; acc:   6.43; ppl: 26881171418161356094253400435962903554686976.00; xent: 105.97; lr: 0.10000;   0/759 tok/s;  20376 sec
[2019-08-01 06:34:22,485 INFO] Step 41000/100000; acc:   6.47; ppl: 26881171418161356094253400435962903554686976.00; xent: 111.82; lr: 0.10000;   0/1195 tok/s;  20622 sec
[2019-08-01 06:38:28,605 INFO] Step 41500/100000; acc:   6.60; ppl: 26881171418161356094253400435962903554686976.00; xent: 108.51; lr: 0.10000;   0/1194 tok/s;  20868 sec
[2019-08-01 06:42:32,288 INFO] Step 42000/100000; acc:   6.73; ppl: 26881171418161356094253400435962903554686976.00; xent: 108.43; lr: 0.10000;   0/1211 tok/s;  21112 sec
[2019-08-01 06:46:30,361 INFO] Step 42500/100000; acc:   6.57; ppl: 26881171418161356094253400435962903554686976.00; xent: 107.72; lr: 0.10000;   0/1219 tok/s;  21350 sec
[2019-08-01 06:50:37,250 INFO] Step 43000/100000; acc:   6.39; ppl: 26881171418161356094253400435962903554686976.00; xent: 107.29; lr: 0.10000;   0/1187 tok/s;  21597 sec
[2019-08-01 06:55:06,467 INFO] Step 43500/100000; acc:   6.39; ppl: 26881171418161356094253400435962903554686976.00; xent: 110.87; lr: 0.10000;   0/1088 tok/s;  21866 sec
[2019-08-01 06:57:39,656 INFO] Step 44000/100000; acc:   6.78; ppl: 26881171418161356094253400435962903554686976.00; xent: 103.80; lr: 0.10000;   0/1904 tok/s;  22019 sec
[2019-08-01 07:00:13,487 INFO] Step 44500/100000; acc:   6.47; ppl: 26881171418161356094253400435962903554686976.00; xent: 108.94; lr: 0.10000;   0/1920 tok/s;  22173 sec
[2019-08-01 07:02:42,486 INFO] Step 45000/100000; acc:   6.34; ppl: 26881171418161356094253400435962903554686976.00; xent: 109.53; lr: 0.10000;   0/1953 tok/s;  22322 sec
[2019-08-01 07:05:16,316 INFO] Step 45500/100000; acc:   6.36; ppl: 26881171418161356094253400435962903554686976.00; xent: 107.19; lr: 0.10000;   0/1893 tok/s;  22476 sec
[2019-08-01 07:07:49,378 INFO] Step 46000/100000; acc:   6.52; ppl: 26881171418161356094253400435962903554686976.00; xent: 110.44; lr: 0.10000;   0/1934 tok/s;  22629 sec
[2019-08-01 07:10:23,057 INFO] Step 46500/100000; acc:   6.40; ppl: 26881171418161356094253400435962903554686976.00; xent: 110.47; lr: 0.10000;   0/1916 tok/s;  22782 sec
[2019-08-01 07:12:55,418 INFO] Step 47000/100000; acc:   6.47; ppl: 26881171418161356094253400435962903554686976.00; xent: 108.27; lr: 0.10000;   0/1907 tok/s;  22935 sec
[2019-08-01 07:15:30,874 INFO] Step 47500/100000; acc:   6.61; ppl: 26881171418161356094253400435962903554686976.00; xent: 107.55; lr: 0.10000;   0/1880 tok/s;  23090 sec
[2019-08-01 07:18:02,740 INFO] Step 48000/100000; acc:   6.63; ppl: 26881171418161356094253400435962903554686976.00; xent: 106.81; lr: 0.10000;   0/1920 tok/s;  23242 sec
[2019-08-01 07:20:36,274 INFO] Step 48500/100000; acc:   6.37; ppl: 26881171418161356094253400435962903554686976.00; xent: 109.92; lr: 0.10000;   0/1903 tok/s;  23396 sec
[2019-08-01 07:23:09,102 INFO] Step 49000/100000; acc:   6.65; ppl: 26881171418161356094253400435962903554686976.00; xent: 111.10; lr: 0.10000;   0/1932 tok/s;  23548 sec
[2019-08-01 07:25:41,772 INFO] Step 49500/100000; acc:   6.61; ppl: 26881171418161356094253400435962903554686976.00; xent: 104.97; lr: 0.10000;   0/1948 tok/s;  23701 sec
[2019-08-01 07:28:14,244 INFO] Step 50000/100000; acc:   6.53; ppl: 26881171418161356094253400435962903554686976.00; xent: 109.16; lr: 0.05000;   0/1893 tok/s;  23854 sec
[2019-08-01 07:29:39,297 INFO] Validation perplexity: 2.68812e+43
[2019-08-01 07:29:39,298 INFO] Validation accuracy: 16.2855
[2019-08-01 07:29:39,301 INFO] Saving checkpoint ../results/models/im2latex-13_step_50000.pt
[2019-08-01 07:32:14,878 INFO] Step 50500/100000; acc:   7.28; ppl: 944797100307446016.00; xent: 41.39; lr: 0.05000;   0/1221 tok/s;  24094 sec
[2019-08-01 07:34:47,474 INFO] Step 51000/100000; acc:   7.45; ppl: 366025372623279.69; xent: 33.53; lr: 0.05000;   0/1924 tok/s;  24247 sec
[2019-08-01 07:37:20,986 INFO] Step 51500/100000; acc:   7.68; ppl: 67793088071473.29; xent: 31.85; lr: 0.05000;   0/1902 tok/s;  24400 sec
[2019-08-01 07:39:55,675 INFO] Step 52000/100000; acc:   8.01; ppl: 321045081167753.25; xent: 33.40; lr: 0.05000;   0/1905 tok/s;  24555 sec
[2019-08-01 07:42:23,577 INFO] Step 52500/100000; acc:   7.06; ppl: 494770342150796.00; xent: 33.84; lr: 0.05000;   0/1970 tok/s;  24703 sec
[2019-08-01 07:45:01,242 INFO] Step 53000/100000; acc:   7.52; ppl: 179757563297509.22; xent: 32.82; lr: 0.05000;   0/1844 tok/s;  24861 sec
[2019-08-01 07:48:18,961 INFO] Step 53500/100000; acc:   7.51; ppl: 73795871039626.84; xent: 31.93; lr: 0.05000;   0/1488 tok/s;  25058 sec
[2019-08-01 07:51:30,057 INFO] Step 54000/100000; acc:   7.59; ppl: 437103254354700.88; xent: 33.71; lr: 0.05000;   0/1549 tok/s;  25249 sec
[2019-08-01 07:54:33,502 INFO] Step 54500/100000; acc:   7.70; ppl: 779459346867938.00; xent: 34.29; lr: 0.05000;   0/1591 tok/s;  25433 sec
[2019-08-01 07:57:38,654 INFO] Step 55000/100000; acc:   7.37; ppl: 187173511137149.75; xent: 32.86; lr: 0.05000;   0/1571 tok/s;  25618 sec
[2019-08-01 08:00:41,453 INFO] Step 55500/100000; acc:   7.93; ppl: 85515533903082.19; xent: 32.08; lr: 0.05000;   0/1593 tok/s;  25801 sec
[2019-08-01 08:03:51,032 INFO] Step 56000/100000; acc:   7.32; ppl: 79672536164215.83; xent: 32.01; lr: 0.05000;   0/1554 tok/s;  25990 sec
[2019-08-01 08:06:56,538 INFO] Step 56500/100000; acc:   7.57; ppl: 314098009059605.06; xent: 33.38; lr: 0.05000;   0/1579 tok/s;  26176 sec
[2019-08-01 08:10:02,570 INFO] Step 57000/100000; acc:   7.17; ppl: 2910288739139847.00; xent: 35.61; lr: 0.05000;   0/1601 tok/s;  26362 sec
[2019-08-01 08:13:15,106 INFO] Step 57500/100000; acc:   7.44; ppl: 292205005773516.25; xent: 33.31; lr: 0.05000;   0/1511 tok/s;  26554 sec
[2019-08-01 08:16:15,222 INFO] Step 58000/100000; acc:   7.51; ppl: 153476340633254.19; xent: 32.66; lr: 0.05000;   0/1620 tok/s;  26735 sec
[2019-08-01 08:19:22,311 INFO] Step 58500/100000; acc:   7.68; ppl: 146128840762141.28; xent: 32.62; lr: 0.05000;   0/1568 tok/s;  26922 sec
[2019-08-01 08:22:31,440 INFO] Step 59000/100000; acc:   7.72; ppl: 121294300696194.73; xent: 32.43; lr: 0.05000;   0/1556 tok/s;  27111 sec
[2019-08-01 08:25:38,308 INFO] Step 59500/100000; acc:   7.67; ppl: 133376871650026.89; xent: 32.52; lr: 0.05000;   0/1567 tok/s;  27298 sec
[2019-08-01 08:28:46,942 INFO] Step 60000/100000; acc:   7.39; ppl: 64152543229215.73; xent: 31.79; lr: 0.02500;   0/1555 tok/s;  27486 sec
[2019-08-01 08:30:31,798 INFO] Validation perplexity: 2.56355e+13
[2019-08-01 08:30:31,799 INFO] Validation accuracy: 16.2855
[2019-08-01 08:30:31,803 INFO] Saving checkpoint ../results/models/im2latex-13_step_60000.pt
[2019-08-01 08:33:37,769 INFO] Step 60500/100000; acc:  10.13; ppl: 220682.85; xent: 12.30; lr: 0.02500;   0/998 tok/s;  27777 sec
[2019-08-01 08:36:49,272 INFO] Step 61000/100000; acc:  10.65; ppl: 21701.78; xent: 9.99; lr: 0.02500;   0/1525 tok/s;  27969 sec
[2019-08-01 08:40:00,441 INFO] Step 61500/100000; acc:  10.64; ppl: 12622.80; xent: 9.44; lr: 0.02500;   0/1552 tok/s;  28160 sec
[2019-08-01 08:43:07,777 INFO] Step 62000/100000; acc:  10.66; ppl: 11442.95; xent: 9.35; lr: 0.02500;   0/1562 tok/s;  28347 sec
[2019-08-01 08:46:12,344 INFO] Step 62500/100000; acc:  10.45; ppl: 12999.89; xent: 9.47; lr: 0.02500;   0/1574 tok/s;  28532 sec
[2019-08-01 08:49:13,135 INFO] Step 63000/100000; acc:  10.79; ppl: 9700.47; xent: 9.18; lr: 0.02500;   0/1609 tok/s;  28712 sec
[2019-08-01 08:52:24,880 INFO] Step 63500/100000; acc:  10.95; ppl: 7798.18; xent: 8.96; lr: 0.02500;   0/1531 tok/s;  28904 sec
[2019-08-01 08:55:34,153 INFO] Step 64000/100000; acc:  10.44; ppl: 15483.12; xent: 9.65; lr: 0.02500;   0/1559 tok/s;  29094 sec
[2019-08-01 08:58:42,565 INFO] Step 64500/100000; acc:  10.88; ppl: 11220.21; xent: 9.33; lr: 0.02500;   0/1566 tok/s;  29282 sec
[2019-08-01 09:01:49,008 INFO] Step 65000/100000; acc:  11.25; ppl: 7621.10; xent: 8.94; lr: 0.02500;   0/1570 tok/s;  29468 sec
[2019-08-01 09:04:53,797 INFO] Step 65500/100000; acc:  10.40; ppl: 11062.62; xent: 9.31; lr: 0.02500;   0/1575 tok/s;  29653 sec
[2019-08-01 09:08:04,362 INFO] Step 66000/100000; acc:  10.70; ppl: 11623.73; xent: 9.36; lr: 0.02500;   0/1540 tok/s;  29844 sec
[2019-08-01 09:11:17,015 INFO] Step 66500/100000; acc:  10.44; ppl: 15265.99; xent: 9.63; lr: 0.02500;   0/1522 tok/s;  30036 sec
[2019-08-01 09:14:22,741 INFO] Step 67000/100000; acc:  10.31; ppl: 15309.85; xent: 9.64; lr: 0.02500;   0/1570 tok/s;  30222 sec
[2019-08-01 09:17:33,866 INFO] Step 67500/100000; acc:  10.58; ppl: 10790.96; xent: 9.29; lr: 0.02500;   0/1545 tok/s;  30413 sec
[2019-08-01 09:20:37,453 INFO] Step 68000/100000; acc:  11.00; ppl: 6864.96; xent: 8.83; lr: 0.02500;   0/1579 tok/s;  30597 sec
[2019-08-01 09:23:46,291 INFO] Step 68500/100000; acc:  10.59; ppl: 9393.41; xent: 9.15; lr: 0.02500;   0/1545 tok/s;  30786 sec
[2019-08-01 09:26:56,260 INFO] Step 69000/100000; acc:  10.73; ppl: 9727.26; xent: 9.18; lr: 0.02500;   0/1556 tok/s;  30976 sec
[2019-08-01 09:30:03,796 INFO] Step 69500/100000; acc:  10.29; ppl: 12687.10; xent: 9.45; lr: 0.02500;   0/1572 tok/s;  31163 sec
[2019-08-01 09:33:15,554 INFO] Step 70000/100000; acc:  10.73; ppl: 11100.22; xent: 9.31; lr: 0.01250;   0/1512 tok/s;  31355 sec
[2019-08-01 09:35:01,852 INFO] Validation perplexity: 13499.9
[2019-08-01 09:35:01,853 INFO] Validation accuracy: 16.2855
[2019-08-01 09:35:01,856 INFO] Saving checkpoint ../results/models/im2latex-13_step_70000.pt
[2019-08-01 09:38:11,144 INFO] Step 70500/100000; acc:  14.06; ppl: 311.53; xent: 5.74; lr: 0.01250;   0/991 tok/s;  31650 sec
[2019-08-01 09:41:20,961 INFO] Step 71000/100000; acc:  13.77; ppl: 210.81; xent: 5.35; lr: 0.01250;   0/1543 tok/s;  31840 sec
[2019-08-01 09:44:29,162 INFO] Step 71500/100000; acc:  14.27; ppl: 199.41; xent: 5.30; lr: 0.01250;   0/1563 tok/s;  32029 sec
[2019-08-01 09:47:35,716 INFO] Step 72000/100000; acc:  14.69; ppl: 178.13; xent: 5.18; lr: 0.01250;   0/1571 tok/s;  32215 sec
[2019-08-01 09:50:48,920 INFO] Step 72500/100000; acc:  14.59; ppl: 170.49; xent: 5.14; lr: 0.01250;   0/1533 tok/s;  32408 sec
[2019-08-01 09:53:53,172 INFO] Step 73000/100000; acc:  14.21; ppl: 176.28; xent: 5.17; lr: 0.01250;   0/1570 tok/s;  32593 sec
[2019-08-01 09:57:07,328 INFO] Step 73500/100000; acc:  14.10; ppl: 199.39; xent: 5.30; lr: 0.01250;   0/1512 tok/s;  32787 sec
[2019-08-01 10:00:12,233 INFO] Step 74000/100000; acc:  13.79; ppl: 189.16; xent: 5.24; lr: 0.01250;   0/1586 tok/s;  32972 sec
[2019-08-01 10:03:20,254 INFO] Step 74500/100000; acc:  14.53; ppl: 179.14; xent: 5.19; lr: 0.01250;   0/1555 tok/s;  33160 sec
[2019-08-01 10:06:33,361 INFO] Step 75000/100000; acc:  14.15; ppl: 185.20; xent: 5.22; lr: 0.01250;   0/1521 tok/s;  33353 sec
[2019-08-01 10:09:35,003 INFO] Step 75500/100000; acc:  13.96; ppl: 175.05; xent: 5.17; lr: 0.01250;   0/1608 tok/s;  33534 sec
[2019-08-01 10:12:51,312 INFO] Step 76000/100000; acc:  14.61; ppl: 172.74; xent: 5.15; lr: 0.01250;   0/1480 tok/s;  33731 sec
[2019-08-01 10:15:59,090 INFO] Step 76500/100000; acc:  14.61; ppl: 182.39; xent: 5.21; lr: 0.01250;   0/1576 tok/s;  33918 sec
[2019-08-01 10:19:07,181 INFO] Step 77000/100000; acc:  14.23; ppl: 191.22; xent: 5.25; lr: 0.01250;   0/1571 tok/s;  34107 sec
[2019-08-01 10:22:13,825 INFO] Step 77500/100000; acc:  14.52; ppl: 171.64; xent: 5.15; lr: 0.01250;   0/1554 tok/s;  34293 sec
[2019-08-01 10:25:19,734 INFO] Step 78000/100000; acc:  14.60; ppl: 165.98; xent: 5.11; lr: 0.01250;   0/1572 tok/s;  34479 sec
[2019-08-01 10:28:27,858 INFO] Step 78500/100000; acc:  14.46; ppl: 183.76; xent: 5.21; lr: 0.01250;   0/1546 tok/s;  34667 sec
[2019-08-01 10:31:37,294 INFO] Step 79000/100000; acc:  14.49; ppl: 180.74; xent: 5.20; lr: 0.01250;   0/1550 tok/s;  34857 sec
[2019-08-01 10:34:45,616 INFO] Step 79500/100000; acc:  14.53; ppl: 188.59; xent: 5.24; lr: 0.01250;   0/1568 tok/s;  35045 sec
[2019-08-01 10:38:00,820 INFO] Step 80000/100000; acc:  14.32; ppl: 175.08; xent: 5.17; lr: 0.00625;   0/1521 tok/s;  35240 sec
[2019-08-01 10:39:45,543 INFO] Validation perplexity: 136.412
[2019-08-01 10:39:45,544 INFO] Validation accuracy: 16.2855
[2019-08-01 10:39:45,547 INFO] Saving checkpoint ../results/models/im2latex-13_step_80000.pt
[2019-08-01 10:42:53,623 INFO] Step 80500/100000; acc:  15.82; ppl: 92.81; xent: 4.53; lr: 0.00625;   0/987 tok/s;  35533 sec
[2019-08-01 10:46:54,021 INFO] Step 81000/100000; acc:  15.74; ppl: 89.85; xent: 4.50; lr: 0.00625;   0/1222 tok/s;  35773 sec
[2019-08-01 10:50:01,084 INFO] Step 81500/100000; acc:  15.71; ppl: 88.96; xent: 4.49; lr: 0.00625;   0/1569 tok/s;  35960 sec
[2019-08-01 10:53:16,232 INFO] Step 82000/100000; acc:  15.92; ppl: 89.14; xent: 4.49; lr: 0.00625;   0/1500 tok/s;  36156 sec
[2019-08-01 10:57:14,537 INFO] Step 82500/100000; acc:  15.94; ppl: 88.10; xent: 4.48; lr: 0.00625;   0/1238 tok/s;  36394 sec
[2019-08-01 11:00:25,091 INFO] Step 83000/100000; acc:  15.89; ppl: 86.88; xent: 4.46; lr: 0.00625;   0/1529 tok/s;  36584 sec
[2019-08-01 11:03:26,981 INFO] Step 83500/100000; acc:  16.00; ppl: 84.73; xent: 4.44; lr: 0.00625;   0/1598 tok/s;  36766 sec
[2019-08-01 11:06:40,184 INFO] Step 84000/100000; acc:  15.92; ppl: 89.28; xent: 4.49; lr: 0.00625;   0/1515 tok/s;  36960 sec
[2019-08-01 11:10:11,493 INFO] Step 84500/100000; acc:  16.12; ppl: 85.78; xent: 4.45; lr: 0.00625;   0/1407 tok/s;  37171 sec
[2019-08-01 11:13:48,244 INFO] Step 85000/100000; acc:  16.13; ppl: 83.87; xent: 4.43; lr: 0.00625;   0/1346 tok/s;  37388 sec
[2019-08-01 11:16:51,504 INFO] Step 85500/100000; acc:  15.95; ppl: 84.58; xent: 4.44; lr: 0.00625;   0/1587 tok/s;  37571 sec
[2019-08-01 11:20:00,986 INFO] Step 86000/100000; acc:  16.11; ppl: 85.23; xent: 4.45; lr: 0.00625;   0/1533 tok/s;  37760 sec
[2019-08-01 11:23:24,741 INFO] Step 86500/100000; acc:  15.84; ppl: 87.79; xent: 4.47; lr: 0.00625;   0/1443 tok/s;  37964 sec
[2019-08-01 11:27:22,475 INFO] Step 87000/100000; acc:  15.83; ppl: 87.16; xent: 4.47; lr: 0.00625;   0/1230 tok/s;  38202 sec
[2019-08-01 11:30:54,340 INFO] Step 87500/100000; acc:  16.14; ppl: 83.97; xent: 4.43; lr: 0.00625;   0/1404 tok/s;  38414 sec
[2019-08-01 11:34:05,761 INFO] Step 88000/100000; acc:  15.94; ppl: 84.74; xent: 4.44; lr: 0.00625;   0/1522 tok/s;  38605 sec
[2019-08-01 11:37:09,766 INFO] Step 88500/100000; acc:  15.78; ppl: 86.71; xent: 4.46; lr: 0.00625;   0/1579 tok/s;  38789 sec
[2019-08-01 11:40:16,929 INFO] Step 89000/100000; acc:  15.87; ppl: 85.06; xent: 4.44; lr: 0.00625;   0/1574 tok/s;  38976 sec
[2019-08-01 11:43:25,208 INFO] Step 89500/100000; acc:  15.94; ppl: 86.82; xent: 4.46; lr: 0.00625;   0/1562 tok/s;  39165 sec
[2019-08-01 11:47:10,610 INFO] Step 90000/100000; acc:  15.96; ppl: 87.63; xent: 4.47; lr: 0.00313;   0/1299 tok/s;  39390 sec
[2019-08-01 11:48:55,026 INFO] Validation perplexity: 80.2142
[2019-08-01 11:48:55,027 INFO] Validation accuracy: 16.2855
[2019-08-01 11:48:55,032 INFO] Saving checkpoint ../results/models/im2latex-13_step_90000.pt
[2019-08-01 11:52:00,115 INFO] Step 90500/100000; acc:  16.24; ppl: 69.01; xent: 4.23; lr: 0.00313;   0/1012 tok/s;  39679 sec
[2019-08-01 11:55:06,099 INFO] Step 91000/100000; acc:  16.29; ppl: 66.17; xent: 4.19; lr: 0.00313;   0/1562 tok/s;  39865 sec
[2019-08-01 11:58:12,957 INFO] Step 91500/100000; acc:  16.25; ppl: 67.18; xent: 4.21; lr: 0.00313;   0/1567 tok/s;  40052 sec
[2019-08-01 12:01:16,465 INFO] Step 92000/100000; acc:  16.17; ppl: 66.47; xent: 4.20; lr: 0.00313;   0/1615 tok/s;  40236 sec
[2019-08-01 12:04:22,077 INFO] Step 92500/100000; acc:  16.31; ppl: 66.02; xent: 4.19; lr: 0.00313;   0/1578 tok/s;  40421 sec
[2019-08-01 12:07:23,906 INFO] Step 93000/100000; acc:  16.27; ppl: 65.75; xent: 4.19; lr: 0.00313;   0/1596 tok/s;  40603 sec
[2019-08-01 12:10:19,591 INFO] Step 93500/100000; acc:  16.37; ppl: 64.68; xent: 4.17; lr: 0.00313;   0/1656 tok/s;  40779 sec
[2019-08-01 12:13:11,105 INFO] Step 94000/100000; acc:  16.08; ppl: 66.22; xent: 4.19; lr: 0.00313;   0/1714 tok/s;  40950 sec
[2019-08-01 12:16:14,539 INFO] Step 94500/100000; acc:  16.19; ppl: 67.52; xent: 4.21; lr: 0.00313;   0/1603 tok/s;  41134 sec
[2019-08-01 12:19:07,086 INFO] Step 95000/100000; acc:  16.43; ppl: 65.77; xent: 4.19; lr: 0.00313;   0/1709 tok/s;  41306 sec
[2019-08-01 12:22:10,932 INFO] Step 95500/100000; acc:  16.39; ppl: 65.70; xent: 4.19; lr: 0.00313;   0/1599 tok/s;  41490 sec
[2019-08-01 12:25:01,852 INFO] Step 96000/100000; acc:  16.26; ppl: 65.03; xent: 4.17; lr: 0.00313;   0/1700 tok/s;  41661 sec
[2019-08-01 12:28:03,686 INFO] Step 96500/100000; acc:  16.19; ppl: 66.76; xent: 4.20; lr: 0.00313;   0/1614 tok/s;  41843 sec
[2019-08-01 12:31:00,784 INFO] Step 97000/100000; acc:  16.21; ppl: 66.90; xent: 4.20; lr: 0.00313;   0/1657 tok/s;  42020 sec
[2019-08-01 12:33:58,686 INFO] Step 97500/100000; acc:  16.30; ppl: 65.71; xent: 4.19; lr: 0.00313;   0/1640 tok/s;  42198 sec
[2019-08-01 12:36:55,272 INFO] Step 98000/100000; acc:  16.35; ppl: 66.26; xent: 4.19; lr: 0.00313;   0/1669 tok/s;  42375 sec
[2019-08-01 12:39:51,355 INFO] Step 98500/100000; acc:  16.28; ppl: 65.31; xent: 4.18; lr: 0.00313;   0/1652 tok/s;  42551 sec
[2019-08-01 12:42:44,127 INFO] Step 99000/100000; acc:  16.26; ppl: 65.20; xent: 4.18; lr: 0.00313;   0/1690 tok/s;  42723 sec
[2019-08-01 12:45:49,518 INFO] Step 99500/100000; acc:  16.14; ppl: 66.69; xent: 4.20; lr: 0.00313;   0/1589 tok/s;  42909 sec
[2019-08-01 12:49:06,450 INFO] Step 100000/100000; acc:  16.29; ppl: 66.05; xent: 4.19; lr: 0.00156;   0/1499 tok/s;  43106 sec
[2019-08-01 12:50:59,320 INFO] Validation perplexity: 61.4573
[2019-08-01 12:50:59,321 INFO] Validation accuracy: 16.2855
[2019-08-01 12:50:59,324 INFO] Saving checkpoint ../results/models/im2latex-13_step_100000.pt
