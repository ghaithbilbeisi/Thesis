[2019-10-25 12:47:46,169 INFO]  * tgt vocab size = 510
[2019-10-25 12:47:46,169 INFO] Building model...
[2019-10-25 12:47:50,129 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer3): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer5): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer6): DCN(
      (conv_offset_mask): Conv2d(512, 54, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    )
    (batch_norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(512, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 512)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-10-25 12:47:50,131 INFO] encoder: 8296310
[2019-10-25 12:47:50,131 INFO] decoder: 5214310
[2019-10-25 12:47:50,131 INFO] * number of parameters: 13510620
[2019-10-25 12:47:50,446 INFO] Starting training on GPU: [0]
[2019-10-25 12:47:50,447 INFO] Start training loop and validate every 10000 steps...
[2019-10-25 12:51:04,785 INFO] Step 500/100000; acc:  29.09; ppl: 38.06; xent: 3.64; lr: 0.10000;   0/3028 tok/s;    194 sec
[2019-10-25 12:54:12,194 INFO] Step 1000/100000; acc:  44.80; ppl: 13.28; xent: 2.59; lr: 0.10000;   0/3102 tok/s;    382 sec
[2019-10-25 12:57:23,920 INFO] Step 1500/100000; acc:  49.52; ppl:  9.85; xent: 2.29; lr: 0.10000;   0/3072 tok/s;    573 sec
[2019-10-25 13:00:35,090 INFO] Step 2000/100000; acc:  61.31; ppl:  5.31; xent: 1.67; lr: 0.10000;   0/3069 tok/s;    765 sec
[2019-10-25 13:03:46,619 INFO] Step 2500/100000; acc:  76.09; ppl:  2.76; xent: 1.02; lr: 0.10000;   0/3048 tok/s;    956 sec
[2019-10-25 13:06:59,297 INFO] Step 3000/100000; acc:  82.63; ppl:  2.09; xent: 0.74; lr: 0.10000;   0/3047 tok/s;   1149 sec
[2019-10-25 13:10:10,560 INFO] Step 3500/100000; acc:  86.10; ppl:  1.79; xent: 0.58; lr: 0.10000;   0/3057 tok/s;   1340 sec
[2019-10-25 13:13:34,644 INFO] Step 4000/100000; acc:  87.95; ppl:  1.65; xent: 0.50; lr: 0.10000;   0/2878 tok/s;   1544 sec
[2019-10-25 13:16:58,075 INFO] Step 4500/100000; acc:  89.28; ppl:  1.55; xent: 0.44; lr: 0.10000;   0/2871 tok/s;   1748 sec
[2019-10-25 13:20:20,046 INFO] Step 5000/100000; acc:  90.34; ppl:  1.49; xent: 0.40; lr: 0.10000;   0/2900 tok/s;   1950 sec
[2019-10-25 13:23:41,789 INFO] Step 5500/100000; acc:  91.02; ppl:  1.44; xent: 0.37; lr: 0.10000;   0/2911 tok/s;   2151 sec
[2019-10-25 13:27:01,916 INFO] Step 6000/100000; acc:  91.49; ppl:  1.41; xent: 0.35; lr: 0.10000;   0/2924 tok/s;   2351 sec
[2019-10-25 13:30:29,203 INFO] Step 6500/100000; acc:  91.97; ppl:  1.38; xent: 0.32; lr: 0.10000;   0/2828 tok/s;   2559 sec
[2019-10-25 13:33:51,098 INFO] Step 7000/100000; acc:  92.42; ppl:  1.35; xent: 0.30; lr: 0.10000;   0/2905 tok/s;   2761 sec
[2019-10-25 13:37:12,774 INFO] Step 7500/100000; acc:  92.94; ppl:  1.32; xent: 0.28; lr: 0.10000;   0/2891 tok/s;   2962 sec
[2019-10-25 13:40:40,035 INFO] Step 8000/100000; acc:  93.00; ppl:  1.32; xent: 0.28; lr: 0.10000;   0/2846 tok/s;   3170 sec
[2019-10-25 13:44:03,161 INFO] Step 8500/100000; acc:  93.62; ppl:  1.29; xent: 0.25; lr: 0.10000;   0/2868 tok/s;   3373 sec
[2019-10-25 13:47:23,398 INFO] Step 9000/100000; acc:  93.90; ppl:  1.28; xent: 0.24; lr: 0.10000;   0/2922 tok/s;   3573 sec
[2019-10-25 13:50:48,533 INFO] Step 9500/100000; acc:  94.14; ppl:  1.26; xent: 0.23; lr: 0.10000;   0/2891 tok/s;   3778 sec
[2019-10-25 13:54:08,139 INFO] Step 10000/100000; acc:  94.36; ppl:  1.25; xent: 0.23; lr: 0.10000;   0/2916 tok/s;   3978 sec
[2019-10-25 13:55:30,977 INFO] Validation perplexity: 1.24847
[2019-10-25 13:55:30,977 INFO] Validation accuracy: 94.4265
[2019-10-25 13:55:30,981 INFO] Saving checkpoint ../results/models/im2latex-42_step_10000.pt
[2019-10-25 13:58:55,998 INFO] Step 10500/100000; acc:  94.54; ppl:  1.24; xent: 0.22; lr: 0.10000;   0/2034 tok/s;   4266 sec
[2019-10-25 14:02:15,165 INFO] Step 11000/100000; acc:  94.67; ppl:  1.23; xent: 0.21; lr: 0.10000;   0/2946 tok/s;   4465 sec
[2019-10-25 14:05:29,484 INFO] Step 11500/100000; acc:  94.83; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/3009 tok/s;   4659 sec
[2019-10-25 14:08:46,533 INFO] Step 12000/100000; acc:  94.97; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/2981 tok/s;   4856 sec
[2019-10-25 14:11:56,661 INFO] Step 12500/100000; acc:  95.22; ppl:  1.20; xent: 0.19; lr: 0.10000;   0/3064 tok/s;   5046 sec
[2019-10-25 14:15:11,598 INFO] Step 13000/100000; acc:  95.27; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/3006 tok/s;   5241 sec
[2019-10-25 14:18:27,116 INFO] Step 13500/100000; acc:  95.39; ppl:  1.19; xent: 0.18; lr: 0.10000;   0/3010 tok/s;   5437 sec
[2019-10-25 14:21:41,962 INFO] Step 14000/100000; acc:  95.41; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/3003 tok/s;   5632 sec
[2019-10-25 14:24:56,822 INFO] Step 14500/100000; acc:  95.47; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/3015 tok/s;   5826 sec
[2019-10-25 14:28:11,266 INFO] Step 15000/100000; acc:  95.63; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/2999 tok/s;   6021 sec
[2019-10-25 14:31:30,824 INFO] Step 15500/100000; acc:  95.63; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/2953 tok/s;   6220 sec
[2019-10-25 14:34:46,311 INFO] Step 16000/100000; acc:  95.85; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/2983 tok/s;   6416 sec
[2019-10-25 14:37:58,553 INFO] Step 16500/100000; acc:  95.90; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/3037 tok/s;   6608 sec
[2019-10-25 14:41:12,623 INFO] Step 17000/100000; acc:  96.01; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/3030 tok/s;   6802 sec
[2019-10-25 14:44:24,803 INFO] Step 17500/100000; acc:  95.93; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/3036 tok/s;   6994 sec
[2019-10-25 14:47:39,380 INFO] Step 18000/100000; acc:  96.08; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/3019 tok/s;   7189 sec
[2019-10-25 14:50:54,720 INFO] Step 18500/100000; acc:  96.07; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/3005 tok/s;   7384 sec
[2019-10-25 14:54:06,088 INFO] Step 19000/100000; acc:  96.27; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/3040 tok/s;   7576 sec
[2019-10-25 14:57:24,383 INFO] Step 19500/100000; acc:  96.18; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/2977 tok/s;   7774 sec
[2019-10-25 15:00:35,905 INFO] Step 20000/100000; acc:  96.38; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/3039 tok/s;   7965 sec
[2019-10-25 15:01:56,219 INFO] Validation perplexity: 1.18516
[2019-10-25 15:01:56,220 INFO] Validation accuracy: 95.6202
[2019-10-25 15:01:56,223 INFO] Saving checkpoint ../results/models/im2latex-42_step_20000.pt
[2019-10-25 15:05:12,022 INFO] Step 20500/100000; acc:  96.48; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2127 tok/s;   8242 sec
[2019-10-25 15:08:29,714 INFO] Step 21000/100000; acc:  96.49; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2989 tok/s;   8439 sec
[2019-10-25 15:11:42,159 INFO] Step 21500/100000; acc:  96.50; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/3031 tok/s;   8632 sec
[2019-10-25 15:14:58,169 INFO] Step 22000/100000; acc:  96.48; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2984 tok/s;   8828 sec
[2019-10-25 15:18:13,252 INFO] Step 22500/100000; acc:  96.49; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/3004 tok/s;   9023 sec
[2019-10-25 15:21:29,698 INFO] Step 23000/100000; acc:  96.61; ppl:  1.13; xent: 0.13; lr: 0.10000;   0/2990 tok/s;   9219 sec
[2019-10-25 15:24:45,125 INFO] Step 23500/100000; acc:  96.66; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2994 tok/s;   9415 sec
[2019-10-25 15:27:56,834 INFO] Step 24000/100000; acc:  96.65; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/3044 tok/s;   9606 sec
[2019-10-25 15:31:10,908 INFO] Step 24500/100000; acc:  96.74; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/3019 tok/s;   9800 sec
[2019-10-25 15:34:25,128 INFO] Step 25000/100000; acc:  96.78; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/3020 tok/s;   9995 sec
[2019-10-25 15:37:38,499 INFO] Step 25500/100000; acc:  96.70; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/3039 tok/s;  10188 sec
[2019-10-25 15:40:53,403 INFO] Step 26000/100000; acc:  96.69; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/3009 tok/s;  10383 sec
[2019-10-25 15:44:06,212 INFO] Step 26500/100000; acc:  96.81; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/3019 tok/s;  10576 sec
[2019-10-25 15:47:22,381 INFO] Step 27000/100000; acc:  96.79; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/3008 tok/s;  10772 sec
[2019-10-25 15:50:35,319 INFO] Step 27500/100000; acc:  96.90; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3019 tok/s;  10965 sec
[2019-10-25 15:53:46,696 INFO] Step 28000/100000; acc:  96.88; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3062 tok/s;  11156 sec
[2019-10-25 15:56:59,228 INFO] Step 28500/100000; acc:  96.96; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3056 tok/s;  11349 sec
[2019-10-25 16:00:12,062 INFO] Step 29000/100000; acc:  97.00; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3020 tok/s;  11542 sec
[2019-10-25 16:03:26,700 INFO] Step 29500/100000; acc:  96.97; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3023 tok/s;  11736 sec
[2019-10-25 16:06:39,917 INFO] Step 30000/100000; acc:  96.93; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/3031 tok/s;  11929 sec
[2019-10-25 16:08:00,080 INFO] Validation perplexity: 1.18843
[2019-10-25 16:08:00,080 INFO] Validation accuracy: 95.2486
[2019-10-25 16:08:00,084 INFO] Saving checkpoint ../results/models/im2latex-42_step_30000.pt
[2019-10-25 16:11:12,125 INFO] Step 30500/100000; acc:  97.04; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/2142 tok/s;  12202 sec
[2019-10-25 16:14:29,345 INFO] Step 31000/100000; acc:  97.02; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/2987 tok/s;  12399 sec
[2019-10-25 16:17:40,641 INFO] Step 31500/100000; acc:  97.10; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/3039 tok/s;  12590 sec
[2019-10-25 16:20:53,667 INFO] Step 32000/100000; acc:  97.15; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/3046 tok/s;  12783 sec
[2019-10-25 16:24:08,829 INFO] Step 32500/100000; acc:  97.13; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/3024 tok/s;  12978 sec
[2019-10-25 16:27:21,970 INFO] Step 33000/100000; acc:  97.19; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/3025 tok/s;  13172 sec
[2019-10-25 16:30:38,386 INFO] Step 33500/100000; acc:  97.17; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/2978 tok/s;  13368 sec
[2019-10-25 16:33:50,450 INFO] Step 34000/100000; acc:  97.24; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/3047 tok/s;  13560 sec
[2019-10-25 16:37:04,602 INFO] Step 34500/100000; acc:  97.24; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/3023 tok/s;  13754 sec
[2019-10-25 16:40:20,147 INFO] Step 35000/100000; acc:  97.25; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/2993 tok/s;  13950 sec
[2019-10-25 16:43:31,530 INFO] Step 35500/100000; acc:  97.27; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/3060 tok/s;  14141 sec
[2019-10-25 16:46:45,160 INFO] Step 36000/100000; acc:  97.30; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/3028 tok/s;  14335 sec
[2019-10-25 16:49:58,715 INFO] Step 36500/100000; acc:  97.35; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/3027 tok/s;  14528 sec
[2019-10-25 16:53:14,769 INFO] Step 37000/100000; acc:  97.34; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/2992 tok/s;  14724 sec
[2019-10-25 16:56:28,372 INFO] Step 37500/100000; acc:  97.31; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/3024 tok/s;  14918 sec
[2019-10-25 16:59:42,062 INFO] Step 38000/100000; acc:  97.42; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3011 tok/s;  15112 sec
[2019-10-25 17:02:59,283 INFO] Step 38500/100000; acc:  97.31; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/2996 tok/s;  15309 sec
[2019-10-25 17:06:11,572 INFO] Step 39000/100000; acc:  97.47; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3030 tok/s;  15501 sec
[2019-10-25 17:09:22,800 INFO] Step 39500/100000; acc:  97.41; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/3056 tok/s;  15692 sec
[2019-10-25 17:12:38,083 INFO] Step 40000/100000; acc:  97.44; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3021 tok/s;  15888 sec
[2019-10-25 17:13:58,896 INFO] Validation perplexity: 1.13558
[2019-10-25 17:13:58,897 INFO] Validation accuracy: 96.6815
[2019-10-25 17:13:58,900 INFO] Saving checkpoint ../results/models/im2latex-42_step_40000.pt
[2019-10-25 17:17:11,749 INFO] Step 40500/100000; acc:  97.46; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/2128 tok/s;  16161 sec
[2019-10-25 17:20:27,155 INFO] Step 41000/100000; acc:  97.45; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3000 tok/s;  16357 sec
[2019-10-25 17:23:41,767 INFO] Step 41500/100000; acc:  97.40; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3013 tok/s;  16551 sec
[2019-10-25 17:26:54,432 INFO] Step 42000/100000; acc:  97.51; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3030 tok/s;  16744 sec
[2019-10-25 17:30:12,543 INFO] Step 42500/100000; acc:  97.48; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/2972 tok/s;  16942 sec
[2019-10-25 17:33:23,025 INFO] Step 43000/100000; acc:  97.46; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3051 tok/s;  17133 sec
[2019-10-25 17:36:38,018 INFO] Step 43500/100000; acc:  97.52; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3018 tok/s;  17328 sec
[2019-10-25 17:39:50,884 INFO] Step 44000/100000; acc:  97.56; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3051 tok/s;  17520 sec
[2019-10-25 17:43:04,500 INFO] Step 44500/100000; acc:  97.57; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3021 tok/s;  17714 sec
[2019-10-25 17:46:17,884 INFO] Step 45000/100000; acc:  97.51; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3034 tok/s;  17907 sec
[2019-10-25 17:49:29,216 INFO] Step 45500/100000; acc:  97.54; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3053 tok/s;  18099 sec
[2019-10-25 17:52:45,032 INFO] Step 46000/100000; acc:  97.55; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/3007 tok/s;  18295 sec
[2019-10-25 17:55:59,422 INFO] Step 46500/100000; acc:  97.56; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/2999 tok/s;  18489 sec
[2019-10-25 17:59:11,557 INFO] Step 47000/100000; acc:  97.61; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3047 tok/s;  18681 sec
[2019-10-25 18:02:25,283 INFO] Step 47500/100000; acc:  97.68; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3036 tok/s;  18875 sec
[2019-10-25 18:05:38,982 INFO] Step 48000/100000; acc:  97.60; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3019 tok/s;  19069 sec
[2019-10-25 18:08:54,229 INFO] Step 48500/100000; acc:  97.66; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3006 tok/s;  19264 sec
[2019-10-25 18:12:08,240 INFO] Step 49000/100000; acc:  97.60; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/3021 tok/s;  19458 sec
[2019-10-25 18:15:20,464 INFO] Step 49500/100000; acc:  97.67; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/3034 tok/s;  19650 sec
[2019-10-25 18:18:36,637 INFO] Step 50000/100000; acc:  97.63; ppl:  1.09; xent: 0.08; lr: 0.05000;   0/3007 tok/s;  19846 sec
[2019-10-25 18:19:56,838 INFO] Validation perplexity: 1.13665
[2019-10-25 18:19:56,839 INFO] Validation accuracy: 96.6272
[2019-10-25 18:19:56,841 INFO] Saving checkpoint ../results/models/im2latex-42_step_50000.pt
[2019-10-25 18:23:09,415 INFO] Step 50500/100000; acc:  97.97; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/2134 tok/s;  20119 sec
[2019-10-25 18:26:22,399 INFO] Step 51000/100000; acc:  98.08; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/3039 tok/s;  20312 sec
[2019-10-25 18:29:36,792 INFO] Step 51500/100000; acc:  98.10; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/3027 tok/s;  20506 sec
[2019-10-25 18:32:48,681 INFO] Step 52000/100000; acc:  98.18; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/3037 tok/s;  20698 sec
[2019-10-25 18:36:04,236 INFO] Step 52500/100000; acc:  98.15; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/2991 tok/s;  20894 sec
[2019-10-25 18:39:16,930 INFO] Step 53000/100000; acc:  98.20; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/3044 tok/s;  21086 sec
[2019-10-25 18:42:30,136 INFO] Step 53500/100000; acc:  98.26; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/3027 tok/s;  21280 sec
[2019-10-25 18:45:47,524 INFO] Step 54000/100000; acc:  98.25; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/2976 tok/s;  21477 sec
[2019-10-25 18:48:58,028 INFO] Step 54500/100000; acc:  98.21; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/3059 tok/s;  21668 sec
[2019-10-25 18:52:12,013 INFO] Step 55000/100000; acc:  98.26; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/3025 tok/s;  21862 sec
[2019-10-25 18:55:26,101 INFO] Step 55500/100000; acc:  98.30; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/3031 tok/s;  22056 sec
[2019-10-25 18:58:40,827 INFO] Step 56000/100000; acc:  98.30; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/3008 tok/s;  22250 sec
[2019-10-25 19:01:56,580 INFO] Step 56500/100000; acc:  98.27; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/3000 tok/s;  22446 sec
[2019-10-25 19:05:09,784 INFO] Step 57000/100000; acc:  98.31; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/3015 tok/s;  22639 sec
[2019-10-25 19:08:24,956 INFO] Step 57500/100000; acc:  98.32; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/3023 tok/s;  22835 sec
[2019-10-25 19:11:39,446 INFO] Step 58000/100000; acc:  98.34; ppl:  1.06; xent: 0.05; lr: 0.05000;   0/2998 tok/s;  23029 sec
[2019-10-25 19:14:49,426 INFO] Step 58500/100000; acc:  98.31; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/3073 tok/s;  23219 sec
[2019-10-25 19:18:04,992 INFO] Step 59000/100000; acc:  98.36; ppl:  1.06; xent: 0.05; lr: 0.05000;   0/3021 tok/s;  23415 sec
[2019-10-25 19:21:17,182 INFO] Step 59500/100000; acc:  98.37; ppl:  1.06; xent: 0.05; lr: 0.05000;   0/3031 tok/s;  23607 sec
[2019-10-25 19:24:33,029 INFO] Step 60000/100000; acc:  98.36; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/3003 tok/s;  23803 sec
[2019-10-25 19:25:53,954 INFO] Validation perplexity: 1.08955
[2019-10-25 19:25:53,955 INFO] Validation accuracy: 97.8335
[2019-10-25 19:25:53,958 INFO] Saving checkpoint ../results/models/im2latex-42_step_60000.pt
[2019-10-25 19:29:10,256 INFO] Step 60500/100000; acc:  98.39; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/2117 tok/s;  24080 sec
[2019-10-25 19:32:21,654 INFO] Step 61000/100000; acc:  98.45; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/3044 tok/s;  24271 sec
[2019-10-25 19:35:39,374 INFO] Step 61500/100000; acc:  98.48; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/2983 tok/s;  24469 sec
[2019-10-25 19:38:49,968 INFO] Step 62000/100000; acc:  98.48; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/3051 tok/s;  24660 sec
[2019-10-25 19:42:02,895 INFO] Step 62500/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/3044 tok/s;  24852 sec
[2019-10-25 19:45:15,937 INFO] Step 63000/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/3045 tok/s;  25045 sec
[2019-10-25 19:48:27,289 INFO] Step 63500/100000; acc:  98.58; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/3048 tok/s;  25237 sec
[2019-10-25 19:51:40,391 INFO] Step 64000/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/3032 tok/s;  25430 sec
[2019-10-25 19:54:54,776 INFO] Step 64500/100000; acc:  98.50; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/3015 tok/s;  25624 sec
[2019-10-25 19:58:10,301 INFO] Step 65000/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/2999 tok/s;  25820 sec
[2019-10-25 20:01:24,526 INFO] Step 65500/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/3012 tok/s;  26014 sec
[2019-10-25 20:04:34,734 INFO] Step 66000/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/3073 tok/s;  26204 sec
[2019-10-25 20:07:47,381 INFO] Step 66500/100000; acc:  98.58; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/3044 tok/s;  26397 sec
[2019-10-25 20:11:01,456 INFO] Step 67000/100000; acc:  98.59; ppl:  1.05; xent: 0.04; lr: 0.02500;   0/3023 tok/s;  26591 sec
[2019-10-25 20:14:17,207 INFO] Step 67500/100000; acc:  98.62; ppl:  1.05; xent: 0.04; lr: 0.02500;   0/3001 tok/s;  26787 sec
[2019-10-25 20:17:31,313 INFO] Step 68000/100000; acc:  98.57; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/3016 tok/s;  26981 sec
[2019-10-25 20:20:42,798 INFO] Step 68500/100000; acc:  98.57; ppl:  1.05; xent: 0.04; lr: 0.02500;   0/3042 tok/s;  27172 sec
[2019-10-25 20:23:58,566 INFO] Step 69000/100000; acc:  98.58; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/3017 tok/s;  27368 sec
[2019-10-25 20:27:13,008 INFO] Step 69500/100000; acc:  98.59; ppl:  1.05; xent: 0.04; lr: 0.02500;   0/3000 tok/s;  27563 sec
[2019-10-25 20:30:27,715 INFO] Step 70000/100000; acc:  98.57; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/3005 tok/s;  27757 sec
[2019-10-25 20:31:47,916 INFO] Validation perplexity: 1.08666
[2019-10-25 20:31:47,917 INFO] Validation accuracy: 97.9513
[2019-10-25 20:31:47,921 INFO] Saving checkpoint ../results/models/im2latex-42_step_70000.pt
[2019-10-25 20:35:02,050 INFO] Step 70500/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/2152 tok/s;  28032 sec
[2019-10-25 20:38:13,399 INFO] Step 71000/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3047 tok/s;  28223 sec
[2019-10-25 20:41:27,928 INFO] Step 71500/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3018 tok/s;  28417 sec
[2019-10-25 20:44:41,191 INFO] Step 72000/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3033 tok/s;  28611 sec
[2019-10-25 20:47:54,633 INFO] Step 72500/100000; acc:  98.65; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3012 tok/s;  28804 sec
[2019-10-25 20:51:09,849 INFO] Step 73000/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3014 tok/s;  28999 sec
[2019-10-25 20:54:20,074 INFO] Step 73500/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3057 tok/s;  29190 sec
[2019-10-25 20:57:34,423 INFO] Step 74000/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3029 tok/s;  29384 sec
[2019-10-25 21:00:46,838 INFO] Step 74500/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3050 tok/s;  29576 sec
[2019-10-25 21:03:59,783 INFO] Step 75000/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3027 tok/s;  29769 sec
[2019-10-25 21:07:15,158 INFO] Step 75500/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/2998 tok/s;  29965 sec
[2019-10-25 21:10:28,037 INFO] Step 76000/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3034 tok/s;  30158 sec
[2019-10-25 21:13:42,078 INFO] Step 76500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3025 tok/s;  30352 sec
[2019-10-25 21:16:57,506 INFO] Step 77000/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/2994 tok/s;  30547 sec
[2019-10-25 21:20:08,231 INFO] Step 77500/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3069 tok/s;  30738 sec
[2019-10-25 21:23:23,339 INFO] Step 78000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3012 tok/s;  30933 sec
[2019-10-25 21:26:36,442 INFO] Step 78500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3032 tok/s;  31126 sec
[2019-10-25 21:29:50,149 INFO] Step 79000/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3026 tok/s;  31320 sec
[2019-10-25 21:33:05,440 INFO] Step 79500/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/3003 tok/s;  31515 sec
[2019-10-25 21:36:17,533 INFO] Step 80000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3034 tok/s;  31707 sec
[2019-10-25 21:37:38,064 INFO] Validation perplexity: 1.08582
[2019-10-25 21:37:38,065 INFO] Validation accuracy: 97.9817
[2019-10-25 21:37:38,068 INFO] Saving checkpoint ../results/models/im2latex-42_step_80000.pt
[2019-10-25 21:40:56,061 INFO] Step 80500/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/2119 tok/s;  31986 sec
[2019-10-25 21:44:08,935 INFO] Step 81000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3023 tok/s;  32178 sec
[2019-10-25 21:47:21,050 INFO] Step 81500/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3039 tok/s;  32371 sec
[2019-10-25 21:50:37,801 INFO] Step 82000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3010 tok/s;  32567 sec
[2019-10-25 21:53:48,472 INFO] Step 82500/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3058 tok/s;  32758 sec
[2019-10-25 21:57:02,462 INFO] Step 83000/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3018 tok/s;  32952 sec
[2019-10-25 22:00:15,701 INFO] Step 83500/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3032 tok/s;  33145 sec
[2019-10-25 22:03:27,563 INFO] Step 84000/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3043 tok/s;  33337 sec
[2019-10-25 22:06:45,386 INFO] Step 84500/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/2977 tok/s;  33535 sec
[2019-10-25 22:09:54,770 INFO] Step 85000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3070 tok/s;  33724 sec
[2019-10-25 22:13:09,627 INFO] Step 85500/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3014 tok/s;  33919 sec
[2019-10-25 22:16:23,280 INFO] Step 86000/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3040 tok/s;  34113 sec
[2019-10-25 22:19:36,945 INFO] Step 86500/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3020 tok/s;  34306 sec
[2019-10-25 22:22:51,542 INFO] Step 87000/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3016 tok/s;  34501 sec
[2019-10-25 22:26:04,707 INFO] Step 87500/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3024 tok/s;  34694 sec
[2019-10-25 22:29:20,394 INFO] Step 88000/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3007 tok/s;  34890 sec
[2019-10-25 22:32:34,362 INFO] Step 88500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3008 tok/s;  35084 sec
[2019-10-25 22:35:44,414 INFO] Step 89000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3078 tok/s;  35274 sec
[2019-10-25 22:38:57,890 INFO] Step 89500/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/3036 tok/s;  35467 sec
[2019-10-25 22:42:10,853 INFO] Step 90000/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3029 tok/s;  35660 sec
[2019-10-25 22:43:31,534 INFO] Validation perplexity: 1.08592
[2019-10-25 22:43:31,535 INFO] Validation accuracy: 97.9947
[2019-10-25 22:43:31,538 INFO] Saving checkpoint ../results/models/im2latex-42_step_90000.pt
[2019-10-25 22:46:46,912 INFO] Step 90500/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2125 tok/s;  35936 sec
[2019-10-25 22:49:59,050 INFO] Step 91000/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3052 tok/s;  36129 sec
[2019-10-25 22:53:12,507 INFO] Step 91500/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3011 tok/s;  36322 sec
[2019-10-25 22:56:29,334 INFO] Step 92000/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2997 tok/s;  36519 sec
[2019-10-25 22:59:41,200 INFO] Step 92500/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3038 tok/s;  36711 sec
[2019-10-25 23:02:53,289 INFO] Step 93000/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3053 tok/s;  36903 sec
[2019-10-25 23:06:08,515 INFO] Step 93500/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3031 tok/s;  37098 sec
[2019-10-25 23:09:20,243 INFO] Step 94000/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3037 tok/s;  37290 sec
[2019-10-25 23:12:32,944 INFO] Step 94500/100000; acc:  98.80; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3040 tok/s;  37482 sec
[2019-10-25 23:15:45,790 INFO] Step 95000/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3036 tok/s;  37675 sec
[2019-10-25 23:18:59,810 INFO] Step 95500/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3019 tok/s;  37869 sec
[2019-10-25 23:22:17,523 INFO] Step 96000/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2967 tok/s;  38067 sec
[2019-10-25 23:25:27,794 INFO] Step 96500/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3063 tok/s;  38257 sec
[2019-10-25 23:28:40,102 INFO] Step 97000/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3049 tok/s;  38450 sec
[2019-10-25 23:31:52,907 INFO] Step 97500/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3046 tok/s;  38642 sec
[2019-10-25 23:35:06,334 INFO] Step 98000/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3033 tok/s;  38836 sec
[2019-10-25 23:38:21,075 INFO] Step 98500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3016 tok/s;  39031 sec
[2019-10-25 23:41:34,255 INFO] Step 99000/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3015 tok/s;  39224 sec
[2019-10-25 23:44:49,185 INFO] Step 99500/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/3029 tok/s;  39419 sec
[2019-10-25 23:48:01,571 INFO] Step 100000/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.00156;   0/3026 tok/s;  39611 sec
[2019-10-25 23:49:21,719 INFO] Validation perplexity: 1.0863
[2019-10-25 23:49:21,720 INFO] Validation accuracy: 97.9879
[2019-10-25 23:49:21,723 INFO] Saving checkpoint ../results/models/im2latex-42_step_100000.pt
