[2019-10-09 19:26:20,159 INFO]  * tgt vocab size = 510
[2019-10-09 19:26:20,160 INFO] Building model...
[2019-10-09 19:26:24,442 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer3): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer5): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer6): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer7): Conv2d(128, 128, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layer8): Conv2d(128, 128, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layer9): Conv2d(128, 128, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layer10): Conv2d(128, 128, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (batch_norm1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(128, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 128)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-10-09 19:26:24,444 INFO] encoder: 3210624
[2019-10-09 19:26:24,444 INFO] decoder: 5214310
[2019-10-09 19:26:24,444 INFO] * number of parameters: 8424934
[2019-10-09 19:26:25,809 INFO] Starting training on GPU: [0]
[2019-10-09 19:26:25,809 INFO] Start training loop and validate every 10000 steps...
[2019-10-09 19:35:13,381 INFO] Step 500/100000; acc:  28.78; ppl: 38.20; xent: 3.64; lr: 0.10000;   0/1115 tok/s;    528 sec
[2019-10-09 19:43:37,541 INFO] Step 1000/100000; acc:  44.55; ppl: 13.36; xent: 2.59; lr: 0.10000;   0/1153 tok/s;   1032 sec
[2019-10-09 19:52:13,911 INFO] Step 1500/100000; acc:  48.36; ppl: 10.47; xent: 2.35; lr: 0.10000;   0/1141 tok/s;   1548 sec
[2019-10-09 20:00:48,396 INFO] Step 2000/100000; acc:  52.14; ppl:  8.25; xent: 2.11; lr: 0.10000;   0/1142 tok/s;   2063 sec
[2019-10-09 20:09:27,393 INFO] Step 2500/100000; acc:  67.60; ppl:  3.86; xent: 1.35; lr: 0.10000;   0/1126 tok/s;   2582 sec
[2019-10-09 20:18:08,239 INFO] Step 3000/100000; acc:  83.29; ppl:  2.03; xent: 0.71; lr: 0.10000;   0/1127 tok/s;   3102 sec
[2019-10-09 20:26:35,847 INFO] Step 3500/100000; acc:  88.41; ppl:  1.64; xent: 0.49; lr: 0.10000;   0/1151 tok/s;   3610 sec
[2019-10-09 20:35:09,167 INFO] Step 4000/100000; acc:  90.53; ppl:  1.50; xent: 0.40; lr: 0.10000;   0/1145 tok/s;   4123 sec
[2019-10-09 20:43:36,952 INFO] Step 4500/100000; acc:  91.81; ppl:  1.41; xent: 0.34; lr: 0.10000;   0/1149 tok/s;   4631 sec
[2019-10-09 20:51:53,180 INFO] Step 5000/100000; acc:  92.77; ppl:  1.36; xent: 0.30; lr: 0.10000;   0/1181 tok/s;   5127 sec
[2019-10-09 21:00:26,147 INFO] Step 5500/100000; acc:  93.54; ppl:  1.31; xent: 0.27; lr: 0.10000;   0/1145 tok/s;   5640 sec
[2019-10-09 21:08:49,075 INFO] Step 6000/100000; acc:  94.02; ppl:  1.28; xent: 0.25; lr: 0.10000;   0/1163 tok/s;   6143 sec
[2019-10-09 21:17:21,545 INFO] Step 6500/100000; acc:  94.41; ppl:  1.26; xent: 0.23; lr: 0.10000;   0/1144 tok/s;   6656 sec
[2019-10-09 21:25:49,804 INFO] Step 7000/100000; acc:  94.67; ppl:  1.24; xent: 0.22; lr: 0.10000;   0/1154 tok/s;   7164 sec
[2019-10-09 21:34:13,889 INFO] Step 7500/100000; acc:  95.12; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/1156 tok/s;   7668 sec
[2019-10-09 21:42:50,320 INFO] Step 8000/100000; acc:  95.15; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/1142 tok/s;   8185 sec
[2019-10-09 21:51:14,427 INFO] Step 8500/100000; acc:  95.56; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/1156 tok/s;   8689 sec
[2019-10-09 21:59:36,022 INFO] Step 9000/100000; acc:  95.73; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/1167 tok/s;   9190 sec
[2019-10-09 22:08:09,569 INFO] Step 9500/100000; acc:  95.80; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/1151 tok/s;   9704 sec
[2019-10-09 22:16:30,510 INFO] Step 10000/100000; acc:  95.98; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/1162 tok/s;  10205 sec
[2019-10-09 22:21:12,323 INFO] Validation perplexity: 1.1472
[2019-10-09 22:21:12,324 INFO] Validation accuracy: 96.593
[2019-10-09 22:21:12,327 INFO] Saving checkpoint ../results/models/im2latex-32_step_10000.pt
[2019-10-09 22:29:43,521 INFO] Step 10500/100000; acc:  96.06; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/738 tok/s;  10998 sec
[2019-10-09 22:38:13,116 INFO] Step 11000/100000; acc:  96.18; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/1151 tok/s;  11507 sec
[2019-10-09 22:46:38,806 INFO] Step 11500/100000; acc:  96.29; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/1156 tok/s;  12013 sec
[2019-10-09 22:55:17,130 INFO] Step 12000/100000; acc:  96.35; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/1133 tok/s;  12531 sec
[2019-10-09 23:03:30,745 INFO] Step 12500/100000; acc:  96.54; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/1180 tok/s;  13025 sec
[2019-10-09 23:11:56,696 INFO] Step 13000/100000; acc:  96.59; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1159 tok/s;  13531 sec
[2019-10-09 23:20:23,549 INFO] Step 13500/100000; acc:  96.69; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1160 tok/s;  14038 sec
[2019-10-09 23:28:52,746 INFO] Step 14000/100000; acc:  96.69; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1150 tok/s;  14547 sec
[2019-10-09 23:37:25,028 INFO] Step 14500/100000; acc:  96.72; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1147 tok/s;  15059 sec
[2019-10-09 23:45:47,545 INFO] Step 15000/100000; acc:  96.83; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1160 tok/s;  15562 sec
[2019-10-09 23:54:21,266 INFO] Step 15500/100000; acc:  96.81; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1148 tok/s;  16075 sec
[2019-10-10 00:02:48,784 INFO] Step 16000/100000; acc:  96.91; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/1148 tok/s;  16583 sec
[2019-10-10 00:11:06,468 INFO] Step 16500/100000; acc:  96.99; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1174 tok/s;  17081 sec
[2019-10-10 00:19:37,259 INFO] Step 17000/100000; acc:  97.05; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1154 tok/s;  17591 sec
[2019-10-10 00:27:59,572 INFO] Step 17500/100000; acc:  97.08; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1161 tok/s;  18094 sec
[2019-10-10 00:36:32,659 INFO] Step 18000/100000; acc:  97.04; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1145 tok/s;  18607 sec
[2019-10-10 00:45:00,974 INFO] Step 18500/100000; acc:  97.07; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1154 tok/s;  19115 sec
[2019-10-10 00:53:23,254 INFO] Step 19000/100000; acc:  97.11; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1160 tok/s;  19617 sec
[2019-10-10 01:02:01,569 INFO] Step 19500/100000; acc:  97.11; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1138 tok/s;  20136 sec
[2019-10-10 01:10:19,111 INFO] Step 20000/100000; acc:  97.25; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1169 tok/s;  20633 sec
[2019-10-10 01:15:00,972 INFO] Validation perplexity: 1.10829
[2019-10-10 01:15:00,973 INFO] Validation accuracy: 97.386
[2019-10-10 01:15:00,975 INFO] Saving checkpoint ../results/models/im2latex-32_step_20000.pt
[2019-10-10 01:23:28,456 INFO] Step 20500/100000; acc:  97.28; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/745 tok/s;  21423 sec
[2019-10-10 01:31:58,346 INFO] Step 21000/100000; acc:  97.34; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1154 tok/s;  21933 sec
[2019-10-10 01:40:21,034 INFO] Step 21500/100000; acc:  97.34; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1160 tok/s;  22435 sec
[2019-10-10 01:48:52,861 INFO] Step 22000/100000; acc:  97.30; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1143 tok/s;  22947 sec
[2019-10-10 01:57:28,438 INFO] Step 22500/100000; acc:  97.35; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1137 tok/s;  23463 sec
[2019-10-10 02:06:06,164 INFO] Step 23000/100000; acc:  97.39; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1134 tok/s;  23980 sec
[2019-10-10 02:14:45,121 INFO] Step 23500/100000; acc:  97.40; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1127 tok/s;  24499 sec
[2019-10-10 02:23:07,764 INFO] Step 24000/100000; acc:  97.44; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1161 tok/s;  25002 sec
[2019-10-10 02:31:40,113 INFO] Step 24500/100000; acc:  97.47; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1145 tok/s;  25514 sec
[2019-10-10 02:40:12,618 INFO] Step 25000/100000; acc:  97.55; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1143 tok/s;  26027 sec
[2019-10-10 02:48:51,690 INFO] Step 25500/100000; acc:  97.52; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1132 tok/s;  26546 sec
[2019-10-10 02:57:29,790 INFO] Step 26000/100000; acc:  97.50; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1132 tok/s;  27064 sec
[2019-10-10 03:06:01,386 INFO] Step 26500/100000; acc:  97.54; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1138 tok/s;  27576 sec
[2019-10-10 03:14:41,652 INFO] Step 27000/100000; acc:  97.48; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1134 tok/s;  28096 sec
[2019-10-10 03:23:17,115 INFO] Step 27500/100000; acc:  97.64; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1132 tok/s;  28611 sec
[2019-10-10 03:31:42,073 INFO] Step 28000/100000; acc:  97.63; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1158 tok/s;  29116 sec
[2019-10-10 03:40:21,822 INFO] Step 28500/100000; acc:  97.65; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1136 tok/s;  29636 sec
[2019-10-10 03:48:51,936 INFO] Step 29000/100000; acc:  97.68; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1144 tok/s;  30146 sec
[2019-10-10 03:57:28,429 INFO] Step 29500/100000; acc:  97.66; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1137 tok/s;  30663 sec
[2019-10-10 04:06:07,706 INFO] Step 30000/100000; acc:  97.63; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1129 tok/s;  31182 sec
[2019-10-10 04:10:51,464 INFO] Validation perplexity: 1.09567
[2019-10-10 04:10:51,468 INFO] Validation accuracy: 97.6417
[2019-10-10 04:10:51,470 INFO] Saving checkpoint ../results/models/im2latex-32_step_30000.pt
[2019-10-10 04:19:19,511 INFO] Step 30500/100000; acc:  97.67; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/736 tok/s;  31974 sec
[2019-10-10 04:28:03,344 INFO] Step 31000/100000; acc:  97.66; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1125 tok/s;  32498 sec
[2019-10-10 04:36:25,447 INFO] Step 31500/100000; acc:  97.71; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1157 tok/s;  33000 sec
[2019-10-10 04:45:01,995 INFO] Step 32000/100000; acc:  97.76; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1139 tok/s;  33516 sec
[2019-10-10 04:53:36,834 INFO] Step 32500/100000; acc:  97.76; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1141 tok/s;  34031 sec
[2019-10-10 05:02:04,218 INFO] Step 33000/100000; acc:  97.78; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1151 tok/s;  34538 sec
[2019-10-10 05:10:43,915 INFO] Step 33500/100000; acc:  97.77; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1126 tok/s;  35058 sec
[2019-10-10 05:19:17,960 INFO] Step 34000/100000; acc:  97.77; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1138 tok/s;  35572 sec
[2019-10-10 05:27:53,992 INFO] Step 34500/100000; acc:  97.82; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1139 tok/s;  36088 sec
[2019-10-10 05:36:31,689 INFO] Step 35000/100000; acc:  97.78; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1130 tok/s;  36606 sec
[2019-10-10 05:44:57,073 INFO] Step 35500/100000; acc:  97.86; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1159 tok/s;  37111 sec
[2019-10-10 05:53:33,433 INFO] Step 36000/100000; acc:  97.83; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1136 tok/s;  37628 sec
[2019-10-10 06:02:02,300 INFO] Step 36500/100000; acc:  97.88; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1151 tok/s;  38136 sec
[2019-10-10 06:10:40,910 INFO] Step 37000/100000; acc:  97.89; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1131 tok/s;  38655 sec
[2019-10-10 06:19:18,581 INFO] Step 37500/100000; acc:  97.87; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1132 tok/s;  39173 sec
[2019-10-10 06:27:50,370 INFO] Step 38000/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1139 tok/s;  39685 sec
[2019-10-10 06:36:31,868 INFO] Step 38500/100000; acc:  97.84; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1133 tok/s;  40206 sec
[2019-10-10 06:45:03,035 INFO] Step 39000/100000; acc:  97.95; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1140 tok/s;  40717 sec
[2019-10-10 06:53:25,317 INFO] Step 39500/100000; acc:  97.92; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1164 tok/s;  41220 sec
[2019-10-10 07:02:03,684 INFO] Step 40000/100000; acc:  97.96; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1142 tok/s;  41738 sec
[2019-10-10 07:06:46,703 INFO] Validation perplexity: 1.08525
[2019-10-10 07:06:46,704 INFO] Validation accuracy: 97.8116
[2019-10-10 07:06:46,707 INFO] Saving checkpoint ../results/models/im2latex-32_step_40000.pt
[2019-10-10 07:15:17,916 INFO] Step 40500/100000; acc:  97.99; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/734 tok/s;  42532 sec
[2019-10-10 07:23:50,385 INFO] Step 41000/100000; acc:  97.98; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1144 tok/s;  43045 sec
[2019-10-10 07:32:21,538 INFO] Step 41500/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1146 tok/s;  43556 sec
[2019-10-10 07:40:45,772 INFO] Step 42000/100000; acc:  97.99; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1158 tok/s;  44060 sec
[2019-10-10 07:49:24,841 INFO] Step 42500/100000; acc:  97.98; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1134 tok/s;  44579 sec
[2019-10-10 07:57:38,157 INFO] Step 43000/100000; acc:  97.99; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1178 tok/s;  45072 sec
[2019-10-10 08:06:07,225 INFO] Step 43500/100000; acc:  98.02; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1153 tok/s;  45581 sec
[2019-10-10 08:14:33,394 INFO] Step 44000/100000; acc:  98.03; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1163 tok/s;  46088 sec
[2019-10-10 08:22:59,964 INFO] Step 44500/100000; acc:  98.05; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1154 tok/s;  46594 sec
[2019-10-10 08:31:32,870 INFO] Step 45000/100000; acc:  98.02; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1145 tok/s;  47107 sec
[2019-10-10 08:39:56,663 INFO] Step 45500/100000; acc:  98.03; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1158 tok/s;  47611 sec
[2019-10-10 08:48:29,982 INFO] Step 46000/100000; acc:  98.05; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1147 tok/s;  48124 sec
[2019-10-10 08:56:55,120 INFO] Step 46500/100000; acc:  98.09; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1155 tok/s;  48629 sec
[2019-10-10 09:05:13,453 INFO] Step 47000/100000; acc:  98.08; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1175 tok/s;  49128 sec
[2019-10-10 09:13:43,642 INFO] Step 47500/100000; acc:  98.11; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1149 tok/s;  49638 sec
[2019-10-10 09:22:05,697 INFO] Step 48000/100000; acc:  98.10; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1165 tok/s;  50140 sec
[2019-10-10 09:30:37,521 INFO] Step 48500/100000; acc:  98.12; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1146 tok/s;  50652 sec
[2019-10-10 09:39:05,278 INFO] Step 49000/100000; acc:  98.05; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1155 tok/s;  51159 sec
[2019-10-10 09:47:29,066 INFO] Step 49500/100000; acc:  98.10; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1157 tok/s;  51663 sec
[2019-10-10 09:56:05,019 INFO] Step 50000/100000; acc:  98.09; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/1143 tok/s;  52179 sec
[2019-10-10 10:00:46,995 INFO] Validation perplexity: 1.08487
[2019-10-10 10:00:46,996 INFO] Validation accuracy: 97.9175
[2019-10-10 10:00:46,998 INFO] Saving checkpoint ../results/models/im2latex-32_step_50000.pt
[2019-10-10 10:09:09,962 INFO] Step 50500/100000; acc:  98.27; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/742 tok/s;  52964 sec
[2019-10-10 10:17:33,360 INFO] Step 51000/100000; acc:  98.35; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1165 tok/s;  53468 sec
[2019-10-10 10:26:08,048 INFO] Step 51500/100000; acc:  98.34; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1152 tok/s;  53982 sec
[2019-10-10 10:34:27,400 INFO] Step 52000/100000; acc:  98.41; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1165 tok/s;  54482 sec
[2019-10-10 10:43:00,102 INFO] Step 52500/100000; acc:  98.42; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1142 tok/s;  54994 sec
[2019-10-10 10:51:27,815 INFO] Step 53000/100000; acc:  98.41; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1155 tok/s;  55502 sec
[2019-10-10 10:59:53,435 INFO] Step 53500/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1157 tok/s;  56008 sec
[2019-10-10 11:08:28,606 INFO] Step 54000/100000; acc:  98.46; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1139 tok/s;  56523 sec
[2019-10-10 11:16:42,421 INFO] Step 54500/100000; acc:  98.45; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1180 tok/s;  57017 sec
[2019-10-10 11:25:11,932 INFO] Step 55000/100000; acc:  98.44; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1152 tok/s;  57526 sec
[2019-10-10 11:33:39,561 INFO] Step 55500/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1157 tok/s;  58034 sec
[2019-10-10 11:42:08,246 INFO] Step 56000/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1152 tok/s;  58542 sec
[2019-10-10 11:50:49,521 INFO] Step 56500/100000; acc:  98.50; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1127 tok/s;  59064 sec
[2019-10-10 11:59:31,851 INFO] Step 57000/100000; acc:  98.50; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1115 tok/s;  59586 sec
[2019-10-10 12:08:06,189 INFO] Step 57500/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1147 tok/s;  60100 sec
[2019-10-10 12:16:36,885 INFO] Step 58000/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1141 tok/s;  60611 sec
[2019-10-10 12:24:59,345 INFO] Step 58500/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1162 tok/s;  61114 sec
[2019-10-10 12:33:32,159 INFO] Step 59000/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1147 tok/s;  61626 sec
[2019-10-10 12:41:57,927 INFO] Step 59500/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1152 tok/s;  62132 sec
[2019-10-10 12:50:35,655 INFO] Step 60000/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1136 tok/s;  62650 sec
[2019-10-10 12:55:18,626 INFO] Validation perplexity: 1.07759
[2019-10-10 12:55:18,627 INFO] Validation accuracy: 98.1156
[2019-10-10 12:55:18,629 INFO] Saving checkpoint ../results/models/im2latex-32_step_60000.pt
[2019-10-10 13:03:52,417 INFO] Step 60500/100000; acc:  98.57; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/736 tok/s;  63447 sec
[2019-10-10 13:12:16,775 INFO] Step 61000/100000; acc:  98.63; ppl:  1.05; xent: 0.04; lr: 0.02500;   0/1155 tok/s;  63951 sec
[2019-10-10 13:21:01,744 INFO] Step 61500/100000; acc:  98.65; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1125 tok/s;  64476 sec
[2019-10-10 13:29:22,687 INFO] Step 62000/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1159 tok/s;  64977 sec
[2019-10-10 13:37:53,269 INFO] Step 62500/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1152 tok/s;  65487 sec
[2019-10-10 13:46:30,355 INFO] Step 63000/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1141 tok/s;  66005 sec
[2019-10-10 13:54:54,694 INFO] Step 63500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1156 tok/s;  66509 sec
[2019-10-10 14:03:28,853 INFO] Step 64000/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1138 tok/s;  67023 sec
[2019-10-10 14:12:02,982 INFO] Step 64500/100000; acc:  98.65; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1141 tok/s;  67537 sec
[2019-10-10 14:20:37,071 INFO] Step 65000/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1141 tok/s;  68051 sec
[2019-10-10 14:29:13,832 INFO] Step 65500/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1133 tok/s;  68568 sec
[2019-10-10 14:37:37,156 INFO] Step 66000/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1162 tok/s;  69071 sec
[2019-10-10 14:46:05,366 INFO] Step 66500/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1153 tok/s;  69580 sec
[2019-10-10 14:54:34,193 INFO] Step 67000/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1152 tok/s;  70088 sec
[2019-10-10 15:03:08,633 INFO] Step 67500/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1141 tok/s;  70603 sec
[2019-10-10 15:11:44,097 INFO] Step 68000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1137 tok/s;  71118 sec
[2019-10-10 15:20:14,057 INFO] Step 68500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1141 tok/s;  71628 sec
[2019-10-10 15:28:52,719 INFO] Step 69000/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1138 tok/s;  72147 sec
[2019-10-10 15:37:25,751 INFO] Step 69500/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1138 tok/s;  72660 sec
[2019-10-10 15:45:49,859 INFO] Step 70000/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1159 tok/s;  73164 sec
[2019-10-10 15:50:33,127 INFO] Validation perplexity: 1.07526
[2019-10-10 15:50:33,128 INFO] Validation accuracy: 98.193
[2019-10-10 15:50:33,130 INFO] Saving checkpoint ../results/models/im2latex-32_step_70000.pt
[2019-10-10 15:59:12,605 INFO] Step 70500/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/734 tok/s;  73967 sec
[2019-10-10 16:07:46,198 INFO] Step 71000/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1135 tok/s;  74480 sec
[2019-10-10 16:16:32,307 INFO] Step 71500/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1117 tok/s;  75006 sec
[2019-10-10 16:25:20,337 INFO] Step 72000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1109 tok/s;  75535 sec
[2019-10-10 16:33:59,476 INFO] Step 72500/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1123 tok/s;  76054 sec
[2019-10-10 16:42:54,511 INFO] Step 73000/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1100 tok/s;  76589 sec
[2019-10-10 16:51:26,281 INFO] Step 73500/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1136 tok/s;  77100 sec
[2019-10-10 17:00:13,949 INFO] Step 74000/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1116 tok/s;  77628 sec
[2019-10-10 17:08:57,296 INFO] Step 74500/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1124 tok/s;  78151 sec
[2019-10-10 17:17:37,679 INFO] Step 75000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1123 tok/s;  78672 sec
[2019-10-10 17:26:26,950 INFO] Step 75500/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1107 tok/s;  79201 sec
[2019-10-10 17:35:07,952 INFO] Step 76000/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1122 tok/s;  79722 sec
[2019-10-10 17:43:57,697 INFO] Step 76500/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1110 tok/s;  80252 sec
[2019-10-10 17:52:42,851 INFO] Step 77000/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1113 tok/s;  80777 sec
[2019-10-10 18:01:20,929 INFO] Step 77500/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1131 tok/s;  81295 sec
[2019-10-10 18:10:10,213 INFO] Step 78000/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1109 tok/s;  81824 sec
[2019-10-10 18:18:51,084 INFO] Step 78500/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1124 tok/s;  82345 sec
[2019-10-10 18:27:41,210 INFO] Step 79000/100000; acc:  98.80; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1106 tok/s;  82875 sec
[2019-10-10 18:36:30,272 INFO] Step 79500/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1110 tok/s;  83404 sec
[2019-10-10 18:45:02,578 INFO] Step 80000/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1135 tok/s;  83917 sec
[2019-10-10 18:49:46,136 INFO] Validation perplexity: 1.07569
[2019-10-10 18:49:46,136 INFO] Validation accuracy: 98.2219
[2019-10-10 18:49:46,139 INFO] Saving checkpoint ../results/models/im2latex-32_step_80000.pt
[2019-10-10 18:58:27,325 INFO] Step 80500/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/735 tok/s;  84722 sec
[2019-10-10 19:06:55,017 INFO] Step 81000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1148 tok/s;  85229 sec
[2019-10-10 19:15:17,056 INFO] Step 81500/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1163 tok/s;  85731 sec
[2019-10-10 19:23:53,486 INFO] Step 82000/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1145 tok/s;  86248 sec
[2019-10-10 19:32:19,636 INFO] Step 82500/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1152 tok/s;  86754 sec
[2019-10-10 19:40:53,565 INFO] Step 83000/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1139 tok/s;  87268 sec
[2019-10-10 19:49:25,970 INFO] Step 83500/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1144 tok/s;  87780 sec
[2019-10-10 19:57:52,394 INFO] Step 84000/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1153 tok/s;  88287 sec
[2019-10-10 20:06:36,552 INFO] Step 84500/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1123 tok/s;  88811 sec
[2019-10-10 20:14:53,354 INFO] Step 85000/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1171 tok/s;  89308 sec
[2019-10-10 20:23:25,555 INFO] Step 85500/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1148 tok/s;  89820 sec
[2019-10-10 20:31:55,707 INFO] Step 86000/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1154 tok/s;  90330 sec
[2019-10-10 20:40:27,981 INFO] Step 86500/100000; acc:  98.88; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1142 tok/s;  90842 sec
[2019-10-10 20:49:06,355 INFO] Step 87000/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1133 tok/s;  91361 sec
[2019-10-10 20:57:32,124 INFO] Step 87500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1153 tok/s;  91866 sec
[2019-10-10 21:06:07,709 INFO] Step 88000/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1143 tok/s;  92382 sec
[2019-10-10 21:14:36,829 INFO] Step 88500/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1146 tok/s;  92891 sec
[2019-10-10 21:22:57,668 INFO] Step 89000/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1167 tok/s;  93392 sec
[2019-10-10 21:31:32,560 INFO] Step 89500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1144 tok/s;  93907 sec
[2019-10-10 21:39:55,259 INFO] Step 90000/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1161 tok/s;  94409 sec
[2019-10-10 21:44:37,260 INFO] Validation perplexity: 1.07581
[2019-10-10 21:44:37,261 INFO] Validation accuracy: 98.235
[2019-10-10 21:44:37,264 INFO] Saving checkpoint ../results/models/im2latex-32_step_90000.pt
[2019-10-10 21:53:08,626 INFO] Step 90500/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/739 tok/s;  95203 sec
[2019-10-10 22:01:39,185 INFO] Step 91000/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1150 tok/s;  95713 sec
[2019-10-10 22:10:01,835 INFO] Step 91500/100000; acc:  98.88; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1157 tok/s;  96216 sec
[2019-10-10 22:18:41,329 INFO] Step 92000/100000; acc:  98.89; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1137 tok/s;  96736 sec
[2019-10-10 22:27:01,598 INFO] Step 92500/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1164 tok/s;  97236 sec
[2019-10-10 22:35:27,844 INFO] Step 93000/100000; acc:  98.88; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1160 tok/s;  97742 sec
[2019-10-10 22:43:54,321 INFO] Step 93500/100000; acc:  98.87; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1162 tok/s;  98249 sec
[2019-10-10 22:52:14,302 INFO] Step 94000/100000; acc:  98.89; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1165 tok/s;  98748 sec
[2019-10-10 23:00:46,053 INFO] Step 94500/100000; acc:  98.87; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1145 tok/s;  99260 sec
[2019-10-10 23:09:14,252 INFO] Step 95000/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1152 tok/s;  99768 sec
[2019-10-10 23:17:40,400 INFO] Step 95500/100000; acc:  98.87; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1157 tok/s; 100275 sec
[2019-10-10 23:26:15,331 INFO] Step 96000/100000; acc:  98.90; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1139 tok/s; 100790 sec
[2019-10-10 23:34:28,770 INFO] Step 96500/100000; acc:  98.87; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1181 tok/s; 101283 sec
[2019-10-10 23:42:58,464 INFO] Step 97000/100000; acc:  98.88; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1153 tok/s; 101793 sec
[2019-10-10 23:51:23,080 INFO] Step 97500/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1163 tok/s; 102297 sec
[2019-10-10 23:59:56,278 INFO] Step 98000/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1144 tok/s; 102810 sec
[2019-10-11 00:08:26,291 INFO] Step 98500/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1151 tok/s; 103320 sec
[2019-10-11 00:16:51,305 INFO] Step 99000/100000; acc:  98.87; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1154 tok/s; 103825 sec
[2019-10-11 00:25:24,566 INFO] Step 99500/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1149 tok/s; 104339 sec
[2019-10-11 00:33:49,852 INFO] Step 100000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00156;   0/1154 tok/s; 104844 sec
[2019-10-11 00:38:31,748 INFO] Validation perplexity: 1.07583
[2019-10-11 00:38:31,749 INFO] Validation accuracy: 98.2255
[2019-10-11 00:38:31,752 INFO] Saving checkpoint ../results/models/im2latex-32_step_100000.pt
