[2019-08-06 14:59:52,523 INFO]  * tgt vocab size = 510
[2019-08-06 14:59:52,523 INFO] Building model...
[2019-08-06 14:59:57,087 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer3): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer5): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer6): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (batch_norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(512, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 512)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-08-06 14:59:57,088 INFO] encoder: 8047424
[2019-08-06 14:59:57,088 INFO] decoder: 5214310
[2019-08-06 14:59:57,088 INFO] * number of parameters: 13261734
[2019-08-06 14:59:57,899 INFO] Starting training on GPU: [0]
[2019-08-06 14:59:57,899 INFO] Start training loop and validate every 10000 steps...
[2019-08-06 15:02:05,130 INFO]  * tgt vocab size = 510
[2019-08-06 15:02:05,130 INFO] Building model...
[2019-08-06 15:02:09,458 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer3): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer5): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer6): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (batch_norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(512, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 512)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-08-06 15:02:09,460 INFO] encoder: 8047424
[2019-08-06 15:02:09,460 INFO] decoder: 5214310
[2019-08-06 15:02:09,460 INFO] * number of parameters: 13261734
[2019-08-06 15:02:10,246 INFO] Starting training on GPU: [0]
[2019-08-06 15:02:10,246 INFO] Start training loop and validate every 10000 steps...
[2019-08-06 15:04:23,035 INFO] Step 500/100000; acc:  27.65; ppl: 42.36; xent: 3.75; lr: 0.10000;   0/2240 tok/s;    133 sec
[2019-08-06 15:06:34,262 INFO] Step 1000/100000; acc:  43.54; ppl: 14.48; xent: 2.67; lr: 0.10000;   0/2218 tok/s;    264 sec
[2019-08-06 15:08:45,287 INFO] Step 1500/100000; acc:  46.77; ppl: 11.63; xent: 2.45; lr: 0.10000;   0/2226 tok/s;    395 sec
[2019-08-06 15:10:51,470 INFO] Step 2000/100000; acc:  49.01; ppl: 10.20; xent: 2.32; lr: 0.10000;   0/2295 tok/s;    521 sec
[2019-08-06 15:13:02,359 INFO] Step 2500/100000; acc:  50.59; ppl:  9.26; xent: 2.23; lr: 0.10000;   0/2249 tok/s;    652 sec
[2019-08-06 15:15:17,518 INFO] Step 3000/100000; acc:  52.06; ppl:  8.48; xent: 2.14; lr: 0.10000;   0/2180 tok/s;    787 sec
[2019-08-06 15:17:39,222 INFO] Step 3500/100000; acc:  55.59; ppl:  6.96; xent: 1.94; lr: 0.10000;   0/2079 tok/s;    929 sec
[2019-08-06 15:19:56,290 INFO] Step 4000/100000; acc:  64.27; ppl:  4.58; xent: 1.52; lr: 0.10000;   0/2134 tok/s;   1066 sec
[2019-08-06 15:22:05,705 INFO] Step 4500/100000; acc:  74.36; ppl:  2.92; xent: 1.07; lr: 0.10000;   0/2242 tok/s;   1195 sec
[2019-08-06 15:24:17,192 INFO] Step 5000/100000; acc:  80.03; ppl:  2.29; xent: 0.83; lr: 0.10000;   0/2237 tok/s;   1327 sec
[2019-08-06 15:26:29,493 INFO] Step 5500/100000; acc:  83.39; ppl:  1.99; xent: 0.69; lr: 0.10000;   0/2225 tok/s;   1459 sec
[2019-08-06 15:28:41,349 INFO] Step 6000/100000; acc:  85.20; ppl:  1.84; xent: 0.61; lr: 0.10000;   0/2216 tok/s;   1591 sec
[2019-08-06 15:30:52,494 INFO] Step 6500/100000; acc:  86.94; ppl:  1.71; xent: 0.54; lr: 0.10000;   0/2244 tok/s;   1722 sec
[2019-08-06 15:33:02,329 INFO] Step 7000/100000; acc:  88.11; ppl:  1.62; xent: 0.49; lr: 0.10000;   0/2232 tok/s;   1852 sec
[2019-08-06 15:35:08,737 INFO] Step 7500/100000; acc:  89.04; ppl:  1.57; xent: 0.45; lr: 0.10000;   0/2315 tok/s;   1978 sec
[2019-08-06 15:37:18,428 INFO] Step 8000/100000; acc:  89.71; ppl:  1.52; xent: 0.42; lr: 0.10000;   0/2279 tok/s;   2108 sec
[2019-08-06 15:39:28,910 INFO] Step 8500/100000; acc:  90.14; ppl:  1.49; xent: 0.40; lr: 0.10000;   0/2256 tok/s;   2239 sec
[2019-08-06 15:41:35,198 INFO] Step 9000/100000; acc:  90.92; ppl:  1.44; xent: 0.37; lr: 0.10000;   0/2292 tok/s;   2365 sec
[2019-08-06 15:43:41,850 INFO] Step 9500/100000; acc:  91.27; ppl:  1.42; xent: 0.35; lr: 0.10000;   0/2304 tok/s;   2492 sec
[2019-08-06 15:45:49,076 INFO] Step 10000/100000; acc:  91.63; ppl:  1.40; xent: 0.34; lr: 0.10000;   0/2308 tok/s;   2619 sec
[2019-08-06 15:47:06,605 INFO] Validation perplexity: 1.36104
[2019-08-06 15:47:06,606 INFO] Validation accuracy: 92.264
[2019-08-06 15:47:06,609 INFO] Saving checkpoint ../results/models/im2latex-18_step_10000.pt
[2019-08-06 15:49:20,780 INFO] Step 10500/100000; acc:  92.07; ppl:  1.38; xent: 0.32; lr: 0.10000;   0/1389 tok/s;   2831 sec
[2019-08-06 15:51:33,196 INFO] Step 11000/100000; acc:  92.51; ppl:  1.36; xent: 0.30; lr: 0.10000;   0/2229 tok/s;   2963 sec
[2019-08-06 15:53:44,344 INFO] Step 11500/100000; acc:  92.60; ppl:  1.35; xent: 0.30; lr: 0.10000;   0/2251 tok/s;   3094 sec
[2019-08-06 15:55:54,742 INFO] Step 12000/100000; acc:  92.90; ppl:  1.33; xent: 0.29; lr: 0.10000;   0/2224 tok/s;   3224 sec
[2019-08-06 15:58:07,034 INFO] Step 12500/100000; acc:  93.11; ppl:  1.32; xent: 0.28; lr: 0.10000;   0/2215 tok/s;   3357 sec
[2019-08-06 16:00:19,841 INFO] Step 13000/100000; acc:  93.35; ppl:  1.31; xent: 0.27; lr: 0.10000;   0/2212 tok/s;   3490 sec
[2019-08-06 16:02:30,581 INFO] Step 13500/100000; acc:  93.50; ppl:  1.30; xent: 0.26; lr: 0.10000;   0/2230 tok/s;   3620 sec
[2019-08-06 16:04:41,646 INFO] Step 14000/100000; acc:  93.70; ppl:  1.29; xent: 0.25; lr: 0.10000;   0/2249 tok/s;   3751 sec
[2019-08-06 16:06:52,712 INFO] Step 14500/100000; acc:  93.84; ppl:  1.28; xent: 0.24; lr: 0.10000;   0/2228 tok/s;   3882 sec
[2019-08-06 16:09:02,424 INFO] Step 15000/100000; acc:  94.19; ppl:  1.26; xent: 0.23; lr: 0.10000;   0/2244 tok/s;   4012 sec
[2019-08-06 16:11:12,365 INFO] Step 15500/100000; acc:  94.22; ppl:  1.26; xent: 0.23; lr: 0.10000;   0/2270 tok/s;   4142 sec
[2019-08-06 16:13:23,002 INFO] Step 16000/100000; acc:  94.20; ppl:  1.26; xent: 0.23; lr: 0.10000;   0/2255 tok/s;   4273 sec
[2019-08-06 16:15:28,970 INFO] Step 16500/100000; acc:  94.62; ppl:  1.24; xent: 0.21; lr: 0.10000;   0/2308 tok/s;   4399 sec
[2019-08-06 16:17:36,065 INFO] Step 17000/100000; acc:  94.67; ppl:  1.24; xent: 0.21; lr: 0.10000;   0/2298 tok/s;   4526 sec
[2019-08-06 16:19:44,405 INFO] Step 17500/100000; acc:  94.75; ppl:  1.23; xent: 0.21; lr: 0.10000;   0/2279 tok/s;   4654 sec
[2019-08-06 16:21:57,379 INFO] Step 18000/100000; acc:  94.89; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/2200 tok/s;   4787 sec
[2019-08-06 16:24:08,965 INFO] Step 18500/100000; acc:  95.02; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/2239 tok/s;   4919 sec
[2019-08-06 16:26:18,560 INFO] Step 19000/100000; acc:  95.08; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/2296 tok/s;   5048 sec
[2019-08-06 16:28:23,914 INFO] Step 19500/100000; acc:  95.15; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/2305 tok/s;   5174 sec
[2019-08-06 16:30:34,179 INFO] Step 20000/100000; acc:  95.18; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/2250 tok/s;   5304 sec
[2019-08-06 16:31:51,667 INFO] Validation perplexity: 1.19293
[2019-08-06 16:31:51,669 INFO] Validation accuracy: 95.697
[2019-08-06 16:31:51,672 INFO] Saving checkpoint ../results/models/im2latex-18_step_20000.pt
[2019-08-06 16:34:01,743 INFO] Step 20500/100000; acc:  95.29; ppl:  1.20; xent: 0.19; lr: 0.10000;   0/1415 tok/s;   5511 sec
[2019-08-06 16:36:10,058 INFO] Step 21000/100000; acc:  95.22; ppl:  1.20; xent: 0.19; lr: 0.10000;   0/2275 tok/s;   5640 sec
[2019-08-06 16:38:19,672 INFO] Step 21500/100000; acc:  95.40; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/2265 tok/s;   5769 sec
[2019-08-06 16:40:28,152 INFO] Step 22000/100000; acc:  95.42; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/2281 tok/s;   5898 sec
[2019-08-06 16:42:35,332 INFO] Step 22500/100000; acc:  95.64; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/2275 tok/s;   6025 sec
[2019-08-06 16:44:44,462 INFO] Step 23000/100000; acc:  95.49; ppl:  1.19; xent: 0.18; lr: 0.10000;   0/2285 tok/s;   6154 sec
[2019-08-06 16:46:54,340 INFO] Step 23500/100000; acc:  95.55; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/2276 tok/s;   6284 sec
[2019-08-06 16:49:03,434 INFO] Step 24000/100000; acc:  95.76; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/2260 tok/s;   6413 sec
[2019-08-06 16:51:12,845 INFO] Step 24500/100000; acc:  95.87; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/2253 tok/s;   6543 sec
[2019-08-06 16:53:18,676 INFO] Step 25000/100000; acc:  95.76; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/2314 tok/s;   6668 sec
[2019-08-06 16:55:27,976 INFO] Step 25500/100000; acc:  95.84; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/2273 tok/s;   6798 sec
[2019-08-06 16:57:35,626 INFO] Step 26000/100000; acc:  95.99; ppl:  1.17; xent: 0.15; lr: 0.10000;   0/2293 tok/s;   6925 sec
[2019-08-06 16:59:44,620 INFO] Step 26500/100000; acc:  96.03; ppl:  1.17; xent: 0.15; lr: 0.10000;   0/2307 tok/s;   7054 sec
[2019-08-06 17:01:49,745 INFO] Step 27000/100000; acc:  96.04; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/2323 tok/s;   7179 sec
[2019-08-06 17:03:57,796 INFO] Step 27500/100000; acc:  95.95; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/2286 tok/s;   7308 sec
[2019-08-06 17:06:06,873 INFO] Step 28000/100000; acc:  96.11; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/2273 tok/s;   7437 sec
[2019-08-06 17:08:16,266 INFO] Step 28500/100000; acc:  96.06; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/2270 tok/s;   7566 sec
[2019-08-06 17:10:26,545 INFO] Step 29000/100000; acc:  95.99; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/2252 tok/s;   7696 sec
[2019-08-06 17:12:34,972 INFO] Step 29500/100000; acc:  96.15; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/2279 tok/s;   7825 sec
[2019-08-06 17:14:42,274 INFO] Step 30000/100000; acc:  96.14; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/2282 tok/s;   7952 sec
[2019-08-06 17:15:59,644 INFO] Validation perplexity: 1.15194
[2019-08-06 17:15:59,645 INFO] Validation accuracy: 96.4748
[2019-08-06 17:15:59,647 INFO] Saving checkpoint ../results/models/im2latex-18_step_30000.pt
[2019-08-06 17:18:08,409 INFO] Step 30500/100000; acc:  96.28; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/1418 tok/s;   8158 sec
[2019-08-06 17:20:18,805 INFO] Step 31000/100000; acc:  96.15; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/2279 tok/s;   8289 sec
[2019-08-06 17:22:26,565 INFO] Step 31500/100000; acc:  96.26; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/2281 tok/s;   8416 sec
[2019-08-06 17:24:33,255 INFO] Step 32000/100000; acc:  96.29; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/2298 tok/s;   8543 sec
[2019-08-06 17:26:39,416 INFO] Step 32500/100000; acc:  96.32; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/2300 tok/s;   8669 sec
[2019-08-06 17:28:47,745 INFO] Step 33000/100000; acc:  96.54; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2289 tok/s;   8797 sec
[2019-08-06 17:30:59,948 INFO] Step 33500/100000; acc:  96.46; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2234 tok/s;   8930 sec
[2019-08-06 17:33:08,846 INFO] Step 34000/100000; acc:  96.56; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2292 tok/s;   9059 sec
[2019-08-06 17:35:16,092 INFO] Step 34500/100000; acc:  96.45; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2301 tok/s;   9186 sec
[2019-08-06 17:37:23,194 INFO] Step 35000/100000; acc:  96.53; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2283 tok/s;   9313 sec
[2019-08-06 17:39:31,151 INFO] Step 35500/100000; acc:  96.50; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2295 tok/s;   9441 sec
[2019-08-06 17:41:40,736 INFO] Step 36000/100000; acc:  96.57; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2271 tok/s;   9570 sec
[2019-08-06 17:43:48,929 INFO] Step 36500/100000; acc:  96.55; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2276 tok/s;   9699 sec
[2019-08-06 17:45:57,314 INFO] Step 37000/100000; acc:  96.58; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2299 tok/s;   9827 sec
[2019-08-06 17:48:04,311 INFO] Step 37500/100000; acc:  96.58; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2281 tok/s;   9954 sec
[2019-08-06 17:50:12,095 INFO] Step 38000/100000; acc:  96.64; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2292 tok/s;  10082 sec
[2019-08-06 17:52:23,970 INFO] Step 38500/100000; acc:  96.71; ppl:  1.13; xent: 0.13; lr: 0.10000;   0/2234 tok/s;  10214 sec
[2019-08-06 17:54:33,639 INFO] Step 39000/100000; acc:  96.55; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2277 tok/s;  10343 sec
[2019-08-06 17:56:38,335 INFO] Step 39500/100000; acc:  96.78; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2317 tok/s;  10468 sec
[2019-08-06 17:58:45,852 INFO] Step 40000/100000; acc:  96.77; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2293 tok/s;  10596 sec
[2019-08-06 18:00:02,855 INFO] Validation perplexity: 1.12926
[2019-08-06 18:00:02,856 INFO] Validation accuracy: 96.9539
[2019-08-06 18:00:02,859 INFO] Saving checkpoint ../results/models/im2latex-18_step_40000.pt
[2019-08-06 18:02:11,867 INFO] Step 40500/100000; acc:  96.77; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1426 tok/s;  10802 sec
[2019-08-06 18:04:20,507 INFO] Step 41000/100000; acc:  96.84; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2284 tok/s;  10930 sec
[2019-08-06 18:06:29,608 INFO] Step 41500/100000; acc:  96.84; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2278 tok/s;  11059 sec
[2019-08-06 18:08:38,023 INFO] Step 42000/100000; acc:  96.83; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2300 tok/s;  11188 sec
[2019-08-06 18:10:42,668 INFO] Step 42500/100000; acc:  96.85; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/2326 tok/s;  11312 sec
[2019-08-06 18:12:53,367 INFO] Step 43000/100000; acc:  96.81; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2243 tok/s;  11443 sec
[2019-08-06 18:15:02,276 INFO] Step 43500/100000; acc:  96.85; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/2271 tok/s;  11572 sec
[2019-08-06 18:17:10,061 INFO] Step 44000/100000; acc:  96.85; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2285 tok/s;  11700 sec
[2019-08-06 18:19:19,014 INFO] Step 44500/100000; acc:  96.82; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/2290 tok/s;  11829 sec
[2019-08-06 18:21:25,661 INFO] Step 45000/100000; acc:  96.92; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/2297 tok/s;  11955 sec
[2019-08-06 18:23:34,004 INFO] Step 45500/100000; acc:  97.04; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/2268 tok/s;  12084 sec
[2019-08-06 18:25:43,669 INFO] Step 46000/100000; acc:  96.90; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/2285 tok/s;  12213 sec
[2019-08-06 18:27:53,524 INFO] Step 46500/100000; acc:  96.81; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/2267 tok/s;  12343 sec
[2019-08-06 18:29:59,676 INFO] Step 47000/100000; acc:  97.01; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/2303 tok/s;  12469 sec
[2019-08-06 18:32:07,647 INFO] Step 47500/100000; acc:  96.99; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/2283 tok/s;  12597 sec
[2019-08-06 18:34:17,216 INFO] Step 48000/100000; acc:  97.00; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/2251 tok/s;  12727 sec
[2019-08-06 18:36:24,493 INFO] Step 48500/100000; acc:  97.09; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/2296 tok/s;  12854 sec
[2019-08-06 18:38:32,621 INFO] Step 49000/100000; acc:  97.04; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/2300 tok/s;  12982 sec
[2019-08-06 18:40:42,703 INFO] Step 49500/100000; acc:  97.10; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/2288 tok/s;  13112 sec
[2019-08-06 18:42:47,973 INFO] Step 50000/100000; acc:  97.09; ppl:  1.11; xent: 0.11; lr: 0.01000;   0/2305 tok/s;  13238 sec
[2019-08-06 18:44:05,058 INFO] Validation perplexity: 1.12332
[2019-08-06 18:44:05,059 INFO] Validation accuracy: 97.1125
[2019-08-06 18:44:05,061 INFO] Saving checkpoint ../results/models/im2latex-18_step_50000.pt
[2019-08-06 18:46:14,150 INFO] Step 50500/100000; acc:  97.35; ppl:  1.10; xent: 0.10; lr: 0.01000;   0/1427 tok/s;  13444 sec
[2019-08-06 18:48:23,310 INFO] Step 51000/100000; acc:  97.59; ppl:  1.09; xent: 0.09; lr: 0.01000;   0/2271 tok/s;  13573 sec
[2019-08-06 18:50:32,144 INFO] Step 51500/100000; acc:  97.49; ppl:  1.10; xent: 0.09; lr: 0.01000;   0/2266 tok/s;  13702 sec
[2019-08-06 18:52:39,913 INFO] Step 52000/100000; acc:  97.63; ppl:  1.09; xent: 0.08; lr: 0.01000;   0/2304 tok/s;  13830 sec
[2019-08-06 18:54:49,931 INFO] Step 52500/100000; acc:  97.61; ppl:  1.09; xent: 0.08; lr: 0.01000;   0/2245 tok/s;  13960 sec
[2019-08-06 18:56:56,556 INFO] Step 53000/100000; acc:  97.70; ppl:  1.08; xent: 0.08; lr: 0.01000;   0/2293 tok/s;  14086 sec
[2019-08-06 18:59:03,634 INFO] Step 53500/100000; acc:  97.70; ppl:  1.09; xent: 0.08; lr: 0.01000;   0/2312 tok/s;  14213 sec
[2019-08-06 19:01:13,666 INFO] Step 54000/100000; acc:  97.74; ppl:  1.08; xent: 0.08; lr: 0.01000;   0/2279 tok/s;  14343 sec
[2019-08-06 19:03:22,535 INFO] Step 54500/100000; acc:  97.81; ppl:  1.08; xent: 0.08; lr: 0.01000;   0/2268 tok/s;  14472 sec
[2019-08-06 19:05:28,784 INFO] Step 55000/100000; acc:  97.92; ppl:  1.07; xent: 0.07; lr: 0.01000;   0/2305 tok/s;  14599 sec
[2019-08-06 19:07:35,142 INFO] Step 55500/100000; acc:  97.83; ppl:  1.08; xent: 0.08; lr: 0.01000;   0/2302 tok/s;  14725 sec
[2019-08-06 19:09:42,839 INFO] Step 56000/100000; acc:  97.96; ppl:  1.07; xent: 0.07; lr: 0.01000;   0/2305 tok/s;  14853 sec
[2019-08-06 19:11:50,731 INFO] Step 56500/100000; acc:  98.02; ppl:  1.07; xent: 0.07; lr: 0.01000;   0/2288 tok/s;  14980 sec
[2019-08-06 19:13:59,911 INFO] Step 57000/100000; acc:  98.08; ppl:  1.07; xent: 0.07; lr: 0.01000;   0/2306 tok/s;  15110 sec
[2019-08-06 19:16:08,395 INFO] Step 57500/100000; acc:  98.08; ppl:  1.07; xent: 0.06; lr: 0.01000;   0/2268 tok/s;  15238 sec
[2019-08-06 19:18:15,038 INFO] Step 58000/100000; acc:  97.91; ppl:  1.08; xent: 0.08; lr: 0.01000;   0/2300 tok/s;  15365 sec
[2019-08-06 19:20:23,706 INFO] Step 58500/100000; acc:  97.90; ppl:  1.08; xent: 0.07; lr: 0.01000;   0/2283 tok/s;  15493 sec
[2019-08-06 19:22:33,804 INFO] Step 59000/100000; acc:  97.83; ppl:  1.08; xent: 0.08; lr: 0.01000;   0/2262 tok/s;  15624 sec
[2019-08-06 19:24:41,792 INFO] Step 59500/100000; acc:  97.78; ppl:  1.08; xent: 0.08; lr: 0.01000;   0/2290 tok/s;  15752 sec
[2019-08-06 19:26:49,319 INFO] Step 60000/100000; acc:  97.87; ppl:  1.08; xent: 0.07; lr: 0.00100;   0/2295 tok/s;  15879 sec
[2019-08-06 19:28:06,364 INFO] Validation perplexity: 1.09117
[2019-08-06 19:28:06,366 INFO] Validation accuracy: 97.7288
[2019-08-06 19:28:06,369 INFO] Saving checkpoint ../results/models/im2latex-18_step_60000.pt
[2019-08-06 19:30:13,364 INFO] Step 60500/100000; acc:  97.87; ppl:  1.08; xent: 0.07; lr: 0.00100;   0/1425 tok/s;  16083 sec
[2019-08-06 19:32:20,667 INFO] Step 61000/100000; acc:  97.91; ppl:  1.08; xent: 0.07; lr: 0.00100;   0/2296 tok/s;  16210 sec
[2019-08-06 19:34:30,994 INFO] Step 61500/100000; acc:  97.94; ppl:  1.07; xent: 0.07; lr: 0.00100;   0/2277 tok/s;  16341 sec
[2019-08-06 19:36:42,248 INFO] Step 62000/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.00100;   0/2228 tok/s;  16472 sec
[2019-08-06 19:38:48,347 INFO] Step 62500/100000; acc:  98.05; ppl:  1.07; xent: 0.07; lr: 0.00100;   0/2303 tok/s;  16598 sec
[2019-08-06 19:40:53,815 INFO] Step 63000/100000; acc:  98.00; ppl:  1.07; xent: 0.07; lr: 0.00100;   0/2316 tok/s;  16724 sec
[2019-08-06 19:43:01,846 INFO] Step 63500/100000; acc:  98.11; ppl:  1.07; xent: 0.07; lr: 0.00100;   0/2294 tok/s;  16852 sec
[2019-08-06 19:45:09,695 INFO] Step 64000/100000; acc:  98.10; ppl:  1.07; xent: 0.07; lr: 0.00100;   0/2306 tok/s;  16979 sec
[2019-08-06 19:47:15,934 INFO] Step 64500/100000; acc:  98.17; ppl:  1.06; xent: 0.06; lr: 0.00100;   0/2340 tok/s;  17106 sec
[2019-08-06 19:49:22,806 INFO] Step 65000/100000; acc:  98.14; ppl:  1.07; xent: 0.06; lr: 0.00100;   0/2310 tok/s;  17233 sec
[2019-08-06 19:51:29,203 INFO] Step 65500/100000; acc:  98.13; ppl:  1.07; xent: 0.06; lr: 0.00100;   0/2299 tok/s;  17359 sec
[2019-08-06 19:53:36,793 INFO] Step 66000/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.00100;   0/2301 tok/s;  17487 sec
[2019-08-06 19:55:46,875 INFO] Step 66500/100000; acc:  98.00; ppl:  1.07; xent: 0.07; lr: 0.00100;   0/2254 tok/s;  17617 sec
[2019-08-06 19:57:58,145 INFO] Step 67000/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.00100;   0/2222 tok/s;  17748 sec
[2019-08-06 20:00:08,655 INFO] Step 67500/100000; acc:  97.99; ppl:  1.07; xent: 0.07; lr: 0.00100;   0/2265 tok/s;  17878 sec
[2019-08-06 20:02:16,432 INFO] Step 68000/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.00100;   0/2268 tok/s;  18006 sec
[2019-08-06 20:04:24,539 INFO] Step 68500/100000; acc:  97.98; ppl:  1.07; xent: 0.07; lr: 0.00100;   0/2279 tok/s;  18134 sec
[2019-08-06 20:06:33,868 INFO] Step 69000/100000; acc:  97.98; ppl:  1.07; xent: 0.07; lr: 0.00100;   0/2283 tok/s;  18264 sec
[2019-08-06 20:08:43,149 INFO] Step 69500/100000; acc:  97.88; ppl:  1.08; xent: 0.07; lr: 0.00100;   0/2281 tok/s;  18393 sec
[2019-08-06 20:10:49,989 INFO] Step 70000/100000; acc:  98.07; ppl:  1.07; xent: 0.07; lr: 0.00010;   0/2288 tok/s;  18520 sec
[2019-08-06 20:12:07,167 INFO] Validation perplexity: 1.0898
[2019-08-06 20:12:07,168 INFO] Validation accuracy: 97.7466
[2019-08-06 20:12:07,171 INFO] Saving checkpoint ../results/models/im2latex-18_step_70000.pt
[2019-08-06 20:14:15,455 INFO] Step 70500/100000; acc:  98.05; ppl:  1.07; xent: 0.07; lr: 0.00010;   0/1424 tok/s;  18725 sec
[2019-08-06 20:16:21,707 INFO] Step 71000/100000; acc:  98.04; ppl:  1.07; xent: 0.07; lr: 0.00010;   0/2321 tok/s;  18851 sec
[2019-08-06 20:18:32,663 INFO] Step 71500/100000; acc:  98.14; ppl:  1.07; xent: 0.06; lr: 0.00010;   0/2245 tok/s;  18982 sec
[2019-08-06 20:20:40,964 INFO] Step 72000/100000; acc:  98.14; ppl:  1.07; xent: 0.06; lr: 0.00010;   0/2293 tok/s;  19111 sec
[2019-08-06 20:22:49,267 INFO] Step 72500/100000; acc:  98.19; ppl:  1.06; xent: 0.06; lr: 0.00010;   0/2304 tok/s;  19239 sec
[2019-08-06 20:24:55,107 INFO] Step 73000/100000; acc:  98.19; ppl:  1.06; xent: 0.06; lr: 0.00010;   0/2301 tok/s;  19365 sec
[2019-08-06 20:27:04,025 INFO] Step 73500/100000; acc:  97.99; ppl:  1.07; xent: 0.07; lr: 0.00010;   0/2277 tok/s;  19494 sec
[2019-08-06 20:29:12,162 INFO] Step 74000/100000; acc:  97.99; ppl:  1.07; xent: 0.07; lr: 0.00010;   0/2284 tok/s;  19622 sec
[2019-08-06 20:31:19,381 INFO] Step 74500/100000; acc:  97.96; ppl:  1.07; xent: 0.07; lr: 0.00010;   0/2298 tok/s;  19749 sec
[2019-08-06 20:33:28,433 INFO] Step 75000/100000; acc:  98.01; ppl:  1.07; xent: 0.07; lr: 0.00010;   0/2278 tok/s;  19878 sec
[2019-08-06 20:35:35,908 INFO] Step 75500/100000; acc:  97.96; ppl:  1.07; xent: 0.07; lr: 0.00010;   0/2292 tok/s;  20006 sec
[2019-08-06 20:37:42,745 INFO] Step 76000/100000; acc:  98.04; ppl:  1.07; xent: 0.07; lr: 0.00010;   0/2293 tok/s;  20132 sec
[2019-08-06 20:39:52,713 INFO] Step 76500/100000; acc:  97.89; ppl:  1.08; xent: 0.07; lr: 0.00010;   0/2271 tok/s;  20262 sec
[2019-08-06 20:42:01,604 INFO] Step 77000/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.00010;   0/2292 tok/s;  20391 sec
[2019-08-06 20:44:09,772 INFO] Step 77500/100000; acc:  98.10; ppl:  1.07; xent: 0.07; lr: 0.00010;   0/2268 tok/s;  20520 sec
[2019-08-06 20:46:20,726 INFO] Step 78000/100000; acc:  98.07; ppl:  1.07; xent: 0.07; lr: 0.00010;   0/2228 tok/s;  20650 sec
[2019-08-06 20:48:27,078 INFO] Step 78500/100000; acc:  98.00; ppl:  1.07; xent: 0.07; lr: 0.00010;   0/2308 tok/s;  20777 sec
[2019-08-06 20:50:36,582 INFO] Step 79000/100000; acc:  98.12; ppl:  1.07; xent: 0.07; lr: 0.00010;   0/2259 tok/s;  20906 sec
[2019-08-06 20:52:44,500 INFO] Step 79500/100000; acc:  98.09; ppl:  1.07; xent: 0.07; lr: 0.00010;   0/2302 tok/s;  21034 sec
[2019-08-06 20:54:55,361 INFO] Step 80000/100000; acc:  98.17; ppl:  1.06; xent: 0.06; lr: 0.00001;   0/2275 tok/s;  21165 sec
[2019-08-06 20:56:12,740 INFO] Validation perplexity: 1.08998
[2019-08-06 20:56:12,741 INFO] Validation accuracy: 97.7573
[2019-08-06 20:56:12,744 INFO] Saving checkpoint ../results/models/im2latex-18_step_80000.pt
[2019-08-06 20:58:21,808 INFO] Step 80500/100000; acc:  98.23; ppl:  1.06; xent: 0.06; lr: 0.00001;   0/1401 tok/s;  21372 sec
[2019-08-06 21:00:29,950 INFO] Step 81000/100000; acc:  97.98; ppl:  1.07; xent: 0.07; lr: 0.00001;   0/2294 tok/s;  21500 sec
[2019-08-06 21:02:38,169 INFO] Step 81500/100000; acc:  98.00; ppl:  1.07; xent: 0.07; lr: 0.00001;   0/2285 tok/s;  21628 sec
[2019-08-06 21:04:45,688 INFO] Step 82000/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.00001;   0/2296 tok/s;  21755 sec
[2019-08-06 21:06:55,586 INFO] Step 82500/100000; acc:  98.01; ppl:  1.07; xent: 0.07; lr: 0.00001;   0/2271 tok/s;  21885 sec
[2019-08-06 21:09:01,807 INFO] Step 83000/100000; acc:  97.97; ppl:  1.07; xent: 0.07; lr: 0.00001;   0/2305 tok/s;  22012 sec
[2019-08-06 21:11:07,940 INFO] Step 83500/100000; acc:  98.00; ppl:  1.07; xent: 0.07; lr: 0.00001;   0/2309 tok/s;  22138 sec
[2019-08-06 21:13:17,038 INFO] Step 84000/100000; acc:  97.94; ppl:  1.08; xent: 0.07; lr: 0.00001;   0/2266 tok/s;  22267 sec
[2019-08-06 21:15:27,642 INFO] Step 84500/100000; acc:  97.97; ppl:  1.07; xent: 0.07; lr: 0.00001;   0/2277 tok/s;  22397 sec
[2019-08-06 21:17:36,084 INFO] Step 85000/100000; acc:  98.00; ppl:  1.07; xent: 0.07; lr: 0.00001;   0/2272 tok/s;  22526 sec
[2019-08-06 21:19:44,053 INFO] Step 85500/100000; acc:  98.07; ppl:  1.07; xent: 0.07; lr: 0.00001;   0/2273 tok/s;  22654 sec
[2019-08-06 21:21:49,660 INFO] Step 86000/100000; acc:  98.00; ppl:  1.07; xent: 0.07; lr: 0.00001;   0/2312 tok/s;  22779 sec
[2019-08-06 21:23:57,807 INFO] Step 86500/100000; acc:  98.08; ppl:  1.07; xent: 0.07; lr: 0.00001;   0/2301 tok/s;  22908 sec
[2019-08-06 21:26:06,365 INFO] Step 87000/100000; acc:  98.15; ppl:  1.07; xent: 0.06; lr: 0.00001;   0/2275 tok/s;  23036 sec
[2019-08-06 21:28:15,545 INFO] Step 87500/100000; acc:  98.19; ppl:  1.06; xent: 0.06; lr: 0.00001;   0/2302 tok/s;  23165 sec
[2019-08-06 21:30:22,571 INFO] Step 88000/100000; acc:  98.22; ppl:  1.06; xent: 0.06; lr: 0.00001;   0/2296 tok/s;  23292 sec
[2019-08-06 21:32:30,325 INFO] Step 88500/100000; acc:  98.06; ppl:  1.07; xent: 0.07; lr: 0.00001;   0/2273 tok/s;  23420 sec
[2019-08-06 21:34:39,000 INFO] Step 89000/100000; acc:  98.01; ppl:  1.07; xent: 0.07; lr: 0.00001;   0/2288 tok/s;  23549 sec
[2019-08-06 21:36:48,010 INFO] Step 89500/100000; acc:  98.03; ppl:  1.07; xent: 0.07; lr: 0.00001;   0/2279 tok/s;  23678 sec
[2019-08-06 21:38:55,307 INFO] Step 90000/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.00000;   0/2302 tok/s;  23805 sec
[2019-08-06 21:40:13,614 INFO] Validation perplexity: 1.08997
[2019-08-06 21:40:13,614 INFO] Validation accuracy: 97.7521
[2019-08-06 21:40:13,617 INFO] Saving checkpoint ../results/models/im2latex-18_step_90000.pt
[2019-08-06 21:42:22,876 INFO] Step 90500/100000; acc:  98.01; ppl:  1.07; xent: 0.07; lr: 0.00000;   0/1411 tok/s;  24013 sec
[2019-08-06 21:44:29,016 INFO] Step 91000/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.00000;   0/2305 tok/s;  24139 sec
[2019-08-06 21:46:36,151 INFO] Step 91500/100000; acc:  97.97; ppl:  1.07; xent: 0.07; lr: 0.00000;   0/2299 tok/s;  24266 sec
[2019-08-06 21:48:44,896 INFO] Step 92000/100000; acc:  97.98; ppl:  1.07; xent: 0.07; lr: 0.00000;   0/2304 tok/s;  24395 sec
[2019-08-06 21:50:52,903 INFO] Step 92500/100000; acc:  97.94; ppl:  1.07; xent: 0.07; lr: 0.00000;   0/2289 tok/s;  24523 sec
[2019-08-06 21:52:57,796 INFO] Step 93000/100000; acc:  98.07; ppl:  1.07; xent: 0.07; lr: 0.00000;   0/2323 tok/s;  24648 sec
[2019-08-06 21:55:04,520 INFO] Step 93500/100000; acc:  97.98; ppl:  1.07; xent: 0.07; lr: 0.00000;   0/2297 tok/s;  24774 sec
[2019-08-06 21:57:11,186 INFO] Step 94000/100000; acc:  98.09; ppl:  1.07; xent: 0.07; lr: 0.00000;   0/2321 tok/s;  24901 sec
[2019-08-06 21:59:19,386 INFO] Step 94500/100000; acc:  98.11; ppl:  1.07; xent: 0.06; lr: 0.00000;   0/2293 tok/s;  25029 sec
[2019-08-06 22:01:29,271 INFO] Step 95000/100000; acc:  98.18; ppl:  1.06; xent: 0.06; lr: 0.00000;   0/2267 tok/s;  25159 sec
[2019-08-06 22:03:36,536 INFO] Step 95500/100000; acc:  98.15; ppl:  1.07; xent: 0.06; lr: 0.00000;   0/2311 tok/s;  25286 sec
[2019-08-06 22:05:41,905 INFO] Step 96000/100000; acc:  98.14; ppl:  1.07; xent: 0.06; lr: 0.00000;   0/2316 tok/s;  25412 sec
[2019-08-06 22:07:49,042 INFO] Step 96500/100000; acc:  97.96; ppl:  1.07; xent: 0.07; lr: 0.00000;   0/2310 tok/s;  25539 sec
[2019-08-06 22:09:57,354 INFO] Step 97000/100000; acc:  97.98; ppl:  1.07; xent: 0.07; lr: 0.00000;   0/2284 tok/s;  25667 sec
[2019-08-06 22:12:05,390 INFO] Step 97500/100000; acc:  97.95; ppl:  1.07; xent: 0.07; lr: 0.00000;   0/2283 tok/s;  25795 sec
[2019-08-06 22:14:14,455 INFO] Step 98000/100000; acc:  98.03; ppl:  1.07; xent: 0.07; lr: 0.00000;   0/2283 tok/s;  25924 sec
[2019-08-06 22:16:22,203 INFO] Step 98500/100000; acc:  97.96; ppl:  1.07; xent: 0.07; lr: 0.00000;   0/2277 tok/s;  26052 sec
[2019-08-06 22:18:28,706 INFO] Step 99000/100000; acc:  98.01; ppl:  1.07; xent: 0.07; lr: 0.00000;   0/2304 tok/s;  26178 sec
[2019-08-06 22:20:39,113 INFO] Step 99500/100000; acc:  97.97; ppl:  1.07; xent: 0.07; lr: 0.00000;   0/2263 tok/s;  26309 sec
[2019-08-06 22:22:51,295 INFO] Step 100000/100000; acc:  97.92; ppl:  1.07; xent: 0.07; lr: 0.00000;   0/2232 tok/s;  26441 sec
[2019-08-06 22:24:08,141 INFO] Validation perplexity: 1.08997
[2019-08-06 22:24:08,142 INFO] Validation accuracy: 97.7533
[2019-08-06 22:24:08,145 INFO] Saving checkpoint ../results/models/im2latex-18_step_100000.pt
