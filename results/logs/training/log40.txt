[2019-10-23 09:37:51,853 INFO]  * tgt vocab size = 510
[2019-10-23 09:37:51,853 INFO] Building model...
[2019-10-23 09:37:55,851 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): DCN(
      (conv_offset_mask): Conv2d(3, 27, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    )
    (layer2): DCN(
      (conv_offset_mask): Conv2d(64, 27, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    )
    (layer3): DCN(
      (conv_offset_mask): Conv2d(128, 27, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    )
    (layer4): DCN(
      (conv_offset_mask): Conv2d(256, 27, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    )
    (layer5): DCN(
      (conv_offset_mask): Conv2d(256, 27, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    )
    (layer6): DCN(
      (conv_offset_mask): Conv2d(512, 27, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    )
    (batch_norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(512, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 512)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-10-23 09:37:55,853 INFO] encoder: 8343803
[2019-10-23 09:37:55,853 INFO] decoder: 5214310
[2019-10-23 09:37:55,853 INFO] * number of parameters: 13558113
[2019-10-23 09:37:56,125 INFO] Starting training on GPU: [0]
[2019-10-23 09:37:56,125 INFO] Start training loop and validate every 10000 steps...
[2019-10-23 09:43:05,304 INFO] Step 500/100000; acc:  28.90; ppl: 39.07; xent: 3.67; lr: 0.10000;   0/1903 tok/s;    309 sec
[2019-10-23 09:48:07,322 INFO] Step 1000/100000; acc:  44.68; ppl: 13.31; xent: 2.59; lr: 0.10000;   0/1925 tok/s;    611 sec
[2019-10-23 09:53:10,968 INFO] Step 1500/100000; acc:  48.46; ppl: 10.43; xent: 2.34; lr: 0.10000;   0/1940 tok/s;    915 sec
[2019-10-23 09:58:12,826 INFO] Step 2000/100000; acc:  53.24; ppl:  8.17; xent: 2.10; lr: 0.10000;   0/1943 tok/s;   1217 sec
[2019-10-23 10:03:15,764 INFO] Step 2500/100000; acc:  63.79; ppl:  4.72; xent: 1.55; lr: 0.10000;   0/1927 tok/s;   1520 sec
[2019-10-23 10:08:19,104 INFO] Step 3000/100000; acc:  74.48; ppl:  2.87; xent: 1.06; lr: 0.10000;   0/1936 tok/s;   1823 sec
[2019-10-23 10:13:18,245 INFO] Step 3500/100000; acc:  81.07; ppl:  2.18; xent: 0.78; lr: 0.10000;   0/1953 tok/s;   2122 sec
[2019-10-23 10:18:30,230 INFO] Step 4000/100000; acc:  84.33; ppl:  1.91; xent: 0.65; lr: 0.10000;   0/1884 tok/s;   2434 sec
[2019-10-23 10:23:30,824 INFO] Step 4500/100000; acc:  86.17; ppl:  1.75; xent: 0.56; lr: 0.10000;   0/1945 tok/s;   2735 sec
[2019-10-23 10:28:30,332 INFO] Step 5000/100000; acc:  87.90; ppl:  1.64; xent: 0.49; lr: 0.10000;   0/1956 tok/s;   3034 sec
[2019-10-23 10:33:39,762 INFO] Step 5500/100000; acc:  88.82; ppl:  1.57; xent: 0.45; lr: 0.10000;   0/1904 tok/s;   3344 sec
[2019-10-23 10:38:58,135 INFO] Step 6000/100000; acc:  89.64; ppl:  1.52; xent: 0.42; lr: 0.10000;   0/1837 tok/s;   3662 sec
[2019-10-23 10:44:01,175 INFO] Step 6500/100000; acc:  90.17; ppl:  1.48; xent: 0.39; lr: 0.10000;   0/1935 tok/s;   3965 sec
[2019-10-23 10:49:09,924 INFO] Step 7000/100000; acc:  90.73; ppl:  1.45; xent: 0.37; lr: 0.10000;   0/1900 tok/s;   4274 sec
[2019-10-23 10:54:31,177 INFO] Step 7500/100000; acc:  91.31; ppl:  1.41; xent: 0.34; lr: 0.10000;   0/1814 tok/s;   4595 sec
[2019-10-23 10:59:34,986 INFO] Step 8000/100000; acc:  91.60; ppl:  1.39; xent: 0.33; lr: 0.10000;   0/1941 tok/s;   4899 sec
[2019-10-23 11:04:34,467 INFO] Step 8500/100000; acc:  91.96; ppl:  1.37; xent: 0.31; lr: 0.10000;   0/1947 tok/s;   5198 sec
[2019-10-23 11:09:33,273 INFO] Step 9000/100000; acc:  92.32; ppl:  1.35; xent: 0.30; lr: 0.10000;   0/1958 tok/s;   5497 sec
[2019-10-23 11:14:34,650 INFO] Step 9500/100000; acc:  92.50; ppl:  1.34; xent: 0.30; lr: 0.10000;   0/1961 tok/s;   5799 sec
[2019-10-23 11:19:31,748 INFO] Step 10000/100000; acc:  92.67; ppl:  1.33; xent: 0.29; lr: 0.10000;   0/1959 tok/s;   6096 sec
[2019-10-23 11:21:05,844 INFO] Validation perplexity: 1.52166
[2019-10-23 11:21:05,845 INFO] Validation accuracy: 88.8599
[2019-10-23 11:21:05,848 INFO] Saving checkpoint ../results/models/im2latex-40_step_10000.pt
[2019-10-23 11:26:08,566 INFO] Step 10500/100000; acc:  92.94; ppl:  1.32; xent: 0.28; lr: 0.10000;   0/1476 tok/s;   6492 sec
[2019-10-23 11:31:09,476 INFO] Step 11000/100000; acc:  93.07; ppl:  1.31; xent: 0.27; lr: 0.10000;   0/1949 tok/s;   6793 sec
[2019-10-23 11:36:08,865 INFO] Step 11500/100000; acc:  93.31; ppl:  1.30; xent: 0.26; lr: 0.10000;   0/1952 tok/s;   7093 sec
[2019-10-23 11:41:13,470 INFO] Step 12000/100000; acc:  93.39; ppl:  1.29; xent: 0.26; lr: 0.10000;   0/1928 tok/s;   7397 sec
[2019-10-23 11:46:11,282 INFO] Step 12500/100000; acc:  93.73; ppl:  1.27; xent: 0.24; lr: 0.10000;   0/1957 tok/s;   7695 sec
[2019-10-23 11:51:13,551 INFO] Step 13000/100000; acc:  93.77; ppl:  1.27; xent: 0.24; lr: 0.10000;   0/1937 tok/s;   7997 sec
[2019-10-23 11:56:16,227 INFO] Step 13500/100000; acc:  93.86; ppl:  1.27; xent: 0.24; lr: 0.10000;   0/1944 tok/s;   8300 sec
[2019-10-23 12:01:17,550 INFO] Step 14000/100000; acc:  93.89; ppl:  1.27; xent: 0.24; lr: 0.10000;   0/1943 tok/s;   8601 sec
[2019-10-23 12:06:19,820 INFO] Step 14500/100000; acc:  93.98; ppl:  1.26; xent: 0.23; lr: 0.10000;   0/1943 tok/s;   8904 sec
[2019-10-23 12:11:17,362 INFO] Step 15000/100000; acc:  94.22; ppl:  1.25; xent: 0.22; lr: 0.10000;   0/1960 tok/s;   9201 sec
[2019-10-23 12:16:19,760 INFO] Step 15500/100000; acc:  94.05; ppl:  1.26; xent: 0.23; lr: 0.10000;   0/1950 tok/s;   9504 sec
[2019-10-23 12:21:19,947 INFO] Step 16000/100000; acc:  94.48; ppl:  1.23; xent: 0.21; lr: 0.10000;   0/1941 tok/s;   9804 sec
[2019-10-23 12:26:17,222 INFO] Step 16500/100000; acc:  94.37; ppl:  1.24; xent: 0.22; lr: 0.10000;   0/1965 tok/s;  10101 sec
[2019-10-23 12:31:19,989 INFO] Step 17000/100000; acc:  94.67; ppl:  1.23; xent: 0.20; lr: 0.10000;   0/1949 tok/s;  10404 sec
[2019-10-23 12:36:18,761 INFO] Step 17500/100000; acc:  94.58; ppl:  1.23; xent: 0.21; lr: 0.10000;   0/1952 tok/s;  10703 sec
[2019-10-23 12:41:21,618 INFO] Step 18000/100000; acc:  94.68; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/1941 tok/s;  11005 sec
[2019-10-23 12:46:23,252 INFO] Step 18500/100000; acc:  94.55; ppl:  1.23; xent: 0.21; lr: 0.10000;   0/1946 tok/s;  11307 sec
[2019-10-23 12:51:21,495 INFO] Step 19000/100000; acc:  94.74; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/1952 tok/s;  11605 sec
[2019-10-23 12:56:26,983 INFO] Step 19500/100000; acc:  94.78; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/1930 tok/s;  11911 sec
[2019-10-23 13:01:23,225 INFO] Step 20000/100000; acc:  94.94; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/1964 tok/s;  12207 sec
[2019-10-23 13:02:57,464 INFO] Validation perplexity: 1.72459
[2019-10-23 13:02:57,465 INFO] Validation accuracy: 88.2183
[2019-10-23 13:02:57,468 INFO] Saving checkpoint ../results/models/im2latex-40_step_20000.pt
[2019-10-23 13:08:01,658 INFO] Step 20500/100000; acc:  94.92; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/1474 tok/s;  12606 sec
[2019-10-23 13:13:02,521 INFO] Step 21000/100000; acc:  95.07; ppl:  1.20; xent: 0.19; lr: 0.10000;   0/1961 tok/s;  12906 sec
[2019-10-23 13:18:00,765 INFO] Step 21500/100000; acc:  95.00; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/1956 tok/s;  13205 sec
[2019-10-23 13:23:00,813 INFO] Step 22000/100000; acc:  94.86; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/1949 tok/s;  13505 sec
[2019-10-23 13:28:01,569 INFO] Step 22500/100000; acc:  95.04; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/1949 tok/s;  13805 sec
[2019-10-23 13:33:03,779 INFO] Step 23000/100000; acc:  95.08; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/1943 tok/s;  14108 sec
[2019-10-23 13:38:06,292 INFO] Step 23500/100000; acc:  95.08; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/1934 tok/s;  14410 sec
[2019-10-23 13:43:03,086 INFO] Step 24000/100000; acc:  95.17; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/1966 tok/s;  14707 sec
[2019-10-23 13:48:02,308 INFO] Step 24500/100000; acc:  95.17; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/1958 tok/s;  15006 sec
[2019-10-23 13:53:00,907 INFO] Step 25000/100000; acc:  95.34; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/1962 tok/s;  15305 sec
[2019-10-23 13:58:02,699 INFO] Step 25500/100000; acc:  94.86; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/1948 tok/s;  15607 sec
[2019-10-23 14:03:04,130 INFO] Step 26000/100000; acc:  95.27; ppl:  1.19; xent: 0.18; lr: 0.10000;   0/1946 tok/s;  15908 sec
[2019-10-23 14:08:03,793 INFO] Step 26500/100000; acc:  95.40; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/1943 tok/s;  16208 sec
[2019-10-23 14:13:08,884 INFO] Step 27000/100000; acc:  95.36; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/1933 tok/s;  16513 sec
[2019-10-23 14:18:07,926 INFO] Step 27500/100000; acc:  95.43; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/1949 tok/s;  16812 sec
[2019-10-23 14:23:05,883 INFO] Step 28000/100000; acc:  95.39; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/1965 tok/s;  17110 sec
[2019-10-23 14:28:07,346 INFO] Step 28500/100000; acc:  95.70; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/1957 tok/s;  17411 sec
[2019-10-23 14:33:06,020 INFO] Step 29000/100000; acc:  93.19; ppl:  1.33; xent: 0.29; lr: 0.10000;   0/1949 tok/s;  17710 sec
[2019-10-23 14:38:07,033 INFO] Step 29500/100000; acc:  95.44; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/1953 tok/s;  18011 sec
[2019-10-23 14:43:08,321 INFO] Step 30000/100000; acc:  95.46; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/1945 tok/s;  18312 sec
[2019-10-23 14:44:42,587 INFO] Validation perplexity: 1.91411
[2019-10-23 14:44:42,588 INFO] Validation accuracy: 84.3936
[2019-10-23 14:44:42,590 INFO] Saving checkpoint ../results/models/im2latex-40_step_30000.pt
[2019-10-23 14:49:40,257 INFO] Step 30500/100000; acc:  95.26; ppl:  1.19; xent: 0.18; lr: 0.10000;   0/1486 tok/s;  18704 sec
[2019-10-23 14:54:43,716 INFO] Step 31000/100000; acc:  95.49; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/1941 tok/s;  19008 sec
[2019-10-23 14:59:38,596 INFO] Step 31500/100000; acc:  95.56; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/1971 tok/s;  19302 sec
[2019-10-23 15:04:39,991 INFO] Step 32000/100000; acc:  95.04; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/1953 tok/s;  19604 sec
[2019-10-23 15:09:41,301 INFO] Step 32500/100000; acc:  95.17; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/1954 tok/s;  19905 sec
[2019-10-23 15:14:38,987 INFO] Step 33000/100000; acc:  95.63; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/1962 tok/s;  20203 sec
[2019-10-23 15:19:41,626 INFO] Step 33500/100000; acc:  95.63; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/1933 tok/s;  20506 sec
[2019-10-23 15:24:41,300 INFO] Step 34000/100000; acc:  95.41; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/1954 tok/s;  20805 sec
[2019-10-23 15:29:42,001 INFO] Step 34500/100000; acc:  95.59; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/1951 tok/s;  21106 sec
[2019-10-23 15:34:43,829 INFO] Step 35000/100000; acc:  95.57; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/1939 tok/s;  21408 sec
[2019-10-23 15:39:40,920 INFO] Step 35500/100000; acc:  95.58; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/1971 tok/s;  21705 sec
[2019-10-23 15:44:44,936 INFO] Step 36000/100000; acc:  95.75; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/1928 tok/s;  22009 sec
[2019-10-23 15:49:48,778 INFO] Step 36500/100000; acc:  95.73; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/1927 tok/s;  22313 sec
[2019-10-23 15:54:55,954 INFO] Step 37000/100000; acc:  95.67; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/1911 tok/s;  22620 sec
[2019-10-23 16:00:01,558 INFO] Step 37500/100000; acc:  95.75; ppl:  1.17; xent: 0.15; lr: 0.10000;   0/1916 tok/s;  22925 sec
[2019-10-23 16:05:05,529 INFO] Step 38000/100000; acc:  95.74; ppl:  1.17; xent: 0.15; lr: 0.10000;   0/1919 tok/s;  23229 sec
[2019-10-23 16:10:13,121 INFO] Step 38500/100000; acc:  95.55; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/1921 tok/s;  23537 sec
[2019-10-23 16:15:17,918 INFO] Step 39000/100000; acc:  95.46; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/1912 tok/s;  23842 sec
[2019-10-23 16:20:20,202 INFO] Step 39500/100000; acc:  95.68; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/1933 tok/s;  24144 sec
[2019-10-23 16:25:26,388 INFO] Step 40000/100000; acc:  95.66; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/1928 tok/s;  24450 sec
[2019-10-23 16:27:01,638 INFO] Validation perplexity: 1.26238
[2019-10-23 16:27:01,639 INFO] Validation accuracy: 93.6891
[2019-10-23 16:27:01,642 INFO] Saving checkpoint ../results/models/im2latex-40_step_40000.pt
[2019-10-23 16:32:09,653 INFO] Step 40500/100000; acc:  95.68; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/1444 tok/s;  24854 sec
[2019-10-23 16:37:19,311 INFO] Step 41000/100000; acc:  95.88; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/1894 tok/s;  25163 sec
[2019-10-23 16:42:28,586 INFO] Step 41500/100000; acc:  95.48; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/1896 tok/s;  25472 sec
[2019-10-23 16:47:36,578 INFO] Step 42000/100000; acc:  95.73; ppl:  1.17; xent: 0.15; lr: 0.10000;   0/1894 tok/s;  25780 sec
[2019-10-23 16:52:50,250 INFO] Step 42500/100000; acc:  95.68; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/1876 tok/s;  26094 sec
[2019-10-23 16:57:55,911 INFO] Step 43000/100000; acc:  95.63; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/1903 tok/s;  26400 sec
[2019-10-23 17:03:07,055 INFO] Step 43500/100000; acc:  95.61; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/1894 tok/s;  26711 sec
[2019-10-23 17:08:15,780 INFO] Step 44000/100000; acc:  95.70; ppl:  1.17; xent: 0.15; lr: 0.10000;   0/1904 tok/s;  27020 sec
[2019-10-23 17:13:20,056 INFO] Step 44500/100000; acc:  64.83; ppl:  4.93; xent: 1.59; lr: 0.10000;   0/1921 tok/s;  27324 sec
[2019-10-23 17:18:22,921 INFO] Step 45000/100000; acc:  52.70; ppl:  7.96; xent: 2.07; lr: 0.10000;   0/1938 tok/s;  27627 sec
[2019-10-23 17:23:22,180 INFO] Step 45500/100000; acc:  54.06; ppl:  7.34; xent: 1.99; lr: 0.10000;   0/1952 tok/s;  27926 sec
[2019-10-23 17:28:25,949 INFO] Step 46000/100000; acc:  54.78; ppl:  7.01; xent: 1.95; lr: 0.10000;   0/1937 tok/s;  28230 sec
[2019-10-23 17:33:27,682 INFO] Step 46500/100000; acc:  55.48; ppl:  6.76; xent: 1.91; lr: 0.10000;   0/1935 tok/s;  28532 sec
[2019-10-23 17:38:27,077 INFO] Step 47000/100000; acc:  56.01; ppl:  6.56; xent: 1.88; lr: 0.10000;   0/1955 tok/s;  28831 sec
[2019-10-23 17:43:30,260 INFO] Step 47500/100000; acc:  56.27; ppl:  6.44; xent: 1.86; lr: 0.10000;   0/1939 tok/s;  29134 sec
[2019-10-23 17:48:29,734 INFO] Step 48000/100000; acc:  56.71; ppl:  6.31; xent: 1.84; lr: 0.10000;   0/1953 tok/s;  29434 sec
[2019-10-23 17:53:32,202 INFO] Step 48500/100000; acc:  57.04; ppl:  6.20; xent: 1.82; lr: 0.10000;   0/1938 tok/s;  29736 sec
[2019-10-23 17:58:34,842 INFO] Step 49000/100000; acc:  57.37; ppl:  6.05; xent: 1.80; lr: 0.10000;   0/1938 tok/s;  30039 sec
[2019-10-23 18:03:36,232 INFO] Step 49500/100000; acc:  57.64; ppl:  5.96; xent: 1.79; lr: 0.10000;   0/1934 tok/s;  30340 sec
[2019-10-23 18:08:41,742 INFO] Step 50000/100000; acc:  57.86; ppl:  5.90; xent: 1.78; lr: 0.05000;   0/1931 tok/s;  30646 sec
[2019-10-23 18:10:16,032 INFO] Validation perplexity: 5.85713
[2019-10-23 18:10:16,033 INFO] Validation accuracy: 58.0619
[2019-10-23 18:10:16,037 INFO] Saving checkpoint ../results/models/im2latex-40_step_50000.pt
[2019-10-23 18:15:18,284 INFO] Step 50500/100000; acc:  58.54; ppl:  5.70; xent: 1.74; lr: 0.05000;   0/1469 tok/s;  31042 sec
[2019-10-23 18:20:18,966 INFO] Step 51000/100000; acc:  58.62; ppl:  5.64; xent: 1.73; lr: 0.05000;   0/1950 tok/s;  31343 sec
[2019-10-23 18:25:22,519 INFO] Step 51500/100000; acc:  58.98; ppl:  5.56; xent: 1.72; lr: 0.05000;   0/1942 tok/s;  31646 sec
[2019-10-23 18:30:24,418 INFO] Step 52000/100000; acc:  58.97; ppl:  5.54; xent: 1.71; lr: 0.05000;   0/1928 tok/s;  31948 sec
[2019-10-23 18:35:27,858 INFO] Step 52500/100000; acc:  59.33; ppl:  5.45; xent: 1.70; lr: 0.05000;   0/1931 tok/s;  32252 sec
[2019-10-23 18:40:28,703 INFO] Step 53000/100000; acc:  59.29; ppl:  5.43; xent: 1.69; lr: 0.05000;   0/1948 tok/s;  32553 sec
[2019-10-23 18:45:29,779 INFO] Step 53500/100000; acc:  59.47; ppl:  5.37; xent: 1.68; lr: 0.05000;   0/1943 tok/s;  32854 sec
[2019-10-23 18:50:36,698 INFO] Step 54000/100000; acc:  59.53; ppl:  5.36; xent: 1.68; lr: 0.05000;   0/1913 tok/s;  33161 sec
[2019-10-23 18:55:36,752 INFO] Step 54500/100000; acc:  59.48; ppl:  5.38; xent: 1.68; lr: 0.05000;   0/1943 tok/s;  33461 sec
[2019-10-23 19:00:41,233 INFO] Step 55000/100000; acc:  59.48; ppl:  5.38; xent: 1.68; lr: 0.05000;   0/1929 tok/s;  33765 sec
[2019-10-23 19:05:44,511 INFO] Step 55500/100000; acc:  59.78; ppl:  5.32; xent: 1.67; lr: 0.05000;   0/1939 tok/s;  34068 sec
[2019-10-23 19:10:47,849 INFO] Step 56000/100000; acc:  59.74; ppl:  5.32; xent: 1.67; lr: 0.05000;   0/1931 tok/s;  34372 sec
[2019-10-23 19:15:53,319 INFO] Step 56500/100000; acc:  60.10; ppl:  5.22; xent: 1.65; lr: 0.05000;   0/1924 tok/s;  34677 sec
[2019-10-23 19:20:53,733 INFO] Step 57000/100000; acc:  60.12; ppl:  5.20; xent: 1.65; lr: 0.05000;   0/1939 tok/s;  34978 sec
[2019-10-23 19:25:57,078 INFO] Step 57500/100000; acc:  60.15; ppl:  5.18; xent: 1.65; lr: 0.05000;   0/1945 tok/s;  35281 sec
[2019-10-23 19:30:59,284 INFO] Step 58000/100000; acc:  60.08; ppl:  5.21; xent: 1.65; lr: 0.05000;   0/1928 tok/s;  35583 sec
[2019-10-23 19:35:59,275 INFO] Step 58500/100000; acc:  60.12; ppl:  5.20; xent: 1.65; lr: 0.05000;   0/1946 tok/s;  35883 sec
[2019-10-23 19:41:03,048 INFO] Step 59000/100000; acc:  60.19; ppl:  5.18; xent: 1.64; lr: 0.05000;   0/1941 tok/s;  36187 sec
[2019-10-23 19:46:03,697 INFO] Step 59500/100000; acc:  60.24; ppl:  5.16; xent: 1.64; lr: 0.05000;   0/1938 tok/s;  36488 sec
[2019-10-23 19:51:09,980 INFO] Step 60000/100000; acc:  60.48; ppl:  5.11; xent: 1.63; lr: 0.02500;   0/1920 tok/s;  36794 sec
[2019-10-23 19:52:44,286 INFO] Validation perplexity: 5.31955
[2019-10-23 19:52:44,287 INFO] Validation accuracy: 59.818
[2019-10-23 19:52:44,290 INFO] Saving checkpoint ../results/models/im2latex-40_step_60000.pt
[2019-10-23 19:57:48,601 INFO] Step 60500/100000; acc:  60.71; ppl:  5.03; xent: 1.62; lr: 0.02500;   0/1472 tok/s;  37192 sec
[2019-10-23 20:02:50,018 INFO] Step 61000/100000; acc:  60.87; ppl:  4.98; xent: 1.61; lr: 0.02500;   0/1933 tok/s;  37494 sec
[2019-10-23 20:07:58,931 INFO] Step 61500/100000; acc:  60.94; ppl:  4.98; xent: 1.61; lr: 0.02500;   0/1909 tok/s;  37803 sec
[2019-10-23 20:12:58,129 INFO] Step 62000/100000; acc:  60.93; ppl:  4.99; xent: 1.61; lr: 0.02500;   0/1942 tok/s;  38102 sec
[2019-10-23 20:17:58,785 INFO] Step 62500/100000; acc:  60.95; ppl:  4.96; xent: 1.60; lr: 0.02500;   0/1956 tok/s;  38403 sec
[2019-10-23 20:23:00,250 INFO] Step 63000/100000; acc:  61.24; ppl:  4.92; xent: 1.59; lr: 0.02500;   0/1952 tok/s;  38704 sec
[2019-10-23 20:28:01,146 INFO] Step 63500/100000; acc:  61.16; ppl:  4.92; xent: 1.59; lr: 0.02500;   0/1939 tok/s;  39005 sec
[2019-10-23 20:33:05,800 INFO] Step 64000/100000; acc:  61.40; ppl:  4.88; xent: 1.58; lr: 0.02500;   0/1920 tok/s;  39310 sec
[2019-10-23 20:38:09,371 INFO] Step 64500/100000; acc:  61.15; ppl:  4.93; xent: 1.60; lr: 0.02500;   0/1931 tok/s;  39613 sec
[2019-10-23 20:43:14,971 INFO] Step 65000/100000; acc:  61.31; ppl:  4.88; xent: 1.58; lr: 0.02500;   0/1920 tok/s;  39919 sec
[2019-10-23 20:48:21,143 INFO] Step 65500/100000; acc:  61.33; ppl:  4.88; xent: 1.59; lr: 0.02500;   0/1911 tok/s;  40225 sec
[2019-10-23 20:53:22,796 INFO] Step 66000/100000; acc:  61.26; ppl:  4.89; xent: 1.59; lr: 0.02500;   0/1936 tok/s;  40527 sec
[2019-10-23 20:58:25,377 INFO] Step 66500/100000; acc:  61.19; ppl:  4.90; xent: 1.59; lr: 0.02500;   0/1943 tok/s;  40829 sec
[2019-10-23 21:03:27,992 INFO] Step 67000/100000; acc:  61.40; ppl:  4.86; xent: 1.58; lr: 0.02500;   0/1939 tok/s;  41132 sec
[2019-10-23 21:08:28,997 INFO] Step 67500/100000; acc:  61.45; ppl:  4.85; xent: 1.58; lr: 0.02500;   0/1950 tok/s;  41433 sec
[2019-10-23 21:13:32,396 INFO] Step 68000/100000; acc:  61.54; ppl:  4.83; xent: 1.57; lr: 0.02500;   0/1932 tok/s;  41736 sec
[2019-10-23 21:18:31,014 INFO] Step 68500/100000; acc:  61.50; ppl:  4.82; xent: 1.57; lr: 0.02500;   0/1949 tok/s;  42035 sec
[2019-10-23 21:23:32,706 INFO] Step 69000/100000; acc:  61.49; ppl:  4.81; xent: 1.57; lr: 0.02500;   0/1957 tok/s;  42337 sec
[2019-10-23 21:28:36,641 INFO] Step 69500/100000; acc:  61.52; ppl:  4.82; xent: 1.57; lr: 0.02500;   0/1919 tok/s;  42641 sec
[2019-10-23 21:33:36,847 INFO] Step 70000/100000; acc:  61.48; ppl:  4.84; xent: 1.58; lr: 0.01250;   0/1950 tok/s;  42941 sec
[2019-10-23 21:35:10,822 INFO] Validation perplexity: 5.08175
[2019-10-23 21:35:10,823 INFO] Validation accuracy: 60.699
[2019-10-23 21:35:10,826 INFO] Saving checkpoint ../results/models/im2latex-40_step_70000.pt
[2019-10-23 21:40:13,457 INFO] Step 70500/100000; acc:  61.69; ppl:  4.79; xent: 1.57; lr: 0.01250;   0/1485 tok/s;  43337 sec
[2019-10-23 21:45:13,366 INFO] Step 71000/100000; acc:  61.80; ppl:  4.75; xent: 1.56; lr: 0.01250;   0/1945 tok/s;  43637 sec
[2019-10-23 21:50:16,525 INFO] Step 71500/100000; acc:  62.05; ppl:  4.72; xent: 1.55; lr: 0.01250;   0/1936 tok/s;  43940 sec
[2019-10-23 21:55:20,406 INFO] Step 72000/100000; acc:  61.87; ppl:  4.75; xent: 1.56; lr: 0.01250;   0/1929 tok/s;  44244 sec
[2019-10-23 22:00:22,654 INFO] Step 72500/100000; acc:  61.96; ppl:  4.71; xent: 1.55; lr: 0.01250;   0/1927 tok/s;  44547 sec
[2019-10-23 22:05:28,834 INFO] Step 73000/100000; acc:  62.06; ppl:  4.69; xent: 1.55; lr: 0.01250;   0/1923 tok/s;  44853 sec
[2019-10-23 22:10:26,243 INFO] Step 73500/100000; acc:  61.96; ppl:  4.72; xent: 1.55; lr: 0.01250;   0/1955 tok/s;  45150 sec
[2019-10-23 22:15:28,840 INFO] Step 74000/100000; acc:  61.96; ppl:  4.72; xent: 1.55; lr: 0.01250;   0/1945 tok/s;  45453 sec
[2019-10-23 22:20:29,970 INFO] Step 74500/100000; acc:  61.92; ppl:  4.72; xent: 1.55; lr: 0.01250;   0/1952 tok/s;  45754 sec
[2019-10-23 22:25:29,923 INFO] Step 75000/100000; acc:  61.99; ppl:  4.72; xent: 1.55; lr: 0.01250;   0/1948 tok/s;  46054 sec
[2019-10-23 22:30:35,240 INFO] Step 75500/100000; acc:  62.20; ppl:  4.67; xent: 1.54; lr: 0.01250;   0/1918 tok/s;  46359 sec
[2019-10-23 22:35:36,830 INFO] Step 76000/100000; acc:  62.05; ppl:  4.70; xent: 1.55; lr: 0.01250;   0/1939 tok/s;  46661 sec
[2019-10-23 22:40:41,115 INFO] Step 76500/100000; acc:  62.16; ppl:  4.65; xent: 1.54; lr: 0.01250;   0/1931 tok/s;  46965 sec
[2019-10-23 22:45:42,950 INFO] Step 77000/100000; acc:  62.06; ppl:  4.68; xent: 1.54; lr: 0.01250;   0/1936 tok/s;  47267 sec
[2019-10-23 22:50:41,935 INFO] Step 77500/100000; acc:  62.18; ppl:  4.67; xent: 1.54; lr: 0.01250;   0/1960 tok/s;  47566 sec
[2019-10-23 22:55:45,036 INFO] Step 78000/100000; acc:  62.06; ppl:  4.71; xent: 1.55; lr: 0.01250;   0/1941 tok/s;  47869 sec
[2019-10-23 23:00:44,617 INFO] Step 78500/100000; acc:  62.07; ppl:  4.70; xent: 1.55; lr: 0.01250;   0/1953 tok/s;  48168 sec
[2019-10-23 23:05:49,780 INFO] Step 79000/100000; acc:  62.21; ppl:  4.67; xent: 1.54; lr: 0.01250;   0/1921 tok/s;  48474 sec
[2019-10-23 23:10:51,119 INFO] Step 79500/100000; acc:  62.25; ppl:  4.66; xent: 1.54; lr: 0.01250;   0/1948 tok/s;  48775 sec
[2019-10-23 23:15:51,555 INFO] Step 80000/100000; acc:  62.30; ppl:  4.64; xent: 1.54; lr: 0.00625;   0/1938 tok/s;  49075 sec
[2019-10-23 23:17:25,630 INFO] Validation perplexity: 4.97551
[2019-10-23 23:17:25,631 INFO] Validation accuracy: 61.0993
[2019-10-23 23:17:25,634 INFO] Saving checkpoint ../results/models/im2latex-40_step_80000.pt
[2019-10-23 23:22:32,456 INFO] Step 80500/100000; acc:  62.31; ppl:  4.63; xent: 1.53; lr: 0.00625;   0/1474 tok/s;  49476 sec
[2019-10-23 23:27:32,258 INFO] Step 81000/100000; acc:  62.26; ppl:  4.65; xent: 1.54; lr: 0.00625;   0/1943 tok/s;  49776 sec
[2019-10-23 23:32:30,825 INFO] Step 81500/100000; acc:  62.26; ppl:  4.64; xent: 1.54; lr: 0.00625;   0/1956 tok/s;  50075 sec
[2019-10-23 23:37:33,768 INFO] Step 82000/100000; acc:  62.34; ppl:  4.64; xent: 1.53; lr: 0.00625;   0/1949 tok/s;  50378 sec
[2019-10-23 23:42:33,783 INFO] Step 82500/100000; acc:  62.37; ppl:  4.62; xent: 1.53; lr: 0.00625;   0/1944 tok/s;  50678 sec
[2019-10-23 23:47:35,116 INFO] Step 83000/100000; acc:  62.54; ppl:  4.59; xent: 1.52; lr: 0.00625;   0/1943 tok/s;  50979 sec
[2019-10-23 23:52:36,610 INFO] Step 83500/100000; acc:  62.33; ppl:  4.62; xent: 1.53; lr: 0.00625;   0/1943 tok/s;  51280 sec
[2019-10-23 23:57:37,708 INFO] Step 84000/100000; acc:  62.44; ppl:  4.58; xent: 1.52; lr: 0.00625;   0/1940 tok/s;  51582 sec
[2019-10-24 00:02:44,001 INFO] Step 84500/100000; acc:  62.47; ppl:  4.60; xent: 1.53; lr: 0.00625;   0/1922 tok/s;  51888 sec
[2019-10-24 00:07:42,618 INFO] Step 85000/100000; acc:  62.37; ppl:  4.62; xent: 1.53; lr: 0.00625;   0/1947 tok/s;  52186 sec
[2019-10-24 00:12:45,422 INFO] Step 85500/100000; acc:  62.30; ppl:  4.63; xent: 1.53; lr: 0.00625;   0/1938 tok/s;  52489 sec
[2019-10-24 00:17:48,460 INFO] Step 86000/100000; acc:  62.43; ppl:  4.61; xent: 1.53; lr: 0.00625;   0/1943 tok/s;  52792 sec
[2019-10-24 00:22:52,528 INFO] Step 86500/100000; acc:  62.35; ppl:  4.62; xent: 1.53; lr: 0.00625;   0/1924 tok/s;  53096 sec
[2019-10-24 00:27:54,197 INFO] Step 87000/100000; acc:  62.69; ppl:  4.56; xent: 1.52; lr: 0.00625;   0/1947 tok/s;  53398 sec
[2019-10-24 00:32:52,423 INFO] Step 87500/100000; acc:  62.56; ppl:  4.58; xent: 1.52; lr: 0.00625;   0/1955 tok/s;  53696 sec
[2019-10-24 00:37:55,303 INFO] Step 88000/100000; acc:  62.52; ppl:  4.57; xent: 1.52; lr: 0.00625;   0/1945 tok/s;  53999 sec
[2019-10-24 00:43:00,363 INFO] Step 88500/100000; acc:  62.43; ppl:  4.60; xent: 1.53; lr: 0.00625;   0/1911 tok/s;  54304 sec
[2019-10-24 00:48:00,836 INFO] Step 89000/100000; acc:  62.56; ppl:  4.58; xent: 1.52; lr: 0.00625;   0/1947 tok/s;  54605 sec
[2019-10-24 00:53:07,935 INFO] Step 89500/100000; acc:  62.39; ppl:  4.62; xent: 1.53; lr: 0.00625;   0/1919 tok/s;  54912 sec
[2019-10-24 00:58:12,559 INFO] Step 90000/100000; acc:  62.49; ppl:  4.60; xent: 1.53; lr: 0.00313;   0/1918 tok/s;  55216 sec
[2019-10-24 00:59:46,703 INFO] Validation perplexity: 4.97356
[2019-10-24 00:59:46,704 INFO] Validation accuracy: 61.1876
[2019-10-24 00:59:46,707 INFO] Saving checkpoint ../results/models/im2latex-40_step_90000.pt
[2019-10-24 01:04:55,367 INFO] Step 90500/100000; acc:  62.72; ppl:  4.57; xent: 1.52; lr: 0.00313;   0/1456 tok/s;  55619 sec
[2019-10-24 01:09:57,474 INFO] Step 91000/100000; acc:  62.66; ppl:  4.56; xent: 1.52; lr: 0.00313;   0/1944 tok/s;  55921 sec
[2019-10-24 01:14:59,921 INFO] Step 91500/100000; acc:  62.63; ppl:  4.55; xent: 1.52; lr: 0.00313;   0/1923 tok/s;  56224 sec
[2019-10-24 01:20:09,432 INFO] Step 92000/100000; acc:  62.64; ppl:  4.56; xent: 1.52; lr: 0.00313;   0/1907 tok/s;  56533 sec
[2019-10-24 01:25:10,563 INFO] Step 92500/100000; acc:  62.63; ppl:  4.57; xent: 1.52; lr: 0.00313;   0/1934 tok/s;  56834 sec
[2019-10-24 01:30:17,532 INFO] Step 93000/100000; acc:  62.58; ppl:  4.57; xent: 1.52; lr: 0.00313;   0/1912 tok/s;  57141 sec
[2019-10-24 01:35:23,431 INFO] Step 93500/100000; acc:  62.73; ppl:  4.56; xent: 1.52; lr: 0.00313;   0/1928 tok/s;  57447 sec
[2019-10-24 01:40:25,688 INFO] Step 94000/100000; acc:  62.63; ppl:  4.55; xent: 1.52; lr: 0.00313;   0/1926 tok/s;  57750 sec
[2019-10-24 01:45:33,016 INFO] Step 94500/100000; acc:  62.77; ppl:  4.54; xent: 1.51; lr: 0.00313;   0/1906 tok/s;  58057 sec
[2019-10-24 01:50:38,458 INFO] Step 95000/100000; acc:  62.62; ppl:  4.56; xent: 1.52; lr: 0.00313;   0/1917 tok/s;  58362 sec
[2019-10-24 01:55:42,944 INFO] Step 95500/100000; acc:  62.64; ppl:  4.54; xent: 1.51; lr: 0.00313;   0/1924 tok/s;  58667 sec
[2019-10-24 02:00:48,842 INFO] Step 96000/100000; acc:  62.72; ppl:  4.55; xent: 1.51; lr: 0.00313;   0/1917 tok/s;  58973 sec
[2019-10-24 02:05:48,592 INFO] Step 96500/100000; acc:  62.62; ppl:  4.56; xent: 1.52; lr: 0.00313;   0/1944 tok/s;  59272 sec
[2019-10-24 02:10:52,800 INFO] Step 97000/100000; acc:  62.61; ppl:  4.58; xent: 1.52; lr: 0.00313;   0/1927 tok/s;  59577 sec
[2019-10-24 02:15:57,987 INFO] Step 97500/100000; acc:  62.67; ppl:  4.55; xent: 1.52; lr: 0.00313;   0/1924 tok/s;  59882 sec
[2019-10-24 02:21:04,346 INFO] Step 98000/100000; acc:  62.69; ppl:  4.56; xent: 1.52; lr: 0.00313;   0/1917 tok/s;  60188 sec
[2019-10-24 02:26:12,025 INFO] Step 98500/100000; acc:  62.82; ppl:  4.52; xent: 1.51; lr: 0.00313;   0/1908 tok/s;  60496 sec
[2019-10-24 02:31:15,819 INFO] Step 99000/100000; acc:  62.76; ppl:  4.53; xent: 1.51; lr: 0.00313;   0/1917 tok/s;  60800 sec
[2019-10-24 02:36:23,176 INFO] Step 99500/100000; acc:  62.75; ppl:  4.52; xent: 1.51; lr: 0.00313;   0/1921 tok/s;  61107 sec
[2019-10-24 02:41:25,730 INFO] Step 100000/100000; acc:  62.66; ppl:  4.56; xent: 1.52; lr: 0.00156;   0/1925 tok/s;  61410 sec
[2019-10-24 02:43:03,477 INFO] Validation perplexity: 4.96958
[2019-10-24 02:43:03,478 INFO] Validation accuracy: 61.2141
[2019-10-24 02:43:03,481 INFO] Saving checkpoint ../results/models/im2latex-40_step_100000.pt
