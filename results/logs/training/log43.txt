[2019-10-25 13:03:07,264 INFO]  * tgt vocab size = 510
[2019-10-25 13:03:07,264 INFO] Building model...
[2019-10-25 13:03:11,439 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer3): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer5): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer6): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer7): Conv2d(128, 128, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layer8): DCN(
      (conv_offset_mask): Conv2d(128, 24, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    )
    (layer9): DCN(
      (conv_offset_mask): Conv2d(128, 24, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    )
    (layer10): DCN(
      (conv_offset_mask): Conv2d(128, 24, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    )
    (batch_norm1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(128, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 128)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-10-25 13:03:11,441 INFO] encoder: 3247560
[2019-10-25 13:03:11,441 INFO] decoder: 5214310
[2019-10-25 13:03:11,441 INFO] * number of parameters: 8461870
[2019-10-25 13:03:11,727 INFO] Starting training on GPU: [0]
[2019-10-25 13:03:11,727 INFO] Start training loop and validate every 10000 steps...
[2019-10-25 13:12:30,926 INFO] Step 500/100000; acc:  28.34; ppl: 42.41; xent: 3.75; lr: 0.10000;   0/1052 tok/s;    559 sec
[2019-10-25 13:21:34,092 INFO] Step 1000/100000; acc:  44.54; ppl: 13.46; xent: 2.60; lr: 0.10000;   0/1070 tok/s;   1102 sec
[2019-10-25 13:30:55,830 INFO] Step 1500/100000; acc:  48.30; ppl: 10.53; xent: 2.35; lr: 0.10000;   0/1048 tok/s;   1664 sec
[2019-10-25 13:40:14,570 INFO] Step 2000/100000; acc:  51.47; ppl:  8.70; xent: 2.16; lr: 0.10000;   0/1050 tok/s;   2223 sec
[2019-10-25 13:49:30,464 INFO] Step 2500/100000; acc:  63.85; ppl:  4.65; xent: 1.54; lr: 0.10000;   0/1051 tok/s;   2779 sec
[2019-10-25 13:58:55,905 INFO] Step 3000/100000; acc:  80.26; ppl:  2.27; xent: 0.82; lr: 0.10000;   0/1037 tok/s;   3344 sec
[2019-10-25 14:08:04,714 INFO] Step 3500/100000; acc:  86.90; ppl:  1.73; xent: 0.55; lr: 0.10000;   0/1066 tok/s;   3893 sec
[2019-10-25 14:17:22,060 INFO] Step 4000/100000; acc:  89.50; ppl:  1.56; xent: 0.44; lr: 0.10000;   0/1055 tok/s;   4450 sec
[2019-10-25 14:26:30,736 INFO] Step 4500/100000; acc:  90.96; ppl:  1.46; xent: 0.38; lr: 0.10000;   0/1063 tok/s;   4999 sec
[2019-10-25 14:35:36,543 INFO] Step 5000/100000; acc:  91.97; ppl:  1.40; xent: 0.33; lr: 0.10000;   0/1073 tok/s;   5545 sec
[2019-10-25 14:44:51,561 INFO] Step 5500/100000; acc:  92.66; ppl:  1.36; xent: 0.30; lr: 0.10000;   0/1058 tok/s;   6100 sec
[2019-10-25 14:53:59,349 INFO] Step 6000/100000; acc:  93.12; ppl:  1.33; xent: 0.28; lr: 0.10000;   0/1068 tok/s;   6648 sec
[2019-10-25 15:03:15,088 INFO] Step 6500/100000; acc:  93.55; ppl:  1.30; xent: 0.27; lr: 0.10000;   0/1055 tok/s;   7203 sec
[2019-10-25 15:12:28,313 INFO] Step 7000/100000; acc:  93.93; ppl:  1.28; xent: 0.25; lr: 0.10000;   0/1061 tok/s;   7757 sec
[2019-10-25 15:21:34,963 INFO] Step 7500/100000; acc:  94.34; ppl:  1.26; xent: 0.23; lr: 0.10000;   0/1066 tok/s;   8303 sec
[2019-10-25 15:30:55,567 INFO] Step 8000/100000; acc:  94.44; ppl:  1.25; xent: 0.22; lr: 0.10000;   0/1052 tok/s;   8864 sec
[2019-10-25 15:40:03,156 INFO] Step 8500/100000; acc:  94.77; ppl:  1.23; xent: 0.21; lr: 0.10000;   0/1063 tok/s;   9411 sec
[2019-10-25 15:49:07,690 INFO] Step 9000/100000; acc:  94.96; ppl:  1.23; xent: 0.20; lr: 0.10000;   0/1075 tok/s;   9956 sec
[2019-10-25 15:58:26,100 INFO] Step 9500/100000; acc:  95.07; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/1060 tok/s;  10514 sec
[2019-10-25 16:07:31,524 INFO] Step 10000/100000; acc:  95.29; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/1067 tok/s;  11060 sec
[2019-10-25 16:12:19,529 INFO] Validation perplexity: 1.19334
[2019-10-25 16:12:19,530 INFO] Validation accuracy: 95.6487
[2019-10-25 16:12:19,533 INFO] Saving checkpoint ../results/models/im2latex-43_step_10000.pt
[2019-10-25 16:21:32,445 INFO] Step 10500/100000; acc:  95.29; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/696 tok/s;  11901 sec
[2019-10-25 16:30:43,153 INFO] Step 11000/100000; acc:  95.53; ppl:  1.19; xent: 0.18; lr: 0.10000;   0/1066 tok/s;  12451 sec
[2019-10-25 16:39:52,336 INFO] Step 11500/100000; acc:  95.62; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/1064 tok/s;  13001 sec
[2019-10-25 16:49:15,287 INFO] Step 12000/100000; acc:  95.57; ppl:  1.19; xent: 0.18; lr: 0.10000;   0/1043 tok/s;  13564 sec
[2019-10-25 16:58:12,039 INFO] Step 12500/100000; acc:  95.80; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/1086 tok/s;  14100 sec
[2019-10-25 17:07:24,797 INFO] Step 13000/100000; acc:  95.96; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/1060 tok/s;  14653 sec
[2019-10-25 17:16:34,439 INFO] Step 13500/100000; acc:  95.82; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/1070 tok/s;  15203 sec
[2019-10-25 17:25:46,303 INFO] Step 14000/100000; acc:  95.95; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/1061 tok/s;  15755 sec
[2019-10-25 17:35:03,738 INFO] Step 14500/100000; acc:  95.85; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/1054 tok/s;  16312 sec
[2019-10-25 17:44:08,028 INFO] Step 15000/100000; acc:  96.17; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/1071 tok/s;  16856 sec
[2019-10-25 17:53:25,809 INFO] Step 15500/100000; acc:  96.14; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/1057 tok/s;  17414 sec
[2019-10-25 18:02:36,359 INFO] Step 16000/100000; acc:  96.33; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/1058 tok/s;  17965 sec
[2019-10-25 18:11:35,273 INFO] Step 16500/100000; acc:  96.39; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/1084 tok/s;  18504 sec
[2019-10-25 18:20:50,814 INFO] Step 17000/100000; acc:  96.52; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1061 tok/s;  19059 sec
[2019-10-25 18:29:54,790 INFO] Step 17500/100000; acc:  96.53; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1072 tok/s;  19603 sec
[2019-10-25 18:39:08,549 INFO] Step 18000/100000; acc:  96.45; ppl:  1.14; xent: 0.14; lr: 0.10000;   0/1062 tok/s;  20157 sec
[2019-10-25 18:48:21,438 INFO] Step 18500/100000; acc:  96.49; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1062 tok/s;  20710 sec
[2019-10-25 18:57:23,963 INFO] Step 19000/100000; acc:  96.51; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1072 tok/s;  21252 sec
[2019-10-25 19:06:49,763 INFO] Step 19500/100000; acc:  96.55; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1044 tok/s;  21818 sec
[2019-10-25 19:15:52,983 INFO] Step 20000/100000; acc:  96.67; ppl:  1.13; xent: 0.13; lr: 0.10000;   0/1071 tok/s;  22361 sec
[2019-10-25 19:20:41,123 INFO] Validation perplexity: 1.17472
[2019-10-25 19:20:41,124 INFO] Validation accuracy: 95.8813
[2019-10-25 19:20:41,127 INFO] Saving checkpoint ../results/models/im2latex-43_step_20000.pt
[2019-10-25 19:29:50,359 INFO] Step 20500/100000; acc:  96.72; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/701 tok/s;  23199 sec
[2019-10-25 19:39:03,239 INFO] Step 21000/100000; acc:  96.85; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1068 tok/s;  23752 sec
[2019-10-25 19:48:09,251 INFO] Step 21500/100000; acc:  96.84; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1068 tok/s;  24298 sec
[2019-10-25 19:57:21,304 INFO] Step 22000/100000; acc:  96.85; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1059 tok/s;  24850 sec
[2019-10-25 20:06:32,205 INFO] Step 22500/100000; acc:  96.90; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/1064 tok/s;  25400 sec
[2019-10-25 20:15:46,536 INFO] Step 23000/100000; acc:  96.99; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1060 tok/s;  25955 sec
[2019-10-25 20:25:02,522 INFO] Step 23500/100000; acc:  96.95; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1052 tok/s;  26511 sec
[2019-10-25 20:34:00,947 INFO] Step 24000/100000; acc:  96.98; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1084 tok/s;  27049 sec
[2019-10-25 20:43:09,554 INFO] Step 24500/100000; acc:  96.89; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/1067 tok/s;  27598 sec
[2019-10-25 20:52:17,370 INFO] Step 25000/100000; acc:  97.12; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1070 tok/s;  28146 sec
[2019-10-25 21:01:32,871 INFO] Step 25500/100000; acc:  97.11; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1058 tok/s;  28701 sec
[2019-10-25 21:10:45,830 INFO] Step 26000/100000; acc:  97.02; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1061 tok/s;  29254 sec
[2019-10-25 21:19:52,685 INFO] Step 26500/100000; acc:  97.08; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1065 tok/s;  29801 sec
[2019-10-25 21:29:10,830 INFO] Step 27000/100000; acc:  97.07; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1057 tok/s;  30359 sec
[2019-10-25 21:38:19,167 INFO] Step 27500/100000; acc:  97.22; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1063 tok/s;  30907 sec
[2019-10-25 21:47:20,176 INFO] Step 28000/100000; acc:  87.03; ppl:  1.82; xent: 0.60; lr: 0.10000;   0/1082 tok/s;  31448 sec
[2019-10-25 21:56:33,466 INFO] Step 28500/100000; acc:  71.08; ppl:  3.56; xent: 1.27; lr: 0.10000;   0/1067 tok/s;  32002 sec
[2019-10-25 22:05:39,782 INFO] Step 29000/100000; acc:  95.96; ppl:  1.17; xent: 0.15; lr: 0.10000;   0/1067 tok/s;  32548 sec
[2019-10-25 22:14:57,170 INFO] Step 29500/100000; acc:  96.60; ppl:  1.13; xent: 0.13; lr: 0.10000;   0/1055 tok/s;  33105 sec
[2019-10-25 22:24:07,525 INFO] Step 30000/100000; acc:  97.04; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1064 tok/s;  33656 sec
[2019-10-25 22:28:55,408 INFO] Validation perplexity: 1.11917
[2019-10-25 22:28:55,409 INFO] Validation accuracy: 97.0649
[2019-10-25 22:28:55,412 INFO] Saving checkpoint ../results/models/im2latex-43_step_30000.pt
[2019-10-25 22:38:01,665 INFO] Step 30500/100000; acc:  96.88; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/699 tok/s;  34490 sec
[2019-10-25 22:47:27,007 INFO] Step 31000/100000; acc:  96.98; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1042 tok/s;  35055 sec
[2019-10-25 22:56:24,574 INFO] Step 31500/100000; acc:  97.12; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1081 tok/s;  35593 sec
[2019-10-25 23:05:36,759 INFO] Step 32000/100000; acc:  97.25; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1066 tok/s;  36145 sec
[2019-10-25 23:14:47,984 INFO] Step 32500/100000; acc:  97.23; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1068 tok/s;  36696 sec
[2019-10-25 23:23:52,522 INFO] Step 33000/100000; acc:  97.37; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1073 tok/s;  37241 sec
[2019-10-25 23:33:08,481 INFO] Step 33500/100000; acc:  97.30; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1053 tok/s;  37797 sec
[2019-10-25 23:42:16,430 INFO] Step 34000/100000; acc:  97.25; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1068 tok/s;  38345 sec
[2019-10-25 23:51:28,732 INFO] Step 34500/100000; acc:  97.15; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1063 tok/s;  38897 sec
[2019-10-26 00:00:44,575 INFO] Step 35000/100000; acc:  97.13; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1052 tok/s;  39453 sec
[2019-10-26 00:09:45,392 INFO] Step 35500/100000; acc:  97.40; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1083 tok/s;  39994 sec
[2019-10-26 00:18:54,249 INFO] Step 36000/100000; acc:  97.42; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1066 tok/s;  40543 sec
[2019-10-26 00:28:00,947 INFO] Step 36500/100000; acc:  97.48; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1071 tok/s;  41089 sec
[2019-10-26 00:37:16,495 INFO] Step 37000/100000; acc:  97.51; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1056 tok/s;  41645 sec
[2019-10-26 00:46:28,122 INFO] Step 37500/100000; acc:  97.49; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1063 tok/s;  42196 sec
[2019-10-26 00:55:39,288 INFO] Step 38000/100000; acc:  97.51; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1057 tok/s;  42748 sec
[2019-10-26 01:05:09,273 INFO] Step 38500/100000; acc:  97.45; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1036 tok/s;  43318 sec
[2019-10-26 01:14:24,276 INFO] Step 39000/100000; acc:  97.55; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1050 tok/s;  43873 sec
[2019-10-26 01:23:30,218 INFO] Step 39500/100000; acc:  97.44; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1070 tok/s;  44418 sec
[2019-10-26 01:32:53,142 INFO] Step 40000/100000; acc:  97.54; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1051 tok/s;  44981 sec
[2019-10-26 01:37:46,720 INFO] Validation perplexity: 1.1398
[2019-10-26 01:37:46,720 INFO] Validation accuracy: 96.6037
[2019-10-26 01:37:46,723 INFO] Saving checkpoint ../results/models/im2latex-43_step_40000.pt
[2019-10-26 01:46:53,714 INFO] Step 40500/100000; acc:  97.59; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/694 tok/s;  45822 sec
[2019-10-26 01:56:14,062 INFO] Step 41000/100000; acc:  97.43; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1046 tok/s;  46382 sec
[2019-10-26 02:05:31,228 INFO] Step 41500/100000; acc:  97.46; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1051 tok/s;  46940 sec
[2019-10-26 02:14:37,868 INFO] Step 42000/100000; acc:  97.58; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1068 tok/s;  47486 sec
[2019-10-26 02:24:07,934 INFO] Step 42500/100000; acc:  97.35; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1033 tok/s;  48056 sec
[2019-10-26 02:33:08,711 INFO] Step 43000/100000; acc:  97.61; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1075 tok/s;  48597 sec
[2019-10-26 02:42:24,896 INFO] Step 43500/100000; acc:  97.51; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1058 tok/s;  49153 sec
[2019-10-26 02:51:41,659 INFO] Step 44000/100000; acc:  97.50; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1056 tok/s;  49710 sec
[2019-10-26 03:00:57,642 INFO] Step 44500/100000; acc:  97.40; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1052 tok/s;  50266 sec
[2019-10-26 03:10:21,377 INFO] Step 45000/100000; acc:  97.33; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1041 tok/s;  50830 sec
[2019-10-26 03:19:27,723 INFO] Step 45500/100000; acc:  97.46; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1069 tok/s;  51376 sec
[2019-10-26 03:28:51,137 INFO] Step 46000/100000; acc:  97.62; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1045 tok/s;  51939 sec
[2019-10-26 03:38:04,138 INFO] Step 46500/100000; acc:  97.64; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1054 tok/s;  52492 sec
[2019-10-26 03:47:08,711 INFO] Step 47000/100000; acc:  97.54; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1075 tok/s;  53037 sec
[2019-10-26 03:56:31,110 INFO] Step 47500/100000; acc:  97.64; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1044 tok/s;  53599 sec
[2019-10-26 04:05:36,707 INFO] Step 48000/100000; acc:  97.68; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1071 tok/s;  54145 sec
[2019-10-26 04:14:57,245 INFO] Step 48500/100000; acc:  97.66; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1046 tok/s;  54706 sec
[2019-10-26 04:24:10,712 INFO] Step 49000/100000; acc:  97.52; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1060 tok/s;  55259 sec
[2019-10-26 04:33:20,900 INFO] Step 49500/100000; acc:  97.73; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1059 tok/s;  55809 sec
[2019-10-26 04:42:48,067 INFO] Step 50000/100000; acc:  97.67; ppl:  1.09; xent: 0.08; lr: 0.05000;   0/1040 tok/s;  56376 sec
[2019-10-26 04:47:40,242 INFO] Validation perplexity: 1.09846
[2019-10-26 04:47:40,243 INFO] Validation accuracy: 97.5693
[2019-10-26 04:47:40,246 INFO] Saving checkpoint ../results/models/im2latex-43_step_50000.pt
[2019-10-26 04:56:49,699 INFO] Step 50500/100000; acc:  97.91; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/692 tok/s;  57218 sec
[2019-10-26 05:06:01,549 INFO] Step 51000/100000; acc:  97.96; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/1063 tok/s;  57770 sec
[2019-10-26 05:15:24,863 INFO] Step 51500/100000; acc:  98.06; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/1047 tok/s;  58333 sec
[2019-10-26 05:24:32,566 INFO] Step 52000/100000; acc:  98.16; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1064 tok/s;  58881 sec
[2019-10-26 05:33:51,167 INFO] Step 52500/100000; acc:  98.10; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/1048 tok/s;  59439 sec
[2019-10-26 05:43:08,101 INFO] Step 53000/100000; acc:  98.14; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/1053 tok/s;  59996 sec
[2019-10-26 05:52:24,019 INFO] Step 53500/100000; acc:  98.28; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1053 tok/s;  60552 sec
[2019-10-26 06:01:52,947 INFO] Step 54000/100000; acc:  98.26; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1032 tok/s;  61121 sec
[2019-10-26 06:10:55,501 INFO] Step 54500/100000; acc:  98.26; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1074 tok/s;  61664 sec
[2019-10-26 06:20:14,668 INFO] Step 55000/100000; acc:  98.25; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1052 tok/s;  62223 sec
[2019-10-26 06:29:29,845 INFO] Step 55500/100000; acc:  98.29; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1058 tok/s;  62778 sec
[2019-10-26 06:38:43,036 INFO] Step 56000/100000; acc:  98.29; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1060 tok/s;  63331 sec
[2019-10-26 06:48:06,013 INFO] Step 56500/100000; acc:  98.29; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1044 tok/s;  63894 sec
[2019-10-26 06:57:13,254 INFO] Step 57000/100000; acc:  98.28; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1065 tok/s;  64442 sec
[2019-10-26 07:06:39,676 INFO] Step 57500/100000; acc:  98.32; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1041 tok/s;  65008 sec
[2019-10-26 07:15:52,841 INFO] Step 58000/100000; acc:  98.30; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1054 tok/s;  65561 sec
[2019-10-26 07:24:54,702 INFO] Step 58500/100000; acc:  98.28; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1078 tok/s;  66103 sec
[2019-10-26 07:34:07,982 INFO] Step 59000/100000; acc:  98.32; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1063 tok/s;  66656 sec
[2019-10-26 07:43:19,315 INFO] Step 59500/100000; acc:  98.35; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1057 tok/s;  67208 sec
[2019-10-26 07:52:41,460 INFO] Step 60000/100000; acc:  98.35; ppl:  1.06; xent: 0.05; lr: 0.02500;   0/1047 tok/s;  67770 sec
[2019-10-26 07:57:37,656 INFO] Validation perplexity: 1.07992
[2019-10-26 07:57:37,657 INFO] Validation accuracy: 98.0072
[2019-10-26 07:57:37,660 INFO] Saving checkpoint ../results/models/im2latex-43_step_60000.pt
[2019-10-26 08:06:57,346 INFO] Step 60500/100000; acc:  98.39; ppl:  1.06; xent: 0.05; lr: 0.02500;   0/685 tok/s;  68626 sec
[2019-10-26 08:16:00,251 INFO] Step 61000/100000; acc:  98.46; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1073 tok/s;  69169 sec
[2019-10-26 08:25:30,834 INFO] Step 61500/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1034 tok/s;  69739 sec
[2019-10-26 08:34:35,309 INFO] Step 62000/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1067 tok/s;  70284 sec
[2019-10-26 08:43:48,639 INFO] Step 62500/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1062 tok/s;  70837 sec
[2019-10-26 08:53:08,010 INFO] Step 63000/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1052 tok/s;  71396 sec
[2019-10-26 09:02:14,655 INFO] Step 63500/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1068 tok/s;  71943 sec
[2019-10-26 09:11:30,163 INFO] Step 64000/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1053 tok/s;  72498 sec
[2019-10-26 09:20:42,040 INFO] Step 64500/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1062 tok/s;  73050 sec
[2019-10-26 09:30:00,453 INFO] Step 65000/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1050 tok/s;  73609 sec
[2019-10-26 09:39:18,492 INFO] Step 65500/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1048 tok/s;  74167 sec
[2019-10-26 09:48:21,612 INFO] Step 66000/100000; acc:  98.53; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1077 tok/s;  74710 sec
[2019-10-26 09:57:37,221 INFO] Step 66500/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1058 tok/s;  75265 sec
[2019-10-26 10:06:55,127 INFO] Step 67000/100000; acc:  98.58; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1052 tok/s;  75823 sec
[2019-10-26 10:16:12,754 INFO] Step 67500/100000; acc:  98.62; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1053 tok/s;  76381 sec
[2019-10-26 10:25:32,368 INFO] Step 68000/100000; acc:  98.53; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1047 tok/s;  76941 sec
[2019-10-26 10:34:45,013 INFO] Step 68500/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1054 tok/s;  77493 sec
[2019-10-26 10:44:06,395 INFO] Step 69000/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1052 tok/s;  78055 sec
[2019-10-26 10:53:21,653 INFO] Step 69500/100000; acc:  98.60; ppl:  1.05; xent: 0.04; lr: 0.02500;   0/1050 tok/s;  78610 sec
[2019-10-26 11:02:33,482 INFO] Step 70000/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/1061 tok/s;  79162 sec
[2019-10-26 11:07:28,605 INFO] Validation perplexity: 1.07756
[2019-10-26 11:07:28,605 INFO] Validation accuracy: 98.1031
[2019-10-26 11:07:28,608 INFO] Saving checkpoint ../results/models/im2latex-43_step_70000.pt
[2019-10-26 11:16:45,339 INFO] Step 70500/100000; acc:  98.61; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/692 tok/s;  80014 sec
[2019-10-26 11:25:57,529 INFO] Step 71000/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1056 tok/s;  80566 sec
[2019-10-26 11:35:11,425 INFO] Step 71500/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1060 tok/s;  81120 sec
[2019-10-26 11:44:30,353 INFO] Step 72000/100000; acc:  98.61; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/1049 tok/s;  81679 sec
[2019-10-26 11:53:40,526 INFO] Step 72500/100000; acc:  98.65; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1059 tok/s;  82229 sec
[2019-10-26 12:03:07,891 INFO] Step 73000/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1038 tok/s;  82796 sec
[2019-10-26 12:12:17,530 INFO] Step 73500/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1058 tok/s;  83346 sec
[2019-10-26 12:21:32,019 INFO] Step 74000/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1062 tok/s;  83900 sec
[2019-10-26 12:30:49,683 INFO] Step 74500/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1054 tok/s;  84458 sec
[2019-10-26 12:40:04,241 INFO] Step 75000/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1053 tok/s;  85013 sec
[2019-10-26 12:49:26,871 INFO] Step 75500/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1041 tok/s;  85575 sec
[2019-10-26 12:58:45,335 INFO] Step 76000/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1048 tok/s;  86134 sec
[2019-10-26 13:08:02,499 INFO] Step 76500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1054 tok/s;  86691 sec
[2019-10-26 13:17:20,767 INFO] Step 77000/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1047 tok/s;  87249 sec
[2019-10-26 13:26:23,869 INFO] Step 77500/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1078 tok/s;  87792 sec
[2019-10-26 13:35:43,097 INFO] Step 78000/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1051 tok/s;  88351 sec
[2019-10-26 13:44:59,256 INFO] Step 78500/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1053 tok/s;  88908 sec
[2019-10-26 13:54:22,577 INFO] Step 79000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1040 tok/s;  89471 sec
[2019-10-26 14:03:40,396 INFO] Step 79500/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1052 tok/s;  90029 sec
[2019-10-26 14:12:53,995 INFO] Step 80000/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1052 tok/s;  90582 sec
[2019-10-26 14:17:45,868 INFO] Validation perplexity: 1.0765
[2019-10-26 14:17:45,869 INFO] Validation accuracy: 98.1383
[2019-10-26 14:17:45,872 INFO] Saving checkpoint ../results/models/im2latex-43_step_80000.pt
[2019-10-26 14:27:15,513 INFO] Step 80500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/686 tok/s;  91444 sec
[2019-10-26 14:36:30,207 INFO] Step 81000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1050 tok/s;  91998 sec
[2019-10-26 14:45:36,198 INFO] Step 81500/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1070 tok/s;  92544 sec
[2019-10-26 14:54:52,539 INFO] Step 82000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1064 tok/s;  93101 sec
[2019-10-26 15:04:05,156 INFO] Step 82500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1055 tok/s;  93653 sec
[2019-10-26 15:13:18,536 INFO] Step 83000/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1058 tok/s;  94207 sec
[2019-10-26 15:22:34,760 INFO] Step 83500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1053 tok/s;  94763 sec
[2019-10-26 15:31:53,577 INFO] Step 84000/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1045 tok/s;  95322 sec
[2019-10-26 15:41:22,925 INFO] Step 84500/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1034 tok/s;  95891 sec
[2019-10-26 15:50:21,394 INFO] Step 85000/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1080 tok/s;  96430 sec
[2019-10-26 15:59:39,314 INFO] Step 85500/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1052 tok/s;  96988 sec
[2019-10-26 16:08:59,531 INFO] Step 86000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1051 tok/s;  97548 sec
[2019-10-26 16:18:17,524 INFO] Step 86500/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1048 tok/s;  98106 sec
[2019-10-26 16:27:31,505 INFO] Step 87000/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1059 tok/s;  98660 sec
[2019-10-26 16:36:42,046 INFO] Step 87500/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1060 tok/s;  99210 sec
[2019-10-26 16:46:04,817 INFO] Step 88000/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1047 tok/s;  99773 sec
[2019-10-26 16:55:17,308 INFO] Step 88500/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1055 tok/s; 100326 sec
[2019-10-26 17:04:25,591 INFO] Step 89000/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1067 tok/s; 100874 sec
[2019-10-26 17:13:46,743 INFO] Step 89500/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1049 tok/s; 101435 sec
[2019-10-26 17:22:56,929 INFO] Step 90000/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1061 tok/s; 101985 sec
[2019-10-26 17:27:52,059 INFO] Validation perplexity: 1.07663
[2019-10-26 17:27:52,060 INFO] Validation accuracy: 98.1485
[2019-10-26 17:27:52,063 INFO] Saving checkpoint ../results/models/im2latex-43_step_90000.pt
[2019-10-26 17:37:20,546 INFO] Step 90500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/680 tok/s; 102849 sec
[2019-10-26 17:46:38,272 INFO] Step 91000/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1052 tok/s; 103407 sec
[2019-10-26 17:55:52,602 INFO] Step 91500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1050 tok/s; 103961 sec
[2019-10-26 18:05:18,634 INFO] Step 92000/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1043 tok/s; 104527 sec
[2019-10-26 18:14:28,207 INFO] Step 92500/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1060 tok/s; 105076 sec
[2019-10-26 18:23:40,616 INFO] Step 93000/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1063 tok/s; 105629 sec
[2019-10-26 18:32:59,692 INFO] Step 93500/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1056 tok/s; 106188 sec
[2019-10-26 18:42:09,280 INFO] Step 94000/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1059 tok/s; 106738 sec
[2019-10-26 18:51:26,978 INFO] Step 94500/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1051 tok/s; 107295 sec
[2019-10-26 19:00:40,860 INFO] Step 95000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1057 tok/s; 107849 sec
[2019-10-26 19:09:56,212 INFO] Step 95500/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1055 tok/s; 108404 sec
[2019-10-26 19:19:23,439 INFO] Step 96000/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1034 tok/s; 108972 sec
[2019-10-26 19:28:25,856 INFO] Step 96500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1074 tok/s; 109514 sec
[2019-10-26 19:37:42,883 INFO] Step 97000/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1052 tok/s; 110071 sec
[2019-10-26 19:46:56,087 INFO] Step 97500/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1062 tok/s; 110624 sec
[2019-10-26 19:56:13,535 INFO] Step 98000/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1053 tok/s; 111182 sec
[2019-10-26 20:05:28,379 INFO] Step 98500/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1059 tok/s; 111737 sec
[2019-10-26 20:14:24,522 INFO] Step 99000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1085 tok/s; 112273 sec
[2019-10-26 20:23:32,431 INFO] Step 99500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1077 tok/s; 112821 sec
[2019-10-26 20:32:32,981 INFO] Step 100000/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.00156;   0/1077 tok/s; 113361 sec
[2019-10-26 20:37:20,133 INFO] Validation perplexity: 1.07642
[2019-10-26 20:37:20,134 INFO] Validation accuracy: 98.1554
[2019-10-26 20:37:20,137 INFO] Saving checkpoint ../results/models/im2latex-43_step_100000.pt
