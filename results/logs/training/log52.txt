[2019-11-22 12:19:16,015 INFO]  * tgt vocab size = 510
[2019-11-22 12:19:16,015 INFO] Building model...
[2019-11-22 12:19:25,707 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer3): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer5): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer6): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (batch_norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(512, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 512)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-11-22 12:19:25,718 INFO] encoder: 8047424
[2019-11-22 12:19:25,719 INFO] decoder: 5214310
[2019-11-22 12:19:25,719 INFO] * number of parameters: 13261734
[2019-11-22 12:19:26,361 INFO] Starting training on GPU: [0]
[2019-11-22 12:19:26,361 INFO] Start training loop and validate every 10000 steps...
[2019-11-22 12:28:33,719 INFO] Step 500/100000; acc:  38.95; ppl: 18.72; xent: 2.93; lr: 0.00100;   0/1075 tok/s;    547 sec
[2019-11-22 12:38:00,330 INFO] Step 1000/100000; acc:  50.29; ppl:  9.73; xent: 2.28; lr: 0.00100;   0/1026 tok/s;   1114 sec
[2019-11-22 12:47:18,646 INFO] Step 1500/100000; acc:  62.37; ppl:  5.31; xent: 1.67; lr: 0.00100;   0/1055 tok/s;   1672 sec
[2019-11-22 12:55:22,015 INFO] Step 2000/100000; acc:  76.18; ppl:  2.73; xent: 1.01; lr: 0.00100;   0/1218 tok/s;   2156 sec
[2019-11-22 13:03:10,258 INFO] Step 2500/100000; acc:  83.41; ppl:  2.02; xent: 0.70; lr: 0.00100;   0/1248 tok/s;   2624 sec
[2019-11-22 13:11:01,897 INFO] Step 3000/100000; acc:  86.83; ppl:  1.74; xent: 0.55; lr: 0.00100;   0/1245 tok/s;   3096 sec
[2019-11-22 13:18:43,192 INFO] Step 3500/100000; acc:  89.04; ppl:  1.58; xent: 0.46; lr: 0.00100;   0/1267 tok/s;   3557 sec
[2019-11-22 13:26:30,248 INFO] Step 4000/100000; acc:  90.20; ppl:  1.50; xent: 0.41; lr: 0.00100;   0/1258 tok/s;   4024 sec
[2019-11-22 13:34:21,040 INFO] Step 4500/100000; acc:  91.12; ppl:  1.44; xent: 0.36; lr: 0.00100;   0/1240 tok/s;   4495 sec
[2019-11-22 13:41:25,866 INFO] Step 5000/100000; acc:  91.96; ppl:  1.39; xent: 0.33; lr: 0.00100;   0/1379 tok/s;   4920 sec
[2019-11-22 13:48:50,783 INFO] Step 5500/100000; acc:  92.51; ppl:  1.36; xent: 0.31; lr: 0.00100;   0/1317 tok/s;   5364 sec
[2019-11-22 13:56:26,505 INFO] Step 6000/100000; acc:  92.93; ppl:  1.33; xent: 0.29; lr: 0.00100;   0/1284 tok/s;   5820 sec
[2019-11-22 14:04:12,587 INFO] Step 6500/100000; acc:  93.31; ppl:  1.31; xent: 0.27; lr: 0.00100;   0/1258 tok/s;   6286 sec
[2019-11-22 14:11:52,784 INFO] Step 7000/100000; acc:  93.58; ppl:  1.29; xent: 0.25; lr: 0.00100;   0/1275 tok/s;   6746 sec
[2019-11-22 14:19:32,102 INFO] Step 7500/100000; acc:  94.00; ppl:  1.27; xent: 0.24; lr: 0.00100;   0/1268 tok/s;   7206 sec
[2019-11-22 14:27:10,981 INFO] Step 8000/100000; acc:  94.09; ppl:  1.26; xent: 0.23; lr: 0.00100;   0/1286 tok/s;   7665 sec
[2019-11-22 14:34:49,155 INFO] Step 8500/100000; acc:  94.49; ppl:  1.24; xent: 0.22; lr: 0.00100;   0/1271 tok/s;   8123 sec
[2019-11-22 14:42:22,188 INFO] Step 9000/100000; acc:  94.68; ppl:  1.23; xent: 0.21; lr: 0.00100;   0/1291 tok/s;   8576 sec
[2019-11-22 14:50:03,298 INFO] Step 9500/100000; acc:  94.94; ppl:  1.22; xent: 0.20; lr: 0.00100;   0/1283 tok/s;   9037 sec
[2019-11-22 14:57:33,751 INFO] Step 10000/100000; acc:  95.05; ppl:  1.22; xent: 0.20; lr: 0.00100;   0/1292 tok/s;   9487 sec
[2019-11-22 15:01:36,054 INFO] Validation perplexity: 1.19529
[2019-11-22 15:01:36,063 INFO] Validation accuracy: 95.4842
[2019-11-22 15:01:36,074 INFO] Saving checkpoint ../results/models/im2latex-52_step_10000.pt
[2019-11-22 15:09:14,793 INFO] Step 10500/100000; acc:  95.19; ppl:  1.21; xent: 0.19; lr: 0.00100;   0/835 tok/s;  10188 sec
[2019-11-22 15:16:46,036 INFO] Step 11000/100000; acc:  95.32; ppl:  1.20; xent: 0.18; lr: 0.00100;   0/1300 tok/s;  10640 sec
[2019-11-22 15:24:12,136 INFO] Step 11500/100000; acc:  95.44; ppl:  1.20; xent: 0.18; lr: 0.00100;   0/1310 tok/s;  11086 sec
[2019-11-22 15:31:47,250 INFO] Step 12000/100000; acc:  95.54; ppl:  1.19; xent: 0.17; lr: 0.00100;   0/1291 tok/s;  11541 sec
[2019-11-22 15:39:44,612 INFO] Step 12500/100000; acc:  95.73; ppl:  1.18; xent: 0.17; lr: 0.00100;   0/1221 tok/s;  12018 sec
[2019-11-22 15:48:04,605 INFO] Step 13000/100000; acc:  95.79; ppl:  1.18; xent: 0.16; lr: 0.00100;   0/1171 tok/s;  12518 sec
[2019-11-22 15:56:35,625 INFO] Step 13500/100000; acc:  95.91; ppl:  1.17; xent: 0.16; lr: 0.00100;   0/1152 tok/s;  13029 sec
[2019-11-22 16:05:03,564 INFO] Step 14000/100000; acc:  95.93; ppl:  1.17; xent: 0.16; lr: 0.00100;   0/1154 tok/s;  13537 sec
[2019-11-22 16:13:30,765 INFO] Step 14500/100000; acc:  95.94; ppl:  1.17; xent: 0.15; lr: 0.00100;   0/1158 tok/s;  14044 sec
[2019-11-22 16:21:46,803 INFO] Step 15000/100000; acc:  96.07; ppl:  1.16; xent: 0.15; lr: 0.00100;   0/1175 tok/s;  14540 sec
[2019-11-22 16:30:22,451 INFO] Step 15500/100000; acc:  96.09; ppl:  1.16; xent: 0.15; lr: 0.00100;   0/1142 tok/s;  15056 sec
[2019-11-22 16:38:48,478 INFO] Step 16000/100000; acc:  96.24; ppl:  1.15; xent: 0.14; lr: 0.00100;   0/1152 tok/s;  15562 sec
[2019-11-22 16:47:13,617 INFO] Step 16500/100000; acc:  96.31; ppl:  1.15; xent: 0.14; lr: 0.00100;   0/1156 tok/s;  16067 sec
[2019-11-22 16:55:41,673 INFO] Step 17000/100000; acc:  96.44; ppl:  1.14; xent: 0.13; lr: 0.00100;   0/1159 tok/s;  16575 sec
[2019-11-22 17:04:07,538 INFO] Step 17500/100000; acc:  96.42; ppl:  1.14; xent: 0.13; lr: 0.00100;   0/1152 tok/s;  17081 sec
[2019-11-22 17:12:38,627 INFO] Step 18000/100000; acc:  96.44; ppl:  1.14; xent: 0.13; lr: 0.00100;   0/1150 tok/s;  17592 sec
[2019-11-22 17:20:56,432 INFO] Step 18500/100000; acc:  96.47; ppl:  1.14; xent: 0.13; lr: 0.00100;   0/1179 tok/s;  18090 sec
[2019-11-22 17:28:56,221 INFO] Step 19000/100000; acc:  96.54; ppl:  1.14; xent: 0.13; lr: 0.00100;   0/1213 tok/s;  18570 sec
[2019-11-22 17:36:23,164 INFO] Step 19500/100000; acc:  96.53; ppl:  1.14; xent: 0.13; lr: 0.00100;   0/1321 tok/s;  19017 sec
[2019-11-22 17:43:43,141 INFO] Step 20000/100000; acc:  96.67; ppl:  1.13; xent: 0.12; lr: 0.00100;   0/1323 tok/s;  19457 sec
[2019-11-22 17:47:35,160 INFO] Validation perplexity: 1.14045
[2019-11-22 17:47:35,161 INFO] Validation accuracy: 96.6755
[2019-11-22 17:47:35,168 INFO] Saving checkpoint ../results/models/im2latex-52_step_20000.pt
[2019-11-22 17:55:00,062 INFO] Step 20500/100000; acc:  96.70; ppl:  1.13; xent: 0.12; lr: 0.00100;   0/868 tok/s;  20134 sec
[2019-11-22 18:02:25,195 INFO] Step 21000/100000; acc:  96.77; ppl:  1.13; xent: 0.12; lr: 0.00100;   0/1325 tok/s;  20579 sec
[2019-11-22 18:09:56,034 INFO] Step 21500/100000; acc:  96.74; ppl:  1.13; xent: 0.12; lr: 0.00100;   0/1293 tok/s;  21030 sec
[2019-11-22 18:17:14,640 INFO] Step 22000/100000; acc:  96.77; ppl:  1.13; xent: 0.12; lr: 0.00100;   0/1333 tok/s;  21468 sec
[2019-11-22 18:23:15,154 INFO] Step 22500/100000; acc:  96.79; ppl:  1.13; xent: 0.12; lr: 0.00100;   0/1626 tok/s;  21829 sec
[2019-11-22 18:30:42,865 INFO] Step 23000/100000; acc:  96.87; ppl:  1.12; xent: 0.11; lr: 0.00100;   0/1312 tok/s;  22277 sec
[2019-11-22 18:34:54,097 INFO] Step 23500/100000; acc:  96.90; ppl:  1.12; xent: 0.11; lr: 0.00100;   0/2328 tok/s;  22528 sec
[2019-11-22 18:38:45,444 INFO] Step 24000/100000; acc:  96.96; ppl:  1.12; xent: 0.11; lr: 0.00100;   0/2524 tok/s;  22759 sec
[2019-11-22 18:42:40,745 INFO] Step 24500/100000; acc:  97.03; ppl:  1.11; xent: 0.11; lr: 0.00100;   0/2493 tok/s;  22994 sec
[2019-11-22 18:46:24,388 INFO] Step 25000/100000; acc:  97.05; ppl:  1.11; xent: 0.11; lr: 0.00100;   0/2622 tok/s;  23218 sec
[2019-11-22 18:49:32,782 INFO] Step 25500/100000; acc:  97.01; ppl:  1.12; xent: 0.11; lr: 0.00100;   0/3119 tok/s;  23406 sec
[2019-11-22 18:52:33,001 INFO] Step 26000/100000; acc:  97.02; ppl:  1.11; xent: 0.11; lr: 0.00100;   0/3253 tok/s;  23587 sec
[2019-11-22 18:55:32,749 INFO] Step 26500/100000; acc:  97.08; ppl:  1.11; xent: 0.10; lr: 0.00100;   0/3239 tok/s;  23766 sec
[2019-11-22 18:58:36,081 INFO] Step 27000/100000; acc:  96.99; ppl:  1.12; xent: 0.11; lr: 0.00100;   0/3219 tok/s;  23950 sec
[2019-11-22 19:01:35,343 INFO] Step 27500/100000; acc:  97.18; ppl:  1.11; xent: 0.10; lr: 0.00100;   0/3249 tok/s;  24129 sec
[2019-11-22 19:04:35,596 INFO] Step 28000/100000; acc:  97.14; ppl:  1.11; xent: 0.10; lr: 0.00100;   0/3250 tok/s;  24309 sec
[2019-11-22 19:07:35,964 INFO] Step 28500/100000; acc:  97.27; ppl:  1.10; xent: 0.10; lr: 0.00100;   0/3263 tok/s;  24490 sec
[2019-11-22 19:10:35,072 INFO] Step 29000/100000; acc:  97.20; ppl:  1.11; xent: 0.10; lr: 0.00100;   0/3255 tok/s;  24669 sec
[2019-11-22 19:13:38,900 INFO] Step 29500/100000; acc:  97.22; ppl:  1.10; xent: 0.10; lr: 0.00100;   0/3199 tok/s;  24853 sec
[2019-11-22 19:16:38,860 INFO] Step 30000/100000; acc:  97.18; ppl:  1.11; xent: 0.10; lr: 0.00100;   0/3256 tok/s;  25032 sec
[2019-11-22 19:18:02,366 INFO] Validation perplexity: 1.13538
[2019-11-22 19:18:02,367 INFO] Validation accuracy: 96.7951
[2019-11-22 19:18:02,369 INFO] Saving checkpoint ../results/models/im2latex-52_step_30000.pt
[2019-11-22 19:21:03,490 INFO] Step 30500/100000; acc:  97.24; ppl:  1.10; xent: 0.10; lr: 0.00100;   0/2203 tok/s;  25297 sec
[2019-11-22 19:24:06,587 INFO] Step 31000/100000; acc:  97.24; ppl:  1.10; xent: 0.10; lr: 0.00100;   0/3220 tok/s;  25480 sec
[2019-11-22 19:27:04,374 INFO] Step 31500/100000; acc:  97.35; ppl:  1.10; xent: 0.09; lr: 0.00100;   0/3269 tok/s;  25658 sec
[2019-11-22 19:30:05,237 INFO] Step 32000/100000; acc:  97.34; ppl:  1.10; xent: 0.10; lr: 0.00100;   0/3252 tok/s;  25839 sec
[2019-11-22 19:33:06,987 INFO] Step 32500/100000; acc:  97.33; ppl:  1.10; xent: 0.10; lr: 0.00100;   0/3240 tok/s;  26021 sec
[2019-11-22 19:36:06,261 INFO] Step 33000/100000; acc:  97.38; ppl:  1.10; xent: 0.09; lr: 0.00100;   0/3259 tok/s;  26200 sec
[2019-11-22 19:39:05,875 INFO] Step 33500/100000; acc:  97.37; ppl:  1.10; xent: 0.09; lr: 0.00100;   0/3256 tok/s;  26380 sec
[2019-11-22 19:42:06,827 INFO] Step 34000/100000; acc:  97.39; ppl:  1.10; xent: 0.09; lr: 0.00100;   0/3234 tok/s;  26560 sec
[2019-11-22 19:45:08,325 INFO] Step 34500/100000; acc:  97.44; ppl:  1.10; xent: 0.09; lr: 0.00100;   0/3236 tok/s;  26742 sec
[2019-11-22 19:48:09,344 INFO] Step 35000/100000; acc:  97.41; ppl:  1.09; xent: 0.09; lr: 0.00100;   0/3230 tok/s;  26923 sec
[2019-11-22 19:51:07,400 INFO] Step 35500/100000; acc:  97.49; ppl:  1.09; xent: 0.09; lr: 0.00100;   0/3290 tok/s;  27101 sec
[2019-11-22 19:54:06,952 INFO] Step 36000/100000; acc:  97.51; ppl:  1.09; xent: 0.09; lr: 0.00100;   0/3268 tok/s;  27281 sec
[2019-11-22 19:57:06,321 INFO] Step 36500/100000; acc:  97.51; ppl:  1.09; xent: 0.09; lr: 0.00100;   0/3265 tok/s;  27460 sec
[2019-11-22 20:00:06,979 INFO] Step 37000/100000; acc:  97.51; ppl:  1.09; xent: 0.09; lr: 0.00100;   0/3249 tok/s;  27641 sec
[2019-11-22 20:03:04,959 INFO] Step 37500/100000; acc:  97.50; ppl:  1.09; xent: 0.09; lr: 0.00100;   0/3289 tok/s;  27819 sec
[2019-11-22 20:06:02,948 INFO] Step 38000/100000; acc:  97.53; ppl:  1.09; xent: 0.09; lr: 0.00100;   0/3278 tok/s;  27997 sec
[2019-11-22 20:09:07,054 INFO] Step 38500/100000; acc:  97.45; ppl:  1.09; xent: 0.09; lr: 0.00100;   0/3209 tok/s;  28181 sec
[2019-11-22 20:12:05,432 INFO] Step 39000/100000; acc:  97.62; ppl:  1.09; xent: 0.08; lr: 0.00100;   0/3265 tok/s;  28359 sec
[2019-11-22 20:15:05,359 INFO] Step 39500/100000; acc:  97.58; ppl:  1.09; xent: 0.08; lr: 0.00100;   0/3250 tok/s;  28539 sec
[2019-11-22 20:18:04,116 INFO] Step 40000/100000; acc:  97.66; ppl:  1.09; xent: 0.08; lr: 0.00100;   0/3298 tok/s;  28718 sec
[2019-11-22 20:19:28,583 INFO] Validation perplexity: 1.11944
[2019-11-22 20:19:28,584 INFO] Validation accuracy: 97.1568
[2019-11-22 20:19:28,587 INFO] Saving checkpoint ../results/models/im2latex-52_step_40000.pt
[2019-11-22 20:22:30,270 INFO] Step 40500/100000; acc:  97.62; ppl:  1.09; xent: 0.08; lr: 0.00100;   0/2190 tok/s;  28984 sec
[2019-11-22 20:25:32,317 INFO] Step 41000/100000; acc:  97.61; ppl:  1.09; xent: 0.08; lr: 0.00100;   0/3225 tok/s;  29166 sec
[2019-11-22 20:28:31,116 INFO] Step 41500/100000; acc:  97.61; ppl:  1.09; xent: 0.08; lr: 0.00100;   0/3274 tok/s;  29345 sec
[2019-11-22 20:31:32,324 INFO] Step 42000/100000; acc:  97.65; ppl:  1.08; xent: 0.08; lr: 0.00100;   0/3219 tok/s;  29526 sec
[2019-11-22 20:34:43,556 INFO] Step 42500/100000; acc:  97.64; ppl:  1.09; xent: 0.08; lr: 0.00100;   0/3080 tok/s;  29717 sec
[2019-11-22 20:38:06,829 INFO] Step 43000/100000; acc:  97.69; ppl:  1.08; xent: 0.08; lr: 0.00100;   0/2862 tok/s;  29920 sec
[2019-11-22 20:41:33,906 INFO] Step 43500/100000; acc:  97.73; ppl:  1.08; xent: 0.08; lr: 0.00100;   0/2833 tok/s;  30128 sec
[2019-11-22 20:44:59,894 INFO] Step 44000/100000; acc:  97.72; ppl:  1.08; xent: 0.08; lr: 0.00100;   0/2858 tok/s;  30334 sec
[2019-11-22 20:48:27,219 INFO] Step 44500/100000; acc:  97.71; ppl:  1.08; xent: 0.08; lr: 0.00100;   0/2822 tok/s;  30541 sec
[2019-11-22 20:51:55,613 INFO] Step 45000/100000; acc:  97.67; ppl:  1.08; xent: 0.08; lr: 0.00100;   0/2818 tok/s;  30749 sec
[2019-11-22 20:55:21,088 INFO] Step 45500/100000; acc:  97.74; ppl:  1.08; xent: 0.08; lr: 0.00100;   0/2840 tok/s;  30955 sec
[2019-11-22 20:58:50,233 INFO] Step 46000/100000; acc:  97.73; ppl:  1.08; xent: 0.08; lr: 0.00100;   0/2813 tok/s;  31164 sec
[2019-11-22 21:02:16,388 INFO] Step 46500/100000; acc:  97.76; ppl:  1.08; xent: 0.08; lr: 0.00100;   0/2832 tok/s;  31370 sec
[2019-11-22 21:05:40,375 INFO] Step 47000/100000; acc:  97.82; ppl:  1.08; xent: 0.08; lr: 0.00100;   0/2870 tok/s;  31574 sec
[2019-11-22 21:09:09,564 INFO] Step 47500/100000; acc:  97.83; ppl:  1.08; xent: 0.07; lr: 0.00100;   0/2810 tok/s;  31783 sec
[2019-11-22 21:12:34,036 INFO] Step 48000/100000; acc:  97.80; ppl:  1.08; xent: 0.08; lr: 0.00100;   0/2858 tok/s;  31988 sec
[2019-11-22 21:16:01,802 INFO] Step 48500/100000; acc:  97.82; ppl:  1.08; xent: 0.07; lr: 0.00100;   0/2824 tok/s;  32195 sec
[2019-11-22 21:19:28,241 INFO] Step 49000/100000; acc:  97.76; ppl:  1.08; xent: 0.08; lr: 0.00100;   0/2840 tok/s;  32402 sec
[2019-11-22 21:22:53,280 INFO] Step 49500/100000; acc:  97.81; ppl:  1.08; xent: 0.08; lr: 0.00100;   0/2843 tok/s;  32607 sec
[2019-11-22 21:26:23,581 INFO] Step 50000/100000; acc:  97.79; ppl:  1.08; xent: 0.07; lr: 0.00050;   0/2805 tok/s;  32817 sec
[2019-11-22 21:28:04,197 INFO] Validation perplexity: 1.10971
[2019-11-22 21:28:04,198 INFO] Validation accuracy: 97.4827
[2019-11-22 21:28:04,200 INFO] Saving checkpoint ../results/models/im2latex-52_step_50000.pt
[2019-11-22 21:31:31,427 INFO] Step 50500/100000; acc:  98.07; ppl:  1.07; xent: 0.06; lr: 0.00050;   0/1892 tok/s;  33125 sec
[2019-11-22 21:34:58,251 INFO] Step 51000/100000; acc:  98.17; ppl:  1.06; xent: 0.06; lr: 0.00050;   0/2836 tok/s;  33332 sec
[2019-11-22 21:38:25,562 INFO] Step 51500/100000; acc:  98.22; ppl:  1.06; xent: 0.06; lr: 0.00050;   0/2849 tok/s;  33539 sec
[2019-11-22 21:41:52,129 INFO] Step 52000/100000; acc:  98.30; ppl:  1.06; xent: 0.06; lr: 0.00050;   0/2818 tok/s;  33746 sec
[2019-11-22 21:45:20,157 INFO] Step 52500/100000; acc:  98.30; ppl:  1.06; xent: 0.06; lr: 0.00050;   0/2815 tok/s;  33954 sec
[2019-11-22 21:48:47,409 INFO] Step 53000/100000; acc:  98.28; ppl:  1.06; xent: 0.06; lr: 0.00050;   0/2830 tok/s;  34161 sec
[2019-11-22 21:52:13,615 INFO] Step 53500/100000; acc:  98.36; ppl:  1.06; xent: 0.05; lr: 0.00050;   0/2834 tok/s;  34367 sec
[2019-11-22 21:55:41,432 INFO] Step 54000/100000; acc:  98.36; ppl:  1.05; xent: 0.05; lr: 0.00050;   0/2825 tok/s;  34575 sec
[2019-11-22 21:59:04,665 INFO] Step 54500/100000; acc:  98.35; ppl:  1.06; xent: 0.05; lr: 0.00050;   0/2870 tok/s;  34778 sec
[2019-11-22 22:02:31,959 INFO] Step 55000/100000; acc:  98.37; ppl:  1.05; xent: 0.05; lr: 0.00050;   0/2826 tok/s;  34986 sec
[2019-11-22 22:05:58,748 INFO] Step 55500/100000; acc:  98.42; ppl:  1.05; xent: 0.05; lr: 0.00050;   0/2845 tok/s;  35192 sec
[2019-11-22 22:09:26,042 INFO] Step 56000/100000; acc:  98.43; ppl:  1.05; xent: 0.05; lr: 0.00050;   0/2827 tok/s;  35400 sec
[2019-11-22 22:12:53,734 INFO] Step 56500/100000; acc:  98.43; ppl:  1.05; xent: 0.05; lr: 0.00050;   0/2828 tok/s;  35607 sec
[2019-11-22 22:16:17,972 INFO] Step 57000/100000; acc:  98.41; ppl:  1.05; xent: 0.05; lr: 0.00050;   0/2852 tok/s;  35812 sec
[2019-11-22 22:19:46,133 INFO] Step 57500/100000; acc:  98.46; ppl:  1.05; xent: 0.05; lr: 0.00050;   0/2834 tok/s;  36020 sec
[2019-11-22 22:23:12,154 INFO] Step 58000/100000; acc:  98.44; ppl:  1.05; xent: 0.05; lr: 0.00050;   0/2829 tok/s;  36226 sec
[2019-11-22 22:26:36,047 INFO] Step 58500/100000; acc:  98.44; ppl:  1.05; xent: 0.05; lr: 0.00050;   0/2863 tok/s;  36430 sec
[2019-11-22 22:30:03,628 INFO] Step 59000/100000; acc:  98.50; ppl:  1.05; xent: 0.05; lr: 0.00050;   0/2835 tok/s;  36637 sec
[2019-11-22 22:33:29,262 INFO] Step 59500/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.00050;   0/2835 tok/s;  36843 sec
[2019-11-22 22:36:59,625 INFO] Step 60000/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.00025;   0/2796 tok/s;  37053 sec
[2019-11-22 22:38:42,528 INFO] Validation perplexity: 1.10406
[2019-11-22 22:38:42,529 INFO] Validation accuracy: 97.7034
[2019-11-22 22:38:42,533 INFO] Saving checkpoint ../results/models/im2latex-52_step_60000.pt
[2019-11-22 22:42:11,620 INFO] Step 60500/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.00025;   0/1880 tok/s;  37365 sec
[2019-11-22 22:45:37,548 INFO] Step 61000/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.00025;   0/2830 tok/s;  37571 sec
[2019-11-22 22:49:06,889 INFO] Step 61500/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.00025;   0/2819 tok/s;  37781 sec
[2019-11-22 22:52:31,628 INFO] Step 62000/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.00025;   0/2838 tok/s;  37985 sec
[2019-11-22 22:55:56,134 INFO] Step 62500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.00025;   0/2873 tok/s;  38190 sec
[2019-11-22 22:59:24,292 INFO] Step 63000/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.00025;   0/2834 tok/s;  38398 sec
[2019-11-22 23:02:49,321 INFO] Step 63500/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.00025;   0/2844 tok/s;  38603 sec
[2019-11-22 23:07:00,449 INFO] Step 64000/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.00025;   0/2330 tok/s;  38854 sec
[2019-11-22 23:11:11,458 INFO] Step 64500/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.00025;   0/2337 tok/s;  39105 sec
[2019-11-22 23:15:23,149 INFO] Step 65000/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.00025;   0/2330 tok/s;  39357 sec
[2019-11-22 23:20:10,647 INFO] Step 65500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00025;   0/2035 tok/s;  39644 sec
[2019-11-22 23:24:54,501 INFO] Step 66000/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.00025;   0/2059 tok/s;  39928 sec
[2019-11-22 23:29:35,545 INFO] Step 66500/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.00025;   0/2085 tok/s;  40209 sec
[2019-11-22 23:35:04,105 INFO] Step 67000/100000; acc:  98.86; ppl:  1.04; xent: 0.03; lr: 0.00025;   0/1785 tok/s;  40538 sec
[2019-11-22 23:40:58,649 INFO] Step 67500/100000; acc:  98.87; ppl:  1.03; xent: 0.03; lr: 0.00025;   0/1656 tok/s;  40892 sec
[2019-11-22 23:46:53,664 INFO] Step 68000/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.00025;   0/1650 tok/s;  41247 sec
[2019-11-22 23:53:27,820 INFO] Step 68500/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.00025;   0/1477 tok/s;  41641 sec
[2019-11-23 00:00:42,127 INFO] Step 69000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.00025;   0/1360 tok/s;  42076 sec
[2019-11-23 00:07:49,115 INFO] Step 69500/100000; acc:  98.86; ppl:  1.03; xent: 0.03; lr: 0.00025;   0/1366 tok/s;  42503 sec
[2019-11-23 00:14:54,462 INFO] Step 70000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.00013;   0/1377 tok/s;  42928 sec
[2019-11-23 00:18:49,619 INFO] Validation perplexity: 1.10053
[2019-11-23 00:18:49,625 INFO] Validation accuracy: 97.8558
[2019-11-23 00:18:49,630 INFO] Saving checkpoint ../results/models/im2latex-52_step_70000.pt
[2019-11-23 00:27:11,487 INFO] Step 70500/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00013;   0/799 tok/s;  43665 sec
[2019-11-23 00:34:41,214 INFO] Step 71000/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00013;   0/1297 tok/s;  44115 sec
[2019-11-23 00:41:53,018 INFO] Step 71500/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00013;   0/1360 tok/s;  44547 sec
[2019-11-23 00:48:59,774 INFO] Step 72000/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00013;   0/1373 tok/s;  44973 sec
[2019-11-23 00:57:17,871 INFO] Step 72500/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00013;   0/1170 tok/s;  45472 sec
[2019-11-23 01:07:49,612 INFO] Step 73000/100000; acc:  98.98; ppl:  1.03; xent: 0.03; lr: 0.00013;   0/932 tok/s;  46103 sec
[2019-11-23 01:17:44,302 INFO] Step 73500/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00013;   0/977 tok/s;  46698 sec
[2019-11-23 01:25:13,777 INFO] Step 74000/100000; acc:  98.98; ppl:  1.03; xent: 0.03; lr: 0.00013;   0/1311 tok/s;  47147 sec
[2019-11-23 01:32:06,019 INFO] Step 74500/100000; acc:  98.98; ppl:  1.03; xent: 0.03; lr: 0.00013;   0/1429 tok/s;  47560 sec
[2019-11-23 01:38:54,324 INFO] Step 75000/100000; acc:  99.04; ppl:  1.03; xent: 0.03; lr: 0.00013;   0/1430 tok/s;  47968 sec
[2019-11-23 01:45:45,952 INFO] Step 75500/100000; acc:  99.00; ppl:  1.03; xent: 0.03; lr: 0.00013;   0/1424 tok/s;  48380 sec
[2019-11-23 01:52:30,356 INFO] Step 76000/100000; acc:  99.00; ppl:  1.03; xent: 0.03; lr: 0.00013;   0/1445 tok/s;  48784 sec
[2019-11-23 01:59:23,979 INFO] Step 76500/100000; acc:  99.03; ppl:  1.03; xent: 0.03; lr: 0.00013;   0/1421 tok/s;  49198 sec
[2019-11-23 02:06:02,813 INFO] Step 77000/100000; acc:  99.03; ppl:  1.03; xent: 0.03; lr: 0.00013;   0/1467 tok/s;  49596 sec
[2019-11-23 02:12:38,250 INFO] Step 77500/100000; acc:  99.01; ppl:  1.03; xent: 0.03; lr: 0.00013;   0/1481 tok/s;  49992 sec
[2019-11-23 02:18:14,494 INFO] Step 78000/100000; acc:  99.03; ppl:  1.03; xent: 0.03; lr: 0.00013;   0/1744 tok/s;  50328 sec
[2019-11-23 02:24:08,679 INFO] Step 78500/100000; acc:  99.05; ppl:  1.03; xent: 0.03; lr: 0.00013;   0/1652 tok/s;  50682 sec
[2019-11-23 02:30:39,067 INFO] Step 79000/100000; acc:  99.06; ppl:  1.03; xent: 0.03; lr: 0.00013;   0/1503 tok/s;  51073 sec
[2019-11-23 02:36:45,569 INFO] Step 79500/100000; acc:  99.03; ppl:  1.03; xent: 0.03; lr: 0.00013;   0/1600 tok/s;  51439 sec
[2019-11-23 02:43:00,060 INFO] Step 80000/100000; acc:  99.06; ppl:  1.03; xent: 0.03; lr: 0.00006;   0/1555 tok/s;  51814 sec
[2019-11-23 02:46:29,960 INFO] Validation perplexity: 1.10421
[2019-11-23 02:46:29,961 INFO] Validation accuracy: 97.8781
[2019-11-23 02:46:29,967 INFO] Saving checkpoint ../results/models/im2latex-52_step_80000.pt
[2019-11-23 02:53:22,143 INFO] Step 80500/100000; acc:  99.05; ppl:  1.03; xent: 0.03; lr: 0.00006;   0/950 tok/s;  52436 sec
[2019-11-23 03:00:00,460 INFO] Step 81000/100000; acc:  99.08; ppl:  1.03; xent: 0.03; lr: 0.00006;   0/1463 tok/s;  52834 sec
[2019-11-23 03:06:35,411 INFO] Step 81500/100000; acc:  99.09; ppl:  1.03; xent: 0.03; lr: 0.00006;   0/1479 tok/s;  53229 sec
[2019-11-23 03:13:07,161 INFO] Step 82000/100000; acc:  99.10; ppl:  1.03; xent: 0.03; lr: 0.00006;   0/1508 tok/s;  53621 sec
[2019-11-23 03:19:43,613 INFO] Step 82500/100000; acc:  99.13; ppl:  1.03; xent: 0.03; lr: 0.00006;   0/1471 tok/s;  54017 sec
[2019-11-23 03:26:19,468 INFO] Step 83000/100000; acc:  99.12; ppl:  1.03; xent: 0.03; lr: 0.00006;   0/1479 tok/s;  54413 sec
[2019-11-23 03:34:53,760 INFO] Step 83500/100000; acc:  99.09; ppl:  1.03; xent: 0.03; lr: 0.00006;   0/1139 tok/s;  54927 sec
[2019-11-23 03:45:50,242 INFO] Step 84000/100000; acc:  99.12; ppl:  1.03; xent: 0.03; lr: 0.00006;   0/890 tok/s;  55584 sec
[2019-11-23 03:57:12,864 INFO] Step 84500/100000; acc:  99.11; ppl:  1.03; xent: 0.03; lr: 0.00006;   0/862 tok/s;  56267 sec
[2019-11-23 04:08:15,237 INFO] Step 85000/100000; acc:  99.11; ppl:  1.03; xent: 0.03; lr: 0.00006;   0/878 tok/s;  56929 sec
[2019-11-23 04:19:29,949 INFO] Step 85500/100000; acc:  99.13; ppl:  1.03; xent: 0.03; lr: 0.00006;   0/873 tok/s;  57604 sec
[2019-11-23 04:30:33,363 INFO] Step 86000/100000; acc:  99.13; ppl:  1.03; xent: 0.03; lr: 0.00006;   0/888 tok/s;  58267 sec
[2019-11-23 04:41:51,667 INFO] Step 86500/100000; acc:  99.15; ppl:  1.03; xent: 0.02; lr: 0.00006;   0/862 tok/s;  58945 sec
[2019-11-23 04:53:00,400 INFO] Step 87000/100000; acc:  99.13; ppl:  1.03; xent: 0.03; lr: 0.00006;   0/878 tok/s;  59614 sec
[2019-11-23 05:04:03,815 INFO] Step 87500/100000; acc:  99.15; ppl:  1.03; xent: 0.03; lr: 0.00006;   0/881 tok/s;  60277 sec
[2019-11-23 05:15:01,459 INFO] Step 88000/100000; acc:  99.14; ppl:  1.03; xent: 0.03; lr: 0.00006;   0/894 tok/s;  60935 sec
[2019-11-23 05:25:11,524 INFO] Step 88500/100000; acc:  99.15; ppl:  1.02; xent: 0.02; lr: 0.00006;   0/957 tok/s;  61545 sec
[2019-11-23 05:35:10,715 INFO] Step 89000/100000; acc:  99.14; ppl:  1.03; xent: 0.03; lr: 0.00006;   0/976 tok/s;  62144 sec
[2019-11-23 05:44:40,028 INFO] Step 89500/100000; acc:  99.16; ppl:  1.03; xent: 0.02; lr: 0.00006;   0/1031 tok/s;  62714 sec
[2019-11-23 05:53:47,132 INFO] Step 90000/100000; acc:  99.19; ppl:  1.02; xent: 0.02; lr: 0.00003;   0/1068 tok/s;  63261 sec
[2019-11-23 05:58:31,776 INFO] Validation perplexity: 1.10643
[2019-11-23 05:58:31,777 INFO] Validation accuracy: 97.9009
[2019-11-23 05:58:31,783 INFO] Saving checkpoint ../results/models/im2latex-52_step_90000.pt
[2019-11-23 06:07:35,726 INFO] Step 90500/100000; acc:  99.18; ppl:  1.02; xent: 0.02; lr: 0.00003;   0/708 tok/s;  64089 sec
[2019-11-23 06:16:19,166 INFO] Step 91000/100000; acc:  99.15; ppl:  1.03; xent: 0.03; lr: 0.00003;   0/1121 tok/s;  64613 sec
[2019-11-23 06:24:55,534 INFO] Step 91500/100000; acc:  99.18; ppl:  1.02; xent: 0.02; lr: 0.00003;   0/1127 tok/s;  65129 sec
[2019-11-23 06:31:53,224 INFO] Step 92000/100000; acc:  99.18; ppl:  1.02; xent: 0.02; lr: 0.00003;   0/1414 tok/s;  65547 sec
[2019-11-23 06:37:55,511 INFO] Step 92500/100000; acc:  99.18; ppl:  1.02; xent: 0.02; lr: 0.00003;   0/1608 tok/s;  65909 sec
[2019-11-23 06:44:00,463 INFO] Step 93000/100000; acc:  99.21; ppl:  1.02; xent: 0.02; lr: 0.00003;   0/1607 tok/s;  66274 sec
[2019-11-23 06:50:00,357 INFO] Step 93500/100000; acc:  99.18; ppl:  1.02; xent: 0.02; lr: 0.00003;   0/1638 tok/s;  66634 sec
[2019-11-23 06:55:54,864 INFO] Step 94000/100000; acc:  99.23; ppl:  1.02; xent: 0.02; lr: 0.00003;   0/1642 tok/s;  66989 sec
[2019-11-23 07:01:54,500 INFO] Step 94500/100000; acc:  99.19; ppl:  1.02; xent: 0.02; lr: 0.00003;   0/1629 tok/s;  67348 sec
[2019-11-23 07:07:51,962 INFO] Step 95000/100000; acc:  99.17; ppl:  1.02; xent: 0.02; lr: 0.00003;   0/1638 tok/s;  67706 sec
[2019-11-23 07:13:43,647 INFO] Step 95500/100000; acc:  99.19; ppl:  1.02; xent: 0.02; lr: 0.00003;   0/1666 tok/s;  68057 sec
[2019-11-23 07:19:19,548 INFO] Step 96000/100000; acc:  99.19; ppl:  1.02; xent: 0.02; lr: 0.00003;   0/1746 tok/s;  68393 sec
[2019-11-23 07:24:47,673 INFO] Step 96500/100000; acc:  99.18; ppl:  1.02; xent: 0.02; lr: 0.00003;   0/1776 tok/s;  68721 sec
[2019-11-23 07:30:25,967 INFO] Step 97000/100000; acc:  99.19; ppl:  1.02; xent: 0.02; lr: 0.00003;   0/1741 tok/s;  69060 sec
[2019-11-23 07:36:00,787 INFO] Step 97500/100000; acc:  99.22; ppl:  1.02; xent: 0.02; lr: 0.00003;   0/1753 tok/s;  69394 sec
[2019-11-23 07:41:54,108 INFO] Step 98000/100000; acc:  99.24; ppl:  1.02; xent: 0.02; lr: 0.00003;   0/1660 tok/s;  69748 sec
[2019-11-23 07:48:29,518 INFO] Step 98500/100000; acc:  99.19; ppl:  1.02; xent: 0.02; lr: 0.00003;   0/1485 tok/s;  70143 sec
[2019-11-23 07:54:58,928 INFO] Step 99000/100000; acc:  99.21; ppl:  1.02; xent: 0.02; lr: 0.00003;   0/1496 tok/s;  70533 sec
[2019-11-23 08:01:38,947 INFO] Step 99500/100000; acc:  99.20; ppl:  1.02; xent: 0.02; lr: 0.00003;   0/1476 tok/s;  70933 sec
[2019-11-23 08:08:23,260 INFO] Step 100000/100000; acc:  99.21; ppl:  1.02; xent: 0.02; lr: 0.00002;   0/1441 tok/s;  71337 sec
[2019-11-23 08:12:10,441 INFO] Validation perplexity: 1.1083
[2019-11-23 08:12:10,442 INFO] Validation accuracy: 97.8904
[2019-11-23 08:12:10,448 INFO] Saving checkpoint ../results/models/im2latex-52_step_100000.pt
