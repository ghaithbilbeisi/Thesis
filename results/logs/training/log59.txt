[2019-12-11 14:53:38,456 INFO]  * tgt vocab size = 510
[2019-12-11 14:53:38,456 INFO] Building model...
[2019-12-11 14:53:43,364 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds1): Downsample(
      (pad): ReflectionPad2d([3, 3, 3, 3])
    )
    (layer3): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer5): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer6): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer7): Conv2d(128, 128, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layer8): Conv2d(128, 256, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layer9): Conv2d(256, 256, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layer10): Conv2d(256, 256, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (batch_norm1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(256, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 256)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-12-11 14:53:43,367 INFO] encoder: 4054016
[2019-12-11 14:53:43,367 INFO] decoder: 5214310
[2019-12-11 14:53:43,368 INFO] * number of parameters: 9268326
[2019-12-11 14:53:43,997 INFO] Starting training on GPU: [0]
[2019-12-11 14:53:43,997 INFO] Start training loop and validate every 10000 steps...
[2019-12-11 15:04:08,020 INFO] Step 500/100000; acc:  28.05; ppl: 41.43; xent: 3.72; lr: 0.10000;   0/943 tok/s;    624 sec
[2019-12-11 15:14:15,208 INFO] Step 1000/100000; acc:  44.61; ppl: 13.41; xent: 2.60; lr: 0.10000;   0/957 tok/s;   1231 sec
[2019-12-11 15:24:36,876 INFO] Step 1500/100000; acc:  48.45; ppl: 10.44; xent: 2.35; lr: 0.10000;   0/947 tok/s;   1853 sec
[2019-12-11 15:34:57,738 INFO] Step 2000/100000; acc:  53.83; ppl:  7.70; xent: 2.04; lr: 0.10000;   0/944 tok/s;   2474 sec
[2019-12-11 15:45:17,666 INFO] Step 2500/100000; acc:  75.23; ppl:  2.87; xent: 1.05; lr: 0.10000;   0/941 tok/s;   3094 sec
[2019-12-11 15:55:41,133 INFO] Step 3000/100000; acc:  86.35; ppl:  1.79; xent: 0.58; lr: 0.10000;   0/941 tok/s;   3717 sec
[2019-12-11 16:05:57,247 INFO] Step 3500/100000; acc:  89.69; ppl:  1.55; xent: 0.44; lr: 0.10000;   0/950 tok/s;   4333 sec
[2019-12-11 16:16:01,416 INFO] Step 4000/100000; acc:  91.18; ppl:  1.45; xent: 0.37; lr: 0.10000;   0/973 tok/s;   4937 sec
[2019-12-11 16:25:45,377 INFO] Step 4500/100000; acc:  92.31; ppl:  1.38; xent: 0.32; lr: 0.10000;   0/999 tok/s;   5521 sec
[2019-12-11 16:35:20,424 INFO] Step 5000/100000; acc:  93.17; ppl:  1.33; xent: 0.29; lr: 0.10000;   0/1019 tok/s;   6096 sec
[2019-12-11 16:45:06,091 INFO] Step 5500/100000; acc:  93.85; ppl:  1.29; xent: 0.26; lr: 0.10000;   0/1003 tok/s;   6682 sec
[2019-12-11 16:54:45,790 INFO] Step 6000/100000; acc:  94.23; ppl:  1.27; xent: 0.24; lr: 0.10000;   0/1009 tok/s;   7262 sec
[2019-12-11 17:04:38,717 INFO] Step 6500/100000; acc:  94.52; ppl:  1.25; xent: 0.23; lr: 0.10000;   0/989 tok/s;   7855 sec
[2019-12-11 17:15:02,224 INFO] Step 7000/100000; acc:  94.86; ppl:  1.23; xent: 0.21; lr: 0.10000;   0/942 tok/s;   8478 sec
[2019-12-11 17:25:19,469 INFO] Step 7500/100000; acc:  95.18; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/943 tok/s;   9095 sec
[2019-12-11 17:35:48,706 INFO] Step 8000/100000; acc:  95.33; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/938 tok/s;   9725 sec
[2019-12-11 17:46:06,294 INFO] Step 8500/100000; acc:  95.64; ppl:  1.19; xent: 0.18; lr: 0.10000;   0/944 tok/s;  10342 sec
[2019-12-11 17:56:25,563 INFO] Step 9000/100000; acc:  95.82; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/944 tok/s;  10962 sec
[2019-12-11 18:06:55,835 INFO] Step 9500/100000; acc:  95.97; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/941 tok/s;  11592 sec
[2019-12-11 18:16:33,912 INFO] Step 10000/100000; acc:  96.08; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/1007 tok/s;  12170 sec
[2019-12-11 18:22:06,861 INFO] Validation perplexity: 1.14886
[2019-12-11 18:22:06,863 INFO] Validation accuracy: 96.5464
[2019-12-11 18:22:06,868 INFO] Saving checkpoint ../results/models/im2latex-59_step_10000.pt
[2019-12-11 18:31:51,996 INFO] Step 10500/100000; acc:  96.11; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/638 tok/s;  13088 sec
[2019-12-11 18:41:37,525 INFO] Step 11000/100000; acc:  96.26; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/1002 tok/s;  13674 sec
[2019-12-11 18:51:17,595 INFO] Step 11500/100000; acc:  96.38; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/1007 tok/s;  14254 sec
[2019-12-11 19:01:10,951 INFO] Step 12000/100000; acc:  96.39; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/990 tok/s;  14847 sec
[2019-12-11 19:10:36,205 INFO] Step 12500/100000; acc:  96.55; ppl:  1.14; xent: 0.14; lr: 0.10000;   0/1031 tok/s;  15412 sec
[2019-12-11 19:20:19,073 INFO] Step 13000/100000; acc:  96.69; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1004 tok/s;  15995 sec
[2019-12-11 19:30:01,433 INFO] Step 13500/100000; acc:  96.77; ppl:  1.13; xent: 0.13; lr: 0.10000;   0/1011 tok/s;  16577 sec
[2019-12-11 19:39:44,243 INFO] Step 14000/100000; acc:  96.74; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1004 tok/s;  17160 sec
[2019-12-11 19:49:31,700 INFO] Step 14500/100000; acc:  96.75; ppl:  1.13; xent: 0.13; lr: 0.10000;   0/1000 tok/s;  17748 sec
[2019-12-11 19:59:12,133 INFO] Step 15000/100000; acc:  96.82; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1004 tok/s;  18328 sec
[2019-12-11 20:09:03,362 INFO] Step 15500/100000; acc:  96.83; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/998 tok/s;  18919 sec
[2019-12-11 20:18:43,022 INFO] Step 16000/100000; acc:  96.99; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1005 tok/s;  19499 sec
[2019-12-11 20:28:13,947 INFO] Step 16500/100000; acc:  97.05; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1023 tok/s;  20070 sec
[2019-12-11 20:38:03,539 INFO] Step 17000/100000; acc:  97.08; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1000 tok/s;  20660 sec
[2019-12-11 20:47:40,930 INFO] Step 17500/100000; acc:  97.09; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1009 tok/s;  21237 sec
[2019-12-11 20:57:27,789 INFO] Step 18000/100000; acc:  97.13; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1001 tok/s;  21824 sec
[2019-12-11 21:07:11,736 INFO] Step 18500/100000; acc:  97.13; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1006 tok/s;  22408 sec
[2019-12-11 21:16:49,130 INFO] Step 19000/100000; acc:  97.17; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1008 tok/s;  22985 sec
[2019-12-11 21:26:46,484 INFO] Step 19500/100000; acc:  97.15; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/988 tok/s;  23582 sec
[2019-12-11 21:36:21,594 INFO] Step 20000/100000; acc:  97.27; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1012 tok/s;  24158 sec
[2019-12-11 21:41:52,201 INFO] Validation perplexity: 1.10397
[2019-12-11 21:41:52,202 INFO] Validation accuracy: 97.4493
[2019-12-11 21:41:52,205 INFO] Saving checkpoint ../results/models/im2latex-59_step_20000.pt
[2019-12-11 21:51:31,431 INFO] Step 20500/100000; acc:  97.31; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/645 tok/s;  25067 sec
[2019-12-11 22:01:20,231 INFO] Step 21000/100000; acc:  97.34; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1002 tok/s;  25656 sec
[2019-12-11 22:10:54,398 INFO] Step 21500/100000; acc:  97.36; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1015 tok/s;  26230 sec
[2019-12-11 22:20:41,828 INFO] Step 22000/100000; acc:  97.31; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/996 tok/s;  26818 sec
[2019-12-11 22:30:23,801 INFO] Step 22500/100000; acc:  97.34; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1007 tok/s;  27400 sec
[2019-12-11 22:40:09,021 INFO] Step 23000/100000; acc:  97.39; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1003 tok/s;  27985 sec
[2019-12-11 22:49:59,502 INFO] Step 23500/100000; acc:  97.42; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/991 tok/s;  28576 sec
[2019-12-11 22:59:22,439 INFO] Step 24000/100000; acc:  97.49; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1037 tok/s;  29138 sec
[2019-12-11 23:09:06,410 INFO] Step 24500/100000; acc:  97.50; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1005 tok/s;  29722 sec
[2019-12-11 23:18:47,643 INFO] Step 25000/100000; acc:  97.57; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1008 tok/s;  30304 sec
[2019-12-11 23:28:34,310 INFO] Step 25500/100000; acc:  97.56; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1002 tok/s;  30890 sec
[2019-12-11 23:38:18,469 INFO] Step 26000/100000; acc:  97.49; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1004 tok/s;  31474 sec
[2019-12-11 23:47:55,897 INFO] Step 26500/100000; acc:  97.61; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1009 tok/s;  32052 sec
[2019-12-11 23:57:46,700 INFO] Step 27000/100000; acc:  97.56; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/999 tok/s;  32643 sec
[2019-12-12 00:07:24,165 INFO] Step 27500/100000; acc:  97.65; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1008 tok/s;  33220 sec
[2019-12-12 00:17:01,832 INFO] Step 28000/100000; acc:  97.64; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1014 tok/s;  33798 sec
[2019-12-12 00:26:47,657 INFO] Step 28500/100000; acc:  97.73; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1004 tok/s;  34384 sec
[2019-12-12 00:36:25,707 INFO] Step 29000/100000; acc:  97.67; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1008 tok/s;  34962 sec
[2019-12-12 00:46:12,052 INFO] Step 29500/100000; acc:  97.72; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1002 tok/s;  35548 sec
[2019-12-12 00:55:54,730 INFO] Step 30000/100000; acc:  97.70; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1006 tok/s;  36131 sec
[2019-12-12 01:01:26,169 INFO] Validation perplexity: 1.09351
[2019-12-12 01:01:26,170 INFO] Validation accuracy: 97.7555
[2019-12-12 01:01:26,173 INFO] Saving checkpoint ../results/models/im2latex-59_step_30000.pt
[2019-12-12 01:11:05,687 INFO] Step 30500/100000; acc:  97.74; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/640 tok/s;  37042 sec
[2019-12-12 01:21:01,053 INFO] Step 31000/100000; acc:  97.71; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/990 tok/s;  37637 sec
[2019-12-12 01:30:31,674 INFO] Step 31500/100000; acc:  97.77; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1018 tok/s;  38208 sec
[2019-12-12 01:40:13,624 INFO] Step 32000/100000; acc:  97.84; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1011 tok/s;  38790 sec
[2019-12-12 01:50:01,040 INFO] Step 32500/100000; acc:  97.85; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1002 tok/s;  39377 sec
[2019-12-12 01:59:36,210 INFO] Step 33000/100000; acc:  97.82; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1016 tok/s;  39952 sec
[2019-12-12 02:09:21,085 INFO] Step 33500/100000; acc:  97.78; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1000 tok/s;  40537 sec
[2019-12-12 02:19:02,655 INFO] Step 34000/100000; acc:  97.83; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1006 tok/s;  41119 sec
[2019-12-12 02:28:50,473 INFO] Step 34500/100000; acc:  97.86; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/999 tok/s;  41706 sec
[2019-12-12 02:38:37,013 INFO] Step 35000/100000; acc:  97.85; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/997 tok/s;  42293 sec
[2019-12-12 02:48:10,143 INFO] Step 35500/100000; acc:  97.88; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1021 tok/s;  42866 sec
[2019-12-12 02:57:52,794 INFO] Step 36000/100000; acc:  97.92; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1006 tok/s;  43449 sec
[2019-12-12 03:07:30,060 INFO] Step 36500/100000; acc:  97.92; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1015 tok/s;  44026 sec
[2019-12-12 03:17:16,582 INFO] Step 37000/100000; acc:  97.92; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1000 tok/s;  44613 sec
[2019-12-12 03:26:57,656 INFO] Step 37500/100000; acc:  97.93; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1008 tok/s;  45194 sec
[2019-12-12 03:36:38,046 INFO] Step 38000/100000; acc:  97.95; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1004 tok/s;  45774 sec
[2019-12-12 03:46:28,826 INFO] Step 38500/100000; acc:  97.89; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1001 tok/s;  46365 sec
[2019-12-12 03:56:06,705 INFO] Step 39000/100000; acc:  97.98; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1008 tok/s;  46943 sec
[2019-12-12 04:05:41,651 INFO] Step 39500/100000; acc:  97.95; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1017 tok/s;  47518 sec
[2019-12-12 04:15:31,724 INFO] Step 40000/100000; acc:  98.00; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1000 tok/s;  48108 sec
[2019-12-12 04:21:02,970 INFO] Validation perplexity: 1.08384
[2019-12-12 04:21:02,971 INFO] Validation accuracy: 97.9266
[2019-12-12 04:21:02,975 INFO] Saving checkpoint ../results/models/im2latex-59_step_40000.pt
[2019-12-12 04:30:42,270 INFO] Step 40500/100000; acc:  98.03; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/640 tok/s;  49018 sec
[2019-12-12 04:40:27,095 INFO] Step 41000/100000; acc:  98.00; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1003 tok/s;  49603 sec
[2019-12-12 04:50:09,095 INFO] Step 41500/100000; acc:  98.00; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1006 tok/s;  50185 sec
[2019-12-12 04:59:44,945 INFO] Step 42000/100000; acc:  98.01; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1014 tok/s;  50761 sec
[2019-12-12 05:09:41,243 INFO] Step 42500/100000; acc:  98.03; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/987 tok/s;  51357 sec
[2019-12-12 05:19:08,031 INFO] Step 43000/100000; acc:  98.04; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1026 tok/s;  51924 sec
[2019-12-12 05:28:54,145 INFO] Step 43500/100000; acc:  98.09; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1006 tok/s;  52510 sec
[2019-12-12 05:38:33,799 INFO] Step 44000/100000; acc:  98.11; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1013 tok/s;  53090 sec
[2019-12-12 05:48:12,213 INFO] Step 44500/100000; acc:  98.08; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1010 tok/s;  53668 sec
[2019-12-12 05:57:59,985 INFO] Step 45000/100000; acc:  98.06; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/999 tok/s;  54256 sec
[2019-12-12 06:07:39,630 INFO] Step 45500/100000; acc:  98.05; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1008 tok/s;  54836 sec
[2019-12-12 06:17:29,859 INFO] Step 46000/100000; acc:  98.10; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/997 tok/s;  55426 sec
[2019-12-12 06:27:09,259 INFO] Step 46500/100000; acc:  98.10; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1007 tok/s;  56005 sec
[2019-12-12 06:36:43,635 INFO] Step 47000/100000; acc:  98.09; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1020 tok/s;  56580 sec
[2019-12-12 06:46:32,487 INFO] Step 47500/100000; acc:  98.18; ppl:  1.06; xent: 0.06; lr: 0.10000;   0/997 tok/s;  57168 sec
[2019-12-12 06:56:11,673 INFO] Step 48000/100000; acc:  98.12; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1010 tok/s;  57748 sec
[2019-12-12 07:05:55,385 INFO] Step 48500/100000; acc:  98.14; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1006 tok/s;  58331 sec
[2019-12-12 07:15:36,474 INFO] Step 49000/100000; acc:  98.10; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1008 tok/s;  58912 sec
[2019-12-12 07:25:16,804 INFO] Step 49500/100000; acc:  98.11; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1005 tok/s;  59493 sec
[2019-12-12 07:35:10,548 INFO] Step 50000/100000; acc:  98.12; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/993 tok/s;  60087 sec
[2019-12-12 07:40:39,877 INFO] Validation perplexity: 1.08423
[2019-12-12 07:40:39,878 INFO] Validation accuracy: 97.9911
[2019-12-12 07:40:39,882 INFO] Saving checkpoint ../results/models/im2latex-59_step_50000.pt
[2019-12-12 07:50:19,500 INFO] Step 50500/100000; acc:  98.30; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/641 tok/s;  60996 sec
[2019-12-12 07:59:56,821 INFO] Step 51000/100000; acc:  98.36; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1015 tok/s;  61573 sec
[2019-12-12 08:09:45,572 INFO] Step 51500/100000; acc:  98.36; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1002 tok/s;  62162 sec
[2019-12-12 08:19:21,092 INFO] Step 52000/100000; acc:  98.43; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1012 tok/s;  62737 sec
[2019-12-12 08:29:07,471 INFO] Step 52500/100000; acc:  98.42; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/998 tok/s;  63323 sec
[2019-12-12 08:38:47,923 INFO] Step 53000/100000; acc:  98.45; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1011 tok/s;  63904 sec
[2019-12-12 08:48:27,237 INFO] Step 53500/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1010 tok/s;  64483 sec
[2019-12-12 08:58:20,250 INFO] Step 54000/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/990 tok/s;  65076 sec
[2019-12-12 09:07:47,455 INFO] Step 54500/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1027 tok/s;  65643 sec
[2019-12-12 09:17:30,384 INFO] Step 55000/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1006 tok/s;  66226 sec
[2019-12-12 09:27:11,490 INFO] Step 55500/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1012 tok/s;  66807 sec
[2019-12-12 09:36:54,634 INFO] Step 56000/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1004 tok/s;  67391 sec
[2019-12-12 09:46:41,445 INFO] Step 56500/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1002 tok/s;  67977 sec
[2019-12-12 09:56:17,623 INFO] Step 57000/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1011 tok/s;  68554 sec
[2019-12-12 10:06:08,701 INFO] Step 57500/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/999 tok/s;  69145 sec
[2019-12-12 10:15:48,138 INFO] Step 58000/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1005 tok/s;  69724 sec
[2019-12-12 10:25:21,248 INFO] Step 58500/100000; acc:  98.53; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1018 tok/s;  70297 sec
[2019-12-12 10:35:13,513 INFO] Step 59000/100000; acc:  98.57; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/997 tok/s;  70890 sec
[2019-12-12 10:44:49,256 INFO] Step 59500/100000; acc:  98.59; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1012 tok/s;  71465 sec
[2019-12-12 10:54:43,356 INFO] Step 60000/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/990 tok/s;  72059 sec
[2019-12-12 11:00:17,198 INFO] Validation perplexity: 1.07556
[2019-12-12 11:00:17,199 INFO] Validation accuracy: 98.15
[2019-12-12 11:00:17,202 INFO] Saving checkpoint ../results/models/im2latex-59_step_60000.pt
[2019-12-12 11:10:03,988 INFO] Step 60500/100000; acc:  98.58; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/637 tok/s;  72980 sec
[2019-12-12 11:19:44,648 INFO] Step 61000/100000; acc:  98.62; ppl:  1.05; xent: 0.04; lr: 0.02500;   0/1004 tok/s;  73561 sec
[2019-12-12 11:29:45,627 INFO] Step 61500/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/981 tok/s;  74162 sec
[2019-12-12 11:39:22,478 INFO] Step 62000/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1008 tok/s;  74738 sec
[2019-12-12 11:49:08,145 INFO] Step 62500/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1003 tok/s;  75324 sec
[2019-12-12 11:58:58,322 INFO] Step 63000/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/997 tok/s;  75914 sec
[2019-12-12 12:08:40,309 INFO] Step 63500/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1003 tok/s;  76496 sec
[2019-12-12 12:18:25,734 INFO] Step 64000/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/999 tok/s;  77082 sec
[2019-12-12 12:28:14,469 INFO] Step 64500/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/995 tok/s;  77670 sec
[2019-12-12 12:38:05,529 INFO] Step 65000/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/993 tok/s;  78262 sec
[2019-12-12 12:47:57,712 INFO] Step 65500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/988 tok/s;  78854 sec
[2019-12-12 12:57:35,141 INFO] Step 66000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1012 tok/s;  79431 sec
[2019-12-12 13:07:22,496 INFO] Step 66500/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/998 tok/s;  80018 sec
[2019-12-12 13:17:10,875 INFO] Step 67000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/997 tok/s;  80607 sec
[2019-12-12 13:27:01,458 INFO] Step 67500/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/994 tok/s;  81197 sec
[2019-12-12 13:36:50,662 INFO] Step 68000/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/994 tok/s;  81787 sec
[2019-12-12 13:46:32,912 INFO] Step 68500/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1001 tok/s;  82369 sec
[2019-12-12 13:56:22,810 INFO] Step 69000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1000 tok/s;  82959 sec
[2019-12-12 14:06:03,568 INFO] Step 69500/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1004 tok/s;  83540 sec
[2019-12-12 14:15:42,184 INFO] Step 70000/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1012 tok/s;  84118 sec
[2019-12-12 14:21:18,742 INFO] Validation perplexity: 1.07325
[2019-12-12 14:21:18,743 INFO] Validation accuracy: 98.2274
[2019-12-12 14:21:18,750 INFO] Saving checkpoint ../results/models/im2latex-59_step_70000.pt
[2019-12-12 14:31:15,125 INFO] Step 70500/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/635 tok/s;  85051 sec
[2019-12-12 14:40:57,562 INFO] Step 71000/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1001 tok/s;  85634 sec
[2019-12-12 14:50:43,014 INFO] Step 71500/100000; acc:  98.80; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1003 tok/s;  86219 sec
[2019-12-12 18:11:53,578 INFO] Step 72000/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1000 tok/s;  98290 sec
[2019-12-12 18:21:35,105 INFO] Step 72500/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1002 tok/s;  98871 sec
[2019-12-12 18:31:32,660 INFO] Step 73000/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/985 tok/s;  99469 sec
[2019-12-12 18:41:07,046 INFO] Step 73500/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1012 tok/s; 100043 sec
[2019-12-12 18:50:58,400 INFO] Step 74000/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/996 tok/s; 100634 sec
[2019-12-12 19:00:46,133 INFO] Step 74500/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/999 tok/s; 101222 sec
[2019-12-12 19:10:33,796 INFO] Step 75000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/994 tok/s; 101810 sec
[2019-12-12 19:21:06,901 INFO] Step 75500/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/925 tok/s; 102443 sec
[2019-12-12 19:31:04,961 INFO] Step 76000/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/979 tok/s; 103041 sec
[2019-12-12 19:41:01,786 INFO] Step 76500/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/983 tok/s; 103638 sec
[2019-12-12 19:50:54,220 INFO] Step 77000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/988 tok/s; 104230 sec
[2019-12-12 20:00:33,413 INFO] Step 77500/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1011 tok/s; 104809 sec
[2019-12-12 20:10:24,256 INFO] Step 78000/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/991 tok/s; 105400 sec
[2019-12-12 20:20:11,453 INFO] Step 78500/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/997 tok/s; 105987 sec
[2019-12-12 20:30:08,882 INFO] Step 79000/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/981 tok/s; 106585 sec
[2019-12-12 20:40:00,240 INFO] Step 79500/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/991 tok/s; 107176 sec
[2019-12-12 20:49:50,115 INFO] Step 80000/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/988 tok/s; 107766 sec
[2019-12-12 20:55:28,947 INFO] Validation perplexity: 1.07408
[2019-12-12 20:55:28,948 INFO] Validation accuracy: 98.2374
[2019-12-12 20:55:28,952 INFO] Saving checkpoint ../results/models/im2latex-59_step_80000.pt
[2019-12-12 21:05:28,588 INFO] Step 80500/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/630 tok/s; 108705 sec
[2019-12-12 21:15:17,115 INFO] Step 81000/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/990 tok/s; 109293 sec
[2019-12-12 21:24:59,453 INFO] Step 81500/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1003 tok/s; 109875 sec
[2019-12-12 21:35:01,031 INFO] Step 82000/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/987 tok/s; 110477 sec
[2019-12-12 21:44:47,639 INFO] Step 82500/100000; acc:  98.87; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/994 tok/s; 111064 sec
[2019-12-12 21:54:41,234 INFO] Step 83000/100000; acc:  98.87; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/986 tok/s; 111657 sec
[2019-12-12 22:04:25,099 INFO] Step 83500/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1003 tok/s; 112241 sec
[2019-12-12 22:14:06,546 INFO] Step 84000/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1004 tok/s; 112823 sec
[2019-12-12 22:24:02,437 INFO] Step 84500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/988 tok/s; 113418 sec
[2019-12-12 22:33:28,563 INFO] Step 85000/100000; acc:  98.87; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1027 tok/s; 113985 sec
[2019-12-12 22:43:10,107 INFO] Step 85500/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1006 tok/s; 114566 sec
[2019-12-12 22:52:56,437 INFO] Step 86000/100000; acc:  98.89; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1004 tok/s; 115152 sec
[2019-12-12 23:02:44,360 INFO] Step 86500/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/995 tok/s; 115740 sec
[2019-12-12 23:12:35,885 INFO] Step 87000/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/992 tok/s; 116332 sec
[2019-12-12 23:22:16,783 INFO] Step 87500/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1005 tok/s; 116913 sec
[2019-12-12 23:32:09,051 INFO] Step 88000/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/994 tok/s; 117505 sec
[2019-12-12 23:41:51,579 INFO] Step 88500/100000; acc:  98.88; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1001 tok/s; 118088 sec
[2019-12-12 23:51:26,472 INFO] Step 89000/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1018 tok/s; 118662 sec
[2019-12-13 00:01:21,733 INFO] Step 89500/100000; acc:  98.88; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/988 tok/s; 119258 sec
[2019-12-13 00:11:06,521 INFO] Step 90000/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1000 tok/s; 119843 sec
[2019-12-13 00:16:41,200 INFO] Validation perplexity: 1.07369
[2019-12-13 00:16:41,201 INFO] Validation accuracy: 98.2587
[2019-12-13 00:16:41,205 INFO] Saving checkpoint ../results/models/im2latex-59_step_90000.pt
[2019-12-13 00:26:40,562 INFO] Step 90500/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/628 tok/s; 120777 sec
[2019-12-13 00:36:29,867 INFO] Step 91000/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/995 tok/s; 121366 sec
[2019-12-13 00:46:16,395 INFO] Step 91500/100000; acc:  98.86; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/993 tok/s; 121952 sec
[2019-12-13 00:56:19,375 INFO] Step 92000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/978 tok/s; 122555 sec
[2019-12-13 01:06:07,059 INFO] Step 92500/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/992 tok/s; 123143 sec
[2019-12-13 01:15:57,209 INFO] Step 93000/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/994 tok/s; 123733 sec
[2019-12-13 01:25:50,059 INFO] Step 93500/100000; acc:  98.87; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/998 tok/s; 124326 sec
[2019-12-13 01:35:26,904 INFO] Step 94000/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1009 tok/s; 124903 sec
[2019-12-13 01:45:16,264 INFO] Step 94500/100000; acc:  98.87; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/994 tok/s; 125492 sec
[2019-12-13 01:54:58,862 INFO] Step 95000/100000; acc:  98.87; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1005 tok/s; 126075 sec
[2019-12-13 02:04:40,046 INFO] Step 95500/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1008 tok/s; 126656 sec
[2019-12-13 02:14:32,647 INFO] Step 96000/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/990 tok/s; 127249 sec
[2019-12-13 02:24:00,293 INFO] Step 96500/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1027 tok/s; 127816 sec
[2019-12-13 02:33:43,132 INFO] Step 97000/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1005 tok/s; 128399 sec
[2019-12-13 02:43:27,025 INFO] Step 97500/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1006 tok/s; 128983 sec
[2019-12-13 02:53:10,863 INFO] Step 98000/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1005 tok/s; 129567 sec
[2019-12-13 03:02:57,967 INFO] Step 98500/100000; acc:  98.88; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1000 tok/s; 130154 sec
[2019-12-13 03:12:34,612 INFO] Step 99000/100000; acc:  98.87; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1010 tok/s; 130731 sec
[2019-12-13 03:22:25,185 INFO] Step 99500/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/998 tok/s; 131321 sec
[2019-12-13 03:32:03,841 INFO] Step 100000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00156;   0/1007 tok/s; 131900 sec
[2019-12-13 03:37:35,114 INFO] Validation perplexity: 1.07447
[2019-12-13 03:37:35,115 INFO] Validation accuracy: 98.2563
[2019-12-13 03:37:35,119 INFO] Saving checkpoint ../results/models/im2latex-59_step_100000.pt
