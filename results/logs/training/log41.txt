[2019-10-25 12:46:00,645 INFO]  * tgt vocab size = 510
[2019-10-25 12:46:00,645 INFO] Building model...
[2019-10-25 12:46:04,527 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer3): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer5): DCN(
      (conv_offset_mask): Conv2d(256, 54, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    )
    (layer6): DCN(
      (conv_offset_mask): Conv2d(512, 54, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    )
    (batch_norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(512, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 512)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-10-25 12:46:04,529 INFO] encoder: 8420780
[2019-10-25 12:46:04,529 INFO] decoder: 5214310
[2019-10-25 12:46:04,529 INFO] * number of parameters: 13635090
[2019-10-25 12:46:04,875 INFO] Starting training on GPU: [0]
[2019-10-25 12:46:04,875 INFO] Start training loop and validate every 10000 steps...
[2019-10-25 12:49:38,316 INFO] Step 500/100000; acc:  28.51; ppl: 39.89; xent: 3.69; lr: 0.10000;   0/2757 tok/s;    213 sec
[2019-10-25 12:53:02,359 INFO] Step 1000/100000; acc:  44.61; ppl: 13.33; xent: 2.59; lr: 0.10000;   0/2849 tok/s;    417 sec
[2019-10-25 12:56:28,920 INFO] Step 1500/100000; acc:  49.41; ppl:  9.94; xent: 2.30; lr: 0.10000;   0/2851 tok/s;    624 sec
[2019-10-25 12:59:55,468 INFO] Step 2000/100000; acc:  59.11; ppl:  5.96; xent: 1.78; lr: 0.10000;   0/2847 tok/s;    831 sec
[2019-10-25 13:03:23,162 INFO] Step 2500/100000; acc:  73.01; ppl:  3.12; xent: 1.14; lr: 0.10000;   0/2818 tok/s;   1038 sec
[2019-10-25 13:06:52,186 INFO] Step 3000/100000; acc:  80.57; ppl:  2.26; xent: 0.81; lr: 0.10000;   0/2805 tok/s;   1247 sec
[2019-10-25 13:10:20,883 INFO] Step 3500/100000; acc:  84.53; ppl:  1.90; xent: 0.64; lr: 0.10000;   0/2800 tok/s;   1456 sec
[2019-10-25 13:14:02,061 INFO] Step 4000/100000; acc:  86.65; ppl:  1.74; xent: 0.55; lr: 0.10000;   0/2659 tok/s;   1677 sec
[2019-10-25 13:17:41,255 INFO] Step 4500/100000; acc:  88.25; ppl:  1.62; xent: 0.48; lr: 0.10000;   0/2662 tok/s;   1896 sec
[2019-10-25 13:21:17,674 INFO] Step 5000/100000; acc:  89.24; ppl:  1.55; xent: 0.44; lr: 0.10000;   0/2707 tok/s;   2113 sec
[2019-10-25 13:24:57,332 INFO] Step 5500/100000; acc:  90.18; ppl:  1.49; xent: 0.40; lr: 0.10000;   0/2679 tok/s;   2332 sec
[2019-10-25 13:28:40,769 INFO] Step 6000/100000; acc:  90.87; ppl:  1.45; xent: 0.37; lr: 0.10000;   0/2617 tok/s;   2556 sec
[2019-10-25 13:32:20,679 INFO] Step 6500/100000; acc:  91.34; ppl:  1.42; xent: 0.35; lr: 0.10000;   0/2668 tok/s;   2776 sec
[2019-10-25 13:35:58,641 INFO] Step 7000/100000; acc:  91.84; ppl:  1.38; xent: 0.33; lr: 0.10000;   0/2689 tok/s;   2994 sec
[2019-10-25 13:39:36,110 INFO] Step 7500/100000; acc:  92.27; ppl:  1.36; xent: 0.31; lr: 0.10000;   0/2682 tok/s;   3211 sec
[2019-10-25 13:43:18,283 INFO] Step 8000/100000; acc:  92.54; ppl:  1.35; xent: 0.30; lr: 0.10000;   0/2654 tok/s;   3433 sec
[2019-10-25 13:46:54,662 INFO] Step 8500/100000; acc:  93.13; ppl:  1.32; xent: 0.27; lr: 0.10000;   0/2691 tok/s;   3650 sec
[2019-10-25 13:50:32,861 INFO] Step 9000/100000; acc:  93.31; ppl:  1.31; xent: 0.27; lr: 0.10000;   0/2685 tok/s;   3868 sec
[2019-10-25 13:54:12,654 INFO] Step 9500/100000; acc:  93.56; ppl:  1.29; xent: 0.25; lr: 0.10000;   0/2682 tok/s;   4088 sec
[2019-10-25 13:57:49,052 INFO] Step 10000/100000; acc:  93.75; ppl:  1.28; xent: 0.25; lr: 0.10000;   0/2690 tok/s;   4304 sec
[2019-10-25 13:59:14,861 INFO] Validation perplexity: 1.36452
[2019-10-25 13:59:14,862 INFO] Validation accuracy: 91.7031
[2019-10-25 13:59:14,865 INFO] Saving checkpoint ../results/models/im2latex-41_step_10000.pt
[2019-10-25 14:02:51,318 INFO] Step 10500/100000; acc:  93.88; ppl:  1.27; xent: 0.24; lr: 0.10000;   0/1938 tok/s;   4606 sec
[2019-10-25 14:06:21,106 INFO] Step 11000/100000; acc:  93.88; ppl:  1.27; xent: 0.24; lr: 0.10000;   0/2796 tok/s;   4816 sec
[2019-10-25 14:09:50,562 INFO] Step 11500/100000; acc:  94.19; ppl:  1.26; xent: 0.23; lr: 0.10000;   0/2790 tok/s;   5026 sec
[2019-10-25 14:13:23,715 INFO] Step 12000/100000; acc:  94.32; ppl:  1.25; xent: 0.22; lr: 0.10000;   0/2756 tok/s;   5239 sec
[2019-10-25 14:16:51,558 INFO] Step 12500/100000; acc:  94.52; ppl:  1.24; xent: 0.21; lr: 0.10000;   0/2804 tok/s;   5447 sec
[2019-10-25 14:20:24,933 INFO] Step 13000/100000; acc:  94.64; ppl:  1.23; xent: 0.21; lr: 0.10000;   0/2754 tok/s;   5660 sec
[2019-10-25 14:23:55,214 INFO] Step 13500/100000; acc:  94.89; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/2796 tok/s;   5870 sec
[2019-10-25 14:27:26,027 INFO] Step 14000/100000; acc:  94.76; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/2778 tok/s;   6081 sec
[2019-10-25 14:31:02,456 INFO] Step 14500/100000; acc:  94.75; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/2714 tok/s;   6298 sec
[2019-10-25 14:34:32,799 INFO] Step 15000/100000; acc:  95.00; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/2773 tok/s;   6508 sec
[2019-10-25 14:38:06,450 INFO] Step 15500/100000; acc:  95.01; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/2758 tok/s;   6722 sec
[2019-10-25 14:41:37,785 INFO] Step 16000/100000; acc:  95.12; ppl:  1.20; xent: 0.19; lr: 0.10000;   0/2759 tok/s;   6933 sec
[2019-10-25 14:45:06,063 INFO] Step 16500/100000; acc:  95.24; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/2804 tok/s;   7141 sec
[2019-10-25 14:48:36,888 INFO] Step 17000/100000; acc:  95.36; ppl:  1.19; xent: 0.18; lr: 0.10000;   0/2797 tok/s;   7352 sec
[2019-10-25 14:52:05,530 INFO] Step 17500/100000; acc:  95.25; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/2796 tok/s;   7561 sec
[2019-10-25 14:55:36,138 INFO] Step 18000/100000; acc:  95.30; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/2790 tok/s;   7771 sec
[2019-10-25 14:59:06,873 INFO] Step 18500/100000; acc:  95.29; ppl:  1.19; xent: 0.18; lr: 0.10000;   0/2785 tok/s;   7982 sec
[2019-10-25 15:02:35,073 INFO] Step 19000/100000; acc:  95.44; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/2797 tok/s;   8190 sec
[2019-10-25 15:06:11,028 INFO] Step 19500/100000; acc:  95.45; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/2731 tok/s;   8406 sec
[2019-10-25 15:09:38,700 INFO] Step 20000/100000; acc:  95.70; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/2802 tok/s;   8614 sec
[2019-10-25 15:11:02,592 INFO] Validation perplexity: 1.18849
[2019-10-25 15:11:02,593 INFO] Validation accuracy: 95.5518
[2019-10-25 15:11:02,596 INFO] Saving checkpoint ../results/models/im2latex-41_step_20000.pt
[2019-10-25 15:14:33,661 INFO] Step 20500/100000; acc:  95.65; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/1992 tok/s;   8909 sec
[2019-10-25 15:18:04,033 INFO] Step 21000/100000; acc:  95.72; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/2794 tok/s;   9119 sec
[2019-10-25 15:21:34,660 INFO] Step 21500/100000; acc:  95.73; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/2769 tok/s;   9330 sec
[2019-10-25 15:25:04,861 INFO] Step 22000/100000; acc:  95.70; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/2781 tok/s;   9540 sec
[2019-10-25 15:28:36,229 INFO] Step 22500/100000; acc:  95.79; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/2773 tok/s;   9751 sec
[2019-10-25 15:32:07,145 INFO] Step 23000/100000; acc:  95.88; ppl:  1.17; xent: 0.15; lr: 0.10000;   0/2785 tok/s;   9962 sec
[2019-10-25 15:35:39,163 INFO] Step 23500/100000; acc:  95.89; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/2759 tok/s;  10174 sec
[2019-10-25 15:39:06,248 INFO] Step 24000/100000; acc:  95.85; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/2819 tok/s;  10381 sec
[2019-10-25 15:42:35,123 INFO] Step 24500/100000; acc:  95.94; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/2808 tok/s;  10590 sec
[2019-10-25 15:46:04,197 INFO] Step 25000/100000; acc:  96.03; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/2803 tok/s;  10799 sec
[2019-10-25 15:49:36,010 INFO] Step 25500/100000; acc:  96.03; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/2775 tok/s;  11011 sec
[2019-10-25 15:53:07,058 INFO] Step 26000/100000; acc:  95.93; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/2779 tok/s;  11222 sec
[2019-10-25 15:56:34,048 INFO] Step 26500/100000; acc:  96.07; ppl:  1.16; xent: 0.14; lr: 0.10000;   0/2814 tok/s;  11429 sec
[2019-10-25 16:00:05,310 INFO] Step 27000/100000; acc:  96.00; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/2794 tok/s;  11640 sec
[2019-10-25 16:03:36,083 INFO] Step 27500/100000; acc:  96.21; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/2765 tok/s;  11851 sec
[2019-10-25 16:07:03,167 INFO] Step 28000/100000; acc:  96.10; ppl:  1.16; xent: 0.14; lr: 0.10000;   0/2825 tok/s;  12058 sec
[2019-10-25 16:10:35,580 INFO] Step 28500/100000; acc:  96.31; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/2785 tok/s;  12271 sec
[2019-10-25 16:14:05,863 INFO] Step 29000/100000; acc:  96.19; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/2773 tok/s;  12481 sec
[2019-10-25 16:17:36,632 INFO] Step 29500/100000; acc:  96.22; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/2788 tok/s;  12692 sec
[2019-10-25 16:21:06,447 INFO] Step 30000/100000; acc:  96.25; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/2794 tok/s;  12902 sec
[2019-10-25 16:22:30,225 INFO] Validation perplexity: 1.15103
[2019-10-25 16:22:30,226 INFO] Validation accuracy: 96.3666
[2019-10-25 16:22:30,229 INFO] Saving checkpoint ../results/models/im2latex-41_step_30000.pt
[2019-10-25 16:26:00,094 INFO] Step 30500/100000; acc:  96.30; ppl:  1.14; xent: 0.14; lr: 0.10000;   0/1982 tok/s;  13195 sec
[2019-10-25 16:29:33,515 INFO] Step 31000/100000; acc:  96.32; ppl:  1.14; xent: 0.14; lr: 0.10000;   0/2759 tok/s;  13409 sec
[2019-10-25 16:32:59,401 INFO] Step 31500/100000; acc:  96.35; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2824 tok/s;  13615 sec
[2019-10-25 16:36:30,242 INFO] Step 32000/100000; acc:  96.30; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/2791 tok/s;  13825 sec
[2019-10-25 16:39:59,784 INFO] Step 32500/100000; acc:  96.47; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2802 tok/s;  14035 sec
[2019-10-25 16:43:29,124 INFO] Step 33000/100000; acc:  96.46; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2791 tok/s;  14244 sec
[2019-10-25 16:46:59,046 INFO] Step 33500/100000; acc:  96.35; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2786 tok/s;  14454 sec
[2019-10-25 16:50:26,861 INFO] Step 34000/100000; acc:  96.32; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2816 tok/s;  14662 sec
[2019-10-25 16:53:56,453 INFO] Step 34500/100000; acc:  96.47; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2803 tok/s;  14872 sec
[2019-10-25 16:57:27,297 INFO] Step 35000/100000; acc:  96.43; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2774 tok/s;  15082 sec
[2019-10-25 17:00:54,395 INFO] Step 35500/100000; acc:  96.59; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2829 tok/s;  15290 sec
[2019-10-25 17:04:24,895 INFO] Step 36000/100000; acc:  96.61; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2782 tok/s;  15500 sec
[2019-10-25 17:07:52,271 INFO] Step 36500/100000; acc:  96.56; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2822 tok/s;  15707 sec
[2019-10-25 17:11:24,139 INFO] Step 37000/100000; acc:  96.17; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/2769 tok/s;  15919 sec
[2019-10-25 17:14:54,468 INFO] Step 37500/100000; acc:  96.46; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2788 tok/s;  16130 sec
[2019-10-25 17:18:22,855 INFO] Step 38000/100000; acc:  96.58; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2797 tok/s;  16338 sec
[2019-10-25 17:21:56,035 INFO] Step 38500/100000; acc:  96.49; ppl:  1.13; xent: 0.13; lr: 0.10000;   0/2770 tok/s;  16551 sec
[2019-10-25 17:25:24,993 INFO] Step 39000/100000; acc:  96.72; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/2789 tok/s;  16760 sec
[2019-10-25 17:28:51,374 INFO] Step 39500/100000; acc:  96.66; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2828 tok/s;  16966 sec
[2019-10-25 17:32:23,593 INFO] Step 40000/100000; acc:  96.71; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2797 tok/s;  17179 sec
[2019-10-25 17:33:47,377 INFO] Validation perplexity: 1.15361
[2019-10-25 17:33:47,378 INFO] Validation accuracy: 96.283
[2019-10-25 17:33:47,381 INFO] Saving checkpoint ../results/models/im2latex-41_step_40000.pt
[2019-10-25 17:37:18,681 INFO] Step 40500/100000; acc:  96.66; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1975 tok/s;  17474 sec
[2019-10-25 17:40:48,427 INFO] Step 41000/100000; acc:  96.66; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2793 tok/s;  17684 sec
[2019-10-25 17:44:19,326 INFO] Step 41500/100000; acc:  96.48; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2778 tok/s;  17894 sec
[2019-10-25 17:47:48,217 INFO] Step 42000/100000; acc:  96.54; ppl:  1.13; xent: 0.13; lr: 0.10000;   0/2797 tok/s;  18103 sec
[2019-10-25 17:51:21,958 INFO] Step 42500/100000; acc:  96.71; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2754 tok/s;  18317 sec
[2019-10-25 17:54:47,469 INFO] Step 43000/100000; acc:  96.71; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/2826 tok/s;  18523 sec
[2019-10-25 17:58:16,035 INFO] Step 43500/100000; acc:  96.83; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/2811 tok/s;  18731 sec
[2019-10-25 18:01:44,769 INFO] Step 44000/100000; acc:  96.80; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/2825 tok/s;  18940 sec
[2019-10-25 18:05:13,737 INFO] Step 44500/100000; acc:  96.75; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/2800 tok/s;  19149 sec
[2019-10-25 18:08:44,790 INFO] Step 45000/100000; acc:  96.68; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2781 tok/s;  19360 sec
[2019-10-25 18:12:12,975 INFO] Step 45500/100000; acc:  96.82; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/2804 tok/s;  19568 sec
[2019-10-25 18:15:46,454 INFO] Step 46000/100000; acc:  96.86; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/2758 tok/s;  19782 sec
[2019-10-25 18:19:14,839 INFO] Step 46500/100000; acc:  96.79; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/2799 tok/s;  19990 sec
[2019-10-25 18:22:42,691 INFO] Step 47000/100000; acc:  96.76; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/2817 tok/s;  20198 sec
[2019-10-25 18:26:14,144 INFO] Step 47500/100000; acc:  96.89; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/2772 tok/s;  20409 sec
[2019-10-25 18:29:41,766 INFO] Step 48000/100000; acc:  96.88; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/2816 tok/s;  20617 sec
[2019-10-25 18:33:12,408 INFO] Step 48500/100000; acc:  96.69; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/2785 tok/s;  20828 sec
[2019-10-25 18:36:42,972 INFO] Step 49000/100000; acc:  96.44; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/2785 tok/s;  21038 sec
[2019-10-25 18:40:11,289 INFO] Step 49500/100000; acc:  96.84; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/2797 tok/s;  21246 sec
[2019-10-25 18:43:44,198 INFO] Step 50000/100000; acc:  96.77; ppl:  1.12; xent: 0.11; lr: 0.05000;   0/2771 tok/s;  21459 sec
[2019-10-25 18:45:07,962 INFO] Validation perplexity: 1.1527
[2019-10-25 18:45:07,963 INFO] Validation accuracy: 96.2768
[2019-10-25 18:45:07,965 INFO] Saving checkpoint ../results/models/im2latex-41_step_50000.pt
[2019-10-25 18:48:39,322 INFO] Step 50500/100000; acc:  97.46; ppl:  1.09; xent: 0.09; lr: 0.05000;   0/1973 tok/s;  21754 sec
[2019-10-25 18:52:07,413 INFO] Step 51000/100000; acc:  97.64; ppl:  1.09; xent: 0.08; lr: 0.05000;   0/2818 tok/s;  21963 sec
[2019-10-25 18:55:39,705 INFO] Step 51500/100000; acc:  97.71; ppl:  1.08; xent: 0.08; lr: 0.05000;   0/2792 tok/s;  22175 sec
[2019-10-25 18:59:07,651 INFO] Step 52000/100000; acc:  97.74; ppl:  1.08; xent: 0.08; lr: 0.05000;   0/2801 tok/s;  22383 sec
[2019-10-25 19:02:38,420 INFO] Step 52500/100000; acc:  97.76; ppl:  1.08; xent: 0.08; lr: 0.05000;   0/2781 tok/s;  22594 sec
[2019-10-25 19:06:08,520 INFO] Step 53000/100000; acc:  97.81; ppl:  1.08; xent: 0.07; lr: 0.05000;   0/2786 tok/s;  22804 sec
[2019-10-25 19:09:38,043 INFO] Step 53500/100000; acc:  97.86; ppl:  1.08; xent: 0.07; lr: 0.05000;   0/2793 tok/s;  23013 sec
[2019-10-25 19:13:09,877 INFO] Step 54000/100000; acc:  97.89; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/2769 tok/s;  23225 sec
[2019-10-25 19:16:36,402 INFO] Step 54500/100000; acc:  97.90; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/2821 tok/s;  23432 sec
[2019-10-25 19:20:06,255 INFO] Step 55000/100000; acc:  97.91; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/2795 tok/s;  23641 sec
[2019-10-25 19:23:35,532 INFO] Step 55500/100000; acc:  97.98; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/2810 tok/s;  23851 sec
[2019-10-25 19:27:06,380 INFO] Step 56000/100000; acc:  97.97; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/2780 tok/s;  24062 sec
[2019-10-25 19:30:38,507 INFO] Step 56500/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/2769 tok/s;  24274 sec
[2019-10-25 19:34:06,399 INFO] Step 57000/100000; acc:  98.00; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/2803 tok/s;  24482 sec
[2019-10-25 19:37:37,349 INFO] Step 57500/100000; acc:  98.03; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/2796 tok/s;  24692 sec
[2019-10-25 19:41:06,706 INFO] Step 58000/100000; acc:  98.02; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/2784 tok/s;  24902 sec
[2019-10-25 19:44:31,978 INFO] Step 58500/100000; acc:  98.04; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/2844 tok/s;  25107 sec
[2019-10-25 19:48:02,375 INFO] Step 59000/100000; acc:  98.08; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/2795 tok/s;  25318 sec
[2019-10-25 19:51:30,546 INFO] Step 59500/100000; acc:  98.09; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/2799 tok/s;  25526 sec
[2019-10-25 19:55:01,563 INFO] Step 60000/100000; acc:  98.07; ppl:  1.07; xent: 0.06; lr: 0.02500;   0/2786 tok/s;  25737 sec
[2019-10-25 19:56:25,506 INFO] Validation perplexity: 1.09545
[2019-10-25 19:56:25,507 INFO] Validation accuracy: 97.6393
[2019-10-25 19:56:25,510 INFO] Saving checkpoint ../results/models/im2latex-41_step_60000.pt
[2019-10-25 19:59:56,056 INFO] Step 60500/100000; acc:  98.16; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/1994 tok/s;  26031 sec
[2019-10-25 20:03:23,658 INFO] Step 61000/100000; acc:  98.23; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/2806 tok/s;  26239 sec
[2019-10-25 20:06:57,075 INFO] Step 61500/100000; acc:  98.23; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/2764 tok/s;  26452 sec
[2019-10-25 20:10:24,268 INFO] Step 62000/100000; acc:  98.28; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/2805 tok/s;  26659 sec
[2019-10-25 20:13:54,086 INFO] Step 62500/100000; acc:  98.29; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/2801 tok/s;  26869 sec
[2019-10-25 20:17:26,285 INFO] Step 63000/100000; acc:  98.33; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/2782 tok/s;  27081 sec
[2019-10-25 20:20:54,957 INFO] Step 63500/100000; acc:  98.36; ppl:  1.06; xent: 0.05; lr: 0.02500;   0/2798 tok/s;  27290 sec
[2019-10-25 20:24:25,145 INFO] Step 64000/100000; acc:  98.31; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/2782 tok/s;  27500 sec
[2019-10-25 20:27:54,802 INFO] Step 64500/100000; acc:  98.30; ppl:  1.06; xent: 0.06; lr: 0.02500;   0/2798 tok/s;  27710 sec
[2019-10-25 20:31:26,461 INFO] Step 65000/100000; acc:  98.35; ppl:  1.06; xent: 0.05; lr: 0.02500;   0/2770 tok/s;  27922 sec
[2019-10-25 20:34:57,309 INFO] Step 65500/100000; acc:  98.34; ppl:  1.06; xent: 0.05; lr: 0.02500;   0/2777 tok/s;  28132 sec
[2019-10-25 20:38:23,845 INFO] Step 66000/100000; acc:  98.35; ppl:  1.06; xent: 0.05; lr: 0.02500;   0/2832 tok/s;  28339 sec
[2019-10-25 20:41:53,031 INFO] Step 66500/100000; acc:  98.37; ppl:  1.06; xent: 0.05; lr: 0.02500;   0/2795 tok/s;  28548 sec
[2019-10-25 20:45:22,276 INFO] Step 67000/100000; acc:  98.41; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/2805 tok/s;  28757 sec
[2019-10-25 20:48:51,063 INFO] Step 67500/100000; acc:  98.42; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/2811 tok/s;  28966 sec
[2019-10-25 20:52:20,253 INFO] Step 68000/100000; acc:  98.32; ppl:  1.06; xent: 0.05; lr: 0.02500;   0/2799 tok/s;  29175 sec
[2019-10-25 20:55:48,652 INFO] Step 68500/100000; acc:  98.40; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/2797 tok/s;  29384 sec
[2019-10-25 20:59:20,227 INFO] Step 69000/100000; acc:  98.36; ppl:  1.06; xent: 0.05; lr: 0.02500;   0/2792 tok/s;  29595 sec
[2019-10-25 21:02:49,483 INFO] Step 69500/100000; acc:  98.42; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/2787 tok/s;  29805 sec
[2019-10-25 21:06:15,784 INFO] Step 70000/100000; acc:  98.38; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/2835 tok/s;  30011 sec
[2019-10-25 21:07:40,495 INFO] Validation perplexity: 1.09019
[2019-10-25 21:07:40,496 INFO] Validation accuracy: 97.8393
[2019-10-25 21:07:40,501 INFO] Saving checkpoint ../results/models/im2latex-41_step_70000.pt
[2019-10-25 21:11:13,320 INFO] Step 70500/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/1978 tok/s;  30308 sec
[2019-10-25 21:14:41,659 INFO] Step 71000/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/2798 tok/s;  30517 sec
[2019-10-25 21:18:12,862 INFO] Step 71500/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/2782 tok/s;  30728 sec
[2019-10-25 21:21:43,337 INFO] Step 72000/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/2783 tok/s;  30938 sec
[2019-10-25 21:25:10,684 INFO] Step 72500/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/2811 tok/s;  31146 sec
[2019-10-25 21:28:43,496 INFO] Step 73000/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/2765 tok/s;  31359 sec
[2019-10-25 21:32:09,796 INFO] Step 73500/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/2818 tok/s;  31565 sec
[2019-10-25 21:35:40,130 INFO] Step 74000/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/2799 tok/s;  31775 sec
[2019-10-25 21:39:09,880 INFO] Step 74500/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/2810 tok/s;  31985 sec
[2019-10-25 21:42:38,594 INFO] Step 75000/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/2800 tok/s;  32194 sec
[2019-10-25 21:46:10,794 INFO] Step 75500/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/2763 tok/s;  32406 sec
[2019-10-25 21:49:38,783 INFO] Step 76000/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/2809 tok/s;  32614 sec
[2019-10-25 21:53:08,418 INFO] Step 76500/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/2804 tok/s;  32824 sec
[2019-10-25 21:56:37,726 INFO] Step 77000/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/2790 tok/s;  33033 sec
[2019-10-25 22:00:05,148 INFO] Step 77500/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/2826 tok/s;  33240 sec
[2019-10-25 22:03:36,526 INFO] Step 78000/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/2781 tok/s;  33452 sec
[2019-10-25 22:07:05,362 INFO] Step 78500/100000; acc:  98.58; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/2801 tok/s;  33660 sec
[2019-10-25 22:10:36,275 INFO] Step 79000/100000; acc:  98.58; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/2780 tok/s;  33871 sec
[2019-10-25 22:14:06,593 INFO] Step 79500/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.01250;   0/2791 tok/s;  34082 sec
[2019-10-25 22:17:34,330 INFO] Step 80000/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.00625;   0/2803 tok/s;  34289 sec
[2019-10-25 22:18:58,256 INFO] Validation perplexity: 1.09058
[2019-10-25 22:18:58,257 INFO] Validation accuracy: 97.8701
[2019-10-25 22:18:58,260 INFO] Saving checkpoint ../results/models/im2latex-41_step_80000.pt
[2019-10-25 22:22:32,542 INFO] Step 80500/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.00625;   0/1980 tok/s;  34588 sec
[2019-10-25 22:26:01,258 INFO] Step 81000/100000; acc:  98.59; ppl:  1.05; xent: 0.04; lr: 0.00625;   0/2791 tok/s;  34796 sec
[2019-10-25 22:29:28,198 INFO] Step 81500/100000; acc:  98.59; ppl:  1.05; xent: 0.04; lr: 0.00625;   0/2823 tok/s;  35003 sec
[2019-10-25 22:32:58,993 INFO] Step 82000/100000; acc:  98.58; ppl:  1.05; xent: 0.05; lr: 0.00625;   0/2802 tok/s;  35214 sec
[2019-10-25 22:36:25,953 INFO] Step 82500/100000; acc:  98.63; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/2817 tok/s;  35421 sec
[2019-10-25 22:39:57,851 INFO] Step 83000/100000; acc:  98.63; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/2762 tok/s;  35633 sec
[2019-10-25 22:43:27,316 INFO] Step 83500/100000; acc:  98.58; ppl:  1.05; xent: 0.04; lr: 0.00625;   0/2798 tok/s;  35842 sec
[2019-10-25 22:46:55,517 INFO] Step 84000/100000; acc:  98.60; ppl:  1.05; xent: 0.04; lr: 0.00625;   0/2805 tok/s;  36051 sec
[2019-10-25 22:50:27,888 INFO] Step 84500/100000; acc:  98.62; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/2771 tok/s;  36263 sec
[2019-10-25 22:53:53,462 INFO] Step 85000/100000; acc:  98.60; ppl:  1.05; xent: 0.04; lr: 0.00625;   0/2829 tok/s;  36469 sec
[2019-10-25 22:57:22,848 INFO] Step 85500/100000; acc:  98.61; ppl:  1.05; xent: 0.04; lr: 0.00625;   0/2808 tok/s;  36678 sec
[2019-10-25 23:00:52,088 INFO] Step 86000/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/2815 tok/s;  36887 sec
[2019-10-25 23:04:21,699 INFO] Step 86500/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/2790 tok/s;  37097 sec
[2019-10-25 23:07:53,668 INFO] Step 87000/100000; acc:  98.60; ppl:  1.05; xent: 0.04; lr: 0.00625;   0/2772 tok/s;  37309 sec
[2019-10-25 23:11:23,652 INFO] Step 87500/100000; acc:  98.62; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/2778 tok/s;  37519 sec
[2019-10-25 23:14:54,672 INFO] Step 88000/100000; acc:  98.61; ppl:  1.05; xent: 0.04; lr: 0.00625;   0/2791 tok/s;  37730 sec
[2019-10-25 23:18:24,597 INFO] Step 88500/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/2779 tok/s;  37940 sec
[2019-10-25 23:21:50,865 INFO] Step 89000/100000; acc:  98.62; ppl:  1.05; xent: 0.04; lr: 0.00625;   0/2835 tok/s;  38146 sec
[2019-10-25 23:25:21,260 INFO] Step 89500/100000; acc:  98.63; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/2802 tok/s;  38356 sec
[2019-10-25 23:28:48,636 INFO] Step 90000/100000; acc:  98.65; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2815 tok/s;  38564 sec
[2019-10-25 23:30:12,609 INFO] Validation perplexity: 1.08899
[2019-10-25 23:30:12,610 INFO] Validation accuracy: 97.9037
[2019-10-25 23:30:12,613 INFO] Saving checkpoint ../results/models/im2latex-41_step_90000.pt
[2019-10-25 23:33:44,927 INFO] Step 90500/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1980 tok/s;  38860 sec
[2019-10-25 23:37:16,155 INFO] Step 91000/100000; acc:  98.61; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2777 tok/s;  39071 sec
[2019-10-25 23:40:45,268 INFO] Step 91500/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2786 tok/s;  39280 sec
[2019-10-25 23:44:19,509 INFO] Step 92000/100000; acc:  98.63; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2751 tok/s;  39495 sec
[2019-10-25 23:47:47,296 INFO] Step 92500/100000; acc:  98.65; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2805 tok/s;  39702 sec
[2019-10-25 23:51:15,026 INFO] Step 93000/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2825 tok/s;  39910 sec
[2019-10-25 23:54:42,726 INFO] Step 93500/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2832 tok/s;  40118 sec
[2019-10-25 23:58:10,459 INFO] Step 94000/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2803 tok/s;  40326 sec
[2019-10-26 00:01:39,579 INFO] Step 94500/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2802 tok/s;  40535 sec
[2019-10-26 00:05:06,966 INFO] Step 95000/100000; acc:  98.63; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2823 tok/s;  40742 sec
[2019-10-26 00:08:34,012 INFO] Step 95500/100000; acc:  98.65; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2829 tok/s;  40949 sec
[2019-10-26 00:12:02,980 INFO] Step 96000/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2807 tok/s;  41158 sec
[2019-10-26 00:15:28,499 INFO] Step 96500/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2836 tok/s;  41364 sec
[2019-10-26 00:18:56,114 INFO] Step 97000/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2833 tok/s;  41571 sec
[2019-10-26 00:22:22,351 INFO] Step 97500/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2847 tok/s;  41777 sec
[2019-10-26 00:25:51,538 INFO] Step 98000/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2809 tok/s;  41987 sec
[2019-10-26 00:29:18,241 INFO] Step 98500/100000; acc:  98.63; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2838 tok/s;  42193 sec
[2019-10-26 00:32:44,912 INFO] Step 99000/100000; acc:  98.65; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2818 tok/s;  42400 sec
[2019-10-26 00:36:12,784 INFO] Step 99500/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/2838 tok/s;  42608 sec
[2019-10-26 00:39:38,611 INFO] Step 100000/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.00156;   0/2830 tok/s;  42814 sec
[2019-10-26 00:41:02,037 INFO] Validation perplexity: 1.08943
[2019-10-26 00:41:02,039 INFO] Validation accuracy: 97.9081
[2019-10-26 00:41:02,042 INFO] Saving checkpoint ../results/models/im2latex-41_step_100000.pt
