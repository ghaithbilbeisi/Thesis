[2019-11-04 22:16:56,993 INFO]  * tgt vocab size = 510
[2019-11-04 22:16:56,993 INFO] Building model...
[2019-11-04 22:17:00,958 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds1): Downsample(
      (pad): ReflectionPad2d([1, 1, 1, 1])
    )
    (layer3): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer5): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer6): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer7): Conv2d(128, 128, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layer8): Conv2d(128, 128, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layer9): Conv2d(128, 128, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layer10): Conv2d(128, 128, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (batch_norm1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(128, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 128)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
      (linear_cover): Linear(in_features=1, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-11-04 22:17:00,959 INFO] encoder: 3210624
[2019-11-04 22:17:00,959 INFO] decoder: 5214810
[2019-11-04 22:17:00,959 INFO] * number of parameters: 8425434
[2019-11-04 22:17:01,407 INFO] Starting training on GPU: [0]
[2019-11-04 22:17:01,407 INFO] Start training loop and validate every 10000 steps...
[2019-11-04 22:25:45,527 INFO] Step 500/100000; acc:  29.04; ppl: 39.65; xent: 3.68; lr: 0.10000;   0/1123 tok/s;    524 sec
[2019-11-04 22:34:08,348 INFO] Step 1000/100000; acc:  44.65; ppl: 13.38; xent: 2.59; lr: 0.10000;   0/1156 tok/s;   1027 sec
[2019-11-04 22:42:42,602 INFO] Step 1500/100000; acc:  48.29; ppl: 10.58; xent: 2.36; lr: 0.10000;   0/1145 tok/s;   1541 sec
[2019-11-04 22:51:19,520 INFO] Step 2000/100000; acc:  52.94; ppl:  8.10; xent: 2.09; lr: 0.10000;   0/1138 tok/s;   2058 sec
[2019-11-04 22:59:54,914 INFO] Step 2500/100000; acc:  71.35; ppl:  3.33; xent: 1.20; lr: 0.10000;   0/1133 tok/s;   2574 sec
[2019-11-04 23:08:37,435 INFO] Step 3000/100000; acc:  84.87; ppl:  1.90; xent: 0.64; lr: 0.10000;   0/1124 tok/s;   3096 sec
[2019-11-04 23:17:05,996 INFO] Step 3500/100000; acc:  89.32; ppl:  1.58; xent: 0.45; lr: 0.10000;   0/1149 tok/s;   3605 sec
[2019-11-04 23:25:51,997 INFO] Step 4000/100000; acc:  91.02; ppl:  1.47; xent: 0.38; lr: 0.10000;   0/1118 tok/s;   4131 sec
[2019-11-04 23:34:26,187 INFO] Step 4500/100000; acc:  92.18; ppl:  1.39; xent: 0.33; lr: 0.10000;   0/1135 tok/s;   4645 sec
[2019-11-04 23:42:49,322 INFO] Step 5000/100000; acc:  93.08; ppl:  1.34; xent: 0.29; lr: 0.10000;   0/1165 tok/s;   5148 sec
[2019-11-04 23:51:30,134 INFO] Step 5500/100000; acc:  93.69; ppl:  1.30; xent: 0.26; lr: 0.10000;   0/1126 tok/s;   5669 sec
[2019-11-04 23:59:58,023 INFO] Step 6000/100000; acc:  94.15; ppl:  1.28; xent: 0.24; lr: 0.10000;   0/1152 tok/s;   6177 sec
[2019-11-05 00:08:36,028 INFO] Step 6500/100000; acc:  94.56; ppl:  1.25; xent: 0.23; lr: 0.10000;   0/1133 tok/s;   6695 sec
[2019-11-05 00:17:07,010 INFO] Step 7000/100000; acc:  94.79; ppl:  1.24; xent: 0.21; lr: 0.10000;   0/1147 tok/s;   7206 sec
[2019-11-05 00:25:37,704 INFO] Step 7500/100000; acc:  95.12; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/1142 tok/s;   7716 sec
[2019-11-05 00:34:25,626 INFO] Step 8000/100000; acc:  95.27; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/1117 tok/s;   8244 sec
[2019-11-05 00:42:56,550 INFO] Step 8500/100000; acc:  95.63; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/1141 tok/s;   8755 sec
[2019-11-05 00:51:25,855 INFO] Step 9000/100000; acc:  95.81; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/1150 tok/s;   9264 sec
[2019-11-05 01:00:03,395 INFO] Step 9500/100000; acc:  95.91; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/1140 tok/s;   9782 sec
[2019-11-05 01:08:33,338 INFO] Step 10000/100000; acc:  95.96; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/1141 tok/s;  10292 sec
[2019-11-05 01:13:18,278 INFO] Validation perplexity: 1.14909
[2019-11-05 01:13:18,279 INFO] Validation accuracy: 96.6322
[2019-11-05 01:13:18,282 INFO] Saving checkpoint ../results/models/im2latex-47_step_10000.pt
[2019-11-05 01:21:58,185 INFO] Step 10500/100000; acc:  96.08; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/728 tok/s;  11097 sec
[2019-11-05 01:30:31,990 INFO] Step 11000/100000; acc:  96.17; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/1142 tok/s;  11611 sec
[2019-11-05 01:39:03,803 INFO] Step 11500/100000; acc:  96.29; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/1142 tok/s;  12122 sec
[2019-11-05 01:47:47,960 INFO] Step 12000/100000; acc:  96.39; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/1121 tok/s;  12647 sec
[2019-11-05 01:56:07,316 INFO] Step 12500/100000; acc:  96.50; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/1167 tok/s;  13146 sec
[2019-11-05 02:04:42,356 INFO] Step 13000/100000; acc:  96.56; ppl:  1.14; xent: 0.14; lr: 0.10000;   0/1141 tok/s;  13661 sec
[2019-11-05 02:13:15,252 INFO] Step 13500/100000; acc:  96.71; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1149 tok/s;  14174 sec
[2019-11-05 02:21:49,862 INFO] Step 14000/100000; acc:  96.69; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1136 tok/s;  14688 sec
[2019-11-05 02:30:30,330 INFO] Step 14500/100000; acc:  96.68; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1129 tok/s;  15209 sec
[2019-11-05 02:39:00,380 INFO] Step 15000/100000; acc:  96.80; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1144 tok/s;  15719 sec
[2019-11-05 02:47:39,892 INFO] Step 15500/100000; acc:  96.79; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1134 tok/s;  16238 sec
[2019-11-05 02:56:17,462 INFO] Step 16000/100000; acc:  96.87; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1127 tok/s;  16756 sec
[2019-11-05 03:04:43,590 INFO] Step 16500/100000; acc:  97.02; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1153 tok/s;  17262 sec
[2019-11-05 03:13:19,848 INFO] Step 17000/100000; acc:  97.05; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1142 tok/s;  17778 sec
[2019-11-05 03:21:50,010 INFO] Step 17500/100000; acc:  97.04; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1143 tok/s;  18289 sec
[2019-11-05 03:30:26,583 INFO] Step 18000/100000; acc:  97.02; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1138 tok/s;  18805 sec
[2019-11-05 03:38:57,278 INFO] Step 18500/100000; acc:  97.07; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1149 tok/s;  19316 sec
[2019-11-05 03:47:22,748 INFO] Step 19000/100000; acc:  97.07; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1152 tok/s;  19821 sec
[2019-11-05 03:56:07,408 INFO] Step 19500/100000; acc:  97.11; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1124 tok/s;  20346 sec
[2019-11-05 04:04:28,492 INFO] Step 20000/100000; acc:  97.22; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1162 tok/s;  20847 sec
[2019-11-05 04:09:13,201 INFO] Validation perplexity: 1.10736
[2019-11-05 04:09:13,201 INFO] Validation accuracy: 97.3683
[2019-11-05 04:09:13,204 INFO] Saving checkpoint ../results/models/im2latex-47_step_20000.pt
[2019-11-05 04:17:43,192 INFO] Step 20500/100000; acc:  97.29; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/739 tok/s;  21642 sec
[2019-11-05 04:26:15,929 INFO] Step 21000/100000; acc:  97.32; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1146 tok/s;  22155 sec
[2019-11-05 04:34:44,289 INFO] Step 21500/100000; acc:  97.32; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1147 tok/s;  22663 sec
[2019-11-05 04:43:20,600 INFO] Step 22000/100000; acc:  97.29; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1133 tok/s;  23179 sec
[2019-11-05 04:51:49,791 INFO] Step 22500/100000; acc:  97.35; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1151 tok/s;  23688 sec
[2019-11-05 05:00:29,295 INFO] Step 23000/100000; acc:  97.39; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1130 tok/s;  24208 sec
[2019-11-05 05:09:08,017 INFO] Step 23500/100000; acc:  97.42; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1128 tok/s;  24727 sec
[2019-11-05 05:17:28,241 INFO] Step 24000/100000; acc:  97.43; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1167 tok/s;  25227 sec
[2019-11-05 05:26:01,597 INFO] Step 24500/100000; acc:  97.50; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1147 tok/s;  25740 sec
[2019-11-05 05:34:29,862 INFO] Step 25000/100000; acc:  97.58; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1152 tok/s;  26248 sec
[2019-11-05 05:43:03,685 INFO] Step 25500/100000; acc:  97.55; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1145 tok/s;  26762 sec
[2019-11-05 05:51:36,746 INFO] Step 26000/100000; acc:  97.51; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1143 tok/s;  27275 sec
[2019-11-05 06:00:04,102 INFO] Step 26500/100000; acc:  97.55; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1148 tok/s;  27783 sec
[2019-11-05 06:08:41,252 INFO] Step 27000/100000; acc:  97.52; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1141 tok/s;  28300 sec
[2019-11-05 06:17:15,822 INFO] Step 27500/100000; acc:  97.61; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1133 tok/s;  28814 sec
[2019-11-05 06:25:43,374 INFO] Step 28000/100000; acc:  97.59; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1153 tok/s;  29322 sec
[2019-11-05 06:34:21,017 INFO] Step 28500/100000; acc:  97.68; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1139 tok/s;  29840 sec
[2019-11-05 06:42:45,893 INFO] Step 29000/100000; acc:  97.69; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1154 tok/s;  30344 sec
[2019-11-05 06:51:24,434 INFO] Step 29500/100000; acc:  97.69; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1133 tok/s;  30863 sec
[2019-11-05 06:59:59,842 INFO] Step 30000/100000; acc:  97.64; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1137 tok/s;  31378 sec
[2019-11-05 07:04:44,929 INFO] Validation perplexity: 1.09295
[2019-11-05 07:04:44,930 INFO] Validation accuracy: 97.7553
[2019-11-05 07:04:44,932 INFO] Saving checkpoint ../results/models/im2latex-47_step_30000.pt
[2019-11-05 07:13:11,083 INFO] Step 30500/100000; acc:  97.71; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/736 tok/s;  32170 sec
[2019-11-05 07:21:52,424 INFO] Step 31000/100000; acc:  97.69; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1129 tok/s;  32691 sec
[2019-11-05 07:30:10,778 INFO] Step 31500/100000; acc:  97.73; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1167 tok/s;  33189 sec
[2019-11-05 07:38:44,990 INFO] Step 32000/100000; acc:  97.76; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1145 tok/s;  33704 sec
[2019-11-05 07:47:14,000 INFO] Step 32500/100000; acc:  97.75; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1153 tok/s;  34213 sec
[2019-11-05 07:55:38,309 INFO] Step 33000/100000; acc:  97.77; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1158 tok/s;  34717 sec
[2019-11-05 08:04:17,565 INFO] Step 33500/100000; acc:  97.76; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1127 tok/s;  35236 sec
[2019-11-05 08:12:45,583 INFO] Step 34000/100000; acc:  97.78; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1153 tok/s;  35744 sec
[2019-11-05 08:21:23,372 INFO] Step 34500/100000; acc:  97.84; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1133 tok/s;  36262 sec
[2019-11-05 08:30:01,170 INFO] Step 35000/100000; acc:  97.82; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1130 tok/s;  36780 sec
[2019-11-05 08:38:27,666 INFO] Step 35500/100000; acc:  97.84; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1156 tok/s;  37286 sec
[2019-11-05 08:47:04,904 INFO] Step 36000/100000; acc:  97.88; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1138 tok/s;  37803 sec
[2019-11-05 08:55:33,304 INFO] Step 36500/100000; acc:  97.87; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1152 tok/s;  38312 sec
[2019-11-05 09:04:08,888 INFO] Step 37000/100000; acc:  97.88; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1138 tok/s;  38827 sec
[2019-11-05 09:12:40,183 INFO] Step 37500/100000; acc:  97.88; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1146 tok/s;  39339 sec
[2019-11-05 09:21:08,475 INFO] Step 38000/100000; acc:  97.90; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1147 tok/s;  39847 sec
[2019-11-05 09:29:47,455 INFO] Step 38500/100000; acc:  97.85; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1138 tok/s;  40366 sec
[2019-11-05 09:38:14,212 INFO] Step 39000/100000; acc:  97.92; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1150 tok/s;  40873 sec
[2019-11-05 09:46:37,159 INFO] Step 39500/100000; acc:  97.92; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1162 tok/s;  41376 sec
[2019-11-05 09:55:18,692 INFO] Step 40000/100000; acc:  97.96; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1133 tok/s;  41897 sec
[2019-11-05 10:00:03,081 INFO] Validation perplexity: 1.08675
[2019-11-05 10:00:03,082 INFO] Validation accuracy: 97.8689
[2019-11-05 10:00:03,084 INFO] Saving checkpoint ../results/models/im2latex-47_step_40000.pt
[2019-11-05 10:08:32,588 INFO] Step 40500/100000; acc:  98.01; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/735 tok/s;  42691 sec
[2019-11-05 10:17:09,065 INFO] Step 41000/100000; acc:  97.98; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1135 tok/s;  43208 sec
[2019-11-05 10:25:38,843 INFO] Step 41500/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1149 tok/s;  43717 sec
[2019-11-05 10:34:09,239 INFO] Step 42000/100000; acc:  97.98; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1144 tok/s;  44228 sec
[2019-11-05 10:42:56,695 INFO] Step 42500/100000; acc:  97.97; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1116 tok/s;  44755 sec
[2019-11-05 10:51:13,148 INFO] Step 43000/100000; acc:  98.00; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1171 tok/s;  45252 sec
[2019-11-05 10:59:40,721 INFO] Step 43500/100000; acc:  98.06; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1154 tok/s;  45759 sec
[2019-11-05 11:08:12,870 INFO] Step 44000/100000; acc:  98.05; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1151 tok/s;  46271 sec
[2019-11-05 11:16:42,509 INFO] Step 44500/100000; acc:  98.06; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1147 tok/s;  46781 sec
[2019-11-05 11:25:17,250 INFO] Step 45000/100000; acc:  98.03; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1140 tok/s;  47296 sec
[2019-11-05 11:33:42,563 INFO] Step 45500/100000; acc:  98.01; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1156 tok/s;  47801 sec
[2019-11-05 11:42:20,197 INFO] Step 46000/100000; acc:  98.08; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1137 tok/s;  48319 sec
[2019-11-05 11:50:52,791 INFO] Step 46500/100000; acc:  98.07; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1138 tok/s;  48831 sec
[2019-11-05 11:59:17,880 INFO] Step 47000/100000; acc:  98.06; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1159 tok/s;  49336 sec
[2019-11-05 12:08:01,265 INFO] Step 47500/100000; acc:  98.11; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1125 tok/s;  49860 sec
[2019-11-05 12:16:26,040 INFO] Step 48000/100000; acc:  98.10; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1158 tok/s;  50365 sec
[2019-11-05 12:25:00,779 INFO] Step 48500/100000; acc:  98.10; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1140 tok/s;  50879 sec
[2019-11-05 12:33:37,115 INFO] Step 49000/100000; acc:  98.06; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1136 tok/s;  51396 sec
[2019-11-05 12:42:01,491 INFO] Step 49500/100000; acc:  98.12; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1155 tok/s;  51900 sec
[2019-11-05 12:50:44,127 INFO] Step 50000/100000; acc:  98.10; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/1129 tok/s;  52423 sec
[2019-11-05 12:55:29,329 INFO] Validation perplexity: 1.08507
[2019-11-05 12:55:29,329 INFO] Validation accuracy: 97.9395
[2019-11-05 12:55:29,332 INFO] Saving checkpoint ../results/models/im2latex-47_step_50000.pt
[2019-11-05 13:03:53,643 INFO] Step 50500/100000; acc:  98.26; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/738 tok/s;  53212 sec
[2019-11-05 13:12:23,605 INFO] Step 51000/100000; acc:  98.33; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1149 tok/s;  53722 sec
[2019-11-05 13:20:55,604 INFO] Step 51500/100000; acc:  98.35; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1154 tok/s;  54234 sec
[2019-11-05 13:29:19,446 INFO] Step 52000/100000; acc:  98.39; ppl:  1.06; xent: 0.05; lr: 0.05000;   0/1156 tok/s;  54738 sec
[2019-11-05 13:37:58,252 INFO] Step 52500/100000; acc:  98.41; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1129 tok/s;  55257 sec
[2019-11-05 13:46:26,793 INFO] Step 53000/100000; acc:  98.40; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1153 tok/s;  55765 sec
[2019-11-05 13:55:02,267 INFO] Step 53500/100000; acc:  98.48; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1135 tok/s;  56281 sec
[2019-11-05 14:03:43,987 INFO] Step 54000/100000; acc:  98.45; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1125 tok/s;  56803 sec
[2019-11-05 14:12:04,026 INFO] Step 54500/100000; acc:  98.45; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1166 tok/s;  57303 sec
[2019-11-05 14:20:33,909 INFO] Step 55000/100000; acc:  98.46; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1148 tok/s;  57813 sec
[2019-11-05 14:29:07,812 INFO] Step 55500/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1144 tok/s;  58326 sec
[2019-11-05 14:37:39,604 INFO] Step 56000/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1145 tok/s;  58838 sec
[2019-11-05 14:46:14,573 INFO] Step 56500/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1141 tok/s;  59353 sec
[2019-11-05 14:54:40,029 INFO] Step 57000/100000; acc:  98.53; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1153 tok/s;  59859 sec
[2019-11-05 15:03:19,242 INFO] Step 57500/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1136 tok/s;  60378 sec
[2019-11-05 15:11:48,745 INFO] Step 58000/100000; acc:  98.53; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1144 tok/s;  60887 sec
[2019-11-05 15:20:09,887 INFO] Step 58500/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1165 tok/s;  61388 sec
[2019-11-05 15:28:49,722 INFO] Step 59000/100000; acc:  98.53; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1135 tok/s;  61908 sec
[2019-11-05 15:37:14,135 INFO] Step 59500/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1155 tok/s;  62413 sec
[2019-11-05 15:45:52,050 INFO] Step 60000/100000; acc:  98.57; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1136 tok/s;  62931 sec
[2019-11-05 15:50:40,380 INFO] Validation perplexity: 1.07744
[2019-11-05 15:50:40,383 INFO] Validation accuracy: 98.15
[2019-11-05 15:50:40,386 INFO] Saving checkpoint ../results/models/im2latex-47_step_60000.pt
[2019-11-05 15:59:12,402 INFO] Step 60500/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/733 tok/s;  63731 sec
[2019-11-05 16:07:41,119 INFO] Step 61000/100000; acc:  98.62; ppl:  1.05; xent: 0.04; lr: 0.02500;   0/1145 tok/s;  64240 sec
[2019-11-05 16:16:28,340 INFO] Step 61500/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1119 tok/s;  64767 sec
[2019-11-05 16:24:51,563 INFO] Step 62000/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1155 tok/s;  65270 sec
[2019-11-05 16:33:22,518 INFO] Step 62500/100000; acc:  98.65; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1150 tok/s;  65781 sec
[2019-11-05 16:41:53,174 INFO] Step 63000/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1154 tok/s;  66292 sec
[2019-11-05 16:50:25,843 INFO] Step 63500/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1137 tok/s;  66804 sec
[2019-11-05 16:59:08,449 INFO] Step 64000/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1119 tok/s;  67327 sec
[2019-11-05 17:07:39,463 INFO] Step 64500/100000; acc:  98.64; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1147 tok/s;  67838 sec
[2019-11-05 17:16:32,294 INFO] Step 65000/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1101 tok/s;  68371 sec
[2019-11-05 17:25:32,773 INFO] Step 65500/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1083 tok/s;  68911 sec
[2019-11-05 17:33:56,834 INFO] Step 66000/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1160 tok/s;  69415 sec
[2019-11-05 17:42:32,808 INFO] Step 66500/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1135 tok/s;  69931 sec
[2019-11-05 17:51:08,498 INFO] Step 67000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1137 tok/s;  70447 sec
[2019-11-05 17:59:49,156 INFO] Step 67500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1128 tok/s;  70968 sec
[2019-11-05 18:08:22,887 INFO] Step 68000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1139 tok/s;  71481 sec
[2019-11-05 18:16:55,479 INFO] Step 68500/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1137 tok/s;  71994 sec
[2019-11-05 18:25:34,675 INFO] Step 69000/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1138 tok/s;  72513 sec
[2019-11-05 18:34:05,901 INFO] Step 69500/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1140 tok/s;  73024 sec
[2019-11-05 18:42:31,899 INFO] Step 70000/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1156 tok/s;  73530 sec
[2019-11-05 18:47:16,721 INFO] Validation perplexity: 1.07522
[2019-11-05 18:47:16,721 INFO] Validation accuracy: 98.2183
[2019-11-05 18:47:16,724 INFO] Saving checkpoint ../results/models/im2latex-47_step_70000.pt
[2019-11-05 18:55:54,203 INFO] Step 70500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/736 tok/s;  74333 sec
[2019-11-05 19:04:22,129 INFO] Step 71000/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1148 tok/s;  74841 sec
[2019-11-05 19:12:57,839 INFO] Step 71500/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1138 tok/s;  75356 sec
[2019-11-05 19:21:33,112 INFO] Step 72000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1138 tok/s;  75872 sec
[2019-11-05 19:30:00,840 INFO] Step 72500/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1147 tok/s;  76379 sec
[2019-11-05 19:38:49,332 INFO] Step 73000/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1114 tok/s;  76908 sec
[2019-11-05 19:47:13,701 INFO] Step 73500/100000; acc:  98.80; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1152 tok/s;  77412 sec
[2019-11-05 19:55:47,751 INFO] Step 74000/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1146 tok/s;  77926 sec
[2019-11-05 20:04:23,368 INFO] Step 74500/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1141 tok/s;  78442 sec
[2019-11-05 20:12:56,866 INFO] Step 75000/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1138 tok/s;  78955 sec
[2019-11-05 20:21:33,397 INFO] Step 75500/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1134 tok/s;  79472 sec
[2019-11-05 20:30:02,282 INFO] Step 76000/100000; acc:  98.79; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1150 tok/s;  79981 sec
[2019-11-05 20:38:41,632 INFO] Step 76500/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1130 tok/s;  80500 sec
[2019-11-05 20:47:14,123 INFO] Step 77000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1141 tok/s;  81013 sec
[2019-11-05 20:55:38,493 INFO] Step 77500/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1162 tok/s;  81517 sec
[2019-11-05 21:04:16,039 INFO] Step 78000/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1133 tok/s;  82035 sec
[2019-11-05 21:12:43,739 INFO] Step 78500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1153 tok/s;  82542 sec
[2019-11-05 21:21:25,185 INFO] Step 79000/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1124 tok/s;  83064 sec
[2019-11-05 21:30:01,021 INFO] Step 79500/100000; acc:  98.80; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1137 tok/s;  83580 sec
[2019-11-05 21:38:31,104 INFO] Step 80000/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1142 tok/s;  84090 sec
[2019-11-05 21:43:19,733 INFO] Validation perplexity: 1.07511
[2019-11-05 21:43:19,734 INFO] Validation accuracy: 98.2386
[2019-11-05 21:43:19,737 INFO] Saving checkpoint ../results/models/im2latex-47_step_80000.pt
[2019-11-05 21:52:02,077 INFO] Step 80500/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/728 tok/s;  84901 sec
[2019-11-05 22:00:34,607 INFO] Step 81000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1137 tok/s;  85413 sec
[2019-11-05 22:09:03,899 INFO] Step 81500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1146 tok/s;  85922 sec
[2019-11-05 22:17:41,136 INFO] Step 82000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1143 tok/s;  86440 sec
[2019-11-05 22:26:08,469 INFO] Step 82500/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1149 tok/s;  86947 sec
[2019-11-05 22:34:42,663 INFO] Step 83000/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1139 tok/s;  87461 sec
[2019-11-05 22:43:13,171 INFO] Step 83500/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1148 tok/s;  87972 sec
[2019-11-05 22:51:42,201 INFO] Step 84000/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1147 tok/s;  88481 sec
[2019-11-05 23:00:27,712 INFO] Step 84500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1120 tok/s;  89006 sec
[2019-11-05 23:08:45,932 INFO] Step 85000/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1167 tok/s;  89505 sec
[2019-11-05 23:17:24,883 INFO] Step 85500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1134 tok/s;  90023 sec
[2019-11-05 23:25:56,449 INFO] Step 86000/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1151 tok/s;  90535 sec
[2019-11-05 23:34:33,921 INFO] Step 86500/100000; acc:  98.89; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1130 tok/s;  91053 sec
[2019-11-05 23:43:15,228 INFO] Step 87000/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1126 tok/s;  91574 sec
[2019-11-05 23:51:40,794 INFO] Step 87500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1154 tok/s;  92079 sec
[2019-11-06 00:00:24,833 INFO] Step 88000/100000; acc:  98.87; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1124 tok/s;  92603 sec
[2019-11-06 00:09:00,154 INFO] Step 88500/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1132 tok/s;  93119 sec
[2019-11-06 00:17:23,930 INFO] Step 89000/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1160 tok/s;  93623 sec
[2019-11-06 00:26:00,987 INFO] Step 89500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1138 tok/s;  94140 sec
[2019-11-06 00:34:27,817 INFO] Step 90000/100000; acc:  98.87; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1153 tok/s;  94646 sec
[2019-11-06 00:39:12,746 INFO] Validation perplexity: 1.07533
[2019-11-06 00:39:12,746 INFO] Validation accuracy: 98.2515
[2019-11-06 00:39:12,750 INFO] Saving checkpoint ../results/models/im2latex-47_step_90000.pt
[2019-11-06 00:47:47,662 INFO] Step 90500/100000; acc:  98.87; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/734 tok/s;  95446 sec
[2019-11-06 00:56:18,577 INFO] Step 91000/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1148 tok/s;  95957 sec
[2019-11-06 01:04:46,263 INFO] Step 91500/100000; acc:  98.87; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1147 tok/s;  96465 sec
[2019-11-06 01:13:33,011 INFO] Step 92000/100000; acc:  98.89; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1120 tok/s;  96992 sec
[2019-11-06 01:21:58,454 INFO] Step 92500/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1153 tok/s;  97497 sec
[2019-11-06 01:30:32,433 INFO] Step 93000/100000; acc:  98.90; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1141 tok/s;  98011 sec
[2019-11-06 01:39:10,661 INFO] Step 93500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1138 tok/s;  98529 sec
[2019-11-06 01:47:35,543 INFO] Step 94000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1153 tok/s;  99034 sec
[2019-11-06 01:56:16,162 INFO] Step 94500/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1125 tok/s;  99555 sec
[2019-11-06 02:04:50,962 INFO] Step 95000/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1137 tok/s; 100070 sec
[2019-11-06 02:13:23,533 INFO] Step 95500/100000; acc:  98.89; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1143 tok/s; 100582 sec
[2019-11-06 02:22:03,551 INFO] Step 96000/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1128 tok/s; 101102 sec
[2019-11-06 02:30:22,388 INFO] Step 96500/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1168 tok/s; 101601 sec
[2019-11-06 02:38:58,425 INFO] Step 97000/100000; acc:  98.87; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1139 tok/s; 102117 sec
[2019-11-06 02:47:27,209 INFO] Step 97500/100000; acc:  98.89; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1154 tok/s; 102626 sec
[2019-11-06 02:56:03,421 INFO] Step 98000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1137 tok/s; 103142 sec
[2019-11-06 03:04:36,628 INFO] Step 98500/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1145 tok/s; 103655 sec
[2019-11-06 03:13:09,845 INFO] Step 99000/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1134 tok/s; 104168 sec
[2019-11-06 03:21:53,707 INFO] Step 99500/100000; acc:  98.89; ppl:  1.04; xent: 0.04; lr: 0.00313;   0/1126 tok/s; 104692 sec
[2019-11-06 03:30:23,017 INFO] Step 100000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00156;   0/1145 tok/s; 105202 sec
[2019-11-06 03:35:12,101 INFO] Validation perplexity: 1.07549
[2019-11-06 03:35:12,102 INFO] Validation accuracy: 98.2545
[2019-11-06 03:35:12,105 INFO] Saving checkpoint ../results/models/im2latex-47_step_100000.pt
