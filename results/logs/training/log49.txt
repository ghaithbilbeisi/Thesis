[2019-11-18 14:47:08,206 INFO]  * tgt vocab size = 510
[2019-11-18 14:47:08,207 INFO] Building model...
[2019-11-18 14:47:17,412 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds1): Downsample(
      (pad): ReflectionPad2d([2, 2, 2, 2])
    )
    (layer2): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds2): Downsample(
      (pad): ReflectionPad2d([2, 2, 2, 2])
    )
    (layer3): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds3): Downsample(
      (pad): ReflectionPad2d([2, 2, 2, 2])
    )
    (layer4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds4): Downsample(
      (pad): ReflectionPad2d([2, 2, 2, 2])
    )
    (layer5): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds5): Downsample(
      (pad): ReflectionPad2d([2, 2, 2, 2])
    )
    (layer6): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (ds6): Downsample(
      (pad): ReflectionPad2d([2, 2, 2, 2])
    )
    (batch_norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(512, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 512)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-11-18 14:47:17,422 INFO] encoder: 8047424
[2019-11-18 14:47:17,422 INFO] decoder: 5214310
[2019-11-18 14:47:17,422 INFO] * number of parameters: 13261734
[2019-11-18 14:47:17,887 INFO] Starting training on GPU: [0]
[2019-11-18 14:47:17,887 INFO] Start training loop and validate every 10000 steps...
[2019-11-18 14:55:16,535 INFO] Step 500/100000; acc:  28.89; ppl: 38.52; xent: 3.65; lr: 0.10000;   0/1229 tok/s;    479 sec
[2019-11-18 15:03:14,860 INFO] Step 1000/100000; acc:  44.55; ppl: 13.47; xent: 2.60; lr: 0.10000;   0/1215 tok/s;    957 sec
[2019-11-18 15:11:46,872 INFO] Step 1500/100000; acc:  48.52; ppl: 10.39; xent: 2.34; lr: 0.10000;   0/1150 tok/s;   1469 sec
[2019-11-18 15:20:48,688 INFO] Step 2000/100000; acc:  54.22; ppl:  7.47; xent: 2.01; lr: 0.10000;   0/1085 tok/s;   2011 sec
[2019-11-18 15:29:59,012 INFO] Step 2500/100000; acc:  69.55; ppl:  3.62; xent: 1.29; lr: 0.10000;   0/1062 tok/s;   2561 sec
[2019-11-18 15:39:11,429 INFO] Step 3000/100000; acc:  80.55; ppl:  2.26; xent: 0.82; lr: 0.10000;   0/1062 tok/s;   3114 sec
[2019-11-18 15:48:11,562 INFO] Step 3500/100000; acc:  85.54; ppl:  1.83; xent: 0.61; lr: 0.10000;   0/1082 tok/s;   3654 sec
[2019-11-18 15:57:21,058 INFO] Step 4000/100000; acc:  87.94; ppl:  1.65; xent: 0.50; lr: 0.10000;   0/1069 tok/s;   4203 sec
[2019-11-18 16:06:43,886 INFO] Step 4500/100000; acc:  89.33; ppl:  1.55; xent: 0.44; lr: 0.10000;   0/1038 tok/s;   4766 sec
[2019-11-18 16:15:53,173 INFO] Step 5000/100000; acc:  90.65; ppl:  1.47; xent: 0.39; lr: 0.10000;   0/1067 tok/s;   5315 sec
[2019-11-18 16:25:16,156 INFO] Step 5500/100000; acc:  91.58; ppl:  1.41; xent: 0.35; lr: 0.10000;   0/1041 tok/s;   5878 sec
[2019-11-18 16:34:30,889 INFO] Step 6000/100000; acc:  92.32; ppl:  1.37; xent: 0.31; lr: 0.10000;   0/1054 tok/s;   6433 sec
[2019-11-18 16:43:07,498 INFO] Step 6500/100000; acc:  92.75; ppl:  1.34; xent: 0.30; lr: 0.10000;   0/1134 tok/s;   6950 sec
[2019-11-18 16:51:30,434 INFO] Step 7000/100000; acc:  93.22; ppl:  1.32; xent: 0.27; lr: 0.10000;   0/1167 tok/s;   7453 sec
[2019-11-18 17:00:44,570 INFO] Step 7500/100000; acc:  93.74; ppl:  1.29; xent: 0.25; lr: 0.10000;   0/1052 tok/s;   8007 sec
[2019-11-18 17:10:30,399 INFO] Step 8000/100000; acc:  93.98; ppl:  1.28; xent: 0.24; lr: 0.10000;   0/1007 tok/s;   8593 sec
[2019-11-18 17:20:19,480 INFO] Step 8500/100000; acc:  94.43; ppl:  1.25; xent: 0.22; lr: 0.10000;   0/990 tok/s;   9182 sec
[2019-11-18 17:29:52,287 INFO] Step 9000/100000; acc:  94.73; ppl:  1.23; xent: 0.21; lr: 0.10000;   0/1021 tok/s;   9754 sec
[2019-11-18 17:39:36,389 INFO] Step 9500/100000; acc:  94.90; ppl:  1.23; xent: 0.20; lr: 0.10000;   0/1014 tok/s;  10339 sec
[2019-11-18 17:49:21,948 INFO] Step 10000/100000; acc:  95.05; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/994 tok/s;  10924 sec
[2019-11-18 17:54:19,042 INFO] Validation perplexity: 1.19732
[2019-11-18 17:54:19,043 INFO] Validation accuracy: 95.4499
[2019-11-18 17:54:19,053 INFO] Saving checkpoint ../results/models/im2latex-49_step_10000.pt
[2019-11-18 18:03:51,926 INFO] Step 10500/100000; acc:  95.16; ppl:  1.21; xent: 0.19; lr: 0.10000;   0/673 tok/s;  11794 sec
[2019-11-18 18:13:28,079 INFO] Step 11000/100000; acc:  95.31; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/1018 tok/s;  12370 sec
[2019-11-18 18:22:51,979 INFO] Step 11500/100000; acc:  95.49; ppl:  1.19; xent: 0.18; lr: 0.10000;   0/1036 tok/s;  12934 sec
[2019-11-18 18:32:24,401 INFO] Step 12000/100000; acc:  95.54; ppl:  1.19; xent: 0.17; lr: 0.10000;   0/1026 tok/s;  13507 sec
[2019-11-18 18:41:44,833 INFO] Step 12500/100000; acc:  95.78; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/1040 tok/s;  14067 sec
[2019-11-18 18:51:09,783 INFO] Step 13000/100000; acc:  95.89; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/1040 tok/s;  14632 sec
[2019-11-18 18:59:56,140 INFO] Step 13500/100000; acc:  96.01; ppl:  1.17; xent: 0.15; lr: 0.10000;   0/1118 tok/s;  15158 sec
[2019-11-18 19:10:04,765 INFO] Step 14000/100000; acc:  95.99; ppl:  1.17; xent: 0.15; lr: 0.10000;   0/962 tok/s;  15767 sec
[2019-11-18 19:20:15,771 INFO] Step 14500/100000; acc:  96.01; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/961 tok/s;  16378 sec
[2019-11-18 19:30:08,503 INFO] Step 15000/100000; acc:  96.19; ppl:  1.16; xent: 0.14; lr: 0.10000;   0/984 tok/s;  16971 sec
[2019-11-18 19:39:25,799 INFO] Step 15500/100000; acc:  96.23; ppl:  1.16; xent: 0.14; lr: 0.10000;   0/1058 tok/s;  17528 sec
[2019-11-18 19:49:14,721 INFO] Step 16000/100000; acc:  96.34; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/989 tok/s;  18117 sec
[2019-11-18 19:59:14,254 INFO] Step 16500/100000; acc:  96.42; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/973 tok/s;  18716 sec
[2019-11-18 20:09:06,893 INFO] Step 17000/100000; acc:  96.54; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/993 tok/s;  19309 sec
[2019-11-18 20:18:54,674 INFO] Step 17500/100000; acc:  96.52; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/992 tok/s;  19897 sec
[2019-11-18 20:28:47,085 INFO] Step 18000/100000; acc:  96.56; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/992 tok/s;  20489 sec
[2019-11-18 20:38:20,841 INFO] Step 18500/100000; acc:  96.55; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1023 tok/s;  21063 sec
[2019-11-18 20:47:24,834 INFO] Step 19000/100000; acc:  96.63; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1070 tok/s;  21607 sec
[2019-11-18 20:57:35,824 INFO] Step 19500/100000; acc:  96.60; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/966 tok/s;  22218 sec
[2019-11-18 21:08:09,999 INFO] Step 20000/100000; acc:  96.83; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/917 tok/s;  22852 sec
[2019-11-18 21:12:09,854 INFO] Validation perplexity: 1.12565
[2019-11-18 21:12:09,855 INFO] Validation accuracy: 96.9459
[2019-11-18 21:12:09,860 INFO] Saving checkpoint ../results/models/im2latex-49_step_20000.pt
[2019-11-18 21:20:16,106 INFO] Step 20500/100000; acc:  96.84; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/809 tok/s;  23578 sec
[2019-11-18 21:28:17,563 INFO] Step 21000/100000; acc:  96.91; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1224 tok/s;  24060 sec
[2019-11-18 21:36:12,435 INFO] Step 21500/100000; acc:  96.92; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1228 tok/s;  24535 sec
[2019-11-18 21:44:04,120 INFO] Step 22000/100000; acc:  96.87; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/1240 tok/s;  25006 sec
[2019-11-18 21:51:49,481 INFO] Step 22500/100000; acc:  96.93; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1260 tok/s;  25472 sec
[2019-11-18 21:59:39,181 INFO] Step 23000/100000; acc:  97.02; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1250 tok/s;  25941 sec
[2019-11-18 22:07:15,362 INFO] Step 23500/100000; acc:  97.04; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1283 tok/s;  26397 sec
[2019-11-18 22:14:58,186 INFO] Step 24000/100000; acc:  97.03; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1261 tok/s;  26860 sec
[2019-11-18 22:22:35,989 INFO] Step 24500/100000; acc:  97.13; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1282 tok/s;  27318 sec
[2019-11-18 22:29:27,053 INFO] Step 25000/100000; acc:  97.20; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1426 tok/s;  27729 sec
[2019-11-18 22:37:00,444 INFO] Step 25500/100000; acc:  97.16; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1296 tok/s;  28183 sec
[2019-11-18 22:44:08,931 INFO] Step 26000/100000; acc:  97.14; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1370 tok/s;  28611 sec
[2019-11-18 22:50:47,190 INFO] Step 26500/100000; acc:  97.23; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1461 tok/s;  29009 sec
[2019-11-18 22:57:23,439 INFO] Step 27000/100000; acc:  97.15; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1488 tok/s;  29406 sec
[2019-11-18 23:04:24,125 INFO] Step 27500/100000; acc:  97.29; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1385 tok/s;  29826 sec
[2019-11-18 23:09:10,587 INFO] Step 28000/100000; acc:  97.27; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/2046 tok/s;  30113 sec
[2019-11-18 23:15:39,413 INFO] Step 28500/100000; acc:  97.41; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1514 tok/s;  30502 sec
[2019-11-18 23:22:18,734 INFO] Step 29000/100000; acc:  97.35; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1459 tok/s;  30901 sec
[2019-11-18 23:28:44,159 INFO] Step 29500/100000; acc:  97.37; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1526 tok/s;  31286 sec
[2019-11-18 23:34:57,482 INFO] Step 30000/100000; acc:  97.34; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1569 tok/s;  31660 sec
[2019-11-18 23:37:58,336 INFO] Validation perplexity: 1.1195
[2019-11-18 23:37:58,345 INFO] Validation accuracy: 97.0327
[2019-11-18 23:37:58,356 INFO] Saving checkpoint ../results/models/im2latex-49_step_30000.pt
[2019-11-18 23:44:11,674 INFO] Step 30500/100000; acc:  97.40; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1051 tok/s;  32214 sec
[2019-11-18 23:50:15,212 INFO] Step 31000/100000; acc:  97.37; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1623 tok/s;  32577 sec
[2019-11-18 23:55:24,262 INFO] Step 31500/100000; acc:  97.46; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1879 tok/s;  32886 sec
[2019-11-19 00:02:07,874 INFO] Step 32000/100000; acc:  97.47; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1457 tok/s;  33290 sec
[2019-11-19 00:10:29,900 INFO] Step 32500/100000; acc:  97.47; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1172 tok/s;  33792 sec
[2019-11-19 00:18:51,733 INFO] Step 33000/100000; acc:  97.52; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1163 tok/s;  34294 sec
[2019-11-19 00:26:46,085 INFO] Step 33500/100000; acc:  97.50; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1234 tok/s;  34768 sec
[2019-11-19 00:35:13,007 INFO] Step 34000/100000; acc:  97.50; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1154 tok/s;  35275 sec
[2019-11-19 00:43:13,361 INFO] Step 34500/100000; acc:  97.55; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1222 tok/s;  35755 sec
[2019-11-19 00:51:07,487 INFO] Step 35000/100000; acc:  97.55; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1234 tok/s;  36230 sec
[2019-11-19 00:59:05,519 INFO] Step 35500/100000; acc:  97.57; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1226 tok/s;  36708 sec
[2019-11-19 01:06:52,520 INFO] Step 36000/100000; acc:  97.62; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1259 tok/s;  37175 sec
[2019-11-19 01:14:31,177 INFO] Step 36500/100000; acc:  97.65; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1276 tok/s;  37633 sec
[2019-11-19 01:22:25,468 INFO] Step 37000/100000; acc:  97.60; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1237 tok/s;  38108 sec
[2019-11-19 01:30:26,474 INFO] Step 37500/100000; acc:  97.60; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1218 tok/s;  38589 sec
[2019-11-19 01:38:01,739 INFO] Step 38000/100000; acc:  97.66; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1282 tok/s;  39044 sec
[2019-11-19 01:45:47,224 INFO] Step 38500/100000; acc:  97.58; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1269 tok/s;  39509 sec
[2019-11-19 01:53:27,583 INFO] Step 39000/100000; acc:  97.72; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1266 tok/s;  39970 sec
[2019-11-19 02:00:23,866 INFO] Step 39500/100000; acc:  97.70; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1403 tok/s;  40386 sec
[2019-11-19 02:06:12,978 INFO] Step 40000/100000; acc:  97.72; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1691 tok/s;  40735 sec
[2019-11-19 02:09:32,453 INFO] Validation perplexity: 1.11318
[2019-11-19 02:09:32,454 INFO] Validation accuracy: 97.2472
[2019-11-19 02:09:32,461 INFO] Saving checkpoint ../results/models/im2latex-49_step_40000.pt
[2019-11-19 02:16:07,350 INFO] Step 40500/100000; acc:  97.75; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/980 tok/s;  41329 sec
[2019-11-19 02:22:32,593 INFO] Step 41000/100000; acc:  97.75; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1524 tok/s;  41715 sec
[2019-11-19 02:28:49,592 INFO] Step 41500/100000; acc:  97.70; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1554 tok/s;  42092 sec
[2019-11-19 02:34:45,921 INFO] Step 42000/100000; acc:  97.73; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1637 tok/s;  42448 sec
[2019-11-19 02:41:09,509 INFO] Step 42500/100000; acc:  97.78; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1536 tok/s;  42832 sec
[2019-11-19 02:47:13,221 INFO] Step 43000/100000; acc:  97.78; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1598 tok/s;  43195 sec
[2019-11-19 02:53:19,973 INFO] Step 43500/100000; acc:  97.81; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1598 tok/s;  43562 sec
[2019-11-19 02:59:20,127 INFO] Step 44000/100000; acc:  97.89; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1637 tok/s;  43922 sec
[2019-11-19 03:05:02,458 INFO] Step 44500/100000; acc:  97.85; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1708 tok/s;  44265 sec
[2019-11-19 03:10:43,276 INFO] Step 45000/100000; acc:  97.80; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1721 tok/s;  44605 sec
[2019-11-19 03:16:24,333 INFO] Step 45500/100000; acc:  97.84; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1713 tok/s;  44946 sec
[2019-11-19 03:22:05,491 INFO] Step 46000/100000; acc:  97.86; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1724 tok/s;  45288 sec
[2019-11-19 03:27:46,488 INFO] Step 46500/100000; acc:  97.89; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1712 tok/s;  45629 sec
[2019-11-19 03:33:28,251 INFO] Step 47000/100000; acc:  97.87; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1712 tok/s;  45970 sec
[2019-11-19 03:39:06,984 INFO] Step 47500/100000; acc:  97.91; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1737 tok/s;  46309 sec
[2019-11-19 03:44:54,837 INFO] Step 48000/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1681 tok/s;  46657 sec
[2019-11-19 03:51:47,689 INFO] Step 48500/100000; acc:  97.92; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1421 tok/s;  47070 sec
[2019-11-19 03:58:30,891 INFO] Step 49000/100000; acc:  97.89; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1454 tok/s;  47473 sec
[2019-11-19 04:04:55,099 INFO] Step 49500/100000; acc:  97.97; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1516 tok/s;  47857 sec
[2019-11-19 04:11:41,331 INFO] Step 50000/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.05000;   0/1452 tok/s;  48263 sec
[2019-11-19 04:14:57,928 INFO] Validation perplexity: 1.10098
[2019-11-19 04:14:57,930 INFO] Validation accuracy: 97.4915
[2019-11-19 04:14:57,933 INFO] Saving checkpoint ../results/models/im2latex-49_step_50000.pt
[2019-11-19 04:21:44,082 INFO] Step 50500/100000; acc:  98.15; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/966 tok/s;  48866 sec
[2019-11-19 04:28:59,551 INFO] Step 51000/100000; acc:  98.21; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1346 tok/s;  49302 sec
[2019-11-19 04:36:20,808 INFO] Step 51500/100000; acc:  98.29; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1339 tok/s;  49743 sec
[2019-11-19 04:43:23,811 INFO] Step 52000/100000; acc:  98.30; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1376 tok/s;  50166 sec
[2019-11-19 04:50:39,516 INFO] Step 52500/100000; acc:  98.30; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/1345 tok/s;  50602 sec
[2019-11-19 04:57:39,424 INFO] Step 53000/100000; acc:  98.36; ppl:  1.06; xent: 0.05; lr: 0.05000;   0/1396 tok/s;  51022 sec
[2019-11-19 05:04:58,532 INFO] Step 53500/100000; acc:  98.42; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1332 tok/s;  51461 sec
[2019-11-19 05:11:59,089 INFO] Step 54000/100000; acc:  98.40; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1397 tok/s;  51881 sec
[2019-11-19 05:19:39,215 INFO] Step 54500/100000; acc:  98.36; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1266 tok/s;  52341 sec
[2019-11-19 05:28:21,455 INFO] Step 55000/100000; acc:  98.40; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1121 tok/s;  52864 sec
[2019-11-19 05:37:06,901 INFO] Step 55500/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1119 tok/s;  53389 sec
[2019-11-19 05:45:46,795 INFO] Step 56000/100000; acc:  98.42; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1128 tok/s;  53909 sec
[2019-11-19 05:54:41,039 INFO] Step 56500/100000; acc:  98.45; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1099 tok/s;  54443 sec
[2019-11-19 06:03:21,276 INFO] Step 57000/100000; acc:  98.46; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1120 tok/s;  54963 sec
[2019-11-19 06:12:02,534 INFO] Step 57500/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1132 tok/s;  55485 sec
[2019-11-19 06:20:38,678 INFO] Step 58000/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1129 tok/s;  56001 sec
[2019-11-19 06:29:19,285 INFO] Step 58500/100000; acc:  98.45; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1121 tok/s;  56521 sec
[2019-11-19 06:38:59,718 INFO] Step 59000/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1019 tok/s;  57102 sec
[2019-11-19 06:48:25,447 INFO] Step 59500/100000; acc:  98.51; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1030 tok/s;  57668 sec
[2019-11-19 06:58:03,815 INFO] Step 60000/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1017 tok/s;  58246 sec
[2019-11-19 07:03:04,497 INFO] Validation perplexity: 1.09103
[2019-11-19 07:03:04,498 INFO] Validation accuracy: 97.856
[2019-11-19 07:03:04,510 INFO] Saving checkpoint ../results/models/im2latex-49_step_60000.pt
[2019-11-19 07:13:17,022 INFO] Step 60500/100000; acc:  98.53; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/642 tok/s;  59159 sec
[2019-11-19 07:23:12,656 INFO] Step 61000/100000; acc:  98.60; ppl:  1.05; xent: 0.04; lr: 0.02500;   0/978 tok/s;  59755 sec
[2019-11-19 07:33:34,662 INFO] Step 61500/100000; acc:  98.62; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/948 tok/s;  60377 sec
[2019-11-19 07:43:44,447 INFO] Step 62000/100000; acc:  98.62; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/954 tok/s;  60987 sec
[2019-11-19 07:53:54,192 INFO] Step 62500/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/963 tok/s;  61596 sec
[2019-11-19 08:04:07,517 INFO] Step 63000/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/958 tok/s;  62210 sec
[2019-11-19 08:14:19,158 INFO] Step 63500/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/954 tok/s;  62821 sec
[2019-11-19 08:24:20,184 INFO] Step 64000/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/973 tok/s;  63422 sec
[2019-11-19 08:34:35,917 INFO] Step 64500/100000; acc:  98.63; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/953 tok/s;  64038 sec
[2019-11-19 08:44:44,526 INFO] Step 65000/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/963 tok/s;  64647 sec
[2019-11-19 08:54:40,492 INFO] Step 65500/100000; acc:  98.68; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/982 tok/s;  65243 sec
[2019-11-19 09:04:48,892 INFO] Step 66000/100000; acc:  98.69; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/960 tok/s;  65851 sec
[2019-11-19 09:14:51,735 INFO] Step 66500/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/971 tok/s;  66454 sec
[2019-11-19 09:25:08,234 INFO] Step 67000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/951 tok/s;  67070 sec
[2019-11-19 09:34:49,011 INFO] Step 67500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1011 tok/s;  67651 sec
[2019-11-19 09:45:01,414 INFO] Step 68000/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/957 tok/s;  68264 sec
[2019-11-19 09:55:03,050 INFO] Step 68500/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/968 tok/s;  68865 sec
[2019-11-19 10:05:06,736 INFO] Step 69000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/978 tok/s;  69469 sec
[2019-11-19 10:15:10,957 INFO] Step 69500/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/964 tok/s;  70073 sec
[2019-11-19 10:25:20,311 INFO] Step 70000/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/962 tok/s;  70682 sec
[2019-11-19 10:30:43,319 INFO] Validation perplexity: 1.09003
[2019-11-19 10:30:43,320 INFO] Validation accuracy: 97.9644
[2019-11-19 10:30:43,330 INFO] Saving checkpoint ../results/models/im2latex-49_step_70000.pt
[2019-11-19 10:40:47,096 INFO] Step 70500/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/639 tok/s;  71609 sec
[2019-11-19 10:50:58,248 INFO] Step 71000/100000; acc:  98.80; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/954 tok/s;  72220 sec
[2019-11-19 11:01:14,706 INFO] Step 71500/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/952 tok/s;  72837 sec
[2019-11-19 11:11:06,396 INFO] Step 72000/100000; acc:  98.80; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/990 tok/s;  73429 sec
[2019-11-19 11:20:20,259 INFO] Step 72500/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1052 tok/s;  73982 sec
[2019-11-19 11:29:39,114 INFO] Step 73000/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1053 tok/s;  74541 sec
[2019-11-19 11:38:39,014 INFO] Step 73500/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1077 tok/s;  75081 sec
[2019-11-19 11:47:55,303 INFO] Step 74000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1058 tok/s;  75637 sec
[2019-11-19 11:57:09,400 INFO] Step 74500/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1059 tok/s;  76192 sec
[2019-11-19 12:06:15,532 INFO] Step 75000/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1070 tok/s;  76738 sec
[2019-11-19 12:15:31,637 INFO] Step 75500/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1053 tok/s;  77294 sec
[2019-11-19 12:24:40,414 INFO] Step 76000/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1065 tok/s;  77843 sec
[2019-11-19 12:33:53,037 INFO] Step 76500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1064 tok/s;  78395 sec
[2019-11-19 12:43:10,310 INFO] Step 77000/100000; acc:  98.86; ppl:  1.03; xent: 0.03; lr: 0.01250;   0/1049 tok/s;  78952 sec
[2019-11-19 12:51:40,976 INFO] Step 77500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1147 tok/s;  79463 sec
[2019-11-19 12:59:57,121 INFO] Step 78000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1179 tok/s;  79959 sec
[2019-11-19 13:08:21,178 INFO] Step 78500/100000; acc:  98.87; ppl:  1.04; xent: 0.03; lr: 0.01250;   0/1161 tok/s;  80463 sec
[2019-11-19 13:16:51,524 INFO] Step 79000/100000; acc:  98.87; ppl:  1.04; xent: 0.03; lr: 0.01250;   0/1148 tok/s;  80974 sec
[2019-11-19 13:25:11,593 INFO] Step 79500/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1173 tok/s;  81474 sec
[2019-11-19 13:33:40,276 INFO] Step 80000/100000; acc:  98.86; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1145 tok/s;  81982 sec
[2019-11-19 13:37:54,516 INFO] Validation perplexity: 1.09174
[2019-11-19 13:37:54,517 INFO] Validation accuracy: 97.9823
[2019-11-19 13:37:54,523 INFO] Saving checkpoint ../results/models/im2latex-49_step_80000.pt
[2019-11-19 13:46:10,984 INFO] Step 80500/100000; acc:  98.85; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/787 tok/s;  82733 sec
[2019-11-19 13:53:46,050 INFO] Step 81000/100000; acc:  98.87; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1280 tok/s;  83188 sec
[2019-11-19 14:01:26,400 INFO] Step 81500/100000; acc:  98.88; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1269 tok/s;  83649 sec
[2019-11-19 14:09:04,023 INFO] Step 82000/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1297 tok/s;  84106 sec
[2019-11-19 14:16:41,647 INFO] Step 82500/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1274 tok/s;  84564 sec
[2019-11-19 14:24:21,205 INFO] Step 83000/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1274 tok/s;  85023 sec
[2019-11-19 14:31:54,744 INFO] Step 83500/100000; acc:  98.87; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1292 tok/s;  85477 sec
[2019-11-19 14:39:31,206 INFO] Step 84000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1279 tok/s;  85933 sec
[2019-11-19 14:47:58,870 INFO] Step 84500/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1161 tok/s;  86441 sec
[2019-11-19 14:58:10,067 INFO] Step 85000/100000; acc:  98.87; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/951 tok/s;  87052 sec
[2019-11-19 15:08:26,185 INFO] Step 85500/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/953 tok/s;  87668 sec
[2019-11-19 15:17:41,260 INFO] Step 86000/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1062 tok/s;  88223 sec
[2019-11-19 15:25:24,225 INFO] Step 86500/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1263 tok/s;  88686 sec
[2019-11-19 15:33:08,709 INFO] Step 87000/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1263 tok/s;  89151 sec
[2019-11-19 15:40:53,985 INFO] Step 87500/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1256 tok/s;  89616 sec
[2019-11-19 15:48:50,841 INFO] Step 88000/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1235 tok/s;  90093 sec
[2019-11-19 15:56:51,269 INFO] Step 88500/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1214 tok/s;  90573 sec
[2019-11-19 16:04:01,711 INFO] Step 89000/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1359 tok/s;  91004 sec
[2019-11-19 16:10:31,551 INFO] Step 89500/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1506 tok/s;  91394 sec
[2019-11-19 16:17:01,452 INFO] Step 90000/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1498 tok/s;  91784 sec
[2019-11-19 16:19:59,173 INFO] Validation perplexity: 1.0918
[2019-11-19 16:19:59,174 INFO] Validation accuracy: 97.997
[2019-11-19 16:19:59,183 INFO] Saving checkpoint ../results/models/im2latex-49_step_90000.pt
[2019-11-19 16:26:17,260 INFO] Step 90500/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1056 tok/s;  92339 sec
[2019-11-19 16:32:53,873 INFO] Step 91000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1480 tok/s;  92736 sec
[2019-11-19 16:39:22,798 INFO] Step 91500/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1497 tok/s;  93125 sec
[2019-11-19 16:45:44,850 INFO] Step 92000/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1544 tok/s;  93507 sec
[2019-11-19 16:52:04,346 INFO] Step 92500/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1537 tok/s;  93886 sec
[2019-11-19 16:58:20,071 INFO] Step 93000/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1560 tok/s;  94262 sec
[2019-11-19 17:04:36,527 INFO] Step 93500/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1570 tok/s;  94639 sec
[2019-11-19 17:11:04,906 INFO] Step 94000/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1499 tok/s;  95027 sec
[2019-11-19 17:17:30,191 INFO] Step 94500/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1521 tok/s;  95412 sec
[2019-11-19 17:23:44,231 INFO] Step 95000/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1565 tok/s;  95786 sec
[2019-11-19 17:30:11,973 INFO] Step 95500/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1511 tok/s;  96174 sec
[2019-11-19 17:36:24,524 INFO] Step 96000/100000; acc:  98.96; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1574 tok/s;  96547 sec
[2019-11-19 17:42:31,192 INFO] Step 96500/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1589 tok/s;  96913 sec
[2019-11-19 17:48:54,502 INFO] Step 97000/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1535 tok/s;  97297 sec
[2019-11-19 17:55:11,445 INFO] Step 97500/100000; acc:  98.97; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1558 tok/s;  97674 sec
[2019-11-19 18:01:40,299 INFO] Step 98000/100000; acc:  98.98; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1508 tok/s;  98062 sec
[2019-11-19 18:07:54,765 INFO] Step 98500/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1569 tok/s;  98437 sec
[2019-11-19 18:14:13,472 INFO] Step 99000/100000; acc:  98.93; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1538 tok/s;  98816 sec
[2019-11-19 18:20:39,170 INFO] Step 99500/100000; acc:  98.95; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1530 tok/s;  99201 sec
[2019-11-19 18:27:01,004 INFO] Step 100000/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00156;   0/1526 tok/s;  99583 sec
[2019-11-19 18:30:09,894 INFO] Validation perplexity: 1.09231
[2019-11-19 18:30:09,897 INFO] Validation accuracy: 98.004
[2019-11-19 18:30:09,904 INFO] Saving checkpoint ../results/models/im2latex-49_step_100000.pt
