[2019-12-28 19:35:22,178 INFO]  * tgt vocab size = 510
[2019-12-28 19:35:22,178 INFO] Building model...
[2019-12-28 19:35:25,998 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer3): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer5): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer6): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer7): Conv2d(128, 128, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layer8): Conv2d(128, 256, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layer9): Conv2d(256, 256, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layer10): Conv2d(256, 256, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layerfinal): Conv2d(256, 256, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (batch_norm1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(256, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 256)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-12-28 19:35:25,999 INFO] encoder: 4316416
[2019-12-28 19:35:25,999 INFO] decoder: 5214310
[2019-12-28 19:35:25,999 INFO] * number of parameters: 9530726
[2019-12-28 19:35:26,607 INFO] Starting training on GPU: [0]
[2019-12-28 19:35:26,607 INFO] Start training loop and validate every 10000 steps...
[2019-12-28 19:45:06,929 INFO] Step 500/100000; acc:  29.21; ppl: 37.27; xent: 3.62; lr: 0.10000;   0/1014 tok/s;    580 sec
[2019-12-28 19:54:18,421 INFO] Step 1000/100000; acc:  44.73; ppl: 13.34; xent: 2.59; lr: 0.10000;   0/1054 tok/s;   1132 sec
[2019-12-28 20:03:48,328 INFO] Step 1500/100000; acc:  48.08; ppl: 10.60; xent: 2.36; lr: 0.10000;   0/1033 tok/s;   1702 sec
[2019-12-28 20:13:10,390 INFO] Step 2000/100000; acc:  50.87; ppl:  8.92; xent: 2.19; lr: 0.10000;   0/1043 tok/s;   2264 sec
[2019-12-28 20:22:37,071 INFO] Step 2500/100000; acc:  61.77; ppl:  5.07; xent: 1.62; lr: 0.10000;   0/1030 tok/s;   2830 sec
[2019-12-28 20:32:04,604 INFO] Step 3000/100000; acc:  81.03; ppl:  2.22; xent: 0.80; lr: 0.10000;   0/1034 tok/s;   3398 sec
[2019-12-28 20:41:20,730 INFO] Step 3500/100000; acc:  88.05; ppl:  1.66; xent: 0.51; lr: 0.10000;   0/1050 tok/s;   3954 sec
[2019-12-28 20:50:47,295 INFO] Step 4000/100000; acc:  90.40; ppl:  1.50; xent: 0.41; lr: 0.10000;   0/1038 tok/s;   4521 sec
[2019-12-28 21:00:05,505 INFO] Step 4500/100000; acc:  91.80; ppl:  1.41; xent: 0.34; lr: 0.10000;   0/1045 tok/s;   5079 sec
[2019-12-28 21:09:10,001 INFO] Step 5000/100000; acc:  92.83; ppl:  1.35; xent: 0.30; lr: 0.10000;   0/1075 tok/s;   5623 sec
[2019-12-28 21:18:35,786 INFO] Step 5500/100000; acc:  93.58; ppl:  1.31; xent: 0.27; lr: 0.10000;   0/1040 tok/s;   6189 sec
[2019-12-28 21:27:47,062 INFO] Step 6000/100000; acc:  94.07; ppl:  1.28; xent: 0.25; lr: 0.10000;   0/1061 tok/s;   6740 sec
[2019-12-28 21:37:09,290 INFO] Step 6500/100000; acc:  94.42; ppl:  1.26; xent: 0.23; lr: 0.10000;   0/1042 tok/s;   7303 sec
[2019-12-28 21:46:26,029 INFO] Step 7000/100000; acc:  94.73; ppl:  1.24; xent: 0.22; lr: 0.10000;   0/1055 tok/s;   7859 sec
[2019-12-28 21:55:39,457 INFO] Step 7500/100000; acc:  95.09; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/1052 tok/s;   8413 sec
[2019-12-28 22:05:06,547 INFO] Step 8000/100000; acc:  95.11; ppl:  1.22; xent: 0.20; lr: 0.10000;   0/1040 tok/s;   8980 sec
[2019-12-28 22:14:17,658 INFO] Step 8500/100000; acc:  95.44; ppl:  1.20; xent: 0.18; lr: 0.10000;   0/1058 tok/s;   9531 sec
[2019-12-28 22:23:27,969 INFO] Step 9000/100000; acc:  95.70; ppl:  1.19; xent: 0.18; lr: 0.10000;   0/1063 tok/s;  10081 sec
[2019-12-28 22:32:51,373 INFO] Step 9500/100000; acc:  95.85; ppl:  1.18; xent: 0.17; lr: 0.10000;   0/1052 tok/s;  10645 sec
[2019-12-28 22:42:00,374 INFO] Step 10000/100000; acc:  95.98; ppl:  1.18; xent: 0.16; lr: 0.10000;   0/1061 tok/s;  11194 sec
[2019-12-28 22:47:03,527 INFO] Validation perplexity: 1.1523
[2019-12-28 22:47:03,528 INFO] Validation accuracy: 96.4728
[2019-12-28 22:47:03,530 INFO] Saving checkpoint ../results/models/im2latex-64_step_10000.pt
[2019-12-28 22:56:24,590 INFO] Step 10500/100000; acc:  95.99; ppl:  1.17; xent: 0.16; lr: 0.10000;   0/678 tok/s;  12058 sec
[2019-12-28 23:05:43,486 INFO] Step 11000/100000; acc:  96.15; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/1050 tok/s;  12617 sec
[2019-12-28 23:14:57,470 INFO] Step 11500/100000; acc:  96.26; ppl:  1.16; xent: 0.15; lr: 0.10000;   0/1055 tok/s;  13171 sec
[2019-12-28 23:24:26,690 INFO] Step 12000/100000; acc:  96.34; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/1032 tok/s;  13740 sec
[2019-12-28 23:33:27,772 INFO] Step 12500/100000; acc:  96.49; ppl:  1.15; xent: 0.14; lr: 0.10000;   0/1077 tok/s;  14281 sec
[2019-12-28 23:42:43,526 INFO] Step 13000/100000; acc:  96.56; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1052 tok/s;  14837 sec
[2019-12-28 23:52:00,146 INFO] Step 13500/100000; acc:  96.65; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1058 tok/s;  15394 sec
[2019-12-29 00:01:19,019 INFO] Step 14000/100000; acc:  96.66; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1047 tok/s;  15952 sec
[2019-12-29 00:10:40,926 INFO] Step 14500/100000; acc:  96.61; ppl:  1.14; xent: 0.13; lr: 0.10000;   0/1046 tok/s;  16514 sec
[2019-12-29 00:19:51,838 INFO] Step 15000/100000; acc:  96.80; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1058 tok/s;  17065 sec
[2019-12-29 00:29:16,973 INFO] Step 15500/100000; acc:  96.71; ppl:  1.13; xent: 0.13; lr: 0.10000;   0/1044 tok/s;  17630 sec
[2019-12-29 00:38:31,957 INFO] Step 16000/100000; acc:  96.85; ppl:  1.13; xent: 0.12; lr: 0.10000;   0/1049 tok/s;  18185 sec
[2019-12-29 00:47:37,576 INFO] Step 16500/100000; acc:  96.98; ppl:  1.12; xent: 0.12; lr: 0.10000;   0/1071 tok/s;  18731 sec
[2019-12-29 00:56:59,990 INFO] Step 17000/100000; acc:  96.99; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1049 tok/s;  19293 sec
[2019-12-29 01:06:11,960 INFO] Step 17500/100000; acc:  97.06; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1056 tok/s;  19845 sec
[2019-12-29 01:15:33,669 INFO] Step 18000/100000; acc:  97.07; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1045 tok/s;  20407 sec
[2019-12-29 01:24:52,450 INFO] Step 18500/100000; acc:  97.05; ppl:  1.12; xent: 0.11; lr: 0.10000;   0/1051 tok/s;  20966 sec
[2019-12-29 01:34:02,090 INFO] Step 19000/100000; acc:  97.12; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1059 tok/s;  21515 sec
[2019-12-29 01:43:33,887 INFO] Step 19500/100000; acc:  97.12; ppl:  1.11; xent: 0.11; lr: 0.10000;   0/1032 tok/s;  22087 sec
[2019-12-29 01:52:38,953 INFO] Step 20000/100000; acc:  97.25; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1068 tok/s;  22632 sec
[2019-12-29 01:57:42,273 INFO] Validation perplexity: 1.10782
[2019-12-29 01:57:42,274 INFO] Validation accuracy: 97.3478
[2019-12-29 01:57:42,277 INFO] Saving checkpoint ../results/models/im2latex-64_step_20000.pt
[2019-12-29 02:06:59,904 INFO] Step 20500/100000; acc:  97.26; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/682 tok/s;  23493 sec
[2019-12-29 02:16:17,705 INFO] Step 21000/100000; acc:  97.32; ppl:  1.11; xent: 0.10; lr: 0.10000;   0/1056 tok/s;  24051 sec
[2019-12-29 02:25:27,210 INFO] Step 21500/100000; acc:  97.33; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1061 tok/s;  24601 sec
[2019-12-29 02:34:43,734 INFO] Step 22000/100000; acc:  97.30; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1051 tok/s;  25157 sec
[2019-12-29 02:43:57,678 INFO] Step 22500/100000; acc:  97.34; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1058 tok/s;  25711 sec
[2019-12-29 02:53:15,069 INFO] Step 23000/100000; acc:  97.39; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1053 tok/s;  26268 sec
[2019-12-29 03:02:34,331 INFO] Step 23500/100000; acc:  97.38; ppl:  1.10; xent: 0.10; lr: 0.10000;   0/1047 tok/s;  26828 sec
[2019-12-29 03:11:35,662 INFO] Step 24000/100000; acc:  97.44; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1078 tok/s;  27369 sec
[2019-12-29 03:20:48,277 INFO] Step 24500/100000; acc:  97.47; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1060 tok/s;  27922 sec
[2019-12-29 03:30:00,125 INFO] Step 25000/100000; acc:  97.54; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1062 tok/s;  28474 sec
[2019-12-29 03:39:18,185 INFO] Step 25500/100000; acc:  97.51; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1054 tok/s;  29032 sec
[2019-12-29 03:48:34,973 INFO] Step 26000/100000; acc:  97.46; ppl:  1.10; xent: 0.09; lr: 0.10000;   0/1054 tok/s;  29588 sec
[2019-12-29 03:57:45,027 INFO] Step 26500/100000; acc:  97.59; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1058 tok/s;  30138 sec
[2019-12-29 04:07:06,107 INFO] Step 27000/100000; acc:  97.54; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1052 tok/s;  30699 sec
[2019-12-29 04:16:19,929 INFO] Step 27500/100000; acc:  97.64; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1052 tok/s;  31253 sec
[2019-12-29 04:25:24,985 INFO] Step 28000/100000; acc:  97.63; ppl:  1.09; xent: 0.09; lr: 0.10000;   0/1074 tok/s;  31798 sec
[2019-12-29 04:34:42,051 INFO] Step 28500/100000; acc:  97.68; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1058 tok/s;  32355 sec
[2019-12-29 04:43:51,102 INFO] Step 29000/100000; acc:  97.65; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1062 tok/s;  32904 sec
[2019-12-29 04:53:09,219 INFO] Step 29500/100000; acc:  97.66; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1052 tok/s;  33463 sec
[2019-12-29 05:02:26,209 INFO] Step 30000/100000; acc:  97.64; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1053 tok/s;  34020 sec
[2019-12-29 05:07:28,821 INFO] Validation perplexity: 1.09488
[2019-12-29 05:07:28,822 INFO] Validation accuracy: 97.6445
[2019-12-29 05:07:28,825 INFO] Saving checkpoint ../results/models/im2latex-64_step_30000.pt
[2019-12-29 05:16:36,007 INFO] Step 30500/100000; acc:  97.67; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/686 tok/s;  34869 sec
[2019-12-29 05:26:02,295 INFO] Step 31000/100000; acc:  97.70; ppl:  1.09; xent: 0.08; lr: 0.10000;   0/1040 tok/s;  35436 sec
[2019-12-29 05:35:01,551 INFO] Step 31500/100000; acc:  97.76; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1078 tok/s;  35975 sec
[2019-12-29 05:44:20,047 INFO] Step 32000/100000; acc:  97.80; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1054 tok/s;  36533 sec
[2019-12-29 05:53:33,196 INFO] Step 32500/100000; acc:  97.77; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1063 tok/s;  37087 sec
[2019-12-29 06:02:40,350 INFO] Step 33000/100000; acc:  97.81; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1067 tok/s;  37634 sec
[2019-12-29 06:12:00,269 INFO] Step 33500/100000; acc:  97.74; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1045 tok/s;  38194 sec
[2019-12-29 06:21:13,025 INFO] Step 34000/100000; acc:  97.79; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1059 tok/s;  38746 sec
[2019-12-29 06:30:30,250 INFO] Step 34500/100000; acc:  97.85; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1053 tok/s;  39304 sec
[2019-12-29 06:39:47,944 INFO] Step 35000/100000; acc:  97.81; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1049 tok/s;  39861 sec
[2019-12-29 06:48:50,762 INFO] Step 35500/100000; acc:  97.89; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1079 tok/s;  40404 sec
[2019-12-29 06:58:06,559 INFO] Step 36000/100000; acc:  97.87; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1055 tok/s;  40960 sec
[2019-12-29 07:07:14,134 INFO] Step 36500/100000; acc:  97.89; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1070 tok/s;  41508 sec
[2019-12-29 07:16:34,542 INFO] Step 37000/100000; acc:  97.88; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1047 tok/s;  42068 sec
[2019-12-29 07:25:48,678 INFO] Step 37500/100000; acc:  97.87; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1057 tok/s;  42622 sec
[2019-12-29 07:34:58,738 INFO] Step 38000/100000; acc:  97.87; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1060 tok/s;  43172 sec
[2019-12-29 07:44:22,000 INFO] Step 38500/100000; acc:  97.84; ppl:  1.08; xent: 0.08; lr: 0.10000;   0/1049 tok/s;  43735 sec
[2019-12-29 07:53:32,820 INFO] Step 39000/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1058 tok/s;  44286 sec
[2019-12-29 08:02:38,323 INFO] Step 39500/100000; acc:  97.91; ppl:  1.08; xent: 0.07; lr: 0.10000;   0/1071 tok/s;  44832 sec
[2019-12-29 08:11:59,713 INFO] Step 40000/100000; acc:  97.98; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1054 tok/s;  45393 sec
[2019-12-29 08:17:02,113 INFO] Validation perplexity: 1.08502
[2019-12-29 08:17:02,114 INFO] Validation accuracy: 97.8986
[2019-12-29 08:17:02,117 INFO] Saving checkpoint ../results/models/im2latex-64_step_40000.pt
[2019-12-29 08:26:12,175 INFO] Step 40500/100000; acc:  97.94; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/684 tok/s;  46246 sec
[2019-12-29 08:35:29,482 INFO] Step 41000/100000; acc:  97.95; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1052 tok/s;  46803 sec
[2019-12-29 08:44:44,549 INFO] Step 41500/100000; acc:  97.93; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1055 tok/s;  47358 sec
[2019-12-29 08:53:52,965 INFO] Step 42000/100000; acc:  97.99; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1065 tok/s;  47906 sec
[2019-12-29 09:03:21,336 INFO] Step 42500/100000; acc:  98.00; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1035 tok/s;  48475 sec
[2019-12-29 09:12:18,252 INFO] Step 43000/100000; acc:  98.03; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1083 tok/s;  49012 sec
[2019-12-29 09:21:36,096 INFO] Step 43500/100000; acc:  98.08; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1056 tok/s;  49569 sec
[2019-12-29 09:30:47,041 INFO] Step 44000/100000; acc:  98.07; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1065 tok/s;  50120 sec
[2019-12-29 09:40:00,416 INFO] Step 44500/100000; acc:  98.07; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1056 tok/s;  50674 sec
[2019-12-29 09:49:20,211 INFO] Step 45000/100000; acc:  98.04; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1049 tok/s;  51234 sec
[2019-12-29 09:58:30,158 INFO] Step 45500/100000; acc:  98.03; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1062 tok/s;  51784 sec
[2019-12-29 10:07:51,828 INFO] Step 46000/100000; acc:  98.12; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1048 tok/s;  52345 sec
[2019-12-29 10:17:03,746 INFO] Step 46500/100000; acc:  98.08; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1058 tok/s;  52897 sec
[2019-12-29 10:26:07,394 INFO] Step 47000/100000; acc:  98.08; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1076 tok/s;  53441 sec
[2019-12-29 10:35:26,111 INFO] Step 47500/100000; acc:  98.11; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1050 tok/s;  54000 sec
[2019-12-29 10:44:34,384 INFO] Step 48000/100000; acc:  98.10; ppl:  1.07; xent: 0.07; lr: 0.10000;   0/1067 tok/s;  54548 sec
[2019-12-29 10:53:53,566 INFO] Step 48500/100000; acc:  98.15; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1049 tok/s;  55107 sec
[2019-12-29 11:03:06,891 INFO] Step 49000/100000; acc:  98.10; ppl:  1.07; xent: 0.06; lr: 0.10000;   0/1059 tok/s;  55660 sec
[2019-12-29 11:12:16,972 INFO] Step 49500/100000; acc:  98.15; ppl:  1.06; xent: 0.06; lr: 0.10000;   0/1060 tok/s;  56210 sec
[2019-12-29 11:21:41,438 INFO] Step 50000/100000; acc:  98.15; ppl:  1.07; xent: 0.06; lr: 0.05000;   0/1045 tok/s;  56775 sec
[2019-12-29 11:26:43,769 INFO] Validation perplexity: 1.08653
[2019-12-29 11:26:43,770 INFO] Validation accuracy: 97.9187
[2019-12-29 11:26:43,772 INFO] Saving checkpoint ../results/models/im2latex-64_step_50000.pt
[2019-12-29 11:35:52,402 INFO] Step 50500/100000; acc:  98.28; ppl:  1.06; xent: 0.06; lr: 0.05000;   0/684 tok/s;  57626 sec
[2019-12-29 11:45:02,979 INFO] Step 51000/100000; acc:  98.35; ppl:  1.06; xent: 0.05; lr: 0.05000;   0/1065 tok/s;  58176 sec
[2019-12-29 11:54:22,090 INFO] Step 51500/100000; acc:  98.38; ppl:  1.06; xent: 0.05; lr: 0.05000;   0/1059 tok/s;  58735 sec
[2019-12-29 12:03:29,404 INFO] Step 52000/100000; acc:  98.44; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1063 tok/s;  59283 sec
[2019-12-29 12:12:48,705 INFO] Step 52500/100000; acc:  98.42; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1047 tok/s;  59842 sec
[2019-12-29 12:22:01,944 INFO] Step 53000/100000; acc:  98.45; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1059 tok/s;  60395 sec
[2019-12-29 12:31:14,699 INFO] Step 53500/100000; acc:  98.49; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1058 tok/s;  60948 sec
[2019-12-29 12:40:38,585 INFO] Step 54000/100000; acc:  98.47; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1042 tok/s;  61512 sec
[2019-12-29 12:49:37,481 INFO] Step 54500/100000; acc:  98.48; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1081 tok/s;  62051 sec
[2019-12-29 12:58:52,782 INFO] Step 55000/100000; acc:  98.48; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1056 tok/s;  62606 sec
[2019-12-29 13:08:05,769 INFO] Step 55500/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1063 tok/s;  63159 sec
[2019-12-29 13:17:20,505 INFO] Step 56000/100000; acc:  98.52; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1057 tok/s;  63714 sec
[2019-12-29 13:26:40,155 INFO] Step 56500/100000; acc:  98.50; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1049 tok/s;  64274 sec
[2019-12-29 13:35:48,744 INFO] Step 57000/100000; acc:  98.54; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1062 tok/s;  64822 sec
[2019-12-29 13:45:11,453 INFO] Step 57500/100000; acc:  98.57; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1049 tok/s;  65385 sec
[2019-12-29 13:54:22,976 INFO] Step 58000/100000; acc:  98.55; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1056 tok/s;  65936 sec
[2019-12-29 14:03:26,276 INFO] Step 58500/100000; acc:  98.53; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1075 tok/s;  66480 sec
[2019-12-29 14:12:42,092 INFO] Step 59000/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1059 tok/s;  67035 sec
[2019-12-29 14:21:50,265 INFO] Step 59500/100000; acc:  98.56; ppl:  1.05; xent: 0.05; lr: 0.05000;   0/1063 tok/s;  67584 sec
[2019-12-29 14:31:11,094 INFO] Step 60000/100000; acc:  98.57; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/1049 tok/s;  68144 sec
[2019-12-29 14:36:13,506 INFO] Validation perplexity: 1.07631
[2019-12-29 14:36:13,507 INFO] Validation accuracy: 98.1403
[2019-12-29 14:36:13,509 INFO] Saving checkpoint ../results/models/im2latex-64_step_60000.pt
[2019-12-29 14:45:29,900 INFO] Step 60500/100000; acc:  98.59; ppl:  1.05; xent: 0.05; lr: 0.02500;   0/683 tok/s;  69003 sec
[2019-12-29 14:54:35,774 INFO] Step 61000/100000; acc:  98.63; ppl:  1.05; xent: 0.04; lr: 0.02500;   0/1067 tok/s;  69549 sec
[2019-12-29 15:04:04,208 INFO] Step 61500/100000; acc:  98.65; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1038 tok/s;  70118 sec
[2019-12-29 15:13:05,382 INFO] Step 62000/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1074 tok/s;  70659 sec
[2019-12-29 15:22:18,447 INFO] Step 62500/100000; acc:  98.70; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1062 tok/s;  71212 sec
[2019-12-29 15:31:32,796 INFO] Step 63000/100000; acc:  98.67; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1063 tok/s;  71766 sec
[2019-12-29 15:40:40,140 INFO] Step 63500/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1066 tok/s;  72314 sec
[2019-12-29 15:49:56,765 INFO] Step 64000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1050 tok/s;  72870 sec
[2019-12-29 15:59:11,741 INFO] Step 64500/100000; acc:  98.66; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1056 tok/s;  73425 sec
[2019-12-29 16:08:28,624 INFO] Step 65000/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1054 tok/s;  73982 sec
[2019-12-29 16:17:47,439 INFO] Step 65500/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1047 tok/s;  74541 sec
[2019-12-29 16:26:51,607 INFO] Step 66000/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1074 tok/s;  75085 sec
[2019-12-29 16:36:05,598 INFO] Step 66500/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1060 tok/s;  75639 sec
[2019-12-29 16:45:17,522 INFO] Step 67000/100000; acc:  98.75; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1063 tok/s;  76191 sec
[2019-12-29 16:54:35,520 INFO] Step 67500/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1053 tok/s;  76749 sec
[2019-12-29 17:03:51,929 INFO] Step 68000/100000; acc:  98.71; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1053 tok/s;  77305 sec
[2019-12-29 17:13:02,073 INFO] Step 68500/100000; acc:  98.73; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1058 tok/s;  77855 sec
[2019-12-29 17:22:23,570 INFO] Step 69000/100000; acc:  98.74; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1052 tok/s;  78417 sec
[2019-12-29 17:31:35,962 INFO] Step 69500/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.02500;   0/1055 tok/s;  78969 sec
[2019-12-29 17:40:43,016 INFO] Step 70000/100000; acc:  98.72; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1070 tok/s;  79516 sec
[2019-12-29 17:45:45,559 INFO] Validation perplexity: 1.07508
[2019-12-29 17:45:45,560 INFO] Validation accuracy: 98.2042
[2019-12-29 17:45:45,563 INFO] Saving checkpoint ../results/models/im2latex-64_step_70000.pt
[2019-12-29 17:55:00,887 INFO] Step 70500/100000; acc:  98.77; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/688 tok/s;  80374 sec
[2019-12-29 18:04:09,721 INFO] Step 71000/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1062 tok/s;  80923 sec
[2019-12-29 18:13:27,324 INFO] Step 71500/100000; acc:  98.80; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1053 tok/s;  81481 sec
[2019-12-29 18:22:43,466 INFO] Step 72000/100000; acc:  98.76; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1054 tok/s;  82037 sec
[2019-12-29 18:31:50,264 INFO] Step 72500/100000; acc:  98.80; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1065 tok/s;  82584 sec
[2019-12-29 18:41:15,356 INFO] Step 73000/100000; acc:  98.81; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1042 tok/s;  83149 sec
[2019-12-29 18:50:15,468 INFO] Step 73500/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1076 tok/s;  83689 sec
[2019-12-29 18:59:34,512 INFO] Step 74000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1053 tok/s;  84248 sec
[2019-12-29 19:08:46,817 INFO] Step 74500/100000; acc:  98.80; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1063 tok/s;  84800 sec
[2019-12-29 19:17:57,165 INFO] Step 75000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1061 tok/s;  85351 sec
[2019-12-29 19:27:17,157 INFO] Step 75500/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1046 tok/s;  85911 sec
[2019-12-29 19:36:28,908 INFO] Step 76000/100000; acc:  98.78; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1061 tok/s;  86462 sec
[2019-12-29 19:45:50,897 INFO] Step 76500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1046 tok/s;  87024 sec
[2019-12-29 19:55:04,263 INFO] Step 77000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1056 tok/s;  87578 sec
[2019-12-29 20:04:08,188 INFO] Step 77500/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1077 tok/s;  88122 sec
[2019-12-29 20:13:29,413 INFO] Step 78000/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1047 tok/s;  88683 sec
[2019-12-29 20:22:37,585 INFO] Step 78500/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1068 tok/s;  89231 sec
[2019-12-29 20:31:56,535 INFO] Step 79000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1049 tok/s;  89790 sec
[2019-12-29 20:41:11,626 INFO] Step 79500/100000; acc:  98.82; ppl:  1.04; xent: 0.04; lr: 0.01250;   0/1056 tok/s;  90345 sec
[2019-12-29 20:50:21,036 INFO] Step 80000/100000; acc:  98.83; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1061 tok/s;  90894 sec
[2019-12-29 20:55:23,364 INFO] Validation perplexity: 1.07515
[2019-12-29 20:55:23,365 INFO] Validation accuracy: 98.2292
[2019-12-29 20:55:23,367 INFO] Saving checkpoint ../results/models/im2latex-64_step_80000.pt
[2019-12-29 21:04:48,056 INFO] Step 80500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/682 tok/s;  91761 sec
[2019-12-29 21:13:56,586 INFO] Step 81000/100000; acc:  98.86; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1062 tok/s;  92310 sec
[2019-12-29 21:23:01,567 INFO] Step 81500/100000; acc:  98.87; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1072 tok/s;  92855 sec
[2019-12-29 21:32:20,185 INFO] Step 82000/100000; acc:  98.84; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1059 tok/s;  93414 sec
[2019-12-29 21:41:28,246 INFO] Step 82500/100000; acc:  98.87; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1064 tok/s;  93962 sec
[2019-12-29 21:50:45,271 INFO] Step 83000/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1051 tok/s;  94519 sec
[2019-12-29 21:59:59,943 INFO] Step 83500/100000; acc:  98.85; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1056 tok/s;  95073 sec
[2019-12-29 22:09:09,333 INFO] Step 84000/100000; acc:  98.87; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1063 tok/s;  95623 sec
[2019-12-29 22:18:37,424 INFO] Step 84500/100000; acc:  98.87; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1036 tok/s;  96191 sec
[2019-12-29 22:27:34,216 INFO] Step 85000/100000; acc:  98.88; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1083 tok/s;  96728 sec
[2019-12-29 22:36:47,921 INFO] Step 85500/100000; acc:  98.87; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1060 tok/s;  97281 sec
[2019-12-29 22:45:59,970 INFO] Step 86000/100000; acc:  98.89; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1066 tok/s;  97833 sec
[2019-12-29 22:55:14,912 INFO] Step 86500/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1054 tok/s;  98388 sec
[2019-12-29 23:04:35,995 INFO] Step 87000/100000; acc:  98.87; ppl:  1.04; xent: 0.04; lr: 0.00625;   0/1047 tok/s;  98949 sec
[2019-12-29 23:13:43,297 INFO] Step 87500/100000; acc:  98.86; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1066 tok/s;  99497 sec
[2019-12-29 23:23:03,739 INFO] Step 88000/100000; acc:  98.90; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1050 tok/s; 100057 sec
[2019-12-29 23:32:16,302 INFO] Step 88500/100000; acc:  98.88; ppl:  1.03; xent: 0.03; lr: 0.00625;   0/1056 tok/s; 100610 sec
[2019-12-29 23:41:20,446 INFO] Step 89000/100000; acc:  98.89; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1075 tok/s; 101154 sec
[2019-12-29 23:50:41,131 INFO] Step 89500/100000; acc:  98.89; ppl:  1.04; xent: 0.03; lr: 0.00625;   0/1050 tok/s; 101715 sec
[2019-12-29 23:59:49,359 INFO] Step 90000/100000; acc:  98.89; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1066 tok/s; 102263 sec
[2019-12-30 00:04:51,626 INFO] Validation perplexity: 1.07555
[2019-12-30 00:04:51,627 INFO] Validation accuracy: 98.2338
[2019-12-30 00:04:51,629 INFO] Saving checkpoint ../results/models/im2latex-64_step_90000.pt
[2019-12-30 00:14:09,684 INFO] Step 90500/100000; acc:  98.89; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/682 tok/s; 103123 sec
[2019-12-30 00:23:24,831 INFO] Step 91000/100000; acc:  98.87; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1057 tok/s; 103678 sec
[2019-12-30 00:32:31,987 INFO] Step 91500/100000; acc:  98.88; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1064 tok/s; 104225 sec
[2019-12-30 00:41:59,366 INFO] Step 92000/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1039 tok/s; 104793 sec
[2019-12-30 00:51:05,038 INFO] Step 92500/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1069 tok/s; 105338 sec
[2019-12-30 01:00:18,662 INFO] Step 93000/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1059 tok/s; 105892 sec
[2019-12-30 01:09:34,470 INFO] Step 93500/100000; acc:  98.89; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1063 tok/s; 106448 sec
[2019-12-30 01:18:40,713 INFO] Step 94000/100000; acc:  98.94; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1066 tok/s; 106994 sec
[2019-12-30 01:27:59,690 INFO] Step 94500/100000; acc:  98.89; ppl:  1.04; xent: 0.03; lr: 0.00313;   0/1048 tok/s; 107553 sec
[2019-12-30 01:37:13,914 INFO] Step 95000/100000; acc:  98.88; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1056 tok/s; 108107 sec
[2019-12-30 01:46:26,298 INFO] Step 95500/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1060 tok/s; 108660 sec
[2019-12-30 01:55:49,152 INFO] Step 96000/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1042 tok/s; 109223 sec
[2019-12-30 02:04:47,898 INFO] Step 96500/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1082 tok/s; 109761 sec
[2019-12-30 02:14:03,645 INFO] Step 97000/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1053 tok/s; 110317 sec
[2019-12-30 02:23:14,133 INFO] Step 97500/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1068 tok/s; 110868 sec
[2019-12-30 02:32:33,287 INFO] Step 98000/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1049 tok/s; 111427 sec
[2019-12-30 02:41:49,437 INFO] Step 98500/100000; acc:  98.89; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1055 tok/s; 111983 sec
[2019-12-30 02:50:59,637 INFO] Step 99000/100000; acc:  98.91; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1059 tok/s; 112533 sec
[2019-12-30 03:00:21,156 INFO] Step 99500/100000; acc:  98.90; ppl:  1.03; xent: 0.03; lr: 0.00313;   0/1051 tok/s; 113095 sec
[2019-12-30 03:09:31,650 INFO] Step 100000/100000; acc:  98.92; ppl:  1.03; xent: 0.03; lr: 0.00156;   0/1058 tok/s; 113645 sec
[2019-12-30 03:14:34,083 INFO] Validation perplexity: 1.07554
[2019-12-30 03:14:34,084 INFO] Validation accuracy: 98.2354
[2019-12-30 03:14:34,086 INFO] Saving checkpoint ../results/models/im2latex-64_step_100000.pt
