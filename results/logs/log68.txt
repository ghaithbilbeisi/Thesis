[2020-01-02 02:48:20,991 INFO]  * tgt vocab size = 510
[2020-01-02 02:48:20,991 INFO] Building model...
[2020-01-02 02:48:24,596 INFO] NMTModel(
  (encoder): ImageEncoder(
    (layer1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer3): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer5): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer6): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (layer7): Conv2d(128, 128, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    (layer8): DCN(
      (conv_offset_mask): Conv2d(128, 12, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    )
    (layer9): DCN(
      (conv_offset_mask): Conv2d(128, 12, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    )
    (layer10): DCN(
      (conv_offset_mask): Conv2d(128, 12, kernel_size=(2, 2), stride=(1, 1), padding=(1, 1))
    )
    (batch_norm1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (batch_norm3): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (rnn): LSTM(128, 250, num_layers=2, dropout=0.3, bidirectional=True)
    (pos_lut): Embedding(1000, 128)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(510, 80, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3)
      (layers): ModuleList(
        (0): LSTMCell(580, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=510, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2020-01-02 02:48:24,598 INFO] encoder: 3229092
[2020-01-02 02:48:24,598 INFO] decoder: 5214310
[2020-01-02 02:48:24,598 INFO] * number of parameters: 8443402
[2020-01-02 02:48:25,184 INFO] Starting training on GPU: [0]
[2020-01-02 02:48:25,184 INFO] Start training loop and validate every 10000 steps...
[2020-01-02 02:57:55,580 INFO] Step 500/100000; acc:  27.56; ppl: 41.25; xent: 3.72; lr: 0.10000;   0/1032 tok/s;    570 sec
[2020-01-02 03:07:19,302 INFO] Step 1000/100000; acc:  44.51; ppl: 13.47; xent: 2.60; lr: 0.10000;   0/1031 tok/s;   1134 sec
[2020-01-02 03:17:01,625 INFO] Step 1500/100000; acc:  48.10; ppl: 10.56; xent: 2.36; lr: 0.10000;   0/1011 tok/s;   1716 sec
[2020-01-02 03:26:40,495 INFO] Step 2000/100000; acc:  50.42; ppl:  9.16; xent: 2.21; lr: 0.10000;   0/1013 tok/s;   2295 sec
[2020-01-02 03:36:04,816 INFO] Step 2500/100000; acc:  50.83; ppl:  9.02; xent: 2.20; lr: 0.10000;   0/1035 tok/s;   2860 sec
[2020-01-02 03:45:18,699 INFO] Step 3000/100000; acc:  51.91; ppl:  8.47; xent: 2.14; lr: 0.10000;   0/1059 tok/s;   3414 sec
[2020-01-02 03:54:23,238 INFO] Step 3500/100000; acc:  52.81; ppl:  8.05; xent: 2.09; lr: 0.10000;   0/1072 tok/s;   3958 sec
[2020-01-02 04:03:37,888 INFO] Step 4000/100000; acc:  53.12; ppl:  7.81; xent: 2.06; lr: 0.10000;   0/1060 tok/s;   4513 sec
[2020-01-02 04:12:43,665 INFO] Step 4500/100000; acc:  53.78; ppl:  7.51; xent: 2.02; lr: 0.10000;   0/1070 tok/s;   5058 sec
[2020-01-02 04:21:42,474 INFO] Step 5000/100000; acc:  54.37; ppl:  7.29; xent: 1.99; lr: 0.10000;   0/1087 tok/s;   5597 sec
[2020-01-02 04:30:54,507 INFO] Step 5500/100000; acc:  54.76; ppl:  7.10; xent: 1.96; lr: 0.10000;   0/1065 tok/s;   6149 sec
[2020-01-02 04:39:55,605 INFO] Step 6000/100000; acc:  55.12; ppl:  6.96; xent: 1.94; lr: 0.10000;   0/1082 tok/s;   6690 sec
[2020-01-02 04:49:05,017 INFO] Step 6500/100000; acc:  55.52; ppl:  6.82; xent: 1.92; lr: 0.10000;   0/1067 tok/s;   7240 sec
[2020-01-02 04:58:10,846 INFO] Step 7000/100000; acc:  55.73; ppl:  6.72; xent: 1.91; lr: 0.10000;   0/1074 tok/s;   7786 sec
[2020-01-02 05:07:14,258 INFO] Step 7500/100000; acc:  56.13; ppl:  6.58; xent: 1.88; lr: 0.10000;   0/1073 tok/s;   8329 sec
[2020-01-02 05:16:30,988 INFO] Step 8000/100000; acc:  56.32; ppl:  6.46; xent: 1.87; lr: 0.10000;   0/1059 tok/s;   8886 sec
[2020-01-02 05:25:34,405 INFO] Step 8500/100000; acc:  56.63; ppl:  6.36; xent: 1.85; lr: 0.10000;   0/1072 tok/s;   9429 sec
[2020-01-02 05:34:32,547 INFO] Step 9000/100000; acc:  56.90; ppl:  6.24; xent: 1.83; lr: 0.10000;   0/1087 tok/s;   9967 sec
[2020-01-02 05:43:44,615 INFO] Step 9500/100000; acc:  57.42; ppl:  6.13; xent: 1.81; lr: 0.10000;   0/1073 tok/s;  10519 sec
[2020-01-02 05:52:42,858 INFO] Step 10000/100000; acc:  57.53; ppl:  6.07; xent: 1.80; lr: 0.10000;   0/1082 tok/s;  11058 sec
[2020-01-02 05:57:28,750 INFO] Validation perplexity: 6.03451
[2020-01-02 05:57:28,751 INFO] Validation accuracy: 57.5572
[2020-01-02 05:57:28,753 INFO] Saving checkpoint ../results/models/im2latex-68_step_10000.pt
[2020-01-02 06:06:38,226 INFO] Step 10500/100000; acc:  57.81; ppl:  5.99; xent: 1.79; lr: 0.10000;   0/701 tok/s;  11893 sec
[2020-01-02 06:15:45,994 INFO] Step 11000/100000; acc:  57.98; ppl:  5.93; xent: 1.78; lr: 0.10000;   0/1071 tok/s;  12441 sec
[2020-01-02 06:24:50,340 INFO] Step 11500/100000; acc:  58.14; ppl:  5.84; xent: 1.76; lr: 0.10000;   0/1074 tok/s;  12985 sec
[2020-01-02 06:34:07,365 INFO] Step 12000/100000; acc:  58.39; ppl:  5.80; xent: 1.76; lr: 0.10000;   0/1054 tok/s;  13542 sec
[2020-01-02 06:42:59,525 INFO] Step 12500/100000; acc:  58.36; ppl:  5.77; xent: 1.75; lr: 0.10000;   0/1095 tok/s;  14074 sec
[2020-01-02 06:52:03,626 INFO] Step 13000/100000; acc:  58.39; ppl:  5.78; xent: 1.75; lr: 0.10000;   0/1075 tok/s;  14618 sec
[2020-01-02 07:01:09,189 INFO] Step 13500/100000; acc:  58.65; ppl:  5.71; xent: 1.74; lr: 0.10000;   0/1078 tok/s;  15164 sec
[2020-01-02 07:10:15,581 INFO] Step 14000/100000; acc:  58.82; ppl:  5.66; xent: 1.73; lr: 0.10000;   0/1072 tok/s;  15710 sec
[2020-01-02 07:19:26,710 INFO] Step 14500/100000; acc:  59.04; ppl:  5.55; xent: 1.71; lr: 0.10000;   0/1066 tok/s;  16262 sec
[2020-01-02 07:28:28,440 INFO] Step 15000/100000; acc:  59.35; ppl:  5.50; xent: 1.70; lr: 0.10000;   0/1076 tok/s;  16803 sec
[2020-01-02 07:37:41,653 INFO] Step 15500/100000; acc:  59.33; ppl:  5.48; xent: 1.70; lr: 0.10000;   0/1065 tok/s;  17356 sec
[2020-01-02 07:46:45,031 INFO] Step 16000/100000; acc:  59.34; ppl:  5.49; xent: 1.70; lr: 0.10000;   0/1073 tok/s;  17900 sec
[2020-01-02 07:55:40,412 INFO] Step 16500/100000; acc:  59.34; ppl:  5.47; xent: 1.70; lr: 0.10000;   0/1090 tok/s;  18435 sec
[2020-01-02 08:04:49,700 INFO] Step 17000/100000; acc:  59.50; ppl:  5.45; xent: 1.70; lr: 0.10000;   0/1074 tok/s;  18985 sec
[2020-01-02 08:13:50,694 INFO] Step 17500/100000; acc:  59.58; ppl:  5.41; xent: 1.69; lr: 0.10000;   0/1078 tok/s;  19526 sec
[2020-01-02 08:23:00,848 INFO] Step 18000/100000; acc:  59.77; ppl:  5.37; xent: 1.68; lr: 0.10000;   0/1069 tok/s;  20076 sec
[2020-01-02 08:32:07,475 INFO] Step 18500/100000; acc:  59.82; ppl:  5.33; xent: 1.67; lr: 0.10000;   0/1073 tok/s;  20622 sec
[2020-01-02 08:41:09,583 INFO] Step 19000/100000; acc:  59.95; ppl:  5.29; xent: 1.67; lr: 0.10000;   0/1074 tok/s;  21164 sec
[2020-01-02 08:50:28,653 INFO] Step 19500/100000; acc:  60.06; ppl:  5.26; xent: 1.66; lr: 0.10000;   0/1056 tok/s;  21723 sec
[2020-01-02 08:59:26,645 INFO] Step 20000/100000; acc:  60.14; ppl:  5.24; xent: 1.66; lr: 0.10000;   0/1081 tok/s;  22261 sec
[2020-01-02 09:04:12,934 INFO] Validation perplexity: 5.39302
[2020-01-02 09:04:12,935 INFO] Validation accuracy: 59.7414
[2020-01-02 09:04:12,938 INFO] Saving checkpoint ../results/models/im2latex-68_step_20000.pt
[2020-01-02 09:13:20,910 INFO] Step 20500/100000; acc:  60.27; ppl:  5.21; xent: 1.65; lr: 0.10000;   0/704 tok/s;  23096 sec
[2020-01-02 09:22:33,117 INFO] Step 21000/100000; acc:  60.47; ppl:  5.16; xent: 1.64; lr: 0.10000;   0/1069 tok/s;  23648 sec
[2020-01-02 09:31:35,253 INFO] Step 21500/100000; acc:  60.50; ppl:  5.16; xent: 1.64; lr: 0.10000;   0/1076 tok/s;  24190 sec
[2020-01-02 09:40:44,821 INFO] Step 22000/100000; acc:  60.57; ppl:  5.12; xent: 1.63; lr: 0.10000;   0/1064 tok/s;  24740 sec
[2020-01-02 09:49:53,632 INFO] Step 22500/100000; acc:  60.61; ppl:  5.13; xent: 1.63; lr: 0.10000;   0/1068 tok/s;  25288 sec
[2020-01-02 09:59:04,952 INFO] Step 23000/100000; acc:  60.72; ppl:  5.06; xent: 1.62; lr: 0.10000;   0/1065 tok/s;  25840 sec
[2020-01-02 10:08:17,168 INFO] Step 23500/100000; acc:  60.87; ppl:  5.05; xent: 1.62; lr: 0.10000;   0/1059 tok/s;  26392 sec
[2020-01-02 10:17:13,638 INFO] Step 24000/100000; acc:  60.86; ppl:  5.05; xent: 1.62; lr: 0.10000;   0/1088 tok/s;  26928 sec
[2020-01-02 10:26:19,686 INFO] Step 24500/100000; acc:  60.87; ppl:  5.04; xent: 1.62; lr: 0.10000;   0/1074 tok/s;  27475 sec
[2020-01-02 10:35:25,409 INFO] Step 25000/100000; acc:  60.90; ppl:  5.02; xent: 1.61; lr: 0.10000;   0/1073 tok/s;  28020 sec
[2020-01-02 10:44:35,621 INFO] Step 25500/100000; acc:  61.04; ppl:  5.01; xent: 1.61; lr: 0.10000;   0/1068 tok/s;  28570 sec
[2020-01-02 10:53:46,385 INFO] Step 26000/100000; acc:  61.16; ppl:  4.96; xent: 1.60; lr: 0.10000;   0/1065 tok/s;  29121 sec
[2020-01-02 11:02:50,454 INFO] Step 26500/100000; acc:  61.26; ppl:  4.94; xent: 1.60; lr: 0.10000;   0/1070 tok/s;  29665 sec
[2020-01-02 11:12:06,016 INFO] Step 27000/100000; acc:  61.27; ppl:  4.93; xent: 1.60; lr: 0.10000;   0/1062 tok/s;  30221 sec
[2020-01-02 11:21:11,059 INFO] Step 27500/100000; acc:  61.31; ppl:  4.92; xent: 1.59; lr: 0.10000;   0/1069 tok/s;  30766 sec
[2020-01-02 11:30:10,706 INFO] Step 28000/100000; acc:  61.29; ppl:  4.93; xent: 1.60; lr: 0.10000;   0/1085 tok/s;  31306 sec
[2020-01-02 11:39:21,090 INFO] Step 28500/100000; acc:  61.44; ppl:  4.89; xent: 1.59; lr: 0.10000;   0/1072 tok/s;  31856 sec
[2020-01-02 11:48:23,370 INFO] Step 29000/100000; acc:  61.47; ppl:  4.89; xent: 1.59; lr: 0.10000;   0/1074 tok/s;  32398 sec
[2020-01-02 11:57:32,248 INFO] Step 29500/100000; acc:  61.68; ppl:  4.85; xent: 1.58; lr: 0.10000;   0/1071 tok/s;  32947 sec
[2020-01-02 12:06:43,508 INFO] Step 30000/100000; acc:  61.55; ppl:  4.86; xent: 1.58; lr: 0.10000;   0/1064 tok/s;  33498 sec
[2020-01-02 12:11:30,017 INFO] Validation perplexity: 5.17519
[2020-01-02 12:11:30,018 INFO] Validation accuracy: 60.6057
[2020-01-02 12:11:30,020 INFO] Saving checkpoint ../results/models/im2latex-68_step_30000.pt
[2020-01-02 12:20:31,170 INFO] Step 30500/100000; acc:  61.65; ppl:  4.84; xent: 1.58; lr: 0.10000;   0/704 tok/s;  34326 sec
[2020-01-02 12:29:49,916 INFO] Step 31000/100000; acc:  61.73; ppl:  4.82; xent: 1.57; lr: 0.10000;   0/1055 tok/s;  34885 sec
[2020-01-02 12:38:44,788 INFO] Step 31500/100000; acc:  61.65; ppl:  4.83; xent: 1.57; lr: 0.10000;   0/1085 tok/s;  35420 sec
[2020-01-02 12:47:55,521 INFO] Step 32000/100000; acc:  61.75; ppl:  4.82; xent: 1.57; lr: 0.10000;   0/1068 tok/s;  35970 sec
[2020-01-02 12:57:08,094 INFO] Step 32500/100000; acc:  61.82; ppl:  4.79; xent: 1.57; lr: 0.10000;   0/1067 tok/s;  36523 sec
[2020-01-02 13:06:17,410 INFO] Step 33000/100000; acc:  61.84; ppl:  4.80; xent: 1.57; lr: 0.10000;   0/1063 tok/s;  37072 sec
[2020-01-02 13:16:27,216 INFO] Step 33500/100000; acc:  62.00; ppl:  4.75; xent: 1.56; lr: 0.10000;   0/960 tok/s;  37682 sec
[2020-01-02 13:25:43,336 INFO] Step 34000/100000; acc:  62.00; ppl:  4.77; xent: 1.56; lr: 0.10000;   0/1052 tok/s;  38238 sec
[2020-01-02 13:35:20,886 INFO] Step 34500/100000; acc:  62.02; ppl:  4.72; xent: 1.55; lr: 0.10000;   0/1017 tok/s;  38816 sec
[2020-01-02 13:45:26,926 INFO] Step 35000/100000; acc:  62.15; ppl:  4.72; xent: 1.55; lr: 0.10000;   0/965 tok/s;  39422 sec
[2020-01-02 13:55:48,541 INFO] Step 35500/100000; acc:  62.13; ppl:  4.72; xent: 1.55; lr: 0.10000;   0/942 tok/s;  40043 sec
[2020-01-02 14:06:19,983 INFO] Step 36000/100000; acc:  62.03; ppl:  4.74; xent: 1.56; lr: 0.10000;   0/927 tok/s;  40675 sec
[2020-01-02 14:16:46,851 INFO] Step 36500/100000; acc:  62.08; ppl:  4.72; xent: 1.55; lr: 0.10000;   0/934 tok/s;  41302 sec
[2020-01-02 14:27:24,243 INFO] Step 37000/100000; acc:  62.15; ppl:  4.72; xent: 1.55; lr: 0.10000;   0/920 tok/s;  41939 sec
[2020-01-02 14:37:55,156 INFO] Step 37500/100000; acc:  62.32; ppl:  4.68; xent: 1.54; lr: 0.10000;   0/928 tok/s;  42570 sec
[2020-01-02 14:48:23,887 INFO] Step 38000/100000; acc:  62.38; ppl:  4.67; xent: 1.54; lr: 0.10000;   0/927 tok/s;  43199 sec
[2020-01-02 14:59:05,120 INFO] Step 38500/100000; acc:  62.33; ppl:  4.66; xent: 1.54; lr: 0.10000;   0/922 tok/s;  43840 sec
[2020-01-02 15:09:34,169 INFO] Step 39000/100000; acc:  62.35; ppl:  4.65; xent: 1.54; lr: 0.10000;   0/927 tok/s;  44469 sec
[2020-01-02 15:19:55,937 INFO] Step 39500/100000; acc:  62.31; ppl:  4.67; xent: 1.54; lr: 0.10000;   0/939 tok/s;  45091 sec
[2020-01-02 15:30:30,782 INFO] Step 40000/100000; acc:  62.45; ppl:  4.65; xent: 1.54; lr: 0.10000;   0/930 tok/s;  45726 sec
[2020-01-02 15:36:02,669 INFO] Validation perplexity: 5.02895
[2020-01-02 15:36:02,670 INFO] Validation accuracy: 61.0955
[2020-01-02 15:36:02,673 INFO] Saving checkpoint ../results/models/im2latex-68_step_40000.pt
[2020-01-02 15:46:30,641 INFO] Step 40500/100000; acc:  62.47; ppl:  4.63; xent: 1.53; lr: 0.10000;   0/607 tok/s;  46685 sec
[2020-01-02 15:57:04,930 INFO] Step 41000/100000; acc:  62.59; ppl:  4.62; xent: 1.53; lr: 0.10000;   0/924 tok/s;  47320 sec
[2020-01-02 16:07:37,675 INFO] Step 41500/100000; acc:  62.50; ppl:  4.63; xent: 1.53; lr: 0.10000;   0/927 tok/s;  47952 sec
[2020-01-02 16:18:04,987 INFO] Step 42000/100000; acc:  62.58; ppl:  4.60; xent: 1.53; lr: 0.10000;   0/930 tok/s;  48580 sec
[2020-01-02 16:28:51,732 INFO] Step 42500/100000; acc:  62.66; ppl:  4.59; xent: 1.52; lr: 0.10000;   0/910 tok/s;  49227 sec
[2020-01-02 16:39:08,211 INFO] Step 43000/100000; acc:  62.56; ppl:  4.60; xent: 1.53; lr: 0.10000;   0/943 tok/s;  49843 sec
[2020-01-02 16:49:44,860 INFO] Step 43500/100000; acc:  62.53; ppl:  4.61; xent: 1.53; lr: 0.10000;   0/925 tok/s;  50480 sec
[2020-01-02 17:00:16,069 INFO] Step 44000/100000; acc:  62.78; ppl:  4.57; xent: 1.52; lr: 0.10000;   0/933 tok/s;  51111 sec
[2020-01-02 17:10:19,920 INFO] Step 44500/100000; acc:  62.69; ppl:  4.59; xent: 1.52; lr: 0.10000;   0/968 tok/s;  51715 sec
[2020-01-02 17:20:58,971 INFO] Step 45000/100000; acc:  62.87; ppl:  4.54; xent: 1.51; lr: 0.10000;   0/918 tok/s;  52354 sec
[2020-01-02 17:31:27,876 INFO] Step 45500/100000; acc:  62.81; ppl:  4.56; xent: 1.52; lr: 0.10000;   0/928 tok/s;  52983 sec
[2020-01-02 17:42:10,108 INFO] Step 46000/100000; acc:  62.86; ppl:  4.54; xent: 1.51; lr: 0.10000;   0/917 tok/s;  53625 sec
[2020-01-02 17:52:40,626 INFO] Step 46500/100000; acc:  62.83; ppl:  4.54; xent: 1.51; lr: 0.10000;   0/925 tok/s;  54255 sec
[2020-01-02 18:03:04,062 INFO] Step 47000/100000; acc:  62.96; ppl:  4.53; xent: 1.51; lr: 0.10000;   0/939 tok/s;  54879 sec
[2020-01-02 18:13:41,980 INFO] Step 47500/100000; acc:  62.83; ppl:  4.56; xent: 1.52; lr: 0.10000;   0/917 tok/s;  55517 sec
[2020-01-02 18:24:11,036 INFO] Step 48000/100000; acc:  62.89; ppl:  4.53; xent: 1.51; lr: 0.10000;   0/930 tok/s;  56146 sec
[2020-01-02 18:34:50,852 INFO] Step 48500/100000; acc:  63.08; ppl:  4.51; xent: 1.51; lr: 0.10000;   0/917 tok/s;  56786 sec
[2020-01-02 18:45:27,073 INFO] Step 49000/100000; acc:  63.06; ppl:  4.51; xent: 1.51; lr: 0.10000;   0/921 tok/s;  57422 sec
[2020-01-02 18:55:56,369 INFO] Step 49500/100000; acc:  63.07; ppl:  4.51; xent: 1.51; lr: 0.10000;   0/926 tok/s;  58051 sec
[2020-01-02 19:06:42,894 INFO] Step 50000/100000; acc:  63.11; ppl:  4.49; xent: 1.50; lr: 0.05000;   0/913 tok/s;  58698 sec
[2020-01-02 19:12:17,130 INFO] Validation perplexity: 4.97274
[2020-01-02 19:12:17,131 INFO] Validation accuracy: 61.4505
[2020-01-02 19:12:17,135 INFO] Saving checkpoint ../results/models/im2latex-68_step_50000.pt
[2020-01-02 19:22:45,786 INFO] Step 50500/100000; acc:  63.51; ppl:  4.41; xent: 1.48; lr: 0.05000;   0/605 tok/s;  59661 sec
[2020-01-02 19:33:13,507 INFO] Step 51000/100000; acc:  63.64; ppl:  4.37; xent: 1.48; lr: 0.05000;   0/934 tok/s;  60288 sec
[2020-01-02 19:43:51,074 INFO] Step 51500/100000; acc:  64.00; ppl:  4.32; xent: 1.46; lr: 0.05000;   0/927 tok/s;  60926 sec
[2020-01-02 19:54:13,382 INFO] Step 52000/100000; acc:  63.94; ppl:  4.30; xent: 1.46; lr: 0.05000;   0/935 tok/s;  61548 sec
[2020-01-02 20:04:45,728 INFO] Step 52500/100000; acc:  64.18; ppl:  4.25; xent: 1.45; lr: 0.05000;   0/927 tok/s;  62181 sec
[2020-01-02 20:15:19,082 INFO] Step 53000/100000; acc:  64.09; ppl:  4.28; xent: 1.45; lr: 0.05000;   0/925 tok/s;  62814 sec
[2020-01-02 20:25:51,015 INFO] Step 53500/100000; acc:  64.32; ppl:  4.22; xent: 1.44; lr: 0.05000;   0/926 tok/s;  63446 sec
[2020-01-02 20:36:32,559 INFO] Step 54000/100000; acc:  64.33; ppl:  4.23; xent: 1.44; lr: 0.05000;   0/915 tok/s;  64087 sec
[2020-01-02 20:46:50,261 INFO] Step 54500/100000; acc:  64.04; ppl:  4.28; xent: 1.45; lr: 0.05000;   0/944 tok/s;  64705 sec
[2020-01-02 20:57:27,399 INFO] Step 55000/100000; acc:  64.09; ppl:  4.28; xent: 1.45; lr: 0.05000;   0/922 tok/s;  65342 sec
[2020-01-02 21:07:59,703 INFO] Step 55500/100000; acc:  64.15; ppl:  4.26; xent: 1.45; lr: 0.05000;   0/929 tok/s;  65975 sec
[2020-01-02 21:18:31,969 INFO] Step 56000/100000; acc:  64.25; ppl:  4.25; xent: 1.45; lr: 0.05000;   0/927 tok/s;  66607 sec
[2020-01-02 21:29:11,727 INFO] Step 56500/100000; acc:  64.55; ppl:  4.19; xent: 1.43; lr: 0.05000;   0/919 tok/s;  67247 sec
[2020-01-02 21:39:38,689 INFO] Step 57000/100000; acc:  64.44; ppl:  4.21; xent: 1.44; lr: 0.05000;   0/929 tok/s;  67874 sec
[2020-01-02 21:50:20,302 INFO] Step 57500/100000; acc:  64.51; ppl:  4.17; xent: 1.43; lr: 0.05000;   0/920 tok/s;  68515 sec
[2020-01-02 22:00:50,871 INFO] Step 58000/100000; acc:  64.27; ppl:  4.23; xent: 1.44; lr: 0.05000;   0/924 tok/s;  69146 sec
[2020-01-02 22:11:12,142 INFO] Step 58500/100000; acc:  64.32; ppl:  4.23; xent: 1.44; lr: 0.05000;   0/940 tok/s;  69767 sec
[2020-01-02 22:21:19,815 INFO] Step 59000/100000; acc:  64.34; ppl:  4.23; xent: 1.44; lr: 0.05000;   0/968 tok/s;  70375 sec
[2020-01-02 22:30:21,939 INFO] Step 59500/100000; acc:  64.39; ppl:  4.21; xent: 1.44; lr: 0.05000;   0/1075 tok/s;  70917 sec
[2020-01-02 22:39:35,722 INFO] Step 60000/100000; acc:  64.53; ppl:  4.19; xent: 1.43; lr: 0.02500;   0/1062 tok/s;  71471 sec
[2020-01-02 22:44:22,719 INFO] Validation perplexity: 4.85638
[2020-01-02 22:44:22,720 INFO] Validation accuracy: 61.9552
[2020-01-02 22:44:22,722 INFO] Saving checkpoint ../results/models/im2latex-68_step_60000.pt
[2020-01-02 22:53:35,251 INFO] Step 60500/100000; acc:  64.69; ppl:  4.16; xent: 1.42; lr: 0.02500;   0/699 tok/s;  72310 sec
[2020-01-02 23:02:36,110 INFO] Step 61000/100000; acc:  64.92; ppl:  4.11; xent: 1.41; lr: 0.02500;   0/1077 tok/s;  72851 sec
[2020-01-02 23:11:58,246 INFO] Step 61500/100000; acc:  65.02; ppl:  4.09; xent: 1.41; lr: 0.02500;   0/1049 tok/s;  73413 sec
[2020-01-02 23:20:56,256 INFO] Step 62000/100000; acc:  64.83; ppl:  4.13; xent: 1.42; lr: 0.02500;   0/1080 tok/s;  73951 sec
[2020-01-02 23:30:03,800 INFO] Step 62500/100000; acc:  64.90; ppl:  4.11; xent: 1.41; lr: 0.02500;   0/1074 tok/s;  74499 sec
[2020-01-02 23:39:11,329 INFO] Step 63000/100000; acc:  65.15; ppl:  4.07; xent: 1.40; lr: 0.02500;   0/1077 tok/s;  75046 sec
[2020-01-02 23:48:07,522 INFO] Step 63500/100000; acc:  65.16; ppl:  4.06; xent: 1.40; lr: 0.02500;   0/1087 tok/s;  75582 sec
[2020-01-02 23:57:13,465 INFO] Step 64000/100000; acc:  65.36; ppl:  4.04; xent: 1.40; lr: 0.02500;   0/1072 tok/s;  76128 sec
[2020-01-03 00:06:21,586 INFO] Step 64500/100000; acc:  65.02; ppl:  4.10; xent: 1.41; lr: 0.02500;   0/1070 tok/s;  76676 sec
[2020-01-03 00:15:31,309 INFO] Step 65000/100000; acc:  65.19; ppl:  4.04; xent: 1.40; lr: 0.02500;   0/1067 tok/s;  77226 sec
[2020-01-03 00:24:41,116 INFO] Step 65500/100000; acc:  65.12; ppl:  4.07; xent: 1.40; lr: 0.02500;   0/1064 tok/s;  77776 sec
[2020-01-03 00:33:36,672 INFO] Step 66000/100000; acc:  65.06; ppl:  4.08; xent: 1.41; lr: 0.02500;   0/1092 tok/s;  78311 sec
[2020-01-03 00:42:38,748 INFO] Step 66500/100000; acc:  65.12; ppl:  4.07; xent: 1.40; lr: 0.02500;   0/1083 tok/s;  78854 sec
[2020-01-03 00:51:39,243 INFO] Step 67000/100000; acc:  65.20; ppl:  4.05; xent: 1.40; lr: 0.02500;   0/1085 tok/s;  79394 sec
[2020-01-03 01:00:46,455 INFO] Step 67500/100000; acc:  65.37; ppl:  4.03; xent: 1.39; lr: 0.02500;   0/1073 tok/s;  79941 sec
[2020-01-03 01:09:54,131 INFO] Step 68000/100000; acc:  65.30; ppl:  4.03; xent: 1.39; lr: 0.02500;   0/1069 tok/s;  80489 sec
[2020-01-03 01:18:56,761 INFO] Step 68500/100000; acc:  65.32; ppl:  4.04; xent: 1.40; lr: 0.02500;   0/1074 tok/s;  81032 sec
[2020-01-03 01:28:08,772 INFO] Step 69000/100000; acc:  65.33; ppl:  4.02; xent: 1.39; lr: 0.02500;   0/1069 tok/s;  81584 sec
[2020-01-03 01:37:12,124 INFO] Step 69500/100000; acc:  65.22; ppl:  4.05; xent: 1.40; lr: 0.02500;   0/1073 tok/s;  82127 sec
[2020-01-03 01:46:10,368 INFO] Step 70000/100000; acc:  65.14; ppl:  4.07; xent: 1.40; lr: 0.01250;   0/1088 tok/s;  82665 sec
[2020-01-03 01:50:55,760 INFO] Validation perplexity: 4.83356
[2020-01-03 01:50:55,761 INFO] Validation accuracy: 62.3014
[2020-01-03 01:50:55,763 INFO] Saving checkpoint ../results/models/im2latex-68_step_70000.pt
[2020-01-03 02:00:01,948 INFO] Step 70500/100000; acc:  65.44; ppl:  4.02; xent: 1.39; lr: 0.01250;   0/709 tok/s;  83497 sec
[2020-01-03 02:09:03,301 INFO] Step 71000/100000; acc:  65.54; ppl:  4.00; xent: 1.39; lr: 0.01250;   0/1077 tok/s;  84038 sec
[2020-01-03 02:18:10,072 INFO] Step 71500/100000; acc:  65.69; ppl:  3.96; xent: 1.38; lr: 0.01250;   0/1074 tok/s;  84585 sec
[2020-01-03 02:27:15,815 INFO] Step 72000/100000; acc:  65.45; ppl:  4.00; xent: 1.39; lr: 0.01250;   0/1074 tok/s;  85131 sec
[2020-01-03 02:36:13,771 INFO] Step 72500/100000; acc:  65.63; ppl:  3.97; xent: 1.38; lr: 0.01250;   0/1083 tok/s;  85669 sec
[2020-01-03 02:45:29,372 INFO] Step 73000/100000; acc:  65.75; ppl:  3.95; xent: 1.37; lr: 0.01250;   0/1060 tok/s;  86224 sec
[2020-01-03 02:54:22,495 INFO] Step 73500/100000; acc:  65.57; ppl:  3.98; xent: 1.38; lr: 0.01250;   0/1090 tok/s;  86757 sec
[2020-01-03 03:03:29,573 INFO] Step 74000/100000; acc:  65.55; ppl:  3.98; xent: 1.38; lr: 0.01250;   0/1076 tok/s;  87304 sec
[2020-01-03 03:12:31,156 INFO] Step 74500/100000; acc:  65.63; ppl:  3.98; xent: 1.38; lr: 0.01250;   0/1084 tok/s;  87846 sec
[2020-01-03 03:21:30,380 INFO] Step 75000/100000; acc:  65.66; ppl:  3.97; xent: 1.38; lr: 0.01250;   0/1084 tok/s;  88385 sec
[2020-01-03 03:30:39,976 INFO] Step 75500/100000; acc:  65.83; ppl:  3.93; xent: 1.37; lr: 0.01250;   0/1066 tok/s;  88935 sec
[2020-01-03 03:39:41,745 INFO] Step 76000/100000; acc:  65.53; ppl:  3.98; xent: 1.38; lr: 0.01250;   0/1079 tok/s;  89477 sec
[2020-01-03 03:48:54,378 INFO] Step 76500/100000; acc:  65.79; ppl:  3.92; xent: 1.37; lr: 0.01250;   0/1063 tok/s;  90029 sec
[2020-01-03 03:57:58,413 INFO] Step 77000/100000; acc:  65.72; ppl:  3.95; xent: 1.37; lr: 0.01250;   0/1074 tok/s;  90573 sec
[2020-01-03 04:06:55,485 INFO] Step 77500/100000; acc:  65.69; ppl:  3.95; xent: 1.37; lr: 0.01250;   0/1091 tok/s;  91110 sec
[2020-01-03 04:16:02,617 INFO] Step 78000/100000; acc:  65.60; ppl:  3.99; xent: 1.38; lr: 0.01250;   0/1075 tok/s;  91657 sec
[2020-01-03 04:25:02,277 INFO] Step 78500/100000; acc:  65.58; ppl:  3.97; xent: 1.38; lr: 0.01250;   0/1085 tok/s;  92197 sec
[2020-01-03 04:34:08,654 INFO] Step 79000/100000; acc:  65.83; ppl:  3.94; xent: 1.37; lr: 0.01250;   0/1072 tok/s;  92743 sec
[2020-01-03 04:43:13,951 INFO] Step 79500/100000; acc:  65.78; ppl:  3.94; xent: 1.37; lr: 0.01250;   0/1076 tok/s;  93289 sec
[2020-01-03 04:52:14,791 INFO] Step 80000/100000; acc:  65.77; ppl:  3.93; xent: 1.37; lr: 0.00625;   0/1077 tok/s;  93830 sec
[2020-01-03 04:56:59,926 INFO] Validation perplexity: 4.89147
[2020-01-03 04:56:59,927 INFO] Validation accuracy: 62.2817
[2020-01-03 04:56:59,929 INFO] Saving checkpoint ../results/models/im2latex-68_step_80000.pt
[2020-01-03 05:06:13,756 INFO] Step 80500/100000; acc:  65.85; ppl:  3.92; xent: 1.37; lr: 0.00625;   0/704 tok/s;  94669 sec
[2020-01-03 05:15:13,843 INFO] Step 81000/100000; acc:  65.76; ppl:  3.95; xent: 1.37; lr: 0.00625;   0/1079 tok/s;  95209 sec
[2020-01-03 05:24:08,522 INFO] Step 81500/100000; acc:  65.73; ppl:  3.95; xent: 1.37; lr: 0.00625;   0/1092 tok/s;  95743 sec
[2020-01-03 05:33:17,293 INFO] Step 82000/100000; acc:  65.83; ppl:  3.93; xent: 1.37; lr: 0.00625;   0/1078 tok/s;  96292 sec
[2020-01-03 05:42:15,090 INFO] Step 82500/100000; acc:  65.91; ppl:  3.92; xent: 1.37; lr: 0.00625;   0/1084 tok/s;  96830 sec
[2020-01-03 05:51:21,034 INFO] Step 83000/100000; acc:  66.08; ppl:  3.89; xent: 1.36; lr: 0.00625;   0/1072 tok/s;  97376 sec
[2020-01-03 06:00:24,770 INFO] Step 83500/100000; acc:  65.85; ppl:  3.93; xent: 1.37; lr: 0.00625;   0/1078 tok/s;  97920 sec
[2020-01-03 06:09:24,195 INFO] Step 84000/100000; acc:  65.97; ppl:  3.89; xent: 1.36; lr: 0.00625;   0/1083 tok/s;  98459 sec
[2020-01-03 06:18:41,742 INFO] Step 84500/100000; acc:  66.01; ppl:  3.90; xent: 1.36; lr: 0.00625;   0/1056 tok/s;  99017 sec
[2020-01-03 06:27:31,290 INFO] Step 85000/100000; acc:  65.81; ppl:  3.93; xent: 1.37; lr: 0.00625;   0/1098 tok/s;  99546 sec
[2020-01-03 06:36:33,968 INFO] Step 85500/100000; acc:  65.75; ppl:  3.94; xent: 1.37; lr: 0.00625;   0/1079 tok/s; 100089 sec
[2020-01-03 06:45:36,352 INFO] Step 86000/100000; acc:  65.93; ppl:  3.91; xent: 1.36; lr: 0.00625;   0/1086 tok/s; 100631 sec
[2020-01-03 06:54:37,525 INFO] Step 86500/100000; acc:  65.98; ppl:  3.91; xent: 1.36; lr: 0.00625;   0/1081 tok/s; 101172 sec
[2020-01-03 07:03:45,595 INFO] Step 87000/100000; acc:  66.13; ppl:  3.88; xent: 1.36; lr: 0.00625;   0/1071 tok/s; 101720 sec
[2020-01-03 07:12:44,729 INFO] Step 87500/100000; acc:  65.93; ppl:  3.91; xent: 1.36; lr: 0.00625;   0/1082 tok/s; 102260 sec
[2020-01-03 07:21:56,591 INFO] Step 88000/100000; acc:  66.06; ppl:  3.88; xent: 1.35; lr: 0.00625;   0/1067 tok/s; 102811 sec
[2020-01-03 07:30:57,772 INFO] Step 88500/100000; acc:  65.84; ppl:  3.92; xent: 1.37; lr: 0.00625;   0/1077 tok/s; 103353 sec
[2020-01-03 07:39:52,248 INFO] Step 89000/100000; acc:  65.98; ppl:  3.90; xent: 1.36; lr: 0.00625;   0/1094 tok/s; 103887 sec
[2020-01-03 07:49:04,521 INFO] Step 89500/100000; acc:  65.88; ppl:  3.93; xent: 1.37; lr: 0.00625;   0/1068 tok/s; 104439 sec
[2020-01-03 07:58:03,440 INFO] Step 90000/100000; acc:  66.02; ppl:  3.91; xent: 1.36; lr: 0.00313;   0/1085 tok/s; 104978 sec
[2020-01-03 08:02:48,425 INFO] Validation perplexity: 4.85936
[2020-01-03 08:02:48,426 INFO] Validation accuracy: 62.3695
[2020-01-03 08:02:48,428 INFO] Saving checkpoint ../results/models/im2latex-68_step_90000.pt
[2020-01-03 08:11:55,813 INFO] Step 90500/100000; acc:  66.12; ppl:  3.88; xent: 1.36; lr: 0.00313;   0/705 tok/s; 105811 sec
[2020-01-03 08:21:00,998 INFO] Step 91000/100000; acc:  66.00; ppl:  3.90; xent: 1.36; lr: 0.00313;   0/1076 tok/s; 106356 sec
[2020-01-03 08:30:00,185 INFO] Step 91500/100000; acc:  66.08; ppl:  3.88; xent: 1.36; lr: 0.00313;   0/1080 tok/s; 106895 sec
[2020-01-03 08:39:16,377 INFO] Step 92000/100000; acc:  66.08; ppl:  3.88; xent: 1.36; lr: 0.00313;   0/1061 tok/s; 107451 sec
[2020-01-03 08:48:13,901 INFO] Step 92500/100000; acc:  65.98; ppl:  3.90; xent: 1.36; lr: 0.00313;   0/1084 tok/s; 107989 sec
[2020-01-03 08:57:15,109 INFO] Step 93000/100000; acc:  65.94; ppl:  3.91; xent: 1.36; lr: 0.00313;   0/1083 tok/s; 108530 sec
[2020-01-03 09:06:21,229 INFO] Step 93500/100000; acc:  66.15; ppl:  3.88; xent: 1.36; lr: 0.00313;   0/1081 tok/s; 109076 sec
[2020-01-03 09:15:17,390 INFO] Step 94000/100000; acc:  66.14; ppl:  3.87; xent: 1.35; lr: 0.00313;   0/1086 tok/s; 109612 sec
[2020-01-03 09:24:25,254 INFO] Step 94500/100000; acc:  66.22; ppl:  3.87; xent: 1.35; lr: 0.00313;   0/1069 tok/s; 110160 sec
[2020-01-03 09:33:29,218 INFO] Step 95000/100000; acc:  65.95; ppl:  3.91; xent: 1.36; lr: 0.00313;   0/1076 tok/s; 110704 sec
[2020-01-03 09:42:33,091 INFO] Step 95500/100000; acc:  66.17; ppl:  3.86; xent: 1.35; lr: 0.00313;   0/1077 tok/s; 111248 sec
[2020-01-03 09:51:45,861 INFO] Step 96000/100000; acc:  66.11; ppl:  3.88; xent: 1.36; lr: 0.00313;   0/1061 tok/s; 111801 sec
[2020-01-03 10:00:36,711 INFO] Step 96500/100000; acc:  66.06; ppl:  3.89; xent: 1.36; lr: 0.00313;   0/1098 tok/s; 112332 sec
[2020-01-03 10:09:39,725 INFO] Step 97000/100000; acc:  65.97; ppl:  3.91; xent: 1.36; lr: 0.00313;   0/1079 tok/s; 112875 sec
[2020-01-03 10:18:43,232 INFO] Step 97500/100000; acc:  66.13; ppl:  3.89; xent: 1.36; lr: 0.00313;   0/1080 tok/s; 113418 sec
[2020-01-03 10:27:47,229 INFO] Step 98000/100000; acc:  66.13; ppl:  3.88; xent: 1.36; lr: 0.00313;   0/1079 tok/s; 113962 sec
[2020-01-03 10:36:55,770 INFO] Step 98500/100000; acc:  66.21; ppl:  3.86; xent: 1.35; lr: 0.00313;   0/1070 tok/s; 114511 sec
[2020-01-03 10:45:53,778 INFO] Step 99000/100000; acc:  66.16; ppl:  3.88; xent: 1.36; lr: 0.00313;   0/1083 tok/s; 115049 sec
[2020-01-03 10:55:04,872 INFO] Step 99500/100000; acc:  66.15; ppl:  3.86; xent: 1.35; lr: 0.00313;   0/1070 tok/s; 115600 sec
[2020-01-03 11:04:08,734 INFO] Step 100000/100000; acc:  66.09; ppl:  3.88; xent: 1.36; lr: 0.00156;   0/1072 tok/s; 116144 sec
[2020-01-03 11:08:54,018 INFO] Validation perplexity: 4.8465
[2020-01-03 11:08:54,019 INFO] Validation accuracy: 62.4381
[2020-01-03 11:08:54,022 INFO] Saving checkpoint ../results/models/im2latex-68_step_100000.pt
